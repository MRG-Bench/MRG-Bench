{"litestar-litestar/file_system.py-info": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 8 items\n\ntests/unit/test_file_system.py FF                                        [ 25%]\ntests/unit/test_response/test_file_response.py F                         [ 37%]\ntests/unit/test_file_system.py ..                                        [ 62%]\ntests/unit/test_response/test_file_response.py .                         [ 75%]\ntests/unit/test_file_system.py F.                                        [100%]\n\n=================================== FAILURES ===================================\n______ test_file_adapter_info_handles_permission_exception[file_system0] _______\n\ntmpdir = local('/tmp/pytest-of-root/pytest-2557/test_file_adapter_info_handles0')\nfile_system = <litestar.file_system.BaseLocalFileSystem object at 0x7f90204eb490>\n\n    @pytest.mark.parametrize(\"file_system\", (BaseLocalFileSystem(), LocalFileSystem()))\n    @pytest.mark.xfail(sys.platform == \"win32\", reason=\"permissions equivalent missing on windows\")\n    async def test_file_adapter_info_handles_permission_exception(tmpdir: Path, file_system: \"FileSystemProtocol\") -> None:\n        file = Path(tmpdir / \"test.txt\")\n        file.write_bytes(b\"test\")\n    \n        owner_permissions = file.stat().st_mode\n        Path(tmpdir).chmod(S_IRWXO)\n        adapter = FileSystemAdapter(file_system=file_system)\n    \n        with pytest.raises(NotAuthorizedException):\n>           await adapter.info(path=file)\n\ntests/unit/test_file_system.py:95: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nlitestar/file_system.py:91: in info\n    return cast(\"FileInfo\", await awaitable)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar.file_system.BaseLocalFileSystem object at 0x7f90204eb490>\npath = '/tmp/pytest-of-root/pytest-2557/test_file_adapter_info_handles0/test.txt'\nkwargs = {}\nstat_result = os.stat_result(st_mode=33188, st_ino=59429987, st_dev=57, st_nlink=1, st_uid=0, st_gid=0, st_size=4, st_atime=1726184526, st_mtime=1726184526, st_ctime=1726184526)\n\n    async def info(self, path: PathType, **kwargs: Any) -> FileInfo:\n        \"\"\"Retrieve information about a given file path.\n    \n        Args:\n            path: A file path.\n            **kwargs: Any additional kwargs.\n    \n        Returns:\n            A dictionary of file info.\n        \"\"\"\n        try:\n            stat_result = await Path(path).stat()\n>           file_info = await self.parse_stat_result(path, stat_result)\nE           AttributeError: 'BaseLocalFileSystem' object has no attribute 'parse_stat_result'\n\nlitestar/file_system.py:40: AttributeError\n______ test_file_adapter_info_handles_permission_exception[file_system1] _______\n\ntmpdir = local('/tmp/pytest-of-root/pytest-2557/test_file_adapter_info_handles1')\nfile_system = <fsspec.implementations.local.LocalFileSystem object at 0x7f90204ea800>\n\n    @pytest.mark.parametrize(\"file_system\", (BaseLocalFileSystem(), LocalFileSystem()))\n    @pytest.mark.xfail(sys.platform == \"win32\", reason=\"permissions equivalent missing on windows\")\n    async def test_file_adapter_info_handles_permission_exception(tmpdir: Path, file_system: \"FileSystemProtocol\") -> None:\n        file = Path(tmpdir / \"test.txt\")\n        file.write_bytes(b\"test\")\n    \n        owner_permissions = file.stat().st_mode\n        Path(tmpdir).chmod(S_IRWXO)\n        adapter = FileSystemAdapter(file_system=file_system)\n    \n>       with pytest.raises(NotAuthorizedException):\nE       Failed: DID NOT RAISE <class 'litestar.exceptions.http_exceptions.NotAuthorizedException'>\n\ntests/unit/test_file_system.py:94: Failed\n_________________________ test_file_with_symbolic_link _________________________\n\ntmpdir = local('/tmp/pytest-of-root/pytest-2557/test_file_with_symbolic_link0')\n\n    async def test_file_with_symbolic_link(tmpdir: \"Path\") -> None:\n        path = tmpdir / \"text.txt\"\n        path.write_text(\"content\", \"utf-8\")\n    \n        linked = tmpdir / \"alt.txt\"\n        os.symlink(path, linked, target_is_directory=False)\n    \n        fs = BaseLocalFileSystem()\n>       file_info = await fs.info(linked)\n\ntests/unit/test_response/test_file_response.py:203: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar.file_system.BaseLocalFileSystem object at 0x7f9020282530>\npath = local('/tmp/pytest-of-root/pytest-2557/test_file_with_symbolic_link0/alt.txt')\nkwargs = {}\nstat_result = os.stat_result(st_mode=33188, st_ino=59429999, st_dev=57, st_nlink=1, st_uid=0, st_gid=0, st_size=7, st_atime=1726184526, st_mtime=1726184526, st_ctime=1726184526)\n\n    async def info(self, path: PathType, **kwargs: Any) -> FileInfo:\n        \"\"\"Retrieve information about a given file path.\n    \n        Args:\n            path: A file path.\n            **kwargs: Any additional kwargs.\n    \n        Returns:\n            A dictionary of file info.\n        \"\"\"\n        try:\n            stat_result = await Path(path).stat()\n>           file_info = await self.parse_stat_result(path, stat_result)\nE           AttributeError: 'BaseLocalFileSystem' object has no attribute 'parse_stat_result'\n\nlitestar/file_system.py:40: AttributeError\n_____________________ test_file_adapter_info[file_system0] _____________________\n\ntmpdir = local('/tmp/pytest-of-root/pytest-2557/test_file_adapter_info_file_sy0')\nfile_system = <litestar.file_system.BaseLocalFileSystem object at 0x7f90204ebe80>\n\n    @pytest.mark.parametrize(\"file_system\", (BaseLocalFileSystem(), LocalFileSystem()))\n    @pytest.mark.xfail(sys.platform == \"win32\", reason=\"Suspected fsspec issue\", strict=False)\n    async def test_file_adapter_info(tmpdir: Path, file_system: \"FileSystemProtocol\") -> None:\n        file = Path(tmpdir / \"test.txt\")\n        file.write_bytes(b\"test\")\n        adapter = FileSystemAdapter(file_system=file_system)\n    \n        result = file.stat()\n    \n>       assert await adapter.info(file) == {\n            \"gid\": result.st_gid,\n            \"ino\": result.st_ino,\n            \"islink\": False,\n            \"mode\": result.st_mode,\n            \"mtime\": result.st_mtime,\n            \"name\": str(file),\n            \"nlink\": 1,\n            \"created\": result.st_ctime,\n            \"size\": result.st_size,\n            \"type\": \"file\",\n            \"uid\": result.st_uid,\n        }\n\ntests/unit/test_file_system.py:61: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nlitestar/file_system.py:91: in info\n    return cast(\"FileInfo\", await awaitable)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar.file_system.BaseLocalFileSystem object at 0x7f90204ebe80>\npath = '/tmp/pytest-of-root/pytest-2557/test_file_adapter_info_file_sy0/test.txt'\nkwargs = {}\nstat_result = os.stat_result(st_mode=33188, st_ino=59431398, st_dev=57, st_nlink=1, st_uid=0, st_gid=0, st_size=4, st_atime=1726184526, st_mtime=1726184526, st_ctime=1726184526)\n\n    async def info(self, path: PathType, **kwargs: Any) -> FileInfo:\n        \"\"\"Retrieve information about a given file path.\n    \n        Args:\n            path: A file path.\n            **kwargs: Any additional kwargs.\n    \n        Returns:\n            A dictionary of file info.\n        \"\"\"\n        try:\n            stat_result = await Path(path).stat()\n>           file_info = await self.parse_stat_result(path, stat_result)\nE           AttributeError: 'BaseLocalFileSystem' object has no attribute 'parse_stat_result'\n\nlitestar/file_system.py:40: AttributeError\n=========================== short test summary info ============================\nFAILED tests/unit/test_file_system.py::test_file_adapter_info_handles_permission_exception[file_system0]\nFAILED tests/unit/test_file_system.py::test_file_adapter_info_handles_permission_exception[file_system1]\nFAILED tests/unit/test_response/test_file_response.py::test_file_with_symbolic_link\nFAILED tests/unit/test_file_system.py::test_file_adapter_info[file_system0]\n========================= 4 failed, 4 passed in 0.18s ==========================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/typing.py-has_inner_subclass_of": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 2 items\n\ntests/unit/test_dto/test_factory/test_backends/test_backends.py ..       [100%]\n\n============================== 2 passed in 0.07s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/typing.py-get_type_hints": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 1 item\n\ntests/unit/test_typing.py .                                              [100%]\n\n============================== 1 passed in 0.07s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/typing.py-from_kwarg": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 29 items\n\ntests/unit/test_dto/test_factory/test_dataclass_dto.py s                 [  3%]\ntests/unit/test_dto/test_factory/test_backends/test_backends.py FF       [ 10%]\ntests/unit/test_contrib/test_attrs/test_schema_plugin.py F               [ 13%]\ntests/unit/test_openapi/test_schema.py FF                                [ 20%]\ntests/unit/test_dto/test_factory/test_base_dto.py .                      [ 24%]\ntests/unit/test_dto/test_factory/test_backends/test_utils.py .           [ 27%]\ntests/unit/test_openapi/test_schema.py .                                 [ 31%]\ntests/unit/test_dto/test_factory/test_dataclass_dto.py .                 [ 34%]\ntests/unit/test_contrib/test_pydantic/test_openapi.py .                  [ 37%]\ntests/unit/test_openapi/test_schema.py FFF                               [ 48%]\ntests/unit/test_contrib/test_pydantic/test_openapi.py .                  [ 51%]\ntests/unit/test_openapi/test_schema.py .FFF.                             [ 68%]\ntests/unit/test_dto/test_factory/test_base_dto.py .                      [ 72%]\ntests/unit/test_dto/test_factory/test_backends/test_utils.py .           [ 75%]\ntests/unit/test_contrib/test_pydantic/test_schema_plugin.py FF           [ 82%]\ntests/unit/test_typing.py .                                              [ 86%]\ntests/unit/test_contrib/test_pydantic/test_openapi.py .                  [ 89%]\ntests/unit/test_openapi/test_schema.py FF                                [ 96%]\ntests/unit/test_dto/test_factory/test_base_dto.py .                      [100%]\n\n=================================== FAILURES ===================================\n___________ test_backend_model_name_uniqueness[experimental_backend] ___________\n\ndto_factory = <class 'tests.unit.test_dto.test_factory.test_backends.test_backends.fx_backend_factory.<locals>.Factory'>\nbackend_cls = <class 'litestar.dto._codegen_backend.DTOCodegenBackend'>\n\n    def test_backend_model_name_uniqueness(dto_factory: type[DataclassDTO], backend_cls: type[DTOBackend]) -> None:\n>       backend = backend_cls(\n            handler_id=\"test\",\n            dto_factory=dto_factory,\n            field_definition=FieldDefinition.from_annotation(DC),\n            model_type=DC,\n            wrapper_attribute_name=None,\n            is_data_field=True,\n        )\n\ntests/unit/test_dto/test_factory/test_backends/test_backends.py:233: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nlitestar/dto/_codegen_backend.py:73: in __init__\n    super().__init__(\nlitestar/dto/_backend.py:108: in __init__\n    self.parsed_field_definitions = self.parse_model(\nlitestar/dto/_backend.py:151: in parse_model\n    transfer_type = self._create_transfer_type(\nlitestar/dto/_backend.py:394: in _create_transfer_type\n    return composite_type_handler(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar.dto._codegen_backend.DTOCodegenBackend object at 0x7fe1be64b920>\nfield_definition = DTOFieldDefinition(raw=typing.Optional[str], annotation=typing.Optional[str], type_wrappers=set(), origin=typing.Union...extra={}, kwarg_definition=None, name='optional', model_name='DC', default_factory=None, dto_field=DTOField(mark=None))\nexclude = set(), include = set(), rename_fields = {}, unique_name = 'DC'\nnested_depth = 0\n\n    def _create_union_type(\n        self,\n        field_definition: FieldDefinition,\n        exclude: AbstractSet[str],\n        include: AbstractSet[str],\n        rename_fields: dict[str, str],\n        unique_name: str,\n        nested_depth: int,\n    ) -> UnionType:\n        inner_types = tuple(\n            self._create_transfer_type(\n                field_definition=inner_type,\n                exclude=exclude,\n                include=include,\n                field_name=str(i),\n                unique_name=f\"{unique_name}_{i}\",\n                nested_depth=nested_depth,\n                rename_fields=rename_fields,\n            )\n>           for i, inner_type in enumerate(field_definition.inner_types)\n        )\nE       TypeError: 'NoneType' object is not iterable\n\nlitestar/dto/_backend.py:530: TypeError\n_____________ test_backend_model_name_uniqueness[default_backend] ______________\n\ndto_factory = <class 'tests.unit.test_dto.test_factory.test_backends.test_backends.fx_backend_factory.<locals>.Factory'>\nbackend_cls = <class 'litestar.dto._backend.DTOBackend'>\n\n    def test_backend_model_name_uniqueness(dto_factory: type[DataclassDTO], backend_cls: type[DTOBackend]) -> None:\n>       backend = backend_cls(\n            handler_id=\"test\",\n            dto_factory=dto_factory,\n            field_definition=FieldDefinition.from_annotation(DC),\n            model_type=DC,\n            wrapper_attribute_name=None,\n            is_data_field=True,\n        )\n\ntests/unit/test_dto/test_factory/test_backends/test_backends.py:233: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nlitestar/dto/_backend.py:108: in __init__\n    self.parsed_field_definitions = self.parse_model(\nlitestar/dto/_backend.py:151: in parse_model\n    transfer_type = self._create_transfer_type(\nlitestar/dto/_backend.py:394: in _create_transfer_type\n    return composite_type_handler(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar.dto._backend.DTOBackend object at 0x7fe1be722e40>\nfield_definition = DTOFieldDefinition(raw=typing.Optional[str], annotation=typing.Optional[str], type_wrappers=set(), origin=typing.Union...extra={}, kwarg_definition=None, name='optional', model_name='DC', default_factory=None, dto_field=DTOField(mark=None))\nexclude = set(), include = set(), rename_fields = {}, unique_name = 'DC'\nnested_depth = 0\n\n    def _create_union_type(\n        self,\n        field_definition: FieldDefinition,\n        exclude: AbstractSet[str],\n        include: AbstractSet[str],\n        rename_fields: dict[str, str],\n        unique_name: str,\n        nested_depth: int,\n    ) -> UnionType:\n        inner_types = tuple(\n            self._create_transfer_type(\n                field_definition=inner_type,\n                exclude=exclude,\n                include=include,\n                field_name=str(i),\n                unique_name=f\"{unique_name}_{i}\",\n                nested_depth=nested_depth,\n                rename_fields=rename_fields,\n            )\n>           for i, inner_type in enumerate(field_definition.inner_types)\n        )\nE       TypeError: 'NoneType' object is not iterable\n\nlitestar/dto/_backend.py:530: TypeError\n_________________ test_schema_generation_with_generic_classes __________________\n\n    def test_schema_generation_with_generic_classes() -> None:\n        cls = AttrsGeneric[int]\n        expected_foo_schema = Schema(type=OpenAPIType.INTEGER)\n        expected_optional_foo_schema = Schema(one_of=[Schema(type=OpenAPIType.NULL), Schema(type=OpenAPIType.INTEGER)])\n    \n        field_definition = FieldDefinition.from_kwarg(name=get_name(cls), annotation=cls)\n>       properties = get_schema_for_field_definition(field_definition, plugins=[AttrsSchemaPlugin()]).properties\n\ntests/unit/test_contrib/test_attrs/test_schema_plugin.py:29: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/helpers.py:79: in get_schema_for_field_definition\n    result = creator.for_field_definition(field_definition)\nlitestar/_openapi/schema_generation/schema.py:332: in for_field_definition\n    result = self.for_plugin(field_definition, plugin_for_annotation)\nlitestar/_openapi/schema_generation/schema.py:503: in for_plugin\n    schema = plugin.to_openapi_schema(field_definition=field_definition, schema_creator=self)\nlitestar/contrib/attrs/attrs_schema_plugin.py:42: in to_openapi_schema\n    return schema_creator.create_component_schema(\nlitestar/_openapi/schema_generation/schema.py:639: in create_component_schema\n    schema.properties = {k: self.for_field_definition(v) for k, v in property_fields.items()}\nlitestar/_openapi/schema_generation/schema.py:639: in <dictcomp>\n    schema.properties = {k: self.for_field_definition(v) for k, v in property_fields.items()}\nlitestar/_openapi/schema_generation/schema.py:333: in for_field_definition\n    elif _should_create_enum_schema(field_definition):\nlitestar/_openapi/schema_generation/utils.py:57: in _should_create_enum_schema\n    return field_definition.is_subclass_of(Enum) or (\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = FieldDefinition(raw=typing.Optional[int], annotation=typing.Optional[int], type_wrappers=set(), origin=typing.Union, a...in=typing.Union, inner_types=None, default=<_EmptyEnum.EMPTY: 0>, extra={}, kwarg_definition=None, name='optional_foo')\ncl = <enum 'Enum'>\n\n    def is_subclass_of(self, cl: type[Any] | tuple[type[Any], ...]) -> bool:\n        \"\"\"Whether the annotation is a subclass of the given type.\n    \n        Where ``self.annotation`` is a union type, this method will return ``True`` when all members of the union are\n        a subtype of ``cl``, otherwise, ``False``.\n    \n        Args:\n            cl: The type to check, or tuple of types. Passed as 2nd argument to ``issubclass()``.\n    \n        Returns:\n            Whether the annotation is a subtype of the given type(s).\n        \"\"\"\n        if self.origin:\n            if self.origin in UnionTypes:\n>               return all(t.is_subclass_of(cl) for t in self.inner_types)\nE               TypeError: 'NoneType' object is not iterable\n\nlitestar/typing.py:452: TypeError\n________ test_schema_generation_with_generic_classes[DataclassGeneric] _________\n\ncls = tests.unit.test_openapi.test_schema.DataclassGeneric[int]\n\n    @pytest.mark.parametrize(\"cls\", annotations)\n    def test_schema_generation_with_generic_classes(cls: Any) -> None:\n        expected_foo_schema = Schema(type=OpenAPIType.INTEGER)\n        expected_optional_foo_schema = Schema(one_of=[Schema(type=OpenAPIType.NULL), Schema(type=OpenAPIType.INTEGER)])\n    \n>       properties = get_schema_for_field_definition(\n            FieldDefinition.from_kwarg(name=get_name(cls), annotation=cls)\n        ).properties\n\ntests/unit/test_openapi/test_schema.py:375: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/helpers.py:79: in get_schema_for_field_definition\n    result = creator.for_field_definition(field_definition)\nlitestar/_openapi/schema_generation/schema.py:332: in for_field_definition\n    result = self.for_plugin(field_definition, plugin_for_annotation)\nlitestar/_openapi/schema_generation/schema.py:503: in for_plugin\n    schema = plugin.to_openapi_schema(field_definition=field_definition, schema_creator=self)\nlitestar/_openapi/schema_generation/plugins/dataclass.py:24: in to_openapi_schema\n    return schema_creator.create_component_schema(\nlitestar/_openapi/schema_generation/schema.py:639: in create_component_schema\n    schema.properties = {k: self.for_field_definition(v) for k, v in property_fields.items()}\nlitestar/_openapi/schema_generation/schema.py:639: in <dictcomp>\n    schema.properties = {k: self.for_field_definition(v) for k, v in property_fields.items()}\nlitestar/_openapi/schema_generation/schema.py:333: in for_field_definition\n    elif _should_create_enum_schema(field_definition):\nlitestar/_openapi/schema_generation/utils.py:57: in _should_create_enum_schema\n    return field_definition.is_subclass_of(Enum) or (\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = FieldDefinition(raw=typing.Optional[int], annotation=typing.Optional[int], type_wrappers=set(), origin=typing.Union, a...in=typing.Union, inner_types=None, default=<_EmptyEnum.EMPTY: 0>, extra={}, kwarg_definition=None, name='optional_foo')\ncl = <enum 'Enum'>\n\n    def is_subclass_of(self, cl: type[Any] | tuple[type[Any], ...]) -> bool:\n        \"\"\"Whether the annotation is a subclass of the given type.\n    \n        Where ``self.annotation`` is a union type, this method will return ``True`` when all members of the union are\n        a subtype of ``cl``, otherwise, ``False``.\n    \n        Args:\n            cl: The type to check, or tuple of types. Passed as 2nd argument to ``issubclass()``.\n    \n        Returns:\n            Whether the annotation is a subtype of the given type(s).\n        \"\"\"\n        if self.origin:\n            if self.origin in UnionTypes:\n>               return all(t.is_subclass_of(cl) for t in self.inner_types)\nE               TypeError: 'NoneType' object is not iterable\n\nlitestar/typing.py:452: TypeError\n_________ test_schema_generation_with_generic_classes[MsgspecGeneric] __________\n\ncls = tests.unit.test_openapi.test_schema.MsgspecGeneric[int]\n\n    @pytest.mark.parametrize(\"cls\", annotations)\n    def test_schema_generation_with_generic_classes(cls: Any) -> None:\n        expected_foo_schema = Schema(type=OpenAPIType.INTEGER)\n        expected_optional_foo_schema = Schema(one_of=[Schema(type=OpenAPIType.NULL), Schema(type=OpenAPIType.INTEGER)])\n    \n>       properties = get_schema_for_field_definition(\n            FieldDefinition.from_kwarg(name=get_name(cls), annotation=cls)\n        ).properties\n\ntests/unit/test_openapi/test_schema.py:375: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/helpers.py:79: in get_schema_for_field_definition\n    result = creator.for_field_definition(field_definition)\nlitestar/_openapi/schema_generation/schema.py:332: in for_field_definition\n    result = self.for_plugin(field_definition, plugin_for_annotation)\nlitestar/_openapi/schema_generation/schema.py:503: in for_plugin\n    schema = plugin.to_openapi_schema(field_definition=field_definition, schema_creator=self)\nlitestar/_openapi/schema_generation/plugins/struct.py:32: in to_openapi_schema\n    return schema_creator.create_component_schema(\nlitestar/_openapi/schema_generation/schema.py:639: in create_component_schema\n    schema.properties = {k: self.for_field_definition(v) for k, v in property_fields.items()}\nlitestar/_openapi/schema_generation/schema.py:639: in <dictcomp>\n    schema.properties = {k: self.for_field_definition(v) for k, v in property_fields.items()}\nlitestar/_openapi/schema_generation/schema.py:333: in for_field_definition\n    elif _should_create_enum_schema(field_definition):\nlitestar/_openapi/schema_generation/utils.py:57: in _should_create_enum_schema\n    return field_definition.is_subclass_of(Enum) or (\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = FieldDefinition(raw=typing.Optional[int], annotation=typing.Optional[int], type_wrappers=set(), origin=typing.Union, a...in=typing.Union, inner_types=None, default=<_EmptyEnum.EMPTY: 0>, extra={}, kwarg_definition=None, name='optional_foo')\ncl = <enum 'Enum'>\n\n    def is_subclass_of(self, cl: type[Any] | tuple[type[Any], ...]) -> bool:\n        \"\"\"Whether the annotation is a subclass of the given type.\n    \n        Where ``self.annotation`` is a union type, this method will return ``True`` when all members of the union are\n        a subtype of ``cl``, otherwise, ``False``.\n    \n        Args:\n            cl: The type to check, or tuple of types. Passed as 2nd argument to ``issubclass()``.\n    \n        Returns:\n            Whether the annotation is a subtype of the given type(s).\n        \"\"\"\n        if self.origin:\n            if self.origin in UnionTypes:\n>               return all(t.is_subclass_of(cl) for t in self.inner_types)\nE               TypeError: 'NoneType' object is not iterable\n\nlitestar/typing.py:452: TypeError\n___________________________ test_type_union[Struct] ____________________________\n\nbase_type = <class 'msgspec.Struct'>\n\n    @pytest.mark.parametrize(\"base_type\", [msgspec.Struct, TypedDict, dataclass])\n    def test_type_union(base_type: type) -> None:\n        if base_type is dataclass:  # type: ignore[comparison-overlap]\n    \n            @dataclass\n            class ModelA:  # pyright: ignore\n                pass\n    \n            @dataclass\n            class ModelB:  # pyright: ignore\n                pass\n    \n        else:\n    \n            class ModelA(base_type):  # type: ignore[no-redef, misc]\n                pass\n    \n            class ModelB(base_type):  # type: ignore[no-redef, misc]\n                pass\n    \n>       schema = get_schema_for_field_definition(\n            FieldDefinition.from_kwarg(name=\"Lookup\", annotation=Union[ModelA, ModelB])\n        )\n\ntests/unit/test_openapi/test_schema.py:523: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/helpers.py:79: in get_schema_for_field_definition\n    result = creator.for_field_definition(field_definition)\nlitestar/_openapi/schema_generation/schema.py:333: in for_field_definition\n    elif _should_create_enum_schema(field_definition):\nlitestar/_openapi/schema_generation/utils.py:57: in _should_create_enum_schema\n    return field_definition.is_subclass_of(Enum) or (\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = FieldDefinition(raw=typing.Union[tests.unit.test_openapi.test_schema.test_type_union.<locals>.ModelA, tests.unit.test_...c_origin=typing.Union, inner_types=None, default=<_EmptyEnum.EMPTY: 0>, extra={}, kwarg_definition=None, name='Lookup')\ncl = <enum 'Enum'>\n\n    def is_subclass_of(self, cl: type[Any] | tuple[type[Any], ...]) -> bool:\n        \"\"\"Whether the annotation is a subclass of the given type.\n    \n        Where ``self.annotation`` is a union type, this method will return ``True`` when all members of the union are\n        a subtype of ``cl``, otherwise, ``False``.\n    \n        Args:\n            cl: The type to check, or tuple of types. Passed as 2nd argument to ``issubclass()``.\n    \n        Returns:\n            Whether the annotation is a subtype of the given type(s).\n        \"\"\"\n        if self.origin:\n            if self.origin in UnionTypes:\n>               return all(t.is_subclass_of(cl) for t in self.inner_types)\nE               TypeError: 'NoneType' object is not iterable\n\nlitestar/typing.py:452: TypeError\n__________________________ test_type_union[TypedDict] __________________________\n\nbase_type = <function TypedDict at 0x7fe1c7120310>\n\n    @pytest.mark.parametrize(\"base_type\", [msgspec.Struct, TypedDict, dataclass])\n    def test_type_union(base_type: type) -> None:\n        if base_type is dataclass:  # type: ignore[comparison-overlap]\n    \n            @dataclass\n            class ModelA:  # pyright: ignore\n                pass\n    \n            @dataclass\n            class ModelB:  # pyright: ignore\n                pass\n    \n        else:\n    \n            class ModelA(base_type):  # type: ignore[no-redef, misc]\n                pass\n    \n            class ModelB(base_type):  # type: ignore[no-redef, misc]\n                pass\n    \n>       schema = get_schema_for_field_definition(\n            FieldDefinition.from_kwarg(name=\"Lookup\", annotation=Union[ModelA, ModelB])\n        )\n\ntests/unit/test_openapi/test_schema.py:523: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/helpers.py:79: in get_schema_for_field_definition\n    result = creator.for_field_definition(field_definition)\nlitestar/_openapi/schema_generation/schema.py:333: in for_field_definition\n    elif _should_create_enum_schema(field_definition):\nlitestar/_openapi/schema_generation/utils.py:57: in _should_create_enum_schema\n    return field_definition.is_subclass_of(Enum) or (\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = FieldDefinition(raw=typing.Union[tests.unit.test_openapi.test_schema.test_type_union.<locals>.ModelA, tests.unit.test_...c_origin=typing.Union, inner_types=None, default=<_EmptyEnum.EMPTY: 0>, extra={}, kwarg_definition=None, name='Lookup')\ncl = <enum 'Enum'>\n\n    def is_subclass_of(self, cl: type[Any] | tuple[type[Any], ...]) -> bool:\n        \"\"\"Whether the annotation is a subclass of the given type.\n    \n        Where ``self.annotation`` is a union type, this method will return ``True`` when all members of the union are\n        a subtype of ``cl``, otherwise, ``False``.\n    \n        Args:\n            cl: The type to check, or tuple of types. Passed as 2nd argument to ``issubclass()``.\n    \n        Returns:\n            Whether the annotation is a subtype of the given type(s).\n        \"\"\"\n        if self.origin:\n            if self.origin in UnionTypes:\n>               return all(t.is_subclass_of(cl) for t in self.inner_types)\nE               TypeError: 'NoneType' object is not iterable\n\nlitestar/typing.py:452: TypeError\n__________________________ test_type_union[dataclass] __________________________\n\nbase_type = <function dataclass at 0x7fe1c70db910>\n\n    @pytest.mark.parametrize(\"base_type\", [msgspec.Struct, TypedDict, dataclass])\n    def test_type_union(base_type: type) -> None:\n        if base_type is dataclass:  # type: ignore[comparison-overlap]\n    \n            @dataclass\n            class ModelA:  # pyright: ignore\n                pass\n    \n            @dataclass\n            class ModelB:  # pyright: ignore\n                pass\n    \n        else:\n    \n            class ModelA(base_type):  # type: ignore[no-redef, misc]\n                pass\n    \n            class ModelB(base_type):  # type: ignore[no-redef, misc]\n                pass\n    \n>       schema = get_schema_for_field_definition(\n            FieldDefinition.from_kwarg(name=\"Lookup\", annotation=Union[ModelA, ModelB])\n        )\n\ntests/unit/test_openapi/test_schema.py:523: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/helpers.py:79: in get_schema_for_field_definition\n    result = creator.for_field_definition(field_definition)\nlitestar/_openapi/schema_generation/schema.py:333: in for_field_definition\n    elif _should_create_enum_schema(field_definition):\nlitestar/_openapi/schema_generation/utils.py:57: in _should_create_enum_schema\n    return field_definition.is_subclass_of(Enum) or (\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = FieldDefinition(raw=typing.Union[tests.unit.test_openapi.test_schema.test_type_union.<locals>.ModelA, tests.unit.test_...c_origin=typing.Union, inner_types=None, default=<_EmptyEnum.EMPTY: 0>, extra={}, kwarg_definition=None, name='Lookup')\ncl = <enum 'Enum'>\n\n    def is_subclass_of(self, cl: type[Any] | tuple[type[Any], ...]) -> bool:\n        \"\"\"Whether the annotation is a subclass of the given type.\n    \n        Where ``self.annotation`` is a union type, this method will return ``True`` when all members of the union are\n        a subtype of ``cl``, otherwise, ``False``.\n    \n        Args:\n            cl: The type to check, or tuple of types. Passed as 2nd argument to ``issubclass()``.\n    \n        Returns:\n            Whether the annotation is a subtype of the given type(s).\n        \"\"\"\n        if self.origin:\n            if self.origin in UnionTypes:\n>               return all(t.is_subclass_of(cl) for t in self.inner_types)\nE               TypeError: 'NoneType' object is not iterable\n\nlitestar/typing.py:452: TypeError\n______________________ test_type_union_with_none[Struct] _______________________\n\nbase_type = <class 'msgspec.Struct'>\n\n    @pytest.mark.parametrize(\"base_type\", [msgspec.Struct, TypedDict, dataclass])\n    def test_type_union_with_none(base_type: type) -> None:\n        # https://github.com/litestar-org/litestar/issues/2971\n        if base_type is dataclass:  # type: ignore[comparison-overlap]\n    \n            @dataclass\n            class ModelA:  # pyright: ignore\n                pass\n    \n            @dataclass\n            class ModelB:  # pyright: ignore\n                pass\n    \n        else:\n    \n            class ModelA(base_type):  # type: ignore[no-redef, misc]\n                pass\n    \n            class ModelB(base_type):  # type: ignore[no-redef, misc]\n                pass\n    \n>       schema = get_schema_for_field_definition(\n            FieldDefinition.from_kwarg(name=\"Lookup\", annotation=Union[ModelA, ModelB, None])\n        )\n\ntests/unit/test_openapi/test_schema.py:553: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/helpers.py:79: in get_schema_for_field_definition\n    result = creator.for_field_definition(field_definition)\nlitestar/_openapi/schema_generation/schema.py:333: in for_field_definition\n    elif _should_create_enum_schema(field_definition):\nlitestar/_openapi/schema_generation/utils.py:57: in _should_create_enum_schema\n    return field_definition.is_subclass_of(Enum) or (\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = FieldDefinition(raw=typing.Union[tests.unit.test_openapi.test_schema.test_type_union_with_none.<locals>.ModelA, tests....c_origin=typing.Union, inner_types=None, default=<_EmptyEnum.EMPTY: 0>, extra={}, kwarg_definition=None, name='Lookup')\ncl = <enum 'Enum'>\n\n    def is_subclass_of(self, cl: type[Any] | tuple[type[Any], ...]) -> bool:\n        \"\"\"Whether the annotation is a subclass of the given type.\n    \n        Where ``self.annotation`` is a union type, this method will return ``True`` when all members of the union are\n        a subtype of ``cl``, otherwise, ``False``.\n    \n        Args:\n            cl: The type to check, or tuple of types. Passed as 2nd argument to ``issubclass()``.\n    \n        Returns:\n            Whether the annotation is a subtype of the given type(s).\n        \"\"\"\n        if self.origin:\n            if self.origin in UnionTypes:\n>               return all(t.is_subclass_of(cl) for t in self.inner_types)\nE               TypeError: 'NoneType' object is not iterable\n\nlitestar/typing.py:452: TypeError\n_____________________ test_type_union_with_none[TypedDict] _____________________\n\nbase_type = <function TypedDict at 0x7fe1c7120310>\n\n    @pytest.mark.parametrize(\"base_type\", [msgspec.Struct, TypedDict, dataclass])\n    def test_type_union_with_none(base_type: type) -> None:\n        # https://github.com/litestar-org/litestar/issues/2971\n        if base_type is dataclass:  # type: ignore[comparison-overlap]\n    \n            @dataclass\n            class ModelA:  # pyright: ignore\n                pass\n    \n            @dataclass\n            class ModelB:  # pyright: ignore\n                pass\n    \n        else:\n    \n            class ModelA(base_type):  # type: ignore[no-redef, misc]\n                pass\n    \n            class ModelB(base_type):  # type: ignore[no-redef, misc]\n                pass\n    \n>       schema = get_schema_for_field_definition(\n            FieldDefinition.from_kwarg(name=\"Lookup\", annotation=Union[ModelA, ModelB, None])\n        )\n\ntests/unit/test_openapi/test_schema.py:553: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/helpers.py:79: in get_schema_for_field_definition\n    result = creator.for_field_definition(field_definition)\nlitestar/_openapi/schema_generation/schema.py:333: in for_field_definition\n    elif _should_create_enum_schema(field_definition):\nlitestar/_openapi/schema_generation/utils.py:57: in _should_create_enum_schema\n    return field_definition.is_subclass_of(Enum) or (\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = FieldDefinition(raw=typing.Union[tests.unit.test_openapi.test_schema.test_type_union_with_none.<locals>.ModelA, tests....c_origin=typing.Union, inner_types=None, default=<_EmptyEnum.EMPTY: 0>, extra={}, kwarg_definition=None, name='Lookup')\ncl = <enum 'Enum'>\n\n    def is_subclass_of(self, cl: type[Any] | tuple[type[Any], ...]) -> bool:\n        \"\"\"Whether the annotation is a subclass of the given type.\n    \n        Where ``self.annotation`` is a union type, this method will return ``True`` when all members of the union are\n        a subtype of ``cl``, otherwise, ``False``.\n    \n        Args:\n            cl: The type to check, or tuple of types. Passed as 2nd argument to ``issubclass()``.\n    \n        Returns:\n            Whether the annotation is a subtype of the given type(s).\n        \"\"\"\n        if self.origin:\n            if self.origin in UnionTypes:\n>               return all(t.is_subclass_of(cl) for t in self.inner_types)\nE               TypeError: 'NoneType' object is not iterable\n\nlitestar/typing.py:452: TypeError\n_____________________ test_type_union_with_none[dataclass] _____________________\n\nbase_type = <function dataclass at 0x7fe1c70db910>\n\n    @pytest.mark.parametrize(\"base_type\", [msgspec.Struct, TypedDict, dataclass])\n    def test_type_union_with_none(base_type: type) -> None:\n        # https://github.com/litestar-org/litestar/issues/2971\n        if base_type is dataclass:  # type: ignore[comparison-overlap]\n    \n            @dataclass\n            class ModelA:  # pyright: ignore\n                pass\n    \n            @dataclass\n            class ModelB:  # pyright: ignore\n                pass\n    \n        else:\n    \n            class ModelA(base_type):  # type: ignore[no-redef, misc]\n                pass\n    \n            class ModelB(base_type):  # type: ignore[no-redef, misc]\n                pass\n    \n>       schema = get_schema_for_field_definition(\n            FieldDefinition.from_kwarg(name=\"Lookup\", annotation=Union[ModelA, ModelB, None])\n        )\n\ntests/unit/test_openapi/test_schema.py:553: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/helpers.py:79: in get_schema_for_field_definition\n    result = creator.for_field_definition(field_definition)\nlitestar/_openapi/schema_generation/schema.py:333: in for_field_definition\n    elif _should_create_enum_schema(field_definition):\nlitestar/_openapi/schema_generation/utils.py:57: in _should_create_enum_schema\n    return field_definition.is_subclass_of(Enum) or (\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = FieldDefinition(raw=typing.Union[tests.unit.test_openapi.test_schema.test_type_union_with_none.<locals>.ModelA, tests....c_origin=typing.Union, inner_types=None, default=<_EmptyEnum.EMPTY: 0>, extra={}, kwarg_definition=None, name='Lookup')\ncl = <enum 'Enum'>\n\n    def is_subclass_of(self, cl: type[Any] | tuple[type[Any], ...]) -> bool:\n        \"\"\"Whether the annotation is a subclass of the given type.\n    \n        Where ``self.annotation`` is a union type, this method will return ``True`` when all members of the union are\n        a subtype of ``cl``, otherwise, ``False``.\n    \n        Args:\n            cl: The type to check, or tuple of types. Passed as 2nd argument to ``issubclass()``.\n    \n        Returns:\n            Whether the annotation is a subtype of the given type(s).\n        \"\"\"\n        if self.origin:\n            if self.origin in UnionTypes:\n>               return all(t.is_subclass_of(cl) for t in self.inner_types)\nE               TypeError: 'NoneType' object is not iterable\n\nlitestar/typing.py:452: TypeError\n________ test_schema_generation_with_generic_classes[PydanticV1Generic] ________\n\nmodel = <class 'tests.unit.test_contrib.test_pydantic.test_schema_plugin.PydanticV1Generic'>\n\n    @pytest.mark.parametrize(\"model\", [PydanticV1Generic, PydanticV2Generic])\n    def test_schema_generation_with_generic_classes(model: Type[Union[PydanticV1Generic, PydanticV2Generic]]) -> None:\n        cls = model[int]  # type: ignore[index]\n        field_definition = FieldDefinition.from_kwarg(name=get_name(cls), annotation=cls)\n>       properties = get_schema_for_field_definition(field_definition, plugins=[PydanticSchemaPlugin()]).properties\n\ntests/unit/test_contrib/test_pydantic/test_schema_plugin.py:38: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/helpers.py:79: in get_schema_for_field_definition\n    result = creator.for_field_definition(field_definition)\nlitestar/_openapi/schema_generation/schema.py:332: in for_field_definition\n    result = self.for_plugin(field_definition, plugin_for_annotation)\nlitestar/_openapi/schema_generation/schema.py:503: in for_plugin\n    schema = plugin.to_openapi_schema(field_definition=field_definition, schema_creator=self)\nlitestar/contrib/pydantic/pydantic_schema_plugin.py:241: in to_openapi_schema\n    return self.for_pydantic_model(field_definition=field_definition, schema_creator=schema_creator)\nlitestar/contrib/pydantic/pydantic_schema_plugin.py:317: in for_pydantic_model\n    return schema_creator.create_component_schema(\nlitestar/_openapi/schema_generation/schema.py:639: in create_component_schema\n    schema.properties = {k: self.for_field_definition(v) for k, v in property_fields.items()}\nlitestar/_openapi/schema_generation/schema.py:639: in <dictcomp>\n    schema.properties = {k: self.for_field_definition(v) for k, v in property_fields.items()}\nlitestar/_openapi/schema_generation/schema.py:333: in for_field_definition\n    elif _should_create_enum_schema(field_definition):\nlitestar/_openapi/schema_generation/utils.py:57: in _should_create_enum_schema\n    return field_definition.is_subclass_of(Enum) or (\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = FieldDefinition(raw=typing.Annotated[typing.Optional[int], FieldInfo(default=PydanticUndefined, extra={})], annotation...xtra=None, annotation=<_EmptyEnum.EMPTY: 0>, header=None, cookie=None, query=None, required=None), name='optional_foo')\ncl = <enum 'Enum'>\n\n    def is_subclass_of(self, cl: type[Any] | tuple[type[Any], ...]) -> bool:\n        \"\"\"Whether the annotation is a subclass of the given type.\n    \n        Where ``self.annotation`` is a union type, this method will return ``True`` when all members of the union are\n        a subtype of ``cl``, otherwise, ``False``.\n    \n        Args:\n            cl: The type to check, or tuple of types. Passed as 2nd argument to ``issubclass()``.\n    \n        Returns:\n            Whether the annotation is a subtype of the given type(s).\n        \"\"\"\n        if self.origin:\n            if self.origin in UnionTypes:\n>               return all(t.is_subclass_of(cl) for t in self.inner_types)\nE               TypeError: 'NoneType' object is not iterable\n\nlitestar/typing.py:452: TypeError\n________ test_schema_generation_with_generic_classes[PydanticV2Generic] ________\n\nmodel = <class 'tests.unit.test_contrib.test_pydantic.test_schema_plugin.PydanticV2Generic'>\n\n    @pytest.mark.parametrize(\"model\", [PydanticV1Generic, PydanticV2Generic])\n    def test_schema_generation_with_generic_classes(model: Type[Union[PydanticV1Generic, PydanticV2Generic]]) -> None:\n        cls = model[int]  # type: ignore[index]\n        field_definition = FieldDefinition.from_kwarg(name=get_name(cls), annotation=cls)\n>       properties = get_schema_for_field_definition(field_definition, plugins=[PydanticSchemaPlugin()]).properties\n\ntests/unit/test_contrib/test_pydantic/test_schema_plugin.py:38: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/helpers.py:79: in get_schema_for_field_definition\n    result = creator.for_field_definition(field_definition)\nlitestar/_openapi/schema_generation/schema.py:332: in for_field_definition\n    result = self.for_plugin(field_definition, plugin_for_annotation)\nlitestar/_openapi/schema_generation/schema.py:503: in for_plugin\n    schema = plugin.to_openapi_schema(field_definition=field_definition, schema_creator=self)\nlitestar/contrib/pydantic/pydantic_schema_plugin.py:241: in to_openapi_schema\n    return self.for_pydantic_model(field_definition=field_definition, schema_creator=schema_creator)\nlitestar/contrib/pydantic/pydantic_schema_plugin.py:317: in for_pydantic_model\n    return schema_creator.create_component_schema(\nlitestar/_openapi/schema_generation/schema.py:639: in create_component_schema\n    schema.properties = {k: self.for_field_definition(v) for k, v in property_fields.items()}\nlitestar/_openapi/schema_generation/schema.py:639: in <dictcomp>\n    schema.properties = {k: self.for_field_definition(v) for k, v in property_fields.items()}\nlitestar/_openapi/schema_generation/schema.py:333: in for_field_definition\n    elif _should_create_enum_schema(field_definition):\nlitestar/_openapi/schema_generation/utils.py:57: in _should_create_enum_schema\n    return field_definition.is_subclass_of(Enum) or (\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = FieldDefinition(raw=typing.Annotated[typing.Optional[int], FieldInfo(annotation=Union[~T, NoneType], required=True), [...xtra=None, annotation=<_EmptyEnum.EMPTY: 0>, header=None, cookie=None, query=None, required=None), name='optional_foo')\ncl = <enum 'Enum'>\n\n    def is_subclass_of(self, cl: type[Any] | tuple[type[Any], ...]) -> bool:\n        \"\"\"Whether the annotation is a subclass of the given type.\n    \n        Where ``self.annotation`` is a union type, this method will return ``True`` when all members of the union are\n        a subtype of ``cl``, otherwise, ``False``.\n    \n        Args:\n            cl: The type to check, or tuple of types. Passed as 2nd argument to ``issubclass()``.\n    \n        Returns:\n            Whether the annotation is a subtype of the given type(s).\n        \"\"\"\n        if self.origin:\n            if self.origin in UnionTypes:\n>               return all(t.is_subclass_of(cl) for t in self.inner_types)\nE               TypeError: 'NoneType' object is not iterable\n\nlitestar/typing.py:452: TypeError\n____________________________ test_title_validation _____________________________\n\n    def test_title_validation() -> None:\n        # TODO: what is this actually testing?\n        creator = SchemaCreator(plugins=openapi_schema_plugins)\n>       person_ref = creator.for_field_definition(FieldDefinition.from_kwarg(name=\"Person\", annotation=DataclassPerson))\n\ntests/unit/test_openapi/test_schema.py:237: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nlitestar/_openapi/schema_generation/schema.py:332: in for_field_definition\n    result = self.for_plugin(field_definition, plugin_for_annotation)\nlitestar/_openapi/schema_generation/schema.py:503: in for_plugin\n    schema = plugin.to_openapi_schema(field_definition=field_definition, schema_creator=self)\nlitestar/_openapi/schema_generation/plugins/dataclass.py:24: in to_openapi_schema\n    return schema_creator.create_component_schema(\nlitestar/_openapi/schema_generation/schema.py:639: in create_component_schema\n    schema.properties = {k: self.for_field_definition(v) for k, v in property_fields.items()}\nlitestar/_openapi/schema_generation/schema.py:639: in <dictcomp>\n    schema.properties = {k: self.for_field_definition(v) for k, v in property_fields.items()}\nlitestar/_openapi/schema_generation/schema.py:333: in for_field_definition\n    elif _should_create_enum_schema(field_definition):\nlitestar/_openapi/schema_generation/utils.py:57: in _should_create_enum_schema\n    return field_definition.is_subclass_of(Enum) or (\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = FieldDefinition(raw=typing.Optional[str], annotation=typing.Optional[str], type_wrappers=set(), origin=typing.Union, a...origin=typing.Union, inner_types=None, default=<_EmptyEnum.EMPTY: 0>, extra={}, kwarg_definition=None, name='optional')\ncl = <enum 'Enum'>\n\n    def is_subclass_of(self, cl: type[Any] | tuple[type[Any], ...]) -> bool:\n        \"\"\"Whether the annotation is a subclass of the given type.\n    \n        Where ``self.annotation`` is a union type, this method will return ``True`` when all members of the union are\n        a subtype of ``cl``, otherwise, ``False``.\n    \n        Args:\n            cl: The type to check, or tuple of types. Passed as 2nd argument to ``issubclass()``.\n    \n        Returns:\n            Whether the annotation is a subtype of the given type(s).\n        \"\"\"\n        if self.origin:\n            if self.origin in UnionTypes:\n>               return all(t.is_subclass_of(cl) for t in self.inner_types)\nE               TypeError: 'NoneType' object is not iterable\n\nlitestar/typing.py:452: TypeError\n___________ test_schema_generation_with_generic_classes_constrained ____________\n\n    def test_schema_generation_with_generic_classes_constrained() -> None:\n        cls = ConstrainedGenericDataclass\n>       properties = get_schema_for_field_definition(\n            FieldDefinition.from_kwarg(name=cls.__name__, annotation=cls)\n        ).properties\n\ntests/unit/test_openapi/test_schema.py:399: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/helpers.py:79: in get_schema_for_field_definition\n    result = creator.for_field_definition(field_definition)\nlitestar/_openapi/schema_generation/schema.py:332: in for_field_definition\n    result = self.for_plugin(field_definition, plugin_for_annotation)\nlitestar/_openapi/schema_generation/schema.py:503: in for_plugin\n    schema = plugin.to_openapi_schema(field_definition=field_definition, schema_creator=self)\nlitestar/_openapi/schema_generation/plugins/dataclass.py:24: in to_openapi_schema\n    return schema_creator.create_component_schema(\nlitestar/_openapi/schema_generation/schema.py:639: in create_component_schema\n    schema.properties = {k: self.for_field_definition(v) for k, v in property_fields.items()}\nlitestar/_openapi/schema_generation/schema.py:639: in <dictcomp>\n    schema.properties = {k: self.for_field_definition(v) for k, v in property_fields.items()}\nlitestar/_openapi/schema_generation/schema.py:333: in for_field_definition\n    elif _should_create_enum_schema(field_definition):\nlitestar/_openapi/schema_generation/utils.py:57: in _should_create_enum_schema\n    return field_definition.is_subclass_of(Enum) or (\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = FieldDefinition(raw=typing.Union[int, str], annotation=typing.Union[int, str], type_wrappers=set(), origin=typing.Unio...gin=typing.Union, inner_types=None, default=<_EmptyEnum.EMPTY: 0>, extra={}, kwarg_definition=None, name='constrained')\ncl = <enum 'Enum'>\n\n    def is_subclass_of(self, cl: type[Any] | tuple[type[Any], ...]) -> bool:\n        \"\"\"Whether the annotation is a subclass of the given type.\n    \n        Where ``self.annotation`` is a union type, this method will return ``True`` when all members of the union are\n        a subtype of ``cl``, otherwise, ``False``.\n    \n        Args:\n            cl: The type to check, or tuple of types. Passed as 2nd argument to ``issubclass()``.\n    \n        Returns:\n            Whether the annotation is a subtype of the given type(s).\n        \"\"\"\n        if self.origin:\n            if self.origin in UnionTypes:\n>               return all(t.is_subclass_of(cl) for t in self.inner_types)\nE               TypeError: 'NoneType' object is not iterable\n\nlitestar/typing.py:452: TypeError\n=============================== warnings summary ===============================\n../../../../usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306\n../../../../usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306\n  /usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306: PytestRemovedIn9Warning: Marks applied to fixtures have no effect\n  See docs: https://docs.pytest.org/en/stable/deprecations.html#applying-a-mark-to-a-fixture-function\n    return fixture_marker(fixture_function)\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/unit/test_dto/test_factory/test_backends/test_backends.py::test_backend_model_name_uniqueness[experimental_backend]\nFAILED tests/unit/test_dto/test_factory/test_backends/test_backends.py::test_backend_model_name_uniqueness[default_backend]\nFAILED tests/unit/test_contrib/test_attrs/test_schema_plugin.py::test_schema_generation_with_generic_classes\nFAILED tests/unit/test_openapi/test_schema.py::test_schema_generation_with_generic_classes[DataclassGeneric]\nFAILED tests/unit/test_openapi/test_schema.py::test_schema_generation_with_generic_classes[MsgspecGeneric]\nFAILED tests/unit/test_openapi/test_schema.py::test_type_union[Struct] - Type...\nFAILED tests/unit/test_openapi/test_schema.py::test_type_union[TypedDict] - T...\nFAILED tests/unit/test_openapi/test_schema.py::test_type_union[dataclass] - T...\nFAILED tests/unit/test_openapi/test_schema.py::test_type_union_with_none[Struct]\nFAILED tests/unit/test_openapi/test_schema.py::test_type_union_with_none[TypedDict]\nFAILED tests/unit/test_openapi/test_schema.py::test_type_union_with_none[dataclass]\nFAILED tests/unit/test_contrib/test_pydantic/test_schema_plugin.py::test_schema_generation_with_generic_classes[PydanticV1Generic]\nFAILED tests/unit/test_contrib/test_pydantic/test_schema_plugin.py::test_schema_generation_with_generic_classes[PydanticV2Generic]\nFAILED tests/unit/test_openapi/test_schema.py::test_title_validation - TypeEr...\nFAILED tests/unit/test_openapi/test_schema.py::test_schema_generation_with_generic_classes_constrained\n============= 15 failed, 13 passed, 1 skipped, 2 warnings in 0.62s =============\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/typing.py-from_parameter": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 4 items\n\ntests/unit/test_utils/test_signature.py F.FF                             [100%]\n\n=================================== FAILURES ===================================\n_ test_field_definition_from_parameter_raises_improperly_configured_if_no_annotation _\n\n    def test_field_definition_from_parameter_raises_improperly_configured_if_no_annotation() -> None:\n        \"\"\"Test FieldDefinition raises ImproperlyConfigured if no annotation.\"\"\"\n        param = Parameter(\"foo\", Parameter.POSITIONAL_OR_KEYWORD)\n>       with pytest.raises(ImproperlyConfiguredException):\nE       Failed: DID NOT RAISE <class 'litestar.exceptions.http_exceptions.ImproperlyConfiguredException'>\n\ntests/unit/test_utils/test_signature.py:116: Failed\n__________ test_field_definition_from_parameter_has_default_predicate __________\n\n    def test_field_definition_from_parameter_has_default_predicate() -> None:\n        \"\"\"Test FieldDefinition.has_default.\"\"\"\n        param = Parameter(\"foo\", Parameter.POSITIONAL_OR_KEYWORD, annotation=int)\n        parsed_param = FieldDefinition.from_parameter(param, {\"foo\": int})\n>       assert parsed_param.has_default is False\nE       AssertionError: assert True is False\nE        +  where True = FieldDefinition(raw=<class 'int'>, annotation=<class 'int'>, type_wrappers=set(), origin=None, args=(), metadata=(), i...afe_generic_origin=None, inner_types=(), default=<class 'inspect._empty'>, extra={}, kwarg_definition=None, name='foo').has_default\n\ntests/unit/test_utils/test_signature.py:124: AssertionError\n_____________________ test_field_definition_from_parameter _____________________\n\n    def test_field_definition_from_parameter() -> None:\n        \"\"\"Test FieldDefinition.\"\"\"\n        param = Parameter(\"foo\", Parameter.POSITIONAL_OR_KEYWORD, annotation=int)\n        parsed_param = FieldDefinition.from_parameter(param, {\"foo\": int})\n        assert parsed_param.name == \"foo\"\n>       assert parsed_param.default is Empty\nE       AssertionError: assert <class 'inspect._empty'> is <_EmptyEnum.EMPTY: 0>\nE        +  where <class 'inspect._empty'> = FieldDefinition(raw=<class 'int'>, annotation=<class 'int'>, type_wrappers=set(), origin=None, args=(), metadata=(), i...afe_generic_origin=None, inner_types=(), default=<class 'inspect._empty'>, extra={}, kwarg_definition=None, name='foo').default\n\ntests/unit/test_utils/test_signature.py:109: AssertionError\n=========================== short test summary info ============================\nFAILED tests/unit/test_utils/test_signature.py::test_field_definition_from_parameter_raises_improperly_configured_if_no_annotation\nFAILED tests/unit/test_utils/test_signature.py::test_field_definition_from_parameter_has_default_predicate\nFAILED tests/unit/test_utils/test_signature.py::test_field_definition_from_parameter\n========================= 3 failed, 1 passed in 0.11s ==========================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/_openapi/responses.py-create_success_response": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 3 items\n\ntests/unit/test_openapi/test_responses.py FFF                            [100%]\n\n=================================== FAILURES ===================================\n__________________ test_create_response_for_response_subclass __________________\n\ncreate_factory = <function create_factory.<locals>._create_factory at 0x7f743e2dd6c0>\n\n    def test_create_response_for_response_subclass(create_factory: CreateFactoryFixture) -> None:\n        class CustomResponse(Response[T]):\n            pass\n    \n        @get(path=\"/test\", name=\"test\", signature_types=[CustomResponse])\n        def handler() -> CustomResponse[DataclassPerson]:\n            return CustomResponse(content=DataclassPersonFactory.build())\n    \n        handler = get_registered_route_handler(handler, \"test\")\n        factory = create_factory(handler, True)\n>       response = factory.create_success_response()\n\ntests/unit/test_openapi/test_responses.py:475: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar._openapi.responses.ResponseFactory object at 0x7f743e2fbf70>\n\n    def create_success_response(self) -> OpenAPIResponse:\n        \"\"\"Create the schema for a success response.\"\"\"\n        content = {}\n        description = self.create_description()\n    \n>       if issubclass(self.field_definition.annotation, Redirect):\nE       TypeError: issubclass() arg 1 must be a class\n\nlitestar/_openapi/responses.py:124: TypeError\n______________________ test_response_generation_with_dto _______________________\n\ncreate_factory = <function create_factory.<locals>._create_factory at 0x7f743e2de3b0>\n\n    def test_response_generation_with_dto(create_factory: CreateFactoryFixture) -> None:\n        mock_dto = MagicMock(spec=AbstractDTO)\n        mock_dto.create_openapi_schema.return_value = Schema()\n    \n        @post(path=\"/form-upload\", return_dto=mock_dto)  # pyright: ignore\n        async def handler(data: Dict[str, Any]) -> Dict[str, Any]:\n            return data\n    \n        Litestar(route_handlers=[handler])\n    \n        factory = create_factory(handler)\n        field_definition = FieldDefinition.from_annotation(Dict[str, Any])\n>       factory.create_success_response()\n\ntests/unit/test_openapi/test_responses.py:515: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar._openapi.responses.ResponseFactory object at 0x7f743d961a20>\n\n    def create_success_response(self) -> OpenAPIResponse:\n        \"\"\"Create the schema for a success response.\"\"\"\n        content = {}\n        description = self.create_description()\n    \n>       if issubclass(self.field_definition.annotation, Redirect):\nE       TypeError: issubclass() arg 1 must be a class\n\nlitestar/_openapi/responses.py:124: TypeError\n_______________ test_create_success_response_with_response_class _______________\n\ncreate_factory = <function create_factory.<locals>._create_factory at 0x7f743d973130>\n\n    def test_create_success_response_with_response_class(create_factory: CreateFactoryFixture) -> None:\n        @get(path=\"/test\", name=\"test\")\n        def handler() -> Response[DataclassPerson]:\n            return Response(content=DataclassPersonFactory.build())\n    \n        handler = get_registered_route_handler(handler, \"test\")\n        factory = create_factory(handler, True)\n>       response = factory.create_success_response()\n\ntests/unit/test_openapi/test_responses.py:235: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar._openapi.responses.ResponseFactory object at 0x7f743d8e6740>\n\n    def create_success_response(self) -> OpenAPIResponse:\n        \"\"\"Create the schema for a success response.\"\"\"\n        content = {}\n        description = self.create_description()\n    \n>       if issubclass(self.field_definition.annotation, Redirect):\nE       TypeError: issubclass() arg 1 must be a class\n\nlitestar/_openapi/responses.py:124: TypeError\n=============================== warnings summary ===============================\n../../../../usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306\n../../../../usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306\n  /usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306: PytestRemovedIn9Warning: Marks applied to fixtures have no effect\n  See docs: https://docs.pytest.org/en/stable/deprecations.html#applying-a-mark-to-a-fixture-function\n    return fixture_marker(fixture_function)\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/unit/test_openapi/test_responses.py::test_create_response_for_response_subclass\nFAILED tests/unit/test_openapi/test_responses.py::test_response_generation_with_dto\nFAILED tests/unit/test_openapi/test_responses.py::test_create_success_response_with_response_class\n======================== 3 failed, 2 warnings in 0.12s =========================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/_openapi/responses.py-create_additional_responses": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 3 items\n\ntests/unit/test_openapi/test_responses.py FFF                            [100%]\n\n=================================== FAILURES ===================================\n_______________________ test_create_additional_responses _______________________\n\ncreate_factory = <function create_factory.<locals>._create_factory at 0x7fb7c93ad7e0>\n\n    def test_create_additional_responses(create_factory: CreateFactoryFixture) -> None:\n        @dataclass\n        class ServerError:\n            message: str\n    \n        class AuthenticationError(TypedDict):\n            message: str\n    \n        class UnknownError(TypedDict):\n            message: str\n    \n        @get(\n            responses={\n                401: ResponseSpec(data_container=AuthenticationError, description=\"Authentication error\"),\n                500: ResponseSpec(data_container=ServerError, generate_examples=False, media_type=MediaType.TEXT),\n                505: ResponseSpec(data_container=UnknownError),\n            }\n        )\n        def handler() -> DataclassPerson:\n            return DataclassPersonFactory.build()\n    \n        factory = create_factory(handler)\n        responses = factory.create_additional_responses()\n    \n>       first_response = next(responses)\n\ntests/unit/test_openapi/test_responses.py:372: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar._openapi.responses.ResponseFactory object at 0x7fb7c9460250>\n\n    def create_additional_responses(self) -> Iterator[tuple[str, OpenAPIResponse]]:\n        \"\"\"Create the schema for additional responses, if any.\"\"\"\n>       for status_code, response in self.route_handler.additional_responses.items():\nE       AttributeError: 'get' object has no attribute 'additional_responses'\n\nlitestar/_openapi/responses.py:235: AttributeError\n________________ test_additional_responses_with_custom_examples ________________\n\ncreate_factory = <function create_factory.<locals>._create_factory at 0x7fb7c9293760>\n\n    def test_additional_responses_with_custom_examples(create_factory: CreateFactoryFixture) -> None:\n        @get(responses={200: ResponseSpec(DataclassPerson, examples=[Example(value={\"string\": \"example\", \"number\": 1})])})\n        def handler() -> DataclassPerson:\n            return DataclassPersonFactory.build()\n    \n        factory = create_factory(handler)\n        responses = factory.create_additional_responses()\n>       status_code, response = next(responses)\n\ntests/unit/test_openapi/test_responses.py:450: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar._openapi.responses.ResponseFactory object at 0x7fb7c93c78e0>\n\n    def create_additional_responses(self) -> Iterator[tuple[str, OpenAPIResponse]]:\n        \"\"\"Create the schema for additional responses, if any.\"\"\"\n>       for status_code, response in self.route_handler.additional_responses.items():\nE       AttributeError: 'get' object has no attribute 'additional_responses'\n\nlitestar/_openapi/responses.py:235: AttributeError\n________ test_create_success_response_no_content_explicit_responsespec _________\n\ncreate_factory = <function create_factory.<locals>._create_factory at 0x7fb7c9292d40>\n\n    def test_create_success_response_no_content_explicit_responsespec(\n        create_factory: CreateFactoryFixture,\n    ) -> None:\n        @delete(\n            path=\"/test\",\n            responses={HTTP_204_NO_CONTENT: ResponseSpec(None, description=\"Custom description\")},\n            name=\"test\",\n        )\n        def handler() -> None:\n            return None\n    \n        handler = get_registered_route_handler(handler, \"test\")\n        factory = create_factory(handler)\n        responses = factory.create_additional_responses()\n>       status, response = next(responses)\n\ntests/unit/test_openapi/test_responses.py:300: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar._openapi.responses.ResponseFactory object at 0x7fb7c92cb1c0>\n\n    def create_additional_responses(self) -> Iterator[tuple[str, OpenAPIResponse]]:\n        \"\"\"Create the schema for additional responses, if any.\"\"\"\n>       for status_code, response in self.route_handler.additional_responses.items():\nE       AttributeError: 'delete' object has no attribute 'additional_responses'\n\nlitestar/_openapi/responses.py:235: AttributeError\n=============================== warnings summary ===============================\n../../../../usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306\n../../../../usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306\n  /usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306: PytestRemovedIn9Warning: Marks applied to fixtures have no effect\n  See docs: https://docs.pytest.org/en/stable/deprecations.html#applying-a-mark-to-a-fixture-function\n    return fixture_marker(fixture_function)\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/unit/test_openapi/test_responses.py::test_create_additional_responses\nFAILED tests/unit/test_openapi/test_responses.py::test_additional_responses_with_custom_examples\nFAILED tests/unit/test_openapi/test_responses.py::test_create_success_response_no_content_explicit_responsespec\n======================== 3 failed, 2 warnings in 0.14s =========================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/_openapi/path_item.py-create_path_item": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 3 items\n\ntests/unit/test_openapi/test_path_item.py ...                            [100%]\n\n=============================== warnings summary ===============================\n../../../../usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306\n../../../../usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306\n  /usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306: PytestRemovedIn9Warning: Marks applied to fixtures have no effect\n  See docs: https://docs.pytest.org/en/stable/deprecations.html#applying-a-mark-to-a-fixture-function\n    return fixture_marker(fixture_function)\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n======================== 3 passed, 2 warnings in 0.10s =========================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/_openapi/schema_generation/schema.py-for_field_definition": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 7 items\n\ntests/unit/test_contrib/test_pydantic/test_openapi.py FFFFFFF            [100%]\n\n=================================== FAILURES ===================================\n_____________________ test_create_for_computed_field[True] _____________________\n\nprefer_alias = True\n\n    @pytest.mark.parametrize(\"prefer_alias\", [True, False])\n    def test_create_for_computed_field(prefer_alias: bool) -> None:\n        class Sample(pydantic_v2.BaseModel):\n            property_one: str\n    \n            @pydantic_v2.computed_field(\n                description=\"a description\", title=\"a title\", alias=\"prop_two\" if prefer_alias else None\n            )\n            def property_two(self) -> bool:\n                return True\n    \n        field_definition = FieldDefinition.from_annotation(Sample)\n        schema_creator = SchemaCreator(plugins=[PydanticSchemaPlugin()])\n>       ref = schema_creator.for_field_definition(field_definition)\n\ntests/unit/test_contrib/test_pydantic/test_openapi.py:678: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar._openapi.schema_generation.schema.SchemaCreator object at 0x7f66cca87280>\nfield_definition = FieldDefinition(raw=<class 'tests.unit.test_contrib.test_pydantic.test_openapi.test_create_for_computed_field.<locals>...one, safe_generic_origin=None, inner_types=(), default=<_EmptyEnum.EMPTY: 0>, extra={}, kwarg_definition=None, name='')\n\n    def for_field_definition(self, field_definition: FieldDefinition) -> Schema | Reference:\n        \"\"\"Create a Schema for a given FieldDefinition.\n    \n        Args:\n            field_definition: A signature field instance.\n    \n        Returns:\n            A schema instance.\n        \"\"\"\n        if field_definition.is_none_type:\n            return Schema(type=OpenAPIType.NULL)\n    \n        if field_definition.is_optional:\n            return self.for_optional_field(field_definition)\n    \n        if field_definition.is_union:\n            return self.for_union_field(field_definition)\n    \n        if field_definition.is_new_type:\n            return self.for_new_type(field_definition)\n    \n>       if field_definition.is_typevar:\nE       AttributeError: 'FieldDefinition' object has no attribute 'is_typevar'. Did you mean: 'is_type_var'?\n\nlitestar/_openapi/schema_generation/schema.py:338: AttributeError\n____________________ test_create_for_computed_field[False] _____________________\n\nprefer_alias = False\n\n    @pytest.mark.parametrize(\"prefer_alias\", [True, False])\n    def test_create_for_computed_field(prefer_alias: bool) -> None:\n        class Sample(pydantic_v2.BaseModel):\n            property_one: str\n    \n            @pydantic_v2.computed_field(\n                description=\"a description\", title=\"a title\", alias=\"prop_two\" if prefer_alias else None\n            )\n            def property_two(self) -> bool:\n                return True\n    \n        field_definition = FieldDefinition.from_annotation(Sample)\n        schema_creator = SchemaCreator(plugins=[PydanticSchemaPlugin()])\n>       ref = schema_creator.for_field_definition(field_definition)\n\ntests/unit/test_contrib/test_pydantic/test_openapi.py:678: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar._openapi.schema_generation.schema.SchemaCreator object at 0x7f66ccaa2e00>\nfield_definition = FieldDefinition(raw=<class 'tests.unit.test_contrib.test_pydantic.test_openapi.test_create_for_computed_field.<locals>...one, safe_generic_origin=None, inner_types=(), default=<_EmptyEnum.EMPTY: 0>, extra={}, kwarg_definition=None, name='')\n\n    def for_field_definition(self, field_definition: FieldDefinition) -> Schema | Reference:\n        \"\"\"Create a Schema for a given FieldDefinition.\n    \n        Args:\n            field_definition: A signature field instance.\n    \n        Returns:\n            A schema instance.\n        \"\"\"\n        if field_definition.is_none_type:\n            return Schema(type=OpenAPIType.NULL)\n    \n        if field_definition.is_optional:\n            return self.for_optional_field(field_definition)\n    \n        if field_definition.is_union:\n            return self.for_union_field(field_definition)\n    \n        if field_definition.is_new_type:\n            return self.for_new_type(field_definition)\n    \n>       if field_definition.is_typevar:\nE       AttributeError: 'FieldDefinition' object has no attribute 'is_typevar'. Did you mean: 'is_type_var'?\n\nlitestar/_openapi/schema_generation/schema.py:338: AttributeError\n_ test_create_schema_for_pydantic_model_with_annotated_model_attribute[v1-True] _\n\nwith_future_annotations = True\ncreate_module = <function create_module.<locals>.wrapped at 0x7f66cca1feb0>\npydantic_version = 'v1'\n\n    @pytest.mark.parametrize(\"with_future_annotations\", [True, False])\n    def test_create_schema_for_pydantic_model_with_annotated_model_attribute(\n        with_future_annotations: bool, create_module: \"Callable[[str], ModuleType]\", pydantic_version: PydanticVersion\n    ) -> None:\n        \"\"\"Test that a model with an annotated attribute is correctly handled.\"\"\"\n        module = create_module(\n            f\"\"\"\n    {'from __future__ import annotations' if with_future_annotations else ''}\n    from typing_extensions import Annotated\n    {'from pydantic import BaseModel' if pydantic_version == 'v2' else 'from pydantic.v1 import BaseModel'}\n    \n    class Foo(BaseModel):\n        foo: Annotated[int, \"Foo description\"]\n    \"\"\"\n        )\n        creator = SchemaCreator(plugins=[PydanticSchemaPlugin()])\n>       creator.for_field_definition(FieldDefinition.from_annotation(module.Foo))\n\ntests/unit/test_contrib/test_pydantic/test_openapi.py:620: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar._openapi.schema_generation.schema.SchemaCreator object at 0x7f66cc7fdb40>\nfield_definition = FieldDefinition(raw=<class 'sgzdxaoejg.Foo'>, annotation=<class 'sgzdxaoejg.Foo'>, type_wrappers=set(), origin=None, a...one, safe_generic_origin=None, inner_types=(), default=<_EmptyEnum.EMPTY: 0>, extra={}, kwarg_definition=None, name='')\n\n    def for_field_definition(self, field_definition: FieldDefinition) -> Schema | Reference:\n        \"\"\"Create a Schema for a given FieldDefinition.\n    \n        Args:\n            field_definition: A signature field instance.\n    \n        Returns:\n            A schema instance.\n        \"\"\"\n        if field_definition.is_none_type:\n            return Schema(type=OpenAPIType.NULL)\n    \n        if field_definition.is_optional:\n            return self.for_optional_field(field_definition)\n    \n        if field_definition.is_union:\n            return self.for_union_field(field_definition)\n    \n        if field_definition.is_new_type:\n            return self.for_new_type(field_definition)\n    \n>       if field_definition.is_typevar:\nE       AttributeError: 'FieldDefinition' object has no attribute 'is_typevar'. Did you mean: 'is_type_var'?\n\nlitestar/_openapi/schema_generation/schema.py:338: AttributeError\n_ test_create_schema_for_pydantic_model_with_annotated_model_attribute[v1-False] _\n\nwith_future_annotations = False\ncreate_module = <function create_module.<locals>.wrapped at 0x7f66cca1fd90>\npydantic_version = 'v1'\n\n    @pytest.mark.parametrize(\"with_future_annotations\", [True, False])\n    def test_create_schema_for_pydantic_model_with_annotated_model_attribute(\n        with_future_annotations: bool, create_module: \"Callable[[str], ModuleType]\", pydantic_version: PydanticVersion\n    ) -> None:\n        \"\"\"Test that a model with an annotated attribute is correctly handled.\"\"\"\n        module = create_module(\n            f\"\"\"\n    {'from __future__ import annotations' if with_future_annotations else ''}\n    from typing_extensions import Annotated\n    {'from pydantic import BaseModel' if pydantic_version == 'v2' else 'from pydantic.v1 import BaseModel'}\n    \n    class Foo(BaseModel):\n        foo: Annotated[int, \"Foo description\"]\n    \"\"\"\n        )\n        creator = SchemaCreator(plugins=[PydanticSchemaPlugin()])\n>       creator.for_field_definition(FieldDefinition.from_annotation(module.Foo))\n\ntests/unit/test_contrib/test_pydantic/test_openapi.py:620: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar._openapi.schema_generation.schema.SchemaCreator object at 0x7f66cca4de00>\nfield_definition = FieldDefinition(raw=<class 'trufywlmyj.Foo'>, annotation=<class 'trufywlmyj.Foo'>, type_wrappers=set(), origin=None, a...one, safe_generic_origin=None, inner_types=(), default=<_EmptyEnum.EMPTY: 0>, extra={}, kwarg_definition=None, name='')\n\n    def for_field_definition(self, field_definition: FieldDefinition) -> Schema | Reference:\n        \"\"\"Create a Schema for a given FieldDefinition.\n    \n        Args:\n            field_definition: A signature field instance.\n    \n        Returns:\n            A schema instance.\n        \"\"\"\n        if field_definition.is_none_type:\n            return Schema(type=OpenAPIType.NULL)\n    \n        if field_definition.is_optional:\n            return self.for_optional_field(field_definition)\n    \n        if field_definition.is_union:\n            return self.for_union_field(field_definition)\n    \n        if field_definition.is_new_type:\n            return self.for_new_type(field_definition)\n    \n>       if field_definition.is_typevar:\nE       AttributeError: 'FieldDefinition' object has no attribute 'is_typevar'. Did you mean: 'is_type_var'?\n\nlitestar/_openapi/schema_generation/schema.py:338: AttributeError\n_ test_create_schema_for_pydantic_model_with_annotated_model_attribute[v2-True] _\n\nwith_future_annotations = True\ncreate_module = <function create_module.<locals>.wrapped at 0x7f66ccacd480>\npydantic_version = 'v2'\n\n    @pytest.mark.parametrize(\"with_future_annotations\", [True, False])\n    def test_create_schema_for_pydantic_model_with_annotated_model_attribute(\n        with_future_annotations: bool, create_module: \"Callable[[str], ModuleType]\", pydantic_version: PydanticVersion\n    ) -> None:\n        \"\"\"Test that a model with an annotated attribute is correctly handled.\"\"\"\n        module = create_module(\n            f\"\"\"\n    {'from __future__ import annotations' if with_future_annotations else ''}\n    from typing_extensions import Annotated\n    {'from pydantic import BaseModel' if pydantic_version == 'v2' else 'from pydantic.v1 import BaseModel'}\n    \n    class Foo(BaseModel):\n        foo: Annotated[int, \"Foo description\"]\n    \"\"\"\n        )\n        creator = SchemaCreator(plugins=[PydanticSchemaPlugin()])\n>       creator.for_field_definition(FieldDefinition.from_annotation(module.Foo))\n\ntests/unit/test_contrib/test_pydantic/test_openapi.py:620: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar._openapi.schema_generation.schema.SchemaCreator object at 0x7f66cc9b0580>\nfield_definition = FieldDefinition(raw=<class 'ueooyxvbbx.Foo'>, annotation=<class 'ueooyxvbbx.Foo'>, type_wrappers=set(), origin=None, a...one, safe_generic_origin=None, inner_types=(), default=<_EmptyEnum.EMPTY: 0>, extra={}, kwarg_definition=None, name='')\n\n    def for_field_definition(self, field_definition: FieldDefinition) -> Schema | Reference:\n        \"\"\"Create a Schema for a given FieldDefinition.\n    \n        Args:\n            field_definition: A signature field instance.\n    \n        Returns:\n            A schema instance.\n        \"\"\"\n        if field_definition.is_none_type:\n            return Schema(type=OpenAPIType.NULL)\n    \n        if field_definition.is_optional:\n            return self.for_optional_field(field_definition)\n    \n        if field_definition.is_union:\n            return self.for_union_field(field_definition)\n    \n        if field_definition.is_new_type:\n            return self.for_new_type(field_definition)\n    \n>       if field_definition.is_typevar:\nE       AttributeError: 'FieldDefinition' object has no attribute 'is_typevar'. Did you mean: 'is_type_var'?\n\nlitestar/_openapi/schema_generation/schema.py:338: AttributeError\n_ test_create_schema_for_pydantic_model_with_annotated_model_attribute[v2-False] _\n\nwith_future_annotations = False\ncreate_module = <function create_module.<locals>.wrapped at 0x7f66ccacd900>\npydantic_version = 'v2'\n\n    @pytest.mark.parametrize(\"with_future_annotations\", [True, False])\n    def test_create_schema_for_pydantic_model_with_annotated_model_attribute(\n        with_future_annotations: bool, create_module: \"Callable[[str], ModuleType]\", pydantic_version: PydanticVersion\n    ) -> None:\n        \"\"\"Test that a model with an annotated attribute is correctly handled.\"\"\"\n        module = create_module(\n            f\"\"\"\n    {'from __future__ import annotations' if with_future_annotations else ''}\n    from typing_extensions import Annotated\n    {'from pydantic import BaseModel' if pydantic_version == 'v2' else 'from pydantic.v1 import BaseModel'}\n    \n    class Foo(BaseModel):\n        foo: Annotated[int, \"Foo description\"]\n    \"\"\"\n        )\n        creator = SchemaCreator(plugins=[PydanticSchemaPlugin()])\n>       creator.for_field_definition(FieldDefinition.from_annotation(module.Foo))\n\ntests/unit/test_contrib/test_pydantic/test_openapi.py:620: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar._openapi.schema_generation.schema.SchemaCreator object at 0x7f66ccae19c0>\nfield_definition = FieldDefinition(raw=<class 'rznmtdwurg.Foo'>, annotation=<class 'rznmtdwurg.Foo'>, type_wrappers=set(), origin=None, a...one, safe_generic_origin=None, inner_types=(), default=<_EmptyEnum.EMPTY: 0>, extra={}, kwarg_definition=None, name='')\n\n    def for_field_definition(self, field_definition: FieldDefinition) -> Schema | Reference:\n        \"\"\"Create a Schema for a given FieldDefinition.\n    \n        Args:\n            field_definition: A signature field instance.\n    \n        Returns:\n            A schema instance.\n        \"\"\"\n        if field_definition.is_none_type:\n            return Schema(type=OpenAPIType.NULL)\n    \n        if field_definition.is_optional:\n            return self.for_optional_field(field_definition)\n    \n        if field_definition.is_union:\n            return self.for_union_field(field_definition)\n    \n        if field_definition.is_new_type:\n            return self.for_new_type(field_definition)\n    \n>       if field_definition.is_typevar:\nE       AttributeError: 'FieldDefinition' object has no attribute 'is_typevar'. Did you mean: 'is_type_var'?\n\nlitestar/_openapi/schema_generation/schema.py:338: AttributeError\n____ test_create_schema_for_pydantic_model_with_unhashable_literal_default _____\n\ncreate_module = <function create_module.<locals>.wrapped at 0x7f66ccace170>\n\n    def test_create_schema_for_pydantic_model_with_unhashable_literal_default(\n        create_module: \"Callable[[str], ModuleType]\",\n    ) -> None:\n        \"\"\"Test that a model with unhashable literal defaults is correctly handled.\"\"\"\n        module = create_module(\n            \"\"\"\n    from pydantic import BaseModel, Field\n    \n    class Model(BaseModel):\n        id: int\n        dict_default: dict = {}\n        dict_default_in_field: dict = Field(default={})\n        dict_default_in_factory: dict = Field(default_factory=dict)\n        list_default: list = []\n        list_default_in_field: list = Field(default=[])\n        list_default_in_factory: list = Field(default_factory=list)\n    \"\"\"\n        )\n        creator = SchemaCreator(plugins=[PydanticSchemaPlugin()])\n>       creator.for_field_definition(FieldDefinition.from_annotation(module.Model))\n\ntests/unit/test_contrib/test_pydantic/test_openapi.py:645: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar._openapi.schema_generation.schema.SchemaCreator object at 0x7f66cca04cc0>\nfield_definition = FieldDefinition(raw=<class 'fswnbzenwv.Model'>, annotation=<class 'fswnbzenwv.Model'>, type_wrappers=set(), origin=Non...one, safe_generic_origin=None, inner_types=(), default=<_EmptyEnum.EMPTY: 0>, extra={}, kwarg_definition=None, name='')\n\n    def for_field_definition(self, field_definition: FieldDefinition) -> Schema | Reference:\n        \"\"\"Create a Schema for a given FieldDefinition.\n    \n        Args:\n            field_definition: A signature field instance.\n    \n        Returns:\n            A schema instance.\n        \"\"\"\n        if field_definition.is_none_type:\n            return Schema(type=OpenAPIType.NULL)\n    \n        if field_definition.is_optional:\n            return self.for_optional_field(field_definition)\n    \n        if field_definition.is_union:\n            return self.for_union_field(field_definition)\n    \n        if field_definition.is_new_type:\n            return self.for_new_type(field_definition)\n    \n>       if field_definition.is_typevar:\nE       AttributeError: 'FieldDefinition' object has no attribute 'is_typevar'. Did you mean: 'is_type_var'?\n\nlitestar/_openapi/schema_generation/schema.py:338: AttributeError\n=========================== short test summary info ============================\nFAILED tests/unit/test_contrib/test_pydantic/test_openapi.py::test_create_for_computed_field[True]\nFAILED tests/unit/test_contrib/test_pydantic/test_openapi.py::test_create_for_computed_field[False]\nFAILED tests/unit/test_contrib/test_pydantic/test_openapi.py::test_create_schema_for_pydantic_model_with_annotated_model_attribute[v1-True]\nFAILED tests/unit/test_contrib/test_pydantic/test_openapi.py::test_create_schema_for_pydantic_model_with_annotated_model_attribute[v1-False]\nFAILED tests/unit/test_contrib/test_pydantic/test_openapi.py::test_create_schema_for_pydantic_model_with_annotated_model_attribute[v2-True]\nFAILED tests/unit/test_contrib/test_pydantic/test_openapi.py::test_create_schema_for_pydantic_model_with_annotated_model_attribute[v2-False]\nFAILED tests/unit/test_contrib/test_pydantic/test_openapi.py::test_create_schema_for_pydantic_model_with_unhashable_literal_default\n============================== 7 failed in 0.26s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/_openapi/typescript_converter/converter.py-convert_openapi_to_typescript": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 1 item\n\ntests/unit/test_openapi/test_typescript_converter/test_converter.py F    [100%]\n\n=================================== FAILURES ===================================\n_____________________ test_openapi_to_typescript_converter _____________________\n\nperson_controller = <class 'tests.unit.test_openapi.conftest.create_person_controller.<locals>.PersonController'>\npet_controller = <class 'tests.unit.test_openapi.conftest.create_pet_controller.<locals>.PetController'>\n\n    def test_openapi_to_typescript_converter(person_controller: Type[Controller], pet_controller: Type[Controller]) -> None:\n        BaseFactory.seed_random(1)\n        app = Litestar(route_handlers=[person_controller, pet_controller])\n        assert app.openapi_schema\n    \n>       result = convert_openapi_to_typescript(openapi_schema=app.openapi_schema)\n\ntests/unit/test_openapi/test_typescript_converter/test_converter.py:16: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nopenapi_schema = OpenAPI(info=Info(title='Litestar API', version='1.0.0', summary=None, description=None, terms_of_service=None, contac...one, security_schemes=None, links=None, callbacks=None, path_items=None), security=None, tags=None, external_docs=None)\nnamespace = 'API'\n\n    def convert_openapi_to_typescript(openapi_schema: OpenAPI, namespace: str = \"API\") -> TypeScriptNamespace:\n        \"\"\"Convert an OpenAPI Schema instance to a TypeScript namespace. This function is the main entry point for the\n        TypeScript converter.\n    \n        Args:\n            openapi_schema: An OpenAPI Schema instance.\n            namespace: The namespace to use.\n    \n        Returns:\n            A string representing the generated types.\n        \"\"\"\n        components = openapi_schema.components\n        typescript_elements: list[TypeScriptContainer] = []\n    \n        # Process schemas\n        if components and components.schemas:\n            for schema_name, schema in components.schemas.items():\n                typescript_elements.append(\n                    TypeScriptType(\n                        name=normalize_typescript_namespace(schema_name, allow_quoted=False),\n                        value=parse_schema(schema)\n                    )\n                )\n    \n        # Process paths\n        for path, path_item in openapi_schema.paths.items():\n>           for method, operation in path_item.items():\nE           AttributeError: 'PathItem' object has no attribute 'items'\n\nlitestar/_openapi/typescript_converter/converter.py:280: AttributeError\n=============================== warnings summary ===============================\n../../../../usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306\n../../../../usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306\n  /usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306: PytestRemovedIn9Warning: Marks applied to fixtures have no effect\n  See docs: https://docs.pytest.org/en/stable/deprecations.html#applying-a-mark-to-a-fixture-function\n    return fixture_marker(fixture_function)\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/unit/test_openapi/test_typescript_converter/test_converter.py::test_openapi_to_typescript_converter\n======================== 1 failed, 2 warnings in 0.12s =========================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/_openapi/typescript_converter/types.py-write": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 9 items\n\ntests/unit/test_openapi/test_typescript_converter/test_typescript_types.py . [ 11%]\n.FF.F...                                                                 [100%]\n\n=================================== FAILURES ===================================\n_______________________ test_typescript_named_interface ________________________\n\n    def test_typescript_named_interface() -> None:\n        first_prop = TypeScriptProperty(required=True, key=\"aProp\", value=TypeScriptPrimitive(\"string\"))\n        second_prop = TypeScriptProperty(required=True, key=\"bProp\", value=TypeScriptPrimitive(\"number\"))\n        interface = TypeScriptInterface(name=\"MyInterface\", properties=(first_prop, second_prop))\n>       assert interface.write() == \"export interface MyInterface {\\n\\taProp: string;\\n\\tbProp: number;\\n};\"\n\ntests/unit/test_openapi/test_typescript_converter/test_typescript_types.py:72: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nlitestar/_openapi/typescript_converter/types.py:220: in write\n    return f\"export interface {self.name} {interface.write()};\"\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = TypeScriptAnonymousInterface(properties=(TypeScriptProperty(required=True, key='aProp', value=TypeScriptPrimitive(type='string')), TypeScriptProperty(required=True, key='bProp', value=TypeScriptPrimitive(type='number'))))\n\n    def write(self) -> str:\n        \"\"\"Write a typescript intersection value.\n    \n        Example:\n            { prop: string } & { another: number }\n    \n        Returns:\n            A typescript string\n        \"\"\"\n>       return \" & \".join(t.write() for t in self.types)\nE       AttributeError: 'TypeScriptAnonymousInterface' object has no attribute 'types'\n\nlitestar/_openapi/typescript_converter/types.py:196: AttributeError\n__________________________ test_typescript_namespace ___________________________\n\n    def test_typescript_namespace() -> None:\n        first_prop = TypeScriptProperty(required=True, key=\"aProp\", value=TypeScriptPrimitive(\"string\"))\n        second_prop = TypeScriptProperty(required=True, key=\"bProp\", value=TypeScriptPrimitive(\"number\"))\n        interface = TypeScriptInterface(name=\"MyInterface\", properties=(first_prop, second_prop))\n    \n        enum = TypeScriptEnum(name=\"MyEnum\", values=((\"FIRST\", \"a\"), (\"SECOND\", \"b\")))\n        namespace = TypeScriptNamespace(\"MyNamespace\", values=(interface, enum))\n    \n>       assert (\n            namespace.write()\n            == 'export namespace MyNamespace {\\n\\texport enum MyEnum {\\n\\tFIRST = \"a\",\\n\\tSECOND = \"b\",\\n};\\n\\n\\texport interface MyInterface {\\n\\taProp: string;\\n\\tbProp: number;\\n};\\n};'\n        )\n\ntests/unit/test_openapi/test_typescript_converter/test_typescript_types.py:100: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nlitestar/_openapi/typescript_converter/types.py:304: in write\n    members = \"\\t\" + \"\\n\\n\\t\".join([value.write() for value in sorted(self.values, key=lambda el: el.name)])\nlitestar/_openapi/typescript_converter/types.py:304: in <listcomp>\n    members = \"\\t\" + \"\\n\\n\\t\".join([value.write() for value in sorted(self.values, key=lambda el: el.name)])\nlitestar/_openapi/typescript_converter/types.py:220: in write\n    return f\"export interface {self.name} {interface.write()};\"\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = TypeScriptAnonymousInterface(properties=(TypeScriptProperty(required=True, key='aProp', value=TypeScriptPrimitive(type='string')), TypeScriptProperty(required=True, key='bProp', value=TypeScriptPrimitive(type='number'))))\n\n    def write(self) -> str:\n        \"\"\"Write a typescript intersection value.\n    \n        Example:\n            { prop: string } & { another: number }\n    \n        Returns:\n            A typescript string\n        \"\"\"\n>       return \" & \".join(t.write() for t in self.types)\nE       AttributeError: 'TypeScriptAnonymousInterface' object has no attribute 'types'\n\nlitestar/_openapi/typescript_converter/types.py:196: AttributeError\n_____________________ test_typescript_anonymous_interface ______________________\n\n    def test_typescript_anonymous_interface() -> None:\n        first_prop = TypeScriptProperty(required=True, key=\"aProp\", value=TypeScriptPrimitive(\"string\"))\n        second_prop = TypeScriptProperty(required=True, key=\"bProp\", value=TypeScriptPrimitive(\"number\"))\n        interface = TypeScriptAnonymousInterface(properties=(first_prop, second_prop))\n>       assert interface.write() == \"{\\n\\taProp: string;\\n\\tbProp: number;\\n}\"\n\ntests/unit/test_openapi/test_typescript_converter/test_typescript_types.py:65: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = TypeScriptAnonymousInterface(properties=(TypeScriptProperty(required=True, key='aProp', value=TypeScriptPrimitive(type='string')), TypeScriptProperty(required=True, key='bProp', value=TypeScriptPrimitive(type='number'))))\n\n    def write(self) -> str:\n        \"\"\"Write a typescript intersection value.\n    \n        Example:\n            { prop: string } & { another: number }\n    \n        Returns:\n            A typescript string\n        \"\"\"\n>       return \" & \".join(t.write() for t in self.types)\nE       AttributeError: 'TypeScriptAnonymousInterface' object has no attribute 'types'\n\nlitestar/_openapi/typescript_converter/types.py:196: AttributeError\n=============================== warnings summary ===============================\n../../../../usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306\n../../../../usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306\n  /usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306: PytestRemovedIn9Warning: Marks applied to fixtures have no effect\n  See docs: https://docs.pytest.org/en/stable/deprecations.html#applying-a-mark-to-a-fixture-function\n    return fixture_marker(fixture_function)\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/unit/test_openapi/test_typescript_converter/test_typescript_types.py::test_typescript_named_interface\nFAILED tests/unit/test_openapi/test_typescript_converter/test_typescript_types.py::test_typescript_namespace\nFAILED tests/unit/test_openapi/test_typescript_converter/test_typescript_types.py::test_typescript_anonymous_interface\n=================== 3 failed, 6 passed, 2 warnings in 0.09s ====================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/testing/helpers.py-create_test_client": ["FAILED: No code block"], "litestar-litestar/testing/client/sync_client.py-websocket_connect": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 1 item\n\ntests/examples/test_websockets.py .                                      [100%]\n\n============================== 1 passed in 0.10s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/contrib/pydantic/pydantic_schema_plugin.py-for_pydantic_model": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 5 items\n\ntests/unit/test_contrib/test_pydantic/test_schema_plugin.py FFFFF        [100%]\n\n=================================== FAILURES ===================================\n____________ test_exclude_private_fields[V1ModelWithPrivateFields] _____________\n\nmodel_class = <class 'tests.unit.test_contrib.test_pydantic.test_schema_plugin.V1ModelWithPrivateFields'>\n\n    @pytest.mark.parametrize(\n        \"model_class\",\n        [\n            V1ModelWithPrivateFields,\n            V1GenericModelWithPrivateFields,\n            V2ModelWithPrivateFields,\n            V2GenericModelWithPrivateFields,\n        ],\n    )\n    def test_exclude_private_fields(model_class: Type[Union[pydantic_v1.BaseModel, pydantic_v2.BaseModel]]) -> None:\n        # https://github.com/litestar-org/litestar/issues/3150\n>       schema = PydanticSchemaPlugin.for_pydantic_model(\n            FieldDefinition.from_annotation(model_class), schema_creator=SchemaCreator(plugins=[PydanticSchemaPlugin()])\n        )\n\ntests/unit/test_contrib/test_pydantic/test_schema_plugin.py:126: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nlitestar/contrib/pydantic/pydantic_schema_plugin.py:263: in for_pydantic_model\n    type_hints = pydantic_get_type_hints_with_generics_resolved(field_definition.annotation)\nlitestar/contrib/pydantic/utils.py:137: in pydantic_get_type_hints_with_generics_resolved\n    return get_type_hints_with_generics_resolved(annotation, type_hints=model_annotations)\nlitestar/utils/typing.py:262: in get_type_hints_with_generics_resolved\n    type_hints = get_type_hints(annotation, globalns=globalns, localns=localns, include_extras=include_extras)\n/usr/local/lib/python3.10/site-packages/typing_extensions.py:1230: in get_type_hints\n    hint = typing.get_type_hints(\n/usr/local/lib/python3.10/typing.py:1808: in get_type_hints\n    value = _eval_type(value, base_globals, base_locals)\n/usr/local/lib/python3.10/typing.py:326: in _eval_type\n    return t._evaluate(globalns, localns, recursive_guard)\n/usr/local/lib/python3.10/typing.py:691: in _evaluate\n    eval(self.__forward_code__, globalns, localns),\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n>   ???\nE   NameError: name 'foo' is not defined\n\n<string>:1: NameError\n_________ test_exclude_private_fields[V1GenericModelWithPrivateFields] _________\n\nmodel_class = <class 'tests.unit.test_contrib.test_pydantic.test_schema_plugin.V1GenericModelWithPrivateFields'>\n\n    @pytest.mark.parametrize(\n        \"model_class\",\n        [\n            V1ModelWithPrivateFields,\n            V1GenericModelWithPrivateFields,\n            V2ModelWithPrivateFields,\n            V2GenericModelWithPrivateFields,\n        ],\n    )\n    def test_exclude_private_fields(model_class: Type[Union[pydantic_v1.BaseModel, pydantic_v2.BaseModel]]) -> None:\n        # https://github.com/litestar-org/litestar/issues/3150\n>       schema = PydanticSchemaPlugin.for_pydantic_model(\n            FieldDefinition.from_annotation(model_class), schema_creator=SchemaCreator(plugins=[PydanticSchemaPlugin()])\n        )\n\ntests/unit/test_contrib/test_pydantic/test_schema_plugin.py:126: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nlitestar/contrib/pydantic/pydantic_schema_plugin.py:263: in for_pydantic_model\n    type_hints = pydantic_get_type_hints_with_generics_resolved(field_definition.annotation)\nlitestar/contrib/pydantic/utils.py:137: in pydantic_get_type_hints_with_generics_resolved\n    return get_type_hints_with_generics_resolved(annotation, type_hints=model_annotations)\nlitestar/utils/typing.py:262: in get_type_hints_with_generics_resolved\n    type_hints = get_type_hints(annotation, globalns=globalns, localns=localns, include_extras=include_extras)\n/usr/local/lib/python3.10/site-packages/typing_extensions.py:1230: in get_type_hints\n    hint = typing.get_type_hints(\n/usr/local/lib/python3.10/typing.py:1808: in get_type_hints\n    value = _eval_type(value, base_globals, base_locals)\n/usr/local/lib/python3.10/typing.py:326: in _eval_type\n    return t._evaluate(globalns, localns, recursive_guard)\n/usr/local/lib/python3.10/typing.py:691: in _evaluate\n    eval(self.__forward_code__, globalns, localns),\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n>   ???\nE   NameError: name 'foo' is not defined\n\n<string>:1: NameError\n____________ test_exclude_private_fields[V2ModelWithPrivateFields] _____________\n\nmodel_class = <class 'tests.unit.test_contrib.test_pydantic.test_schema_plugin.V2ModelWithPrivateFields'>\n\n    @pytest.mark.parametrize(\n        \"model_class\",\n        [\n            V1ModelWithPrivateFields,\n            V1GenericModelWithPrivateFields,\n            V2ModelWithPrivateFields,\n            V2GenericModelWithPrivateFields,\n        ],\n    )\n    def test_exclude_private_fields(model_class: Type[Union[pydantic_v1.BaseModel, pydantic_v2.BaseModel]]) -> None:\n        # https://github.com/litestar-org/litestar/issues/3150\n>       schema = PydanticSchemaPlugin.for_pydantic_model(\n            FieldDefinition.from_annotation(model_class), schema_creator=SchemaCreator(plugins=[PydanticSchemaPlugin()])\n        )\n\ntests/unit/test_contrib/test_pydantic/test_schema_plugin.py:126: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nlitestar/contrib/pydantic/pydantic_schema_plugin.py:263: in for_pydantic_model\n    type_hints = pydantic_get_type_hints_with_generics_resolved(field_definition.annotation)\nlitestar/contrib/pydantic/utils.py:142: in pydantic_get_type_hints_with_generics_resolved\n    model_annotations = get_type_hints(\n/usr/local/lib/python3.10/site-packages/typing_extensions.py:1230: in get_type_hints\n    hint = typing.get_type_hints(\n/usr/local/lib/python3.10/typing.py:1808: in get_type_hints\n    value = _eval_type(value, base_globals, base_locals)\n/usr/local/lib/python3.10/typing.py:326: in _eval_type\n    return t._evaluate(globalns, localns, recursive_guard)\n/usr/local/lib/python3.10/typing.py:691: in _evaluate\n    eval(self.__forward_code__, globalns, localns),\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n>   ???\nE   NameError: name 'foo' is not defined\n\n<string>:1: NameError\n_________ test_exclude_private_fields[V2GenericModelWithPrivateFields] _________\n\nmodel_class = <class 'tests.unit.test_contrib.test_pydantic.test_schema_plugin.V2GenericModelWithPrivateFields'>\n\n    @pytest.mark.parametrize(\n        \"model_class\",\n        [\n            V1ModelWithPrivateFields,\n            V1GenericModelWithPrivateFields,\n            V2ModelWithPrivateFields,\n            V2GenericModelWithPrivateFields,\n        ],\n    )\n    def test_exclude_private_fields(model_class: Type[Union[pydantic_v1.BaseModel, pydantic_v2.BaseModel]]) -> None:\n        # https://github.com/litestar-org/litestar/issues/3150\n>       schema = PydanticSchemaPlugin.for_pydantic_model(\n            FieldDefinition.from_annotation(model_class), schema_creator=SchemaCreator(plugins=[PydanticSchemaPlugin()])\n        )\n\ntests/unit/test_contrib/test_pydantic/test_schema_plugin.py:126: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nlitestar/contrib/pydantic/pydantic_schema_plugin.py:263: in for_pydantic_model\n    type_hints = pydantic_get_type_hints_with_generics_resolved(field_definition.annotation)\nlitestar/contrib/pydantic/utils.py:142: in pydantic_get_type_hints_with_generics_resolved\n    model_annotations = get_type_hints(\n/usr/local/lib/python3.10/site-packages/typing_extensions.py:1230: in get_type_hints\n    hint = typing.get_type_hints(\n/usr/local/lib/python3.10/typing.py:1808: in get_type_hints\n    value = _eval_type(value, base_globals, base_locals)\n/usr/local/lib/python3.10/typing.py:326: in _eval_type\n    return t._evaluate(globalns, localns, recursive_guard)\n/usr/local/lib/python3.10/typing.py:691: in _evaluate\n    eval(self.__forward_code__, globalns, localns),\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n>   ???\nE   NameError: name 'foo' is not defined\n\n<string>:1: NameError\n_________________________ test_v2_constrained_secrets __________________________\n\n    def test_v2_constrained_secrets() -> None:\n        # https://github.com/litestar-org/litestar/issues/3148\n        class Model(pydantic_v2.BaseModel):\n            string: pydantic_v2.SecretStr = pydantic_v2.Field(min_length=1)\n            bytes_: pydantic_v2.SecretBytes = pydantic_v2.Field(min_length=1)\n    \n        schema = PydanticSchemaPlugin.for_pydantic_model(\n            FieldDefinition.from_annotation(Model), schema_creator=SchemaCreator(plugins=[PydanticSchemaPlugin()])\n        )\n        assert schema.properties\n>       assert schema.properties[\"string\"] == Schema(min_length=1, type=OpenAPIType.STRING)\nE       AssertionError: assert Schema(all_of... example=None) == Schema(all_of... example=None)\nE         \nE         Omitting 51 identical items, use -vv to show\nE         Differing attributes:\nE         ['min_length']\nE         \nE         Drill down into differing attribute min_length:\nE           min_length: None != 1\n\ntests/unit/test_contrib/test_pydantic/test_schema_plugin.py:81: AssertionError\n=========================== short test summary info ============================\nFAILED tests/unit/test_contrib/test_pydantic/test_schema_plugin.py::test_exclude_private_fields[V1ModelWithPrivateFields]\nFAILED tests/unit/test_contrib/test_pydantic/test_schema_plugin.py::test_exclude_private_fields[V1GenericModelWithPrivateFields]\nFAILED tests/unit/test_contrib/test_pydantic/test_schema_plugin.py::test_exclude_private_fields[V2ModelWithPrivateFields]\nFAILED tests/unit/test_contrib/test_pydantic/test_schema_plugin.py::test_exclude_private_fields[V2GenericModelWithPrivateFields]\nFAILED tests/unit/test_contrib/test_pydantic/test_schema_plugin.py::test_v2_constrained_secrets\n============================== 5 failed in 0.39s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/_kwargs/cleanup.py-cleanup": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 4 items\n\ntests/unit/test_kwargs/test_cleanup_group.py ..F.                        [100%]\n\n=================================== FAILURES ===================================\n________________________ test_cleanup_on_closed_raises _________________________\n\ngenerator = <generator object generator.<locals>.func at 0x7fafe1e543c0>\n\n    async def test_cleanup_on_closed_raises(generator: Generator[str, None, None]) -> None:\n        next(generator)\n        group = DependencyCleanupGroup([generator])\n    \n        await group.cleanup()\n>       with pytest.raises(RuntimeError):\nE       Failed: DID NOT RAISE <class 'RuntimeError'>\n\ntests/unit/test_kwargs/test_cleanup_group.py:78: Failed\n=========================== short test summary info ============================\nFAILED tests/unit/test_kwargs/test_cleanup_group.py::test_cleanup_on_closed_raises\n========================= 1 failed, 3 passed in 0.11s ==========================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/_asgi/routing_trie/mapping.py-build_route_middleware_stack": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 3 items\n\ntests/unit/test_asgi/test_routing_trie/test_mapping.py FFF               [100%]\n\n=================================== FAILURES ===================================\n_______________ test_build_route_middleware_stack_no_middleware ________________\n\nmonkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x7f45775d6500>\n\n    def test_build_route_middleware_stack_no_middleware(monkeypatch: pytest.MonkeyPatch) -> None:\n        # if there is no middleware for the route, then we don't need to wrap route.handle in\n        # exception handling middleware. Exceptions can safely be caught by the outermost exception\n        # handling middleware.\n    \n        @get(\"/\")\n        async def handler() -> None:\n            pass\n    \n>       app = Litestar(route_handlers=[handler], openapi_config=None)\n\ntests/unit/test_asgi/test_routing_trie/test_mapping.py:23: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nlitestar/app.py:484: in __init__\n    self.register(route_handler)\nlitestar/app.py:680: in register\n    self.asgi_router.construct_routing_trie()\nlitestar/_asgi/asgi_router.py:147: in construct_routing_trie\n    add_route_to_trie(\nlitestar/_asgi/routing_trie/mapping.py:122: in add_route_to_trie\n    configure_node(route=route, app=app, node=current_node)\nlitestar/_asgi/routing_trie/mapping.py:150: in configure_node\n    asgi_app=build_route_middleware_stack(app=app, route=route, route_handler=handler),\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\napp = <litestar.app.Litestar object at 0x7f45775e2cd0>\nroute = <litestar.routes.http.HTTPRoute object at 0x7f4577404350>\nroute_handler = <litestar.handlers.http_handlers.decorators.get object at 0x55b12f0390f0>\n\n    def build_route_middleware_stack(\n        app: \"Litestar\",\n        route: \"HTTPRoute | WebSocketRoute | ASGIRoute\",\n        route_handler: \"RouteHandlerType\",\n    ) -> \"ASGIApp\":\n        \"\"\"Construct a middleware stack that serves as the point of entry for each route.\n    \n        Args:\n            app: The Litestar app instance.\n            route: The route that is being added.\n            route_handler: The route handler that is being wrapped.\n    \n        Returns:\n            An ASGIApp that is composed of a \"stack\" of middlewares.\n        \"\"\"\n        middleware_stack = route_handler\n    \n        # Apply route-specific middleware\n>       for middleware in reversed(route.middleware or []):\nE       AttributeError: 'HTTPRoute' object has no attribute 'middleware'\n\nlitestar/_asgi/routing_trie/mapping.py:196: AttributeError\n______________ test_build_route_middleware_stack_with_middleware _______________\n\nmonkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x7f4577408340>\n\n    def test_build_route_middleware_stack_with_middleware(monkeypatch: pytest.MonkeyPatch) -> None:\n        # proves that if there is middleware, the route handler is wrapped in the exception handling\n        # middleware, before being wrapped in the middleware stack.\n        mock_middleware = MagicMock()\n        del mock_middleware.__iter__\n    \n        @get(\"/\", middleware=[mock_middleware])\n        async def handler() -> None:\n            pass\n    \n        route = HTTPRoute(path=\"/\", route_handlers=[handler])\n>       build_route_middleware_stack(app=Litestar(), route=route, route_handler=handler)\n\ntests/unit/test_asgi/test_routing_trie/test_mapping.py:42: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nlitestar/app.py:484: in __init__\n    self.register(route_handler)\nlitestar/app.py:680: in register\n    self.asgi_router.construct_routing_trie()\nlitestar/_asgi/asgi_router.py:147: in construct_routing_trie\n    add_route_to_trie(\nlitestar/_asgi/routing_trie/mapping.py:122: in add_route_to_trie\n    configure_node(route=route, app=app, node=current_node)\nlitestar/_asgi/routing_trie/mapping.py:150: in configure_node\n    asgi_app=build_route_middleware_stack(app=app, route=route, route_handler=handler),\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\napp = <litestar.app.Litestar object at 0x7f457752d780>\nroute = <litestar.routes.http.HTTPRoute object at 0x7f457748ac70>\nroute_handler = <litestar.handlers.http_handlers.base.HTTPRouteHandler object at 0x55b12f05b380>\n\n    def build_route_middleware_stack(\n        app: \"Litestar\",\n        route: \"HTTPRoute | WebSocketRoute | ASGIRoute\",\n        route_handler: \"RouteHandlerType\",\n    ) -> \"ASGIApp\":\n        \"\"\"Construct a middleware stack that serves as the point of entry for each route.\n    \n        Args:\n            app: The Litestar app instance.\n            route: The route that is being added.\n            route_handler: The route handler that is being wrapped.\n    \n        Returns:\n            An ASGIApp that is composed of a \"stack\" of middlewares.\n        \"\"\"\n        middleware_stack = route_handler\n    \n        # Apply route-specific middleware\n>       for middleware in reversed(route.middleware or []):\nE       AttributeError: 'HTTPRoute' object has no attribute 'middleware'\n\nlitestar/_asgi/routing_trie/mapping.py:196: AttributeError\n_________ test_build_route_middleware_stack_with_starlette_middleware __________\n\nmonkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x7f45772e3b80>\n\n    def test_build_route_middleware_stack_with_starlette_middleware(monkeypatch: pytest.MonkeyPatch) -> None:\n        # test our support for starlette's Middleware class\n        class Middleware:\n            \"\"\"A Starlette ``Middleware`` class.\n    \n            See https://github.com/encode/starlette/blob/23c81da94b57701eabd43f582093442e6811f81d/starlette/middleware/__init__.py#L4-L17\n            \"\"\"\n    \n            def __init__(self, cls: Any, **options: Any) -> None:\n                self.cls = cls\n                self.options = options\n    \n            def __iter__(self) -> Iterator[Any]:\n                as_tuple = (self.cls, self.options)\n                return iter(as_tuple)\n    \n        mock_middleware = MagicMock()\n        mock_middleware_arg = MagicMock()\n        del mock_middleware.__iter__\n    \n        @get(\"/\", middleware=[Middleware(mock_middleware, arg=mock_middleware_arg)])  # type: ignore[list-item]\n        async def handler() -> None:\n            pass\n    \n        route = HTTPRoute(path=\"/\", route_handlers=[handler])\n>       build_route_middleware_stack(app=Litestar(), route=route, route_handler=handler)\n\ntests/unit/test_asgi/test_routing_trie/test_mapping.py:73: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nlitestar/app.py:484: in __init__\n    self.register(route_handler)\nlitestar/app.py:680: in register\n    self.asgi_router.construct_routing_trie()\nlitestar/_asgi/asgi_router.py:147: in construct_routing_trie\n    add_route_to_trie(\nlitestar/_asgi/routing_trie/mapping.py:122: in add_route_to_trie\n    configure_node(route=route, app=app, node=current_node)\nlitestar/_asgi/routing_trie/mapping.py:150: in configure_node\n    asgi_app=build_route_middleware_stack(app=app, route=route, route_handler=handler),\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\napp = <litestar.app.Litestar object at 0x7f457752e320>\nroute = <litestar.routes.http.HTTPRoute object at 0x7f45774aeea0>\nroute_handler = <litestar.handlers.http_handlers.decorators.get object at 0x55b12f04dd20>\n\n    def build_route_middleware_stack(\n        app: \"Litestar\",\n        route: \"HTTPRoute | WebSocketRoute | ASGIRoute\",\n        route_handler: \"RouteHandlerType\",\n    ) -> \"ASGIApp\":\n        \"\"\"Construct a middleware stack that serves as the point of entry for each route.\n    \n        Args:\n            app: The Litestar app instance.\n            route: The route that is being added.\n            route_handler: The route handler that is being wrapped.\n    \n        Returns:\n            An ASGIApp that is composed of a \"stack\" of middlewares.\n        \"\"\"\n        middleware_stack = route_handler\n    \n        # Apply route-specific middleware\n>       for middleware in reversed(route.middleware or []):\nE       AttributeError: 'HTTPRoute' object has no attribute 'middleware'\n\nlitestar/_asgi/routing_trie/mapping.py:196: AttributeError\n=========================== short test summary info ============================\nFAILED tests/unit/test_asgi/test_routing_trie/test_mapping.py::test_build_route_middleware_stack_no_middleware\nFAILED tests/unit/test_asgi/test_routing_trie/test_mapping.py::test_build_route_middleware_stack_with_middleware\nFAILED tests/unit/test_asgi/test_routing_trie/test_mapping.py::test_build_route_middleware_stack_with_starlette_middleware\n============================== 3 failed in 0.17s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/utils/signature.py-from_fn": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 12 items\n\ntests/unit/test_signature/test_validation.py F                           [  8%]\ntests/unit/test_response/test_response_to_asgi_response.py FF            [ 25%]\ntests/unit/test_signature/test_parsing.py FF                             [ 41%]\ntests/unit/test_utils/test_signature.py F                                [ 50%]\ntests/unit/test_signature/test_parsing.py FF                             [ 66%]\ntests/unit/test_signature/test_validation.py FFF                         [ 91%]\ntests/unit/test_signature/test_parsing.py F                              [100%]\n\n=================================== FAILURES ===================================\n_______________________ test_create_signature_validation _______________________\n\n    def test_create_signature_validation() -> None:\n        @get()\n        def my_fn(typed: int, untyped) -> None:  # type: ignore[no-untyped-def]\n            pass\n    \n        with pytest.raises(ImproperlyConfiguredException):\n            SignatureModel.create(\n                dependency_name_set=set(),\n                fn=my_fn.fn,\n                data_dto=None,\n>               parsed_signature=ParsedSignature.from_fn(my_fn.fn, {}),\n                type_decoders=[],\n            )\n\ntests/unit/test_signature/test_validation.py:44: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'litestar.utils.signature.ParsedSignature'>\nfn = <function test_create_signature_validation.<locals>.my_fn at 0x7ff3b8518550>\nsignature_namespace = {}\n\n    @classmethod\n    @classmethod\n    def from_fn(cls, fn: AnyCallable, signature_namespace: dict[str, Any]) -> Self:\n        \"\"\"Parse a function signature.\n    \n        Args:\n            fn: Any callable.\n            signature_namespace: mapping of names to types for forward reference resolution\n    \n        Returns:\n            ParsedSignature\n        \"\"\"\n>       fn_signature = inspect.signature(fn)\nE       NameError: name 'inspect' is not defined\n\nlitestar/utils/signature.py:214: NameError\n____________________ test_to_response_async_await[asyncio] _____________________\n\nanyio_backend = 'asyncio'\n\n    async def test_to_response_async_await(anyio_backend: str) -> None:\n        @route(http_method=HttpMethod.POST, path=\"/person\")\n        async def handler(data: DataclassPerson) -> DataclassPerson:\n            assert isinstance(data, DataclassPerson)\n            return data\n    \n        person_instance = DataclassPersonFactory.build()\n        handler._signature_model = SignatureModel.create(\n            dependency_name_set=set(),\n            fn=handler.fn,\n            data_dto=None,\n>           parsed_signature=ParsedSignature.from_fn(handler.fn, {}),\n            type_decoders=[],\n        )\n\ntests/unit/test_response/test_response_to_asgi_response.py:86: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'litestar.utils.signature.ParsedSignature'>\nfn = <function test_to_response_async_await.<locals>.handler at 0x7ff3b7eb8280>\nsignature_namespace = {}\n\n    @classmethod\n    @classmethod\n    def from_fn(cls, fn: AnyCallable, signature_namespace: dict[str, Any]) -> Self:\n        \"\"\"Parse a function signature.\n    \n        Args:\n            fn: Any callable.\n            signature_namespace: mapping of names to types for forward reference resolution\n    \n        Returns:\n            ParsedSignature\n        \"\"\"\n>       fn_signature = inspect.signature(fn)\nE       NameError: name 'inspect' is not defined\n\nlitestar/utils/signature.py:214: NameError\n______________________ test_to_response_async_await[trio] ______________________\n\nanyio_backend = 'trio'\n\n    async def test_to_response_async_await(anyio_backend: str) -> None:\n        @route(http_method=HttpMethod.POST, path=\"/person\")\n        async def handler(data: DataclassPerson) -> DataclassPerson:\n            assert isinstance(data, DataclassPerson)\n            return data\n    \n        person_instance = DataclassPersonFactory.build()\n        handler._signature_model = SignatureModel.create(\n            dependency_name_set=set(),\n            fn=handler.fn,\n            data_dto=None,\n>           parsed_signature=ParsedSignature.from_fn(handler.fn, {}),\n            type_decoders=[],\n        )\n\ntests/unit/test_response/test_response_to_asgi_response.py:86: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'litestar.utils.signature.ParsedSignature'>\nfn = <function test_to_response_async_await.<locals>.handler at 0x7ff3b7eb8040>\nsignature_namespace = {}\n\n    @classmethod\n    @classmethod\n    def from_fn(cls, fn: AnyCallable, signature_namespace: dict[str, Any]) -> Self:\n        \"\"\"Parse a function signature.\n    \n        Args:\n            fn: Any callable.\n            signature_namespace: mapping of names to types for forward reference resolution\n    \n        Returns:\n            ParsedSignature\n        \"\"\"\n>       fn_signature = inspect.signature(fn)\nE       NameError: name 'inspect' is not defined\n\nlitestar/utils/signature.py:214: NameError\n_________________ test_field_definition_is_non_string_iterable _________________\n\n    def test_field_definition_is_non_string_iterable() -> None:\n        def fn(a: Iterable[int], b: Optional[Iterable[int]]) -> None:\n            pass\n    \n        model = SignatureModel.create(\n            dependency_name_set=set(),\n            fn=fn,\n            data_dto=None,\n>           parsed_signature=ParsedSignature.from_fn(fn, {}),\n            type_decoders=[],\n        )\n\ntests/unit/test_signature/test_parsing.py:110: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'litestar.utils.signature.ParsedSignature'>\nfn = <function test_field_definition_is_non_string_iterable.<locals>.fn at 0x7ff3b7eb9ea0>\nsignature_namespace = {}\n\n    @classmethod\n    @classmethod\n    def from_fn(cls, fn: AnyCallable, signature_namespace: dict[str, Any]) -> Self:\n        \"\"\"Parse a function signature.\n    \n        Args:\n            fn: Any callable.\n            signature_namespace: mapping of names to types for forward reference resolution\n    \n        Returns:\n            ParsedSignature\n        \"\"\"\n>       fn_signature = inspect.signature(fn)\nE       NameError: name 'inspect' is not defined\n\nlitestar/utils/signature.py:214: NameError\n____________ test_create_function_signature_model_parameter_parsing ____________\n\n    def test_create_function_signature_model_parameter_parsing() -> None:\n        @get()\n        def my_fn(a: int, b: str, c: Optional[bytes], d: bytes = b\"123\", e: Optional[dict] = None) -> None:\n            pass\n    \n        model = SignatureModel.create(\n            dependency_name_set=set(),\n            fn=my_fn.fn,\n            data_dto=None,\n>           parsed_signature=ParsedSignature.from_fn(my_fn.fn, {}),\n            type_decoders=[],\n        )\n\ntests/unit/test_signature/test_parsing.py:29: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'litestar.utils.signature.ParsedSignature'>\nfn = <function test_create_function_signature_model_parameter_parsing.<locals>.my_fn at 0x7ff3b7eb9b40>\nsignature_namespace = {}\n\n    @classmethod\n    @classmethod\n    def from_fn(cls, fn: AnyCallable, signature_namespace: dict[str, Any]) -> Self:\n        \"\"\"Parse a function signature.\n    \n        Args:\n            fn: Any callable.\n            signature_namespace: mapping of names to types for forward reference resolution\n    \n        Returns:\n            ParsedSignature\n        \"\"\"\n>       fn_signature = inspect.signature(fn)\nE       NameError: name 'inspect' is not defined\n\nlitestar/utils/signature.py:214: NameError\n____________________________ test_parsed_signature _____________________________\n\n    def test_parsed_signature() -> None:\n        \"\"\"Test ParsedSignature.\"\"\"\n    \n        def fn(foo: int, bar: Optional[List[int]] = None) -> None: ...\n    \n>       parsed_sig = ParsedSignature.from_fn(fn, get_fn_type_hints(fn))\n\ntests/unit/test_utils/test_signature.py:144: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'litestar.utils.signature.ParsedSignature'>\nfn = <function test_parsed_signature.<locals>.fn at 0x7ff3b7eba5f0>\nsignature_namespace = {'bar': typing.Optional[typing.List[int]], 'foo': <class 'int'>, 'return': <class 'NoneType'>}\n\n    @classmethod\n    @classmethod\n    def from_fn(cls, fn: AnyCallable, signature_namespace: dict[str, Any]) -> Self:\n        \"\"\"Parse a function signature.\n    \n        Args:\n            fn: Any callable.\n            signature_namespace: mapping of names to types for forward reference resolution\n    \n        Returns:\n            ParsedSignature\n        \"\"\"\n>       fn_signature = inspect.signature(fn)\nE       NameError: name 'inspect' is not defined\n\nlitestar/utils/signature.py:214: NameError\n_________________ test_field_definition_is_non_string_sequence _________________\n\n    def test_field_definition_is_non_string_sequence() -> None:\n        def fn(a: Sequence[int], b: Optional[Sequence[int]]) -> None:\n            pass\n    \n        model = SignatureModel.create(\n            dependency_name_set=set(),\n            fn=fn,\n            data_dto=None,\n>           parsed_signature=ParsedSignature.from_fn(fn, signature_namespace={}),\n            type_decoders=[],\n        )\n\ntests/unit/test_signature/test_parsing.py:126: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'litestar.utils.signature.ParsedSignature'>\nfn = <function test_field_definition_is_non_string_sequence.<locals>.fn at 0x7ff3b7eb8940>\nsignature_namespace = {}\n\n    @classmethod\n    @classmethod\n    def from_fn(cls, fn: AnyCallable, signature_namespace: dict[str, Any]) -> Self:\n        \"\"\"Parse a function signature.\n    \n        Args:\n            fn: Any callable.\n            signature_namespace: mapping of names to types for forward reference resolution\n    \n        Returns:\n            ParsedSignature\n        \"\"\"\n>       fn_signature = inspect.signature(fn)\nE       NameError: name 'inspect' is not defined\n\nlitestar/utils/signature.py:214: NameError\n__________________________ test_dto_data_typed_as_any __________________________\n\n    def test_dto_data_typed_as_any() -> None:\n        \"\"\"DTOs already validate the payload, we don't need the signature model to do it too.\n    \n        https://github.com/litestar-org/litestar/issues/2149\n        \"\"\"\n    \n        @dataclass\n        class Test:\n            a: str\n    \n        dto = DataclassDTO[Test]\n    \n        def fn(data: Test) -> None:\n            pass\n    \n        model = SignatureModel.create(\n            dependency_name_set=set(),\n            fn=fn,\n            data_dto=dto,\n>           parsed_signature=ParsedSignature.from_fn(fn, signature_namespace={\"Test\": Test}),\n            type_decoders=[],\n        )\n\ntests/unit/test_signature/test_parsing.py:208: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'litestar.utils.signature.ParsedSignature'>\nfn = <function test_dto_data_typed_as_any.<locals>.fn at 0x7ff3b7eb8700>\nsignature_namespace = {'Test': <class 'tests.unit.test_signature.test_parsing.test_dto_data_typed_as_any.<locals>.Test'>}\n\n    @classmethod\n    @classmethod\n    def from_fn(cls, fn: AnyCallable, signature_namespace: dict[str, Any]) -> Self:\n        \"\"\"Parse a function signature.\n    \n        Args:\n            fn: Any callable.\n            signature_namespace: mapping of names to types for forward reference resolution\n    \n        Returns:\n            ParsedSignature\n        \"\"\"\n>       fn_signature = inspect.signature(fn)\nE       NameError: name 'inspect' is not defined\n\nlitestar/utils/signature.py:214: NameError\n_____________________ test_validation_error_exception_key ______________________\n\n    def test_validation_error_exception_key() -> None:\n        from dataclasses import dataclass\n    \n        @dataclass\n        class OtherChild:\n            val: List[int]\n    \n        @dataclass\n        class Child:\n            val: int\n            other_val: int\n    \n        @dataclass\n        class Parent:\n            child: Child\n            other_child: OtherChild\n    \n        @get(\"/\")\n        def handler(data: Parent) -> None:\n            pass\n    \n        model = SignatureModel.create(\n            dependency_name_set=set(),\n            fn=handler,\n            data_dto=None,\n>           parsed_signature=ParsedSignature.from_fn(handler.fn, {}),\n            type_decoders=[],\n        )\n\ntests/unit/test_signature/test_validation.py:125: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'litestar.utils.signature.ParsedSignature'>\nfn = <function test_validation_error_exception_key.<locals>.handler at 0x7ff3b7ebad40>\nsignature_namespace = {}\n\n    @classmethod\n    @classmethod\n    def from_fn(cls, fn: AnyCallable, signature_namespace: dict[str, Any]) -> Self:\n        \"\"\"Parse a function signature.\n    \n        Args:\n            fn: Any callable.\n            signature_namespace: mapping of names to types for forward reference resolution\n    \n        Returns:\n            ParsedSignature\n        \"\"\"\n>       fn_signature = inspect.signature(fn)\nE       NameError: name 'inspect' is not defined\n\nlitestar/utils/signature.py:214: NameError\n________ test_parse_values_from_connection_kwargs_with_multiple_errors _________\n\n    def test_parse_values_from_connection_kwargs_with_multiple_errors() -> None:\n        def fn(a: Annotated[int, Parameter(gt=5)], b: Annotated[int, Parameter(lt=5)]) -> None:\n            pass\n    \n        model = SignatureModel.create(\n            dependency_name_set=set(),\n            fn=fn,\n            data_dto=None,\n>           parsed_signature=ParsedSignature.from_fn(fn, {}),\n            type_decoders=[],\n        )\n\ntests/unit/test_signature/test_validation.py:282: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'litestar.utils.signature.ParsedSignature'>\nfn = <function test_parse_values_from_connection_kwargs_with_multiple_errors.<locals>.fn at 0x7ff3b7ebb640>\nsignature_namespace = {}\n\n    @classmethod\n    @classmethod\n    def from_fn(cls, fn: AnyCallable, signature_namespace: dict[str, Any]) -> Self:\n        \"\"\"Parse a function signature.\n    \n        Args:\n            fn: Any callable.\n            signature_namespace: mapping of names to types for forward reference resolution\n    \n        Returns:\n            ParsedSignature\n        \"\"\"\n>       fn_signature = inspect.signature(fn)\nE       NameError: name 'inspect' is not defined\n\nlitestar/utils/signature.py:214: NameError\n_______________ test_parses_values_from_connection_kwargs_raises _______________\n\n    def test_parses_values_from_connection_kwargs_raises() -> None:\n        def fn(a: int) -> None:\n            pass\n    \n        model = SignatureModel.create(\n            dependency_name_set=set(),\n            fn=fn,\n            data_dto=None,\n>           parsed_signature=ParsedSignature.from_fn(fn, {}),\n            type_decoders=[],\n        )\n\ntests/unit/test_signature/test_validation.py:27: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'litestar.utils.signature.ParsedSignature'>\nfn = <function test_parses_values_from_connection_kwargs_raises.<locals>.fn at 0x7ff3b7eb80d0>\nsignature_namespace = {}\n\n    @classmethod\n    @classmethod\n    def from_fn(cls, fn: AnyCallable, signature_namespace: dict[str, Any]) -> Self:\n        \"\"\"Parse a function signature.\n    \n        Args:\n            fn: Any callable.\n            signature_namespace: mapping of names to types for forward reference resolution\n    \n        Returns:\n            ParsedSignature\n        \"\"\"\n>       fn_signature = inspect.signature(fn)\nE       NameError: name 'inspect' is not defined\n\nlitestar/utils/signature.py:214: NameError\n________ test_create_function_signature_model_ignore_return_annotation _________\n\n    def test_create_function_signature_model_ignore_return_annotation() -> None:\n        @get(path=\"/health\", status_code=HTTP_204_NO_CONTENT)\n        async def health_check() -> None:\n            return None\n    \n        signature_model_type = SignatureModel.create(\n            dependency_name_set=set(),\n            fn=health_check.fn,\n            data_dto=None,\n>           parsed_signature=ParsedSignature.from_fn(health_check.fn, {}),\n            type_decoders=[],\n        )\n\ntests/unit/test_signature/test_parsing.py:56: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'litestar.utils.signature.ParsedSignature'>\nfn = <function test_create_function_signature_model_ignore_return_annotation.<locals>.health_check at 0x7ff3b7ebbb50>\nsignature_namespace = {}\n\n    @classmethod\n    @classmethod\n    def from_fn(cls, fn: AnyCallable, signature_namespace: dict[str, Any]) -> Self:\n        \"\"\"Parse a function signature.\n    \n        Args:\n            fn: Any callable.\n            signature_namespace: mapping of names to types for forward reference resolution\n    \n        Returns:\n            ParsedSignature\n        \"\"\"\n>       fn_signature = inspect.signature(fn)\nE       NameError: name 'inspect' is not defined\n\nlitestar/utils/signature.py:214: NameError\n=========================== short test summary info ============================\nFAILED tests/unit/test_signature/test_validation.py::test_create_signature_validation\nFAILED tests/unit/test_response/test_response_to_asgi_response.py::test_to_response_async_await[asyncio]\nFAILED tests/unit/test_response/test_response_to_asgi_response.py::test_to_response_async_await[trio]\nFAILED tests/unit/test_signature/test_parsing.py::test_field_definition_is_non_string_iterable\nFAILED tests/unit/test_signature/test_parsing.py::test_create_function_signature_model_parameter_parsing\nFAILED tests/unit/test_utils/test_signature.py::test_parsed_signature - NameE...\nFAILED tests/unit/test_signature/test_parsing.py::test_field_definition_is_non_string_sequence\nFAILED tests/unit/test_signature/test_parsing.py::test_dto_data_typed_as_any\nFAILED tests/unit/test_signature/test_validation.py::test_validation_error_exception_key\nFAILED tests/unit/test_signature/test_validation.py::test_parse_values_from_connection_kwargs_with_multiple_errors\nFAILED tests/unit/test_signature/test_validation.py::test_parses_values_from_connection_kwargs_raises\nFAILED tests/unit/test_signature/test_parsing.py::test_create_function_signature_model_ignore_return_annotation\n============================== 12 failed in 0.23s ==============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/utils/deprecation.py-deprecated": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 1 item\n\ntests/unit/test_utils/test_deprecation.py .                              [100%]\n\n============================== 1 passed in 0.06s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/utils/sync.py-ensure_async_callable": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 6 items\n\ntests/unit/test_utils/test_sync.py ......                                [100%]\n\n============================== 6 passed in 0.06s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/utils/typing.py-expand_type_var_in_type_hint": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 10 items\n\ntests/unit/test_utils/test_typing.py ...FF...FF                          [100%]\n\n=================================== FAILURES ===================================\n_____ test_expand_type_var_in_type_hints[type_hint3-namespace3-expected3] ______\n\ntype_hint = {'arg1': ~T, 'return': <class 'int'>}\nnamespace = {~T: <class 'tests.unit.test_utils.test_typing.ConcreteT'>}\nexpected = {'arg1': <class 'tests.unit.test_utils.test_typing.ConcreteT'>, 'return': <class 'int'>}\n\n    @pytest.mark.parametrize(\n        (\"type_hint\", \"namespace\", \"expected\"),\n        (\n            ({\"arg1\": T, \"return\": int}, {}, {\"arg1\": T, \"return\": int}),\n            ({\"arg1\": T, \"return\": int}, None, {\"arg1\": T, \"return\": int}),\n            ({\"arg1\": T, \"return\": int}, {U: ConcreteT}, {\"arg1\": T, \"return\": int}),\n            ({\"arg1\": T, \"return\": int}, {T: ConcreteT}, {\"arg1\": ConcreteT, \"return\": int}),\n            ({\"arg1\": T, \"return\": int}, {T: int}, {\"arg1\": int, \"return\": int}),\n            ({\"arg1\": int, \"return\": int}, {}, {\"arg1\": int, \"return\": int}),\n            ({\"arg1\": int, \"return\": int}, None, {\"arg1\": int, \"return\": int}),\n            ({\"arg1\": int, \"return\": int}, {T: int}, {\"arg1\": int, \"return\": int}),\n            ({\"arg1\": T, \"return\": T}, {T: ConcreteT}, {\"arg1\": ConcreteT, \"return\": ConcreteT}),\n            ({\"arg1\": T, \"return\": T}, {T: int}, {\"arg1\": int, \"return\": int}),\n        ),\n    )\n    def test_expand_type_var_in_type_hints(\n        type_hint: dict[str, Any], namespace: dict[str, Any] | None, expected: dict[str, Any]\n    ) -> None:\n>       assert expand_type_var_in_type_hint(type_hint, namespace) == expected\nE       AssertionError: assert {'arg1': ~T, ...<class 'int'>} == {'arg1': <cla...<class 'int'>}\nE         \nE         Omitting 1 identical items, use -vv to show\nE         Differing items:\nE         {'arg1': ~T} != {'arg1': <class 'tests.unit.test_utils.test_typing.ConcreteT'>}\nE         Use -v to get more diff\n\ntests/unit/test_utils/test_typing.py:161: AssertionError\n_____ test_expand_type_var_in_type_hints[type_hint4-namespace4-expected4] ______\n\ntype_hint = {'arg1': ~T, 'return': <class 'int'>}\nnamespace = {~T: <class 'int'>}\nexpected = {'arg1': <class 'int'>, 'return': <class 'int'>}\n\n    @pytest.mark.parametrize(\n        (\"type_hint\", \"namespace\", \"expected\"),\n        (\n            ({\"arg1\": T, \"return\": int}, {}, {\"arg1\": T, \"return\": int}),\n            ({\"arg1\": T, \"return\": int}, None, {\"arg1\": T, \"return\": int}),\n            ({\"arg1\": T, \"return\": int}, {U: ConcreteT}, {\"arg1\": T, \"return\": int}),\n            ({\"arg1\": T, \"return\": int}, {T: ConcreteT}, {\"arg1\": ConcreteT, \"return\": int}),\n            ({\"arg1\": T, \"return\": int}, {T: int}, {\"arg1\": int, \"return\": int}),\n            ({\"arg1\": int, \"return\": int}, {}, {\"arg1\": int, \"return\": int}),\n            ({\"arg1\": int, \"return\": int}, None, {\"arg1\": int, \"return\": int}),\n            ({\"arg1\": int, \"return\": int}, {T: int}, {\"arg1\": int, \"return\": int}),\n            ({\"arg1\": T, \"return\": T}, {T: ConcreteT}, {\"arg1\": ConcreteT, \"return\": ConcreteT}),\n            ({\"arg1\": T, \"return\": T}, {T: int}, {\"arg1\": int, \"return\": int}),\n        ),\n    )\n    def test_expand_type_var_in_type_hints(\n        type_hint: dict[str, Any], namespace: dict[str, Any] | None, expected: dict[str, Any]\n    ) -> None:\n>       assert expand_type_var_in_type_hint(type_hint, namespace) == expected\nE       AssertionError: assert {'arg1': ~T, ...<class 'int'>} == {'arg1': <cla...<class 'int'>}\nE         \nE         Omitting 1 identical items, use -vv to show\nE         Differing items:\nE         {'arg1': ~T} != {'arg1': <class 'int'>}\nE         Use -v to get more diff\n\ntests/unit/test_utils/test_typing.py:161: AssertionError\n_____ test_expand_type_var_in_type_hints[type_hint8-namespace8-expected8] ______\n\ntype_hint = {'arg1': ~T, 'return': ~T}\nnamespace = {~T: <class 'tests.unit.test_utils.test_typing.ConcreteT'>}\nexpected = {'arg1': <class 'tests.unit.test_utils.test_typing.ConcreteT'>, 'return': <class 'tests.unit.test_utils.test_typing.ConcreteT'>}\n\n    @pytest.mark.parametrize(\n        (\"type_hint\", \"namespace\", \"expected\"),\n        (\n            ({\"arg1\": T, \"return\": int}, {}, {\"arg1\": T, \"return\": int}),\n            ({\"arg1\": T, \"return\": int}, None, {\"arg1\": T, \"return\": int}),\n            ({\"arg1\": T, \"return\": int}, {U: ConcreteT}, {\"arg1\": T, \"return\": int}),\n            ({\"arg1\": T, \"return\": int}, {T: ConcreteT}, {\"arg1\": ConcreteT, \"return\": int}),\n            ({\"arg1\": T, \"return\": int}, {T: int}, {\"arg1\": int, \"return\": int}),\n            ({\"arg1\": int, \"return\": int}, {}, {\"arg1\": int, \"return\": int}),\n            ({\"arg1\": int, \"return\": int}, None, {\"arg1\": int, \"return\": int}),\n            ({\"arg1\": int, \"return\": int}, {T: int}, {\"arg1\": int, \"return\": int}),\n            ({\"arg1\": T, \"return\": T}, {T: ConcreteT}, {\"arg1\": ConcreteT, \"return\": ConcreteT}),\n            ({\"arg1\": T, \"return\": T}, {T: int}, {\"arg1\": int, \"return\": int}),\n        ),\n    )\n    def test_expand_type_var_in_type_hints(\n        type_hint: dict[str, Any], namespace: dict[str, Any] | None, expected: dict[str, Any]\n    ) -> None:\n>       assert expand_type_var_in_type_hint(type_hint, namespace) == expected\nE       AssertionError: assert {'arg1': ~T, 'return': ~T} == {'arg1': <cla...g.ConcreteT'>}\nE         \nE         Differing items:\nE         {'arg1': ~T} != {'arg1': <class 'tests.unit.test_utils.test_typing.ConcreteT'>}\nE         {'return': ~T} != {'return': <class 'tests.unit.test_utils.test_typing.ConcreteT'>}\nE         Use -v to get more diff\n\ntests/unit/test_utils/test_typing.py:161: AssertionError\n_____ test_expand_type_var_in_type_hints[type_hint9-namespace9-expected9] ______\n\ntype_hint = {'arg1': ~T, 'return': ~T}, namespace = {~T: <class 'int'>}\nexpected = {'arg1': <class 'int'>, 'return': <class 'int'>}\n\n    @pytest.mark.parametrize(\n        (\"type_hint\", \"namespace\", \"expected\"),\n        (\n            ({\"arg1\": T, \"return\": int}, {}, {\"arg1\": T, \"return\": int}),\n            ({\"arg1\": T, \"return\": int}, None, {\"arg1\": T, \"return\": int}),\n            ({\"arg1\": T, \"return\": int}, {U: ConcreteT}, {\"arg1\": T, \"return\": int}),\n            ({\"arg1\": T, \"return\": int}, {T: ConcreteT}, {\"arg1\": ConcreteT, \"return\": int}),\n            ({\"arg1\": T, \"return\": int}, {T: int}, {\"arg1\": int, \"return\": int}),\n            ({\"arg1\": int, \"return\": int}, {}, {\"arg1\": int, \"return\": int}),\n            ({\"arg1\": int, \"return\": int}, None, {\"arg1\": int, \"return\": int}),\n            ({\"arg1\": int, \"return\": int}, {T: int}, {\"arg1\": int, \"return\": int}),\n            ({\"arg1\": T, \"return\": T}, {T: ConcreteT}, {\"arg1\": ConcreteT, \"return\": ConcreteT}),\n            ({\"arg1\": T, \"return\": T}, {T: int}, {\"arg1\": int, \"return\": int}),\n        ),\n    )\n    def test_expand_type_var_in_type_hints(\n        type_hint: dict[str, Any], namespace: dict[str, Any] | None, expected: dict[str, Any]\n    ) -> None:\n>       assert expand_type_var_in_type_hint(type_hint, namespace) == expected\nE       AssertionError: assert {'arg1': ~T, 'return': ~T} == {'arg1': <cla...<class 'int'>}\nE         \nE         Differing items:\nE         {'arg1': ~T} != {'arg1': <class 'int'>}\nE         {'return': ~T} != {'return': <class 'int'>}\nE         Use -v to get more diff\n\ntests/unit/test_utils/test_typing.py:161: AssertionError\n=========================== short test summary info ============================\nFAILED tests/unit/test_utils/test_typing.py::test_expand_type_var_in_type_hints[type_hint3-namespace3-expected3]\nFAILED tests/unit/test_utils/test_typing.py::test_expand_type_var_in_type_hints[type_hint4-namespace4-expected4]\nFAILED tests/unit/test_utils/test_typing.py::test_expand_type_var_in_type_hints[type_hint8-namespace8-expected8]\nFAILED tests/unit/test_utils/test_typing.py::test_expand_type_var_in_type_hints[type_hint9-namespace9-expected9]\n========================= 4 failed, 6 passed in 0.14s ==========================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/utils/dataclass.py-simple_asdict": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 3 items\n\ntests/unit/test_datastructures/test_headers.py FFF                       [100%]\n\n=================================== FAILURES ===================================\n________________________ test_cache_control_from_header ________________________\n\n    def test_cache_control_from_header() -> None:\n        header_value = (\n            \"public, private, no-store, no-cache, max-age=10000, s-maxage=1000, no-transform, \"\n            \"must-revalidate, proxy-revalidate, must-understand, immutable, stale-while-revalidate=100\"\n        )\n        header = CacheControlHeader.from_header(header_value)\n>       assert simple_asdict(header) == {\n            \"documentation_only\": False,\n            \"public\": True,\n            \"private\": True,\n            \"no_store\": True,\n            \"no_cache\": True,\n            \"max_age\": 10000,\n            \"s_maxage\": 1000,\n            \"no_transform\": True,\n            \"must_revalidate\": True,\n            \"proxy_revalidate\": True,\n            \"must_understand\": True,\n            \"immutable\": True,\n            \"stale_while_revalidate\": 100,\n        }\nE       AssertionError: assert {'HEADER_NAME...': 10000, ...} == {'documentati...e': True, ...}\nE         \nE         Omitting 13 identical items, use -vv to show\nE         Left contains 1 more item:\nE         {'HEADER_NAME': 'cache-control'}\nE         Use -v to get more diff\n\ntests/unit/test_datastructures/test_headers.py:260: AssertionError\n_________________ test_cache_control_from_header_single_value __________________\n\n    def test_cache_control_from_header_single_value() -> None:\n        header_value = \"no-cache\"\n        header = CacheControlHeader.from_header(header_value)\n        header_dict = simple_asdict(header, exclude_none=True)\n>       assert header_dict == {\"no_cache\": True, \"documentation_only\": False}\nE       AssertionError: assert {'HEADER_NAME..._cache': True} == {'documentati..._cache': True}\nE         \nE         Omitting 2 identical items, use -vv to show\nE         Left contains 1 more item:\nE         {'HEADER_NAME': 'cache-control'}\nE         Use -v to get more diff\n\ntests/unit/test_datastructures/test_headers.py:281: AssertionError\n__________________ test_cache_control_header_prevent_storing ___________________\n\n    def test_cache_control_header_prevent_storing() -> None:\n        header = CacheControlHeader.prevent_storing()\n        header_dict = simple_asdict(header, exclude_none=True)\n>       assert header_dict == {\"no_store\": True, \"documentation_only\": False}\nE       AssertionError: assert {'HEADER_NAME..._store': True} == {'documentati..._store': True}\nE         \nE         Omitting 2 identical items, use -vv to show\nE         Left contains 1 more item:\nE         {'HEADER_NAME': 'cache-control'}\nE         Use -v to get more diff\n\ntests/unit/test_datastructures/test_headers.py:293: AssertionError\n=========================== short test summary info ============================\nFAILED tests/unit/test_datastructures/test_headers.py::test_cache_control_from_header\nFAILED tests/unit/test_datastructures/test_headers.py::test_cache_control_from_header_single_value\nFAILED tests/unit/test_datastructures/test_headers.py::test_cache_control_header_prevent_storing\n============================== 3 failed in 0.12s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/utils/path.py-join_paths": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 10 items\n\ntests/unit/test_utils/test_path.py ..........                            [100%]\n\n============================== 10 passed in 0.07s ==============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/utils/helpers.py-get_name": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 11 items\n\ntests/unit/test_contrib/test_attrs/test_schema_plugin.py .               [  9%]\ntests/unit/test_utils/test_helpers.py ......                             [ 63%]\ntests/unit/test_contrib/test_pydantic/test_schema_plugin.py ..           [ 81%]\ntests/unit/test_openapi/test_schema.py ..                                [100%]\n\n=============================== warnings summary ===============================\n../../../../usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306\n../../../../usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306\n  /usr/local/lib/python3.10/site-packages/_pytest/fixtures.py:1306: PytestRemovedIn9Warning: Marks applied to fixtures have no effect\n  See docs: https://docs.pytest.org/en/stable/deprecations.html#applying-a-mark-to-a-fixture-function\n    return fixture_marker(fixture_function)\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n======================== 11 passed, 2 warnings in 0.08s ========================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/utils/predicates.py-is_dataclass_class": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 1 item\n\ntests/unit/test_utils/test_dataclass.py .                                [100%]\n\n============================== 1 passed in 0.06s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/utils/predicates.py-is_class_var": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 0 items / 1 error\n\n==================================== ERRORS ====================================\n__________ ERROR collecting tests/unit/test_utils/test_predicates.py ___________\ntests/unit/test_utils/test_predicates.py:204: in <module>\n    (Annotated[ClassVar[int], \"abc\"], True),\n/usr/local/lib/python3.10/typing.py:311: in inner\n    return func(*args, **kwds)\n/usr/local/lib/python3.10/typing.py:1677: in __class_getitem__\n    origin = _type_check(params[0], msg)\n/usr/local/lib/python3.10/typing.py:167: in _type_check\n    raise TypeError(f\"{arg} is not valid as type argument\")\nE   TypeError: typing.ClassVar[int] is not valid as type argument\n=========================== short test summary info ============================\nERROR tests/unit/test_utils/test_predicates.py - TypeError: typing.ClassVar[i...\n=============================== 1 error in 0.11s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_utils/test_predicates.py::test_is_class_var\n\n"], "litestar-litestar/utils/module_loader.py-import_string": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 3 items\n\ntests/unit/test_utils/test_module_loader.py ...                          [100%]\n\n============================== 3 passed in 0.06s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/channels/backends/redis.py-unsubscribe": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 0 items / 1 error\n\n==================================== ERRORS ====================================\n__________ ERROR collecting tests/unit/test_channels/test_backends.py __________\n'flaky' not found in `markers` configuration option\n=========================== short test summary info ============================\nERROR tests/unit/test_channels/test_backends.py - Failed: 'flaky' not found i...\n=============================== 1 error in 0.01s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_pub_sub_no_subscriptions_by_unsubscribes\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_unsubscribe_without_subscription\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_pub_sub_unsubscribe\n\n"], "litestar-litestar/channels/backends/redis.py-publish": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 0 items / 1 error\n\n==================================== ERRORS ====================================\n__________ ERROR collecting tests/unit/test_channels/test_backends.py __________\n'flaky' not found in `markers` configuration option\n=========================== short test summary info ============================\nERROR tests/unit/test_channels/test_backends.py - Failed: 'flaky' not found i...\n=============================== 1 error in 0.02s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_redis_stream_backend_expires\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_pub_sub_unsubscribe\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_redis_streams_backend_flushall\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_pub_sub_no_subscriptions_by_unsubscribes\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_pub_sub_shutdown_leftover_messages\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_asyncpg_backend_publish_before_startup_raises\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_memory_publish_not_initialized_raises\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_discards_history_entries\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_get_history\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_pub_sub\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_pub_sub_no_subscriptions\n\n"], "litestar-litestar/channels/backends/redis.py-stream_events": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 0 items / 1 error\n\n==================================== ERRORS ====================================\n__________ ERROR collecting tests/unit/test_channels/test_backends.py __________\n'flaky' not found in `markers` configuration option\n=========================== short test summary info ============================\nERROR tests/unit/test_channels/test_backends.py - Failed: 'flaky' not found i...\n=============================== 1 error in 0.02s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_pub_sub_unsubscribe\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_pub_sub_no_subscriptions_by_unsubscribes\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_memory_backend_stream_before_startup_raises\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_asyncpg_backend_stream_before_startup_raises\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_pub_sub\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_pub_sub_no_subscriptions\n\n"], "litestar-litestar/channels/backends/redis.py-get_history": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 0 items / 1 error\n\n==================================== ERRORS ====================================\n__________ ERROR collecting tests/unit/test_channels/test_backends.py __________\n'flaky' not found in `markers` configuration option\n=========================== short test summary info ============================\nERROR tests/unit/test_channels/test_backends.py - Failed: 'flaky' not found i...\n=============================== 1 error in 0.02s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_get_history\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_asyncpg_get_history\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_psycopg_get_history\n\nERROR: found no collectors for /root/repos/py_data/litestar/tests/unit/test_channels/test_backends.py::test_discards_history_entries\n\n"], "litestar-litestar/dto/_backend.py-create_transfer_model_type": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 2 items\n\ntests/unit/test_dto/test_factory/test_backends/test_backends.py ..       [100%]\n\n============================== 2 passed in 0.08s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/dto/_backend.py-populate_data_from_builtins": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 2 items\n\ntests/unit/test_dto/test_factory/test_backends/test_backends.py .F       [100%]\n\n=================================== FAILURES ===================================\n__________ test_backend_populate_data_from_builtins[default_backend] ___________\n\ndto_factory = <class 'tests.unit.test_dto.test_factory.test_backends.test_backends.fx_backend_factory.<locals>.Factory'>\nasgi_connection = <litestar.connection.request.Request object at 0x7faa31cd1c70>\nbackend_cls = <class 'litestar.dto._backend.DTOBackend'>\n\n    def test_backend_populate_data_from_builtins(\n        dto_factory: type[DataclassDTO], asgi_connection: Request[Any, Any, Any], backend_cls: type[DTOBackend]\n    ) -> None:\n        backend = backend_cls(\n            handler_id=\"test\",\n            dto_factory=dto_factory,\n            field_definition=FieldDefinition.from_annotation(DC),\n            model_type=DC,\n            wrapper_attribute_name=None,\n            is_data_field=True,\n        )\n>       data = backend.populate_data_from_builtins(builtins=DESTRUCTURED, asgi_connection=asgi_connection)\n\ntests/unit/test_dto/test_factory/test_backends/test_backends.py:190: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar.dto._backend.DTOBackend object at 0x7faa322d0940>\nbuiltins = {'a': 1, 'b': 'b', 'c': [], 'nested': {'a': 1, 'b': 'two'}, ...}\nasgi_connection = <litestar.connection.request.Request object at 0x7faa31cd1c70>\n\n    def populate_data_from_builtins(self, builtins: Any, asgi_connection: ASGIConnection) -> Any:\n        \"\"\"Populate model instance from builtin types.\n    \n        Args:\n            builtins: Builtin type.\n            asgi_connection: The current ASGI Connection\n    \n        Returns:\n            Instance or collection of ``model_type`` instances.\n        \"\"\"\n>       backend = self._dto_backends[self.asgi_connection.route_handler.handler_id][\"data_backend\"]\nE       AttributeError: 'DTOBackend' object has no attribute '_dto_backends'\n\nlitestar/dto/_backend.py:269: AttributeError\n=========================== short test summary info ============================\nFAILED tests/unit/test_dto/test_factory/test_backends/test_backends.py::test_backend_populate_data_from_builtins[default_backend]\n========================= 1 failed, 1 passed in 0.16s ==========================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/dto/_backend.py-populate_data_from_raw": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 4 items\n\ntests/unit/test_dto/test_factory/test_backends/test_backends.py .F.F     [100%]\n\n=================================== FAILURES ===================================\n_______ test_backend_populate_collection_data_from_raw[default_backend] ________\n\ndto_factory = <class 'tests.unit.test_dto.test_factory.test_backends.test_backends.fx_backend_factory.<locals>.Factory'>\nasgi_connection = <litestar.connection.request.Request object at 0x7f2189412400>\nbackend_cls = <class 'litestar.dto._backend.DTOBackend'>\n\n    def test_backend_populate_collection_data_from_raw(\n        dto_factory: type[DataclassDTO], asgi_connection: Request[Any, Any, Any], backend_cls: type[DTOBackend]\n    ) -> None:\n        backend = backend_cls(\n            handler_id=\"test\",\n            dto_factory=dto_factory,\n            field_definition=FieldDefinition.from_annotation(List[DC]),\n            model_type=DC,\n            wrapper_attribute_name=None,\n            is_data_field=True,\n        )\n>       data = backend.populate_data_from_raw(COLLECTION_RAW, asgi_connection)\n\ntests/unit/test_dto/test_factory/test_backends/test_backends.py:291: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar.dto._backend.DTOBackend object at 0x7f21896c88c0>\nraw = b'[{\"a\":1,\"nested\":{\"a\":1,\"b\":\"two\"},\"nested_list\":[{\"a\":1,\"b\":\"two\"}],\"nested_mapping\":{\"a\":{\"a\":1,\"b\":\"two\"}},\"b\":\"b\",\"c\":[],\"optional\":null}]'\nasgi_connection = <litestar.connection.request.Request object at 0x7f2189412400>\n\n    def populate_data_from_raw(self, raw: bytes, asgi_connection: ASGIConnection) -> Any:\n        \"\"\"Parse raw bytes into instance of `model_type`.\n    \n        Args:\n            raw: bytes\n            asgi_connection: The current ASGI Connection\n    \n        Returns:\n            Instance or collection of ``model_type`` instances.\n        \"\"\"\n        parsed_data = self.parse_raw(raw, asgi_connection)\n    \n        if self.dto_data_type:\n            return self.dto_data_type(\n                backend=self,\n                data_as_builtins=self._transfer_to_dict(parsed_data)\n            )\n    \n>       return self._transfer_to_model_type(parsed_data)\nE       AttributeError: 'DTOBackend' object has no attribute '_transfer_to_model_type'. Did you mean: 'transfer_model_type'?\n\nlitestar/dto/_backend.py:317: AttributeError\n_____________ test_backend_populate_data_from_raw[default_backend] _____________\n\ndto_factory = <class 'tests.unit.test_dto.test_factory.test_backends.test_backends.fx_backend_factory.<locals>.Factory'>\nasgi_connection = <litestar.connection.request.Request object at 0x7f2188309850>\nbackend_cls = <class 'litestar.dto._backend.DTOBackend'>\n\n    def test_backend_populate_data_from_raw(\n        dto_factory: type[DataclassDTO], asgi_connection: Request[Any, Any, Any], backend_cls: type[DTOBackend]\n    ) -> None:\n        backend = backend_cls(\n            handler_id=\"test\",\n            dto_factory=dto_factory,\n            field_definition=FieldDefinition.from_annotation(DC),\n            model_type=DC,\n            wrapper_attribute_name=None,\n            is_data_field=True,\n        )\n>       data = backend.populate_data_from_raw(RAW, asgi_connection)\n\ntests/unit/test_dto/test_factory/test_backends/test_backends.py:276: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar.dto._backend.DTOBackend object at 0x7f2189472440>\nraw = b'{\"a\":1,\"nested\":{\"a\":1,\"b\":\"two\"},\"nested_list\":[{\"a\":1,\"b\":\"two\"}],\"nested_mapping\":{\"a\":{\"a\":1,\"b\":\"two\"}},\"b\":\"b\",\"c\":[],\"optional\":null}'\nasgi_connection = <litestar.connection.request.Request object at 0x7f2188309850>\n\n    def populate_data_from_raw(self, raw: bytes, asgi_connection: ASGIConnection) -> Any:\n        \"\"\"Parse raw bytes into instance of `model_type`.\n    \n        Args:\n            raw: bytes\n            asgi_connection: The current ASGI Connection\n    \n        Returns:\n            Instance or collection of ``model_type`` instances.\n        \"\"\"\n        parsed_data = self.parse_raw(raw, asgi_connection)\n    \n        if self.dto_data_type:\n            return self.dto_data_type(\n                backend=self,\n                data_as_builtins=self._transfer_to_dict(parsed_data)\n            )\n    \n>       return self._transfer_to_model_type(parsed_data)\nE       AttributeError: 'DTOBackend' object has no attribute '_transfer_to_model_type'. Did you mean: 'transfer_model_type'?\n\nlitestar/dto/_backend.py:317: AttributeError\n=========================== short test summary info ============================\nFAILED tests/unit/test_dto/test_factory/test_backends/test_backends.py::test_backend_populate_collection_data_from_raw[default_backend]\nFAILED tests/unit/test_dto/test_factory/test_backends/test_backends.py::test_backend_populate_data_from_raw[default_backend]\n========================= 2 failed, 2 passed in 0.19s ==========================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/dto/_backend.py-encode_data": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 6 items\n\ntests/unit/test_dto/test_factory/test_backends/test_backends.py .F.F.F   [100%]\n\n=================================== FAILURES ===================================\n__________________ test_backend_encode_data[default_backend] ___________________\n\ndto_factory = <class 'tests.unit.test_dto.test_factory.test_backends.test_backends.fx_backend_factory.<locals>.Factory'>\nasgi_connection = <litestar.connection.request.Request object at 0x7f724dfea980>\nbackend_cls = <class 'litestar.dto._backend.DTOBackend'>\n\n    def test_backend_encode_data(\n        dto_factory: type[DataclassDTO], asgi_connection: Request[Any, Any, Any], backend_cls: type[DTOBackend]\n    ) -> None:\n        backend = backend_cls(\n            handler_id=\"test\",\n            dto_factory=dto_factory,\n            field_definition=FieldDefinition.from_annotation(DC),\n            model_type=DC,\n            wrapper_attribute_name=None,\n            is_data_field=True,\n        )\n>       data = backend.encode_data(STRUCTURED)\n\ntests/unit/test_dto/test_factory/test_backends/test_backends.py:306: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar.dto._backend.DTOBackend object at 0x7f724e2b4940>\ndata = DC(a=1, nested=NestedDC(a=1, b='two'), nested_list=[NestedDC(a=1, b='two')], nested_mapping={'a': NestedDC(a=1, b='two')}, b='b', c=[], optional=None)\n\n    def encode_data(self, data: Any) -> LitestarEncodableType:\n        \"\"\"Encode data into a ``LitestarEncodableType``.\n    \n        Args:\n            data: Data to encode.\n    \n        Returns:\n            Encoded data.\n        \"\"\"\n        if self.wrapper_attribute_name:\n            wrapped_transfer = self._encode_data(getattr(data, self.wrapper_attribute_name))\n            setattr(data, self.wrapper_attribute_name, wrapped_transfer)\n            return cast(\"LitestarEncodableType\", data)\n    \n>       return cast(\"LitestarEncodableType\", self._encode_data(data))\nE       AttributeError: 'DTOBackend' object has no attribute '_encode_data'. Did you mean: 'encode_data'?\n\nlitestar/dto/_backend.py:342: AttributeError\n_______ test_transfer_only_touches_included_attributes[default_backend] ________\n\nbackend_cls = <class 'litestar.dto._backend.DTOBackend'>\n\n    def test_transfer_only_touches_included_attributes(backend_cls: type[DTOBackend]) -> None:\n        \"\"\"Ensure attribute that are not included are never touched in any way during\n        transfer.\n    \n        https://github.com/litestar-org/litestar/issues/2125\n        \"\"\"\n        mock = MagicMock()\n    \n        @dataclass()\n        class Foo:\n            id: str\n            bar: str = \"\"\n    \n        class Factory(DataclassDTO):\n            config = DTOConfig(include={\"excluded\"})\n    \n        backend = backend_cls(\n            handler_id=\"test\",\n            dto_factory=Factory,\n            field_definition=TransferDTOFieldDefinition.from_annotation(Foo),\n            model_type=Foo,\n            wrapper_attribute_name=None,\n            is_data_field=False,\n        )\n    \n        Foo.bar = property(fget=lambda s: mock(return_value=\"\"), fset=lambda s, v: None)  # type: ignore[assignment]\n    \n>       backend.encode_data(Foo(id=\"1\"))\n\ntests/unit/test_dto/test_factory/test_backends/test_backends.py:352: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar.dto._backend.DTOBackend object at 0x7f724cee0440>\ndata = test_transfer_only_touches_included_attributes.<locals>.Foo(id='1', bar=<MagicMock name='mock()' id='140128912231008'>)\n\n    def encode_data(self, data: Any) -> LitestarEncodableType:\n        \"\"\"Encode data into a ``LitestarEncodableType``.\n    \n        Args:\n            data: Data to encode.\n    \n        Returns:\n            Encoded data.\n        \"\"\"\n        if self.wrapper_attribute_name:\n            wrapped_transfer = self._encode_data(getattr(data, self.wrapper_attribute_name))\n            setattr(data, self.wrapper_attribute_name, wrapped_transfer)\n            return cast(\"LitestarEncodableType\", data)\n    \n>       return cast(\"LitestarEncodableType\", self._encode_data(data))\nE       AttributeError: 'DTOBackend' object has no attribute '_encode_data'. Did you mean: 'encode_data'?\n\nlitestar/dto/_backend.py:342: AttributeError\n_____________ test_backend_encode_collection_data[default_backend] _____________\n\ndto_factory = <class 'tests.unit.test_dto.test_factory.test_backends.test_backends.fx_backend_factory.<locals>.Factory'>\nasgi_connection = <litestar.connection.request.Request object at 0x7f724cefeae0>\nbackend_cls = <class 'litestar.dto._backend.DTOBackend'>\n\n    def test_backend_encode_collection_data(\n        dto_factory: type[DataclassDTO], asgi_connection: Request[Any, Any, Any], backend_cls: type[DTOBackend]\n    ) -> None:\n        backend = backend_cls(\n            handler_id=\"test\",\n            dto_factory=dto_factory,\n            field_definition=FieldDefinition.from_annotation(List[DC]),\n            model_type=DC,\n            wrapper_attribute_name=None,\n            is_data_field=True,\n        )\n>       data = backend.encode_data([STRUCTURED])\n\ntests/unit/test_dto/test_factory/test_backends/test_backends.py:321: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <litestar.dto._backend.DTOBackend object at 0x7f724e375240>\ndata = [DC(a=1, nested=NestedDC(a=1, b='two'), nested_list=[NestedDC(a=1, b='two')], nested_mapping={'a': NestedDC(a=1, b='two')}, b='b', c=[], optional=None)]\n\n    def encode_data(self, data: Any) -> LitestarEncodableType:\n        \"\"\"Encode data into a ``LitestarEncodableType``.\n    \n        Args:\n            data: Data to encode.\n    \n        Returns:\n            Encoded data.\n        \"\"\"\n        if self.wrapper_attribute_name:\n            wrapped_transfer = self._encode_data(getattr(data, self.wrapper_attribute_name))\n            setattr(data, self.wrapper_attribute_name, wrapped_transfer)\n            return cast(\"LitestarEncodableType\", data)\n    \n>       return cast(\"LitestarEncodableType\", self._encode_data(data))\nE       AttributeError: 'DTOBackend' object has no attribute '_encode_data'. Did you mean: 'encode_data'?\n\nlitestar/dto/_backend.py:342: AttributeError\n=========================== short test summary info ============================\nFAILED tests/unit/test_dto/test_factory/test_backends/test_backends.py::test_backend_encode_data[default_backend]\nFAILED tests/unit/test_dto/test_factory/test_backends/test_backends.py::test_transfer_only_touches_included_attributes[default_backend]\nFAILED tests/unit/test_dto/test_factory/test_backends/test_backends.py::test_backend_encode_collection_data[default_backend]\n========================= 3 failed, 3 passed in 0.20s ==========================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/dto/_backend.py-_create_transfer_model_type_annotation": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 9 items\n\ntests/unit/test_dto/test_factory/test_backends/test_utils.py ....F....   [100%]\n\n=================================== FAILURES ===================================\n_____ test_create_transfer_model_type_annotation_unexpected_transfer_type ______\n\n    def test_create_transfer_model_type_annotation_unexpected_transfer_type() -> None:\n        transfer_type = CompositeType(field_definition=FieldDefinition.from_annotation(Union[str, int]), has_nested=False)\n        with pytest.raises(RuntimeError):\n>           _create_transfer_model_type_annotation(transfer_type=transfer_type)\n\ntests/unit/test_dto/test_factory/test_backends/test_utils.py:129: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ntransfer_type = CompositeType(field_definition=FieldDefinition(raw=typing.Union[str, int], annotation=typing.Union[str, int], type_wra...definition=None, name='')), default=<_EmptyEnum.EMPTY: 0>, extra={}, kwarg_definition=None, name=''), has_nested=False)\n\n    def _create_transfer_model_type_annotation(transfer_type: TransferType) -> Any:\n        \"\"\"Create a type annotation for a transfer model.\n    \n        Uses the parsed type that originates from the data model and the transfer model generated to represent a nested\n        type to reconstruct the type annotation for the transfer model.\n        \"\"\"\n        if isinstance(transfer_type, SimpleType):\n            if transfer_type.nested_field_info:\n                return transfer_type.nested_field_info.model\n            return transfer_type.field_definition.annotation\n        elif isinstance(transfer_type, CollectionType):\n            return _create_transfer_model_collection_type(transfer_type)\n        elif isinstance(transfer_type, TupleType):\n            return _create_transfer_model_tuple_type(transfer_type)\n        elif isinstance(transfer_type, UnionType):\n            return _create_transfer_model_union_type(transfer_type)\n        elif isinstance(transfer_type, MappingType):\n            return _create_transfer_model_mapping_type(transfer_type)\n        else:\n>           raise ValueError(f\"Unsupported transfer type: {type(transfer_type)}\")\nE           ValueError: Unsupported transfer type: <class 'litestar.dto._types.CompositeType'>\n\nlitestar/dto/_backend.py:903: ValueError\n=========================== short test summary info ============================\nFAILED tests/unit/test_dto/test_factory/test_backends/test_utils.py::test_create_transfer_model_type_annotation_unexpected_transfer_type\n========================= 1 failed, 8 passed in 0.11s ==========================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/response/file.py-start_response": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 2 items\n\ntests/unit/test_response/test_file_response.py FF                        [100%]\n\n=================================== FAILURES ===================================\n______________ test_file_response_with_missing_file_raises_error _______________\n\ntmpdir = local('/tmp/pytest-of-root/pytest-2560/test_file_response_with_missin0')\n\n    async def test_file_response_with_missing_file_raises_error(tmpdir: Path) -> None:\n        path = tmpdir / \"404.txt\"\n        with pytest.raises(ImproperlyConfiguredException):\n            asgi_response = ASGIFileResponse(file_path=path, filename=\"404.txt\")\n>           await asgi_response.start_response(empty_send)\n\ntests/unit/test_response/test_file_response.py:278: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nlitestar/response/file.py:212: in start_response\n    await send(event)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n_ = {'headers': [(b'content-type', b'text/plain; charset=utf-8'), (b'content-disposition', b'attachment; filename=\"404.txt\"')], 'status': 200, 'type': 'http.response.start'}\n\n    async def empty_send(_: Message) -> NoReturn:  # pragma: no cover\n        \"\"\"Raise a ``RuntimeError``.\n    \n        Serves as a placeholder ``send`` function.\n    \n        Args:\n            _: An ASGI message\n    \n        Raises:\n            RuntimeError\n        \"\"\"\n>       raise RuntimeError()\nE       RuntimeError\n\nlitestar/connection/base.py:53: RuntimeError\n________________ test_file_response_with_directory_raises_error ________________\n\ntmpdir = local('/tmp/pytest-of-root/pytest-2560/test_file_response_with_direct0')\n\n    async def test_file_response_with_directory_raises_error(tmpdir: Path) -> None:\n        with pytest.raises(ImproperlyConfiguredException):\n            asgi_response = ASGIFileResponse(file_path=tmpdir, filename=\"example.png\")\n>           await asgi_response.start_response(empty_send)\n\ntests/unit/test_response/test_file_response.py:101: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nlitestar/response/file.py:212: in start_response\n    await send(event)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\n_ = {'headers': [(b'content-type', b'image/png'), (b'content-disposition', b'attachment; filename=\"example.png\"')], 'status': 200, 'type': 'http.response.start'}\n\n    async def empty_send(_: Message) -> NoReturn:  # pragma: no cover\n        \"\"\"Raise a ``RuntimeError``.\n    \n        Serves as a placeholder ``send`` function.\n    \n        Args:\n            _: An ASGI message\n    \n        Raises:\n            RuntimeError\n        \"\"\"\n>       raise RuntimeError()\nE       RuntimeError\n\nlitestar/connection/base.py:53: RuntimeError\n=========================== short test summary info ============================\nFAILED tests/unit/test_response/test_file_response.py::test_file_response_with_missing_file_raises_error\nFAILED tests/unit/test_response/test_file_response.py::test_file_response_with_directory_raises_error\n============================== 2 failed in 0.13s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\nsys:1: RuntimeWarning: coroutine 'FileSystemAdapter.info' was never awaited\nRuntimeWarning: Enable tracemalloc to get the object allocation traceback\n"], "litestar-litestar/connection/request.py-json": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 71 items\n\ntests/unit/test_dto/test_factory/test_integration.py ................... [ 26%]\n....................................................                     [100%]\n\n============================== 71 passed in 0.92s ==============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/datastructures/multi_dicts.py-close": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 1 item\n\ntests/unit/test_datastructures/test_multi_dicts.py .                     [100%]\n\n============================== 1 passed in 0.06s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/datastructures/url.py-from_scope": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 2 items\n\ntests/unit/test_datastructures/test_url.py ..                            [100%]\n\n============================== 2 passed in 0.06s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/datastructures/headers.py-to_header": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 5 items\n\ntests/unit/test_datastructures/test_headers.py F                         [ 20%]\ntests/unit/test_response/test_response_headers.py .FF.                   [100%]\n\n=================================== FAILURES ===================================\n_________________________ test_cache_control_to_header _________________________\n\n    def test_cache_control_to_header() -> None:\n        header = CacheControlHeader(max_age=10, private=True)\n        expected_header_values = [\"max-age=10, private\", \"private, max-age=10\"]\n>       assert header.to_header() in expected_header_values\n\ntests/unit/test_datastructures/test_headers.py:250: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = CacheControlHeader(documentation_only=False, max_age=10, s_maxage=None, no_cache=None, no_store=None, private=True, pu...m=None, must_revalidate=None, proxy_revalidate=None, must_understand=None, immutable=None, stale_while_revalidate=None)\ninclude_header_name = False\n\n    def to_header(self, include_header_name: bool = False) -> str:\n        \"\"\"Get the header as string.\n    \n        Args:\n            include_header_name: should include the header name in the return value. If set to false\n                the return value will only include the header value. if set to true the return value\n                will be: ``<header name>: <header value>``. Defaults to false.\n        \"\"\"\n>       if self.value is None:\nE       AttributeError: 'CacheControlHeader' object has no attribute 'value'\n\nlitestar/datastructures/headers.py:266: AttributeError\n_ test_explicit_response_headers[cache_control-app_header1-controller_header1-handler_header1] _\n\nconfig_kwarg = 'cache_control'\napp_header = CacheControlHeader(documentation_only=False, max_age=1, s_maxage=None, no_cache=None, no_store=None, private=None, pub...m=None, must_revalidate=None, proxy_revalidate=None, must_understand=None, immutable=None, stale_while_revalidate=None)\ncontroller_header = CacheControlHeader(documentation_only=False, max_age=2, s_maxage=None, no_cache=None, no_store=None, private=None, pub...m=None, must_revalidate=None, proxy_revalidate=None, must_understand=None, immutable=None, stale_while_revalidate=None)\nhandler_header = CacheControlHeader(documentation_only=False, max_age=3, s_maxage=None, no_cache=None, no_store=None, private=None, pub...m=None, must_revalidate=None, proxy_revalidate=None, must_understand=None, immutable=None, stale_while_revalidate=None)\n\n    @pytest.mark.parametrize(\n        \"config_kwarg,app_header,controller_header,handler_header\",\n        [\n            (\n                \"etag\",\n                ETag(value=\"1\"),\n                ETag(value=\"2\"),\n                ETag(value=\"3\"),\n            ),\n            (\n                \"cache_control\",\n                CacheControlHeader(max_age=1),\n                CacheControlHeader(max_age=2),\n                CacheControlHeader(max_age=3),\n            ),\n        ],\n    )\n    def test_explicit_response_headers(\n        config_kwarg: str, app_header: Header, controller_header: Header, handler_header: Header\n    ) -> None:\n        class MyController(Controller):\n            @get(\n                path=\"/handler-override\",\n                **{config_kwarg: handler_header},  # type: ignore[arg-type]\n            )\n            def controller_override(self) -> None:\n                pass\n    \n            @get(path=\"/controller\")\n            def controller_handler(self) -> None:\n                pass\n    \n        setattr(MyController, config_kwarg, controller_header)\n    \n        @get(path=\"/app\")\n        def app_handler() -> None:\n            pass\n    \n        app = Litestar(\n            route_handlers=[MyController, app_handler],\n            **{config_kwarg: app_header},  # type: ignore[arg-type]\n        )\n    \n        with TestClient(app=app) as client:\n            for path, expected_value in {\n                \"handler-override\": handler_header,\n                \"controller\": controller_header,\n                \"app\": app_header,\n            }.items():\n                response = client.get(path)\n>               assert response.headers[expected_value.HEADER_NAME] == expected_value.to_header()\n\ntests/unit/test_response/test_response_headers.py:140: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Headers({'content-type': 'application/json', 'content-length': '52'})\nkey = 'cache-control'\n\n    def __getitem__(self, key: str) -> str:\n        \"\"\"\n        Return a single header value.\n    \n        If there are multiple headers with the same key, then we concatenate\n        them with commas. See: https://tools.ietf.org/html/rfc7230#section-3.2.2\n        \"\"\"\n        normalized_key = key.lower().encode(self.encoding)\n    \n        items = [\n            header_value.decode(self.encoding)\n            for _, header_key, header_value in self._list\n            if header_key == normalized_key\n        ]\n    \n        if items:\n            return \", \".join(items)\n    \n>       raise KeyError(key)\nE       KeyError: 'cache-control'\n\n/usr/local/lib/python3.10/site-packages/httpx/_models.py:228: KeyError\n_ test_explicit_headers_override_response_headers[cache_control-response_header0-header0] _\n\nconfig_kwarg = 'cache_control'\nresponse_header = ResponseHeader(name='cache-control', documentation_only=False, value='no-store', description=None, required=False, deprecated=False, allow_empty_value=False, style=None, explode=None, allow_reserved=False, example=None, examples=None)\nheader = CacheControlHeader(documentation_only=False, max_age=None, s_maxage=None, no_cache=True, no_store=None, private=None, ...m=None, must_revalidate=None, proxy_revalidate=None, must_understand=None, immutable=None, stale_while_revalidate=None)\n\n    @pytest.mark.parametrize(\n        \"config_kwarg,response_header,header\",\n        [\n            (\n                \"cache_control\",\n                ResponseHeader(name=CacheControlHeader.HEADER_NAME, value=\"no-store\"),\n                CacheControlHeader(no_cache=True),\n            ),\n            (\"etag\", ResponseHeader(name=ETag.HEADER_NAME, value=\"1\"), ETag(value=\"2\")),\n        ],\n    )\n    def test_explicit_headers_override_response_headers(\n        config_kwarg: str, response_header: ResponseHeader, header: Header\n    ) -> None:\n        @get(\n            path=\"/test\",\n            response_headers=[response_header],\n            **{config_kwarg: header},  # type: ignore[arg-type]\n        )\n        def my_handler() -> None:\n            pass\n    \n        app = Litestar(route_handlers=[my_handler])\n    \n        route_handler, _ = app.routes[0].route_handler_map[HttpMethod.GET]  # type: ignore[union-attr]\n>       resolved_headers = {header.name: header for header in route_handler.resolve_response_headers()}\n\ntests/unit/test_response/test_response_headers.py:188: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nlitestar/handlers/http_handlers/base.py:366: in resolve_response_headers\n    value=header_model.to_header(),\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = CacheControlHeader(documentation_only=False, max_age=None, s_maxage=None, no_cache=True, no_store=None, private=None, ...m=None, must_revalidate=None, proxy_revalidate=None, must_understand=None, immutable=None, stale_while_revalidate=None)\ninclude_header_name = False\n\n    def to_header(self, include_header_name: bool = False) -> str:\n        \"\"\"Get the header as string.\n    \n        Args:\n            include_header_name: should include the header name in the return value. If set to false\n                the return value will only include the header value. if set to true the return value\n                will be: ``<header name>: <header value>``. Defaults to false.\n        \"\"\"\n>       if self.value is None:\nE       AttributeError: 'CacheControlHeader' object has no attribute 'value'\n\nlitestar/datastructures/headers.py:266: AttributeError\n=========================== short test summary info ============================\nFAILED tests/unit/test_datastructures/test_headers.py::test_cache_control_to_header\nFAILED tests/unit/test_response/test_response_headers.py::test_explicit_response_headers[cache_control-app_header1-controller_header1-handler_header1]\nFAILED tests/unit/test_response/test_response_headers.py::test_explicit_headers_override_response_headers[cache_control-response_header0-header0]\n========================= 3 failed, 2 passed in 0.20s ==========================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "litestar-litestar/middleware/session/server_side.py-delete": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/litestar\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 3 items\n\ntests/unit/test_security/test_session_auth.py .                          [ 33%]\ntests/unit/test_middleware/test_session/test_server_side_backend.py ..   [100%]\n\n============================== 3 passed in 0.13s ===============================\n\n/usr/local/lib/python3.10/site-packages/pytest_benchmark/logger.py:46: PytestBenchmarkWarning: Benchmarks are automatically disabled because xdist plugin is active.Benchmarks cannot be performed reliably in a parallelized environment.\n  warner(PytestBenchmarkWarning(text))\n"], "marimo-marimo/_islands/island_generator.py-add_code": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/marimo\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 4 items\n\ntests/_islands/test_island_generator.py FFFF                             [100%]\n\n=================================== FAILURES ===================================\n_________________________________ test_render __________________________________\n\n    async def test_render():\n        generator = MarimoIslandGenerator()\n>       block1 = generator.add_code(\"import marimo as mo\")\n\ntests/_islands/test_island_generator.py:40: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <marimo._islands.island_generator.MarimoIslandGenerator object at 0x7f4633527400>\ncode = 'import marimo as mo', display_code = False, display_output = True\nis_raw = False, is_reactive = True\n\n    def add_code(\n        self,\n        code: str,\n        display_code: bool = False,\n        display_output: bool = True,\n        is_raw: bool = False,\n        is_reactive: bool = True,\n    ) -> MarimoIslandStub:\n        \"\"\"Add a code cell to the app.\n    \n        *Args:*\n    \n        - code (str): The code to add to the app.\n        - display_code (bool): Whether to display the code in the HTML.\n        - display_output (bool): Whether to display the output in the HTML.\n        - is_raw (bool): Whether to handled the code without formatting.\n        - is_reactive (bool): Whether this code block will run with pyodide.\n        \"\"\"\n        cell_id = self._app.cell_manager.create_cell_id()\n    \n        if not is_raw:\n>           cell = Cell(\n                code=code,\n                config=CellConfig(),\n                cell_id=cell_id,\n            )\nE           TypeError: Cell.__init__() got an unexpected keyword argument 'code'\n\nmarimo/_islands/island_generator.py:238: TypeError\n________________________________ test_add_code _________________________________\n\n    def test_add_code():\n        generator = MarimoIslandGenerator()\n>       generator.add_code(\"print('Hello, World!')\")\n\ntests/_islands/test_island_generator.py:18: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <marimo._islands.island_generator.MarimoIslandGenerator object at 0x7f4633292890>\ncode = \"print('Hello, World!')\", display_code = False, display_output = True\nis_raw = False, is_reactive = True\n\n    def add_code(\n        self,\n        code: str,\n        display_code: bool = False,\n        display_output: bool = True,\n        is_raw: bool = False,\n        is_reactive: bool = True,\n    ) -> MarimoIslandStub:\n        \"\"\"Add a code cell to the app.\n    \n        *Args:*\n    \n        - code (str): The code to add to the app.\n        - display_code (bool): Whether to display the code in the HTML.\n        - display_output (bool): Whether to display the output in the HTML.\n        - is_raw (bool): Whether to handled the code without formatting.\n        - is_reactive (bool): Whether this code block will run with pyodide.\n        \"\"\"\n        cell_id = self._app.cell_manager.create_cell_id()\n    \n        if not is_raw:\n>           cell = Cell(\n                code=code,\n                config=CellConfig(),\n                cell_id=cell_id,\n            )\nE           TypeError: Cell.__init__() got an unexpected keyword argument 'code'\n\nmarimo/_islands/island_generator.py:238: TypeError\n__________________________________ test_build __________________________________\n\n    async def test_build():\n        generator = MarimoIslandGenerator()\n>       generator.add_code(\"print('Hello, World!')\")\n\ntests/_islands/test_island_generator.py:26: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <marimo._islands.island_generator.MarimoIslandGenerator object at 0x7f4633464460>\ncode = \"print('Hello, World!')\", display_code = False, display_output = True\nis_raw = False, is_reactive = True\n\n    def add_code(\n        self,\n        code: str,\n        display_code: bool = False,\n        display_output: bool = True,\n        is_raw: bool = False,\n        is_reactive: bool = True,\n    ) -> MarimoIslandStub:\n        \"\"\"Add a code cell to the app.\n    \n        *Args:*\n    \n        - code (str): The code to add to the app.\n        - display_code (bool): Whether to display the code in the HTML.\n        - display_output (bool): Whether to display the output in the HTML.\n        - is_raw (bool): Whether to handled the code without formatting.\n        - is_reactive (bool): Whether this code block will run with pyodide.\n        \"\"\"\n        cell_id = self._app.cell_manager.create_cell_id()\n    \n        if not is_raw:\n>           cell = Cell(\n                code=code,\n                config=CellConfig(),\n                cell_id=cell_id,\n            )\nE           TypeError: Cell.__init__() got an unexpected keyword argument 'code'\n\nmarimo/_islands/island_generator.py:238: TypeError\n_______________________________ test_render_head _______________________________\n\n    async def test_render_head():\n        generator = MarimoIslandGenerator()\n>       generator.add_code(\"print('Hello, islands!')\")\n\ntests/_islands/test_island_generator.py:61: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <marimo._islands.island_generator.MarimoIslandGenerator object at 0x7f463354cfd0>\ncode = \"print('Hello, islands!')\", display_code = False, display_output = True\nis_raw = False, is_reactive = True\n\n    def add_code(\n        self,\n        code: str,\n        display_code: bool = False,\n        display_output: bool = True,\n        is_raw: bool = False,\n        is_reactive: bool = True,\n    ) -> MarimoIslandStub:\n        \"\"\"Add a code cell to the app.\n    \n        *Args:*\n    \n        - code (str): The code to add to the app.\n        - display_code (bool): Whether to display the code in the HTML.\n        - display_output (bool): Whether to display the output in the HTML.\n        - is_raw (bool): Whether to handled the code without formatting.\n        - is_reactive (bool): Whether this code block will run with pyodide.\n        \"\"\"\n        cell_id = self._app.cell_manager.create_cell_id()\n    \n        if not is_raw:\n>           cell = Cell(\n                code=code,\n                config=CellConfig(),\n                cell_id=cell_id,\n            )\nE           TypeError: Cell.__init__() got an unexpected keyword argument 'code'\n\nmarimo/_islands/island_generator.py:238: TypeError\n=========================== short test summary info ============================\nFAILED tests/_islands/test_island_generator.py::test_render - TypeError: Cell...\nFAILED tests/_islands/test_island_generator.py::test_add_code - TypeError: Ce...\nFAILED tests/_islands/test_island_generator.py::test_build - TypeError: Cell....\nFAILED tests/_islands/test_island_generator.py::test_render_head - TypeError:...\n============================== 4 failed in 0.07s ===============================\n\n"], "marimo-marimo/_islands/island_generator.py-build": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/marimo\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 3 items\n\ntests/_islands/test_island_generator.py FFF                              [100%]\n\n=================================== FAILURES ===================================\n_________________________________ test_render __________________________________\n\n    async def test_render():\n        generator = MarimoIslandGenerator()\n        block1 = generator.add_code(\"import marimo as mo\")\n        block2 = generator.add_code(\"mo.md('Hello, islands!')\")\n    \n>       await generator.build()\n\ntests/_islands/test_island_generator.py:43: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <marimo._islands.island_generator.MarimoIslandGenerator object at 0x7f000d0f7ac0>\n\n    async def build(self) -> App:\n        \"\"\"\n        Build the app. This should be called after adding all the code cells.\n    \n        *Returns:*\n    \n        - App: The built app.\n        \"\"\"\n        if self.has_run:\n            raise RuntimeError(\"App has already been built\")\n    \n        self.has_run = True\n    \n        # Compile all cells\n        for stub in self._stubs:\n            cell = Cell(\n>               CellConfig(\n                    id=stub._cell_id,\n                    code=stub.code,\n                    name=None,\n                )\n            )\nE           TypeError: CellConfig.__init__() got an unexpected keyword argument 'id'\n\nmarimo/_islands/island_generator.py:276: TypeError\n__________________________________ test_build __________________________________\n\n    async def test_build():\n        generator = MarimoIslandGenerator()\n        generator.add_code(\"print('Hello, World!')\")\n    \n        # Check if the app is built successfully\n>       app = await generator.build()\n\ntests/_islands/test_island_generator.py:29: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <marimo._islands.island_generator.MarimoIslandGenerator object at 0x7f000ce77e20>\n\n    async def build(self) -> App:\n        \"\"\"\n        Build the app. This should be called after adding all the code cells.\n    \n        *Returns:*\n    \n        - App: The built app.\n        \"\"\"\n        if self.has_run:\n            raise RuntimeError(\"App has already been built\")\n    \n        self.has_run = True\n    \n        # Compile all cells\n        for stub in self._stubs:\n            cell = Cell(\n>               CellConfig(\n                    id=stub._cell_id,\n                    code=stub.code,\n                    name=None,\n                )\n            )\nE           TypeError: CellConfig.__init__() got an unexpected keyword argument 'id'\n\nmarimo/_islands/island_generator.py:276: TypeError\n_______________________________ test_render_head _______________________________\n\n    async def test_render_head():\n        generator = MarimoIslandGenerator()\n        generator.add_code(\"print('Hello, islands!')\")\n>       await generator.build()\n\ntests/_islands/test_island_generator.py:62: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <marimo._islands.island_generator.MarimoIslandGenerator object at 0x7f000cffef20>\n\n    async def build(self) -> App:\n        \"\"\"\n        Build the app. This should be called after adding all the code cells.\n    \n        *Returns:*\n    \n        - App: The built app.\n        \"\"\"\n        if self.has_run:\n            raise RuntimeError(\"App has already been built\")\n    \n        self.has_run = True\n    \n        # Compile all cells\n        for stub in self._stubs:\n            cell = Cell(\n>               CellConfig(\n                    id=stub._cell_id,\n                    code=stub.code,\n                    name=None,\n                )\n            )\nE           TypeError: CellConfig.__init__() got an unexpected keyword argument 'id'\n\nmarimo/_islands/island_generator.py:276: TypeError\n=========================== short test summary info ============================\nFAILED tests/_islands/test_island_generator.py::test_render - TypeError: Cell...\nFAILED tests/_islands/test_island_generator.py::test_build - TypeError: CellC...\nFAILED tests/_islands/test_island_generator.py::test_render_head - TypeError:...\n============================== 3 failed in 0.07s ===============================\n\n"], "marimo-marimo/_utils/parse_dataclass.py-build_dataclass": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/marimo\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 2 items\n\ntests/_utils/test_parse_dataclass.py ..                                  [100%]\n\n============================== 2 passed in 0.03s ===============================\n\n"], "marimo-marimo/_utils/parse_dataclass.py-parse_raw": ["\nImportError while loading conftest '/root/repos/py_data/marimo/tests/_server/conftest.py'.\ntests/_server/conftest.py:15: in <module>\n    from marimo._server.main import create_starlette_app\nmarimo/_server/main.py:23: in <module>\n    from marimo._server.api.router import build_routes\nmarimo/_server/api/router.py:7: in <module>\n    from marimo._server.api.endpoints.assets import router as assets_router\nmarimo/_server/api/endpoints/assets.py:40: in <module>\n    app=StaticFiles(\n/usr/local/lib/python3.10/site-packages/starlette/staticfiles.py:59: in __init__\n    raise RuntimeError(f\"Directory '{directory}' does not exist\")\nE   RuntimeError: Directory '/root/repos/py_data/marimo/marimo/_static/assets' does not exist\n"], "marimo-marimo/_plugins/stateless/icon.py-icon": ["\nImportError while loading conftest '/root/repos/py_data/marimo/tests/conftest.py'.\ntests/conftest.py:13: in <module>\n    from marimo._ast.app import CellManager\nmarimo/__init__.py:89: in <module>\n    from marimo._plugins.stateless.icon import icon\nE     File \"/root/repos/py_data/marimo/marimo/_plugins/stateless/icon.py\", line 14\nE       **Args.**\nE   IndentationError: unexpected indent\n"], "marimo-marimo/_plugins/stateless/image.py-image": ["\nImportError while loading conftest '/root/repos/py_data/marimo/tests/conftest.py'.\ntests/conftest.py:13: in <module>\n    from marimo._ast.app import CellManager\nmarimo/__init__.py:90: in <module>\n    from marimo._plugins.stateless.image import image\nE     File \"/root/repos/py_data/marimo/marimo/_plugins/stateless/image.py\", line 90\nE       **Args.**\nE   IndentationError: unexpected indent\n"], "marimo-marimo/_plugins/stateless/flex.py-hstack": ["\nImportError while loading conftest '/root/repos/py_data/marimo/tests/conftest.py'.\ntests/conftest.py:13: in <module>\n    from marimo._ast.app import CellManager\nmarimo/__init__.py:75: in <module>\n    from marimo._islands.island_generator import MarimoIslandGenerator\nmarimo/_islands/island_generator.py:16: in <module>\n    from marimo._plugins.ui import code_editor\nmarimo/_plugins/ui/__init__.py:40: in <module>\n    from marimo._plugins.ui._impl.array import array\nmarimo/_plugins/ui/_impl/array.py:10: in <module>\n    from marimo._plugins.stateless.flex import hstack, vstack\nE     File \"/root/repos/py_data/marimo/marimo/_plugins/stateless/flex.py\", line 131\nE       **Args.**\nE   IndentationError: unexpected indent\n"], "marimo-marimo/_plugins/stateless/status/_progress.py-update_progress": ["\nImportError while loading conftest '/root/repos/py_data/marimo/tests/conftest.py'.\ntests/conftest.py:13: in <module>\n    from marimo._ast.app import CellManager\nmarimo/__init__.py:82: in <module>\n    from marimo._plugins.stateless import mpl, status\nmarimo/_plugins/stateless/status/__init__.py:6: in <module>\n    from marimo._plugins.stateless.status._progress import progress_bar, spinner\nE     File \"/root/repos/py_data/marimo/marimo/_plugins/stateless/status/_progress.py\", line 281\nE       every 150ms.\nE               ^\nE   SyntaxError: invalid decimal literal\n"], "marimo-marimo/_plugins/core/web_component.py-build_ui_plugin": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/marimo\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 3 items\n\ntests/_plugins/core/test_web_component.py ...                            [100%]\n\n============================== 3 passed in 0.25s ===============================\n\n"], "marimo-marimo/_output/formatting.py-as_html": ["\nImportError while loading conftest '/root/repos/py_data/marimo/tests/conftest.py'.\ntests/conftest.py:13: in <module>\n    from marimo._ast.app import CellManager\nmarimo/__init__.py:75: in <module>\n    from marimo._islands.island_generator import MarimoIslandGenerator\nmarimo/_islands/island_generator.py:13: in <module>\n    from marimo._output.formatting import as_html\nE     File \"/root/repos/py_data/marimo/marimo/_output/formatting.py\", line 217\nE       **Args.**\nE   IndentationError: unexpected indent\n"], "marimo-marimo/_output/md.py-md": ["\nImportError while loading conftest '/root/repos/py_data/marimo/tests/conftest.py'.\ntests/conftest.py:13: in <module>\n    from marimo._ast.app import CellManager\nmarimo/__init__.py:75: in <module>\n    from marimo._islands.island_generator import MarimoIslandGenerator\nmarimo/_islands/island_generator.py:13: in <module>\n    from marimo._output.formatting import as_html\nmarimo/_output/formatting.py:33: in <module>\n    from marimo._plugins.stateless.json_output import json_output\nmarimo/_plugins/stateless/json_output.py:7: in <module>\n    from marimo._plugins.core.web_component import JSONType, build_stateless_plugin\nmarimo/_plugins/core/web_component.py:26: in <module>\n    from marimo._output.md import md\nE     File \"/root/repos/py_data/marimo/marimo/_output/md.py\", line 78\nE       \"\"\"Write markdown\nE       ^\nE   SyntaxError: unterminated triple-quoted string literal (detected at line 90)\n"], "marimo-marimo/_output/formatters/formatters.py-register_formatters": ["\nImportError while loading conftest '/root/repos/py_data/marimo/tests/conftest.py'.\ntests/conftest.py:23: in <module>\n    from marimo._output.formatters.formatters import register_formatters\nmarimo/_output/formatters/formatters.py:58: in <module>\n    from marimo._output.formatters import NATIVE_FACTORIES, THIRD_PARTY_FACTORIES\nE   ImportError: cannot import name 'NATIVE_FACTORIES' from 'marimo._output.formatters' (/root/repos/py_data/marimo/marimo/_output/formatters/__init__.py)\n"], "marimo-marimo/_data/series.py-get_category_series_info": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/marimo\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 2 items\n\ntests/_data/test_series.py ss                                            [100%]\n\n=========================== short test summary info ============================\nSKIPPED [2] tests/_data/test_series.py:58: optional dependencies not installed\n============================== 2 skipped in 0.02s ==============================\n\n"], "marimo-marimo/_data/preview_column.py-get_column_preview": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/marimo\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 1 item\n\ntests/_data/test_preview_column.py s                                     [100%]\n\n=========================== short test summary info ============================\nSKIPPED [1] tests/_data/test_preview_column.py:20: optional dependencies not installed\n============================== 1 skipped in 0.01s ==============================\n\n"], "marimo-marimo/_server/sessions.py-start_file_watcher": ["\nImportError while loading conftest '/root/repos/py_data/marimo/tests/_server/conftest.py'.\ntests/_server/conftest.py:15: in <module>\n    from marimo._server.main import create_starlette_app\nmarimo/_server/main.py:23: in <module>\n    from marimo._server.api.router import build_routes\nmarimo/_server/api/router.py:7: in <module>\n    from marimo._server.api.endpoints.assets import router as assets_router\nmarimo/_server/api/endpoints/assets.py:40: in <module>\n    app=StaticFiles(\n/usr/local/lib/python3.10/site-packages/starlette/staticfiles.py:59: in __init__\n    raise RuntimeError(f\"Directory '{directory}' does not exist\")\nE   RuntimeError: Directory '/root/repos/py_data/marimo/marimo/_static/assets' does not exist\n"], "marimo-marimo/_server/file_manager.py-save_app_config": ["\nImportError while loading conftest '/root/repos/py_data/marimo/tests/_server/conftest.py'.\ntests/_server/conftest.py:15: in <module>\n    from marimo._server.main import create_starlette_app\nmarimo/_server/main.py:23: in <module>\n    from marimo._server.api.router import build_routes\nmarimo/_server/api/router.py:7: in <module>\n    from marimo._server.api.endpoints.assets import router as assets_router\nmarimo/_server/api/endpoints/assets.py:40: in <module>\n    app=StaticFiles(\n/usr/local/lib/python3.10/site-packages/starlette/staticfiles.py:59: in __init__\n    raise RuntimeError(f\"Directory '{directory}' does not exist\")\nE   RuntimeError: Directory '/root/repos/py_data/marimo/marimo/_static/assets' does not exist\n"], "marimo-marimo/_server/session/session_view.py-add_stdin": ["\nImportError while loading conftest '/root/repos/py_data/marimo/tests/_server/conftest.py'.\ntests/_server/conftest.py:15: in <module>\n    from marimo._server.main import create_starlette_app\nmarimo/_server/main.py:23: in <module>\n    from marimo._server.api.router import build_routes\nmarimo/_server/api/router.py:7: in <module>\n    from marimo._server.api.endpoints.assets import router as assets_router\nmarimo/_server/api/endpoints/assets.py:40: in <module>\n    app=StaticFiles(\n/usr/local/lib/python3.10/site-packages/starlette/staticfiles.py:59: in __init__\n    raise RuntimeError(f\"Directory '{directory}' does not exist\")\nE   RuntimeError: Directory '/root/repos/py_data/marimo/marimo/_static/assets' does not exist\n"], "marimo-marimo/_server/session/session_view.py-add_operation": ["\nImportError while loading conftest '/root/repos/py_data/marimo/tests/_server/conftest.py'.\ntests/_server/conftest.py:15: in <module>\n    from marimo._server.main import create_starlette_app\nmarimo/_server/main.py:23: in <module>\n    from marimo._server.api.router import build_routes\nmarimo/_server/api/router.py:7: in <module>\n    from marimo._server.api.endpoints.assets import router as assets_router\nmarimo/_server/api/endpoints/assets.py:40: in <module>\n    app=StaticFiles(\n/usr/local/lib/python3.10/site-packages/starlette/staticfiles.py:59: in __init__\n    raise RuntimeError(f\"Directory '{directory}' does not exist\")\nE   RuntimeError: Directory '/root/repos/py_data/marimo/marimo/_static/assets' does not exist\n"], "marimo-marimo/_server/session/session_view.py-get_cell_console_outputs": ["\nImportError while loading conftest '/root/repos/py_data/marimo/tests/_server/conftest.py'.\ntests/_server/conftest.py:15: in <module>\n    from marimo._server.main import create_starlette_app\nmarimo/_server/main.py:23: in <module>\n    from marimo._server.api.router import build_routes\nmarimo/_server/api/router.py:7: in <module>\n    from marimo._server.api.endpoints.assets import router as assets_router\nmarimo/_server/api/endpoints/assets.py:40: in <module>\n    app=StaticFiles(\n/usr/local/lib/python3.10/site-packages/starlette/staticfiles.py:59: in __init__\n    raise RuntimeError(f\"Directory '{directory}' does not exist\")\nE   RuntimeError: Directory '/root/repos/py_data/marimo/marimo/_static/assets' does not exist\n"], "marimo-marimo/_runtime/dataflow.py-register_cell": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/marimo\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 3 items\n\ntests/_runtime/packages/test_module_registry.py FFF                      [100%]\n\n=================================== FAILURES ===================================\n______________________________ test_defining_cell ______________________________\n\n    def test_defining_cell() -> None:\n        mgr = ModuleRegistry(graph := DirectedGraph())\n        mpl = parse_cell(\"import matplotlib\")\n        np = parse_cell(\"import numpy\")\n>       graph.register_cell(\"0\", mpl)\n\ntests/_runtime/packages/test_module_registry.py:14: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = DirectedGraph(cells={'0': CellImpl(key=6822046846339534258, code='import matplotlib', mod=<ast.Module object at 0x7fae...}, siblings={}, definitions={'matplotlib': {'0'}}, cycles=set(), lock=<unlocked _thread.lock object at 0x7fae3c693100>)\ncell_id = '0'\ncell = CellImpl(key=6822046846339534258, code='import matplotlib', mod=<ast.Module object at 0x7fae3c821720>, defs={'matplotl... hide_code=False), _status=CellStatus(state=None), _stale=CellStaleState(state=False), _output=CellOutput(output=None))\n\n    def register_cell(self, cell_id: CellId_t, cell: CellImpl) -> None:\n        \"\"\"Add a cell to the graph.\n    \n        Mutates the graph, acquiring `self.lock`.\n    \n        Requires that `cell_id` is not already in the graph.\n        \"\"\"\n        with self.lock:\n            if cell_id in self.cells:\n                raise ValueError(f\"Cell {cell_id} already exists in the graph\")\n    \n            self.cells[cell_id] = cell\n            self.children[cell_id] = set()\n            self.parents[cell_id] = set()\n    \n            # Update definitions\n            for name in cell.defs:\n                if name not in self.definitions:\n                    self.definitions[name] = set()\n                self.definitions[name].add(cell_id)\n    \n            # Update parents and children\n            for ref in cell.refs:\n                if ref in self.definitions:\n                    for parent_id in self.definitions[ref]:\n                        self.parents[cell_id].add(parent_id)\n                        self.children[parent_id].add(cell_id)\n    \n            # Check for cycles\n>           self._update_cycles()\nE           AttributeError: 'DirectedGraph' object has no attribute '_update_cycles'\n\nmarimo/_runtime/dataflow.py:130: AttributeError\n_____________________________ test_missing_modules _____________________________\n\n    def test_missing_modules() -> None:\n        mgr = ModuleRegistry(graph := DirectedGraph())\n>       graph.register_cell(\"0\", parse_cell(\"import does.nt.exist as foo\"))\n\ntests/_runtime/packages/test_module_registry.py:31: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = DirectedGraph(cells={'0': CellImpl(key=6891005727631499409, code='import does.nt.exist as foo', mod=<ast.Module object...: set()}, siblings={}, definitions={'foo': {'0'}}, cycles=set(), lock=<unlocked _thread.lock object at 0x7fae3c828980>)\ncell_id = '0'\ncell = CellImpl(key=6891005727631499409, code='import does.nt.exist as foo', mod=<ast.Module object at 0x7fae3c820eb0>, defs=... hide_code=False), _status=CellStatus(state=None), _stale=CellStaleState(state=False), _output=CellOutput(output=None))\n\n    def register_cell(self, cell_id: CellId_t, cell: CellImpl) -> None:\n        \"\"\"Add a cell to the graph.\n    \n        Mutates the graph, acquiring `self.lock`.\n    \n        Requires that `cell_id` is not already in the graph.\n        \"\"\"\n        with self.lock:\n            if cell_id in self.cells:\n                raise ValueError(f\"Cell {cell_id} already exists in the graph\")\n    \n            self.cells[cell_id] = cell\n            self.children[cell_id] = set()\n            self.parents[cell_id] = set()\n    \n            # Update definitions\n            for name in cell.defs:\n                if name not in self.definitions:\n                    self.definitions[name] = set()\n                self.definitions[name].add(cell_id)\n    \n            # Update parents and children\n            for ref in cell.refs:\n                if ref in self.definitions:\n                    for parent_id in self.definitions[ref]:\n                        self.parents[cell_id].add(parent_id)\n                        self.children[parent_id].add(cell_id)\n    \n            # Check for cycles\n>           self._update_cycles()\nE           AttributeError: 'DirectedGraph' object has no attribute '_update_cycles'\n\nmarimo/_runtime/dataflow.py:130: AttributeError\n__________________________ test_defining_cell_dotted ___________________________\n\n    def test_defining_cell_dotted() -> None:\n        mgr = ModuleRegistry(graph := DirectedGraph())\n        mpl = parse_cell(\"import matplotlib.pyplot as plt\")\n>       graph.register_cell(\"0\", mpl)\n\ntests/_runtime/packages/test_module_registry.py:23: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = DirectedGraph(cells={'0': CellImpl(key=-7929593108038808330, code='import matplotlib.pyplot as plt', mod=<ast.Module o...: set()}, siblings={}, definitions={'plt': {'0'}}, cycles=set(), lock=<unlocked _thread.lock object at 0x7fae3c5ba140>)\ncell_id = '0'\ncell = CellImpl(key=-7929593108038808330, code='import matplotlib.pyplot as plt', mod=<ast.Module object at 0x7fae3c75fdf0>, ... hide_code=False), _status=CellStatus(state=None), _stale=CellStaleState(state=False), _output=CellOutput(output=None))\n\n    def register_cell(self, cell_id: CellId_t, cell: CellImpl) -> None:\n        \"\"\"Add a cell to the graph.\n    \n        Mutates the graph, acquiring `self.lock`.\n    \n        Requires that `cell_id` is not already in the graph.\n        \"\"\"\n        with self.lock:\n            if cell_id in self.cells:\n                raise ValueError(f\"Cell {cell_id} already exists in the graph\")\n    \n            self.cells[cell_id] = cell\n            self.children[cell_id] = set()\n            self.parents[cell_id] = set()\n    \n            # Update definitions\n            for name in cell.defs:\n                if name not in self.definitions:\n                    self.definitions[name] = set()\n                self.definitions[name].add(cell_id)\n    \n            # Update parents and children\n            for ref in cell.refs:\n                if ref in self.definitions:\n                    for parent_id in self.definitions[ref]:\n                        self.parents[cell_id].add(parent_id)\n                        self.children[parent_id].add(cell_id)\n    \n            # Check for cycles\n>           self._update_cycles()\nE           AttributeError: 'DirectedGraph' object has no attribute '_update_cycles'\n\nmarimo/_runtime/dataflow.py:130: AttributeError\n=========================== short test summary info ============================\nFAILED tests/_runtime/packages/test_module_registry.py::test_defining_cell - ...\nFAILED tests/_runtime/packages/test_module_registry.py::test_missing_modules\nFAILED tests/_runtime/packages/test_module_registry.py::test_defining_cell_dotted\n============================== 3 failed in 0.08s ===============================\n\n"], "marimo-marimo/_runtime/validate_graph.py-check_for_errors": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/marimo\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 7 items\n\ntests/_runtime/test_validate_graph.py .FFFF..                            [100%]\n\n=================================== FAILURES ===================================\n________________________ test_multiple_definition_error ________________________\n\n    def test_multiple_definition_error() -> None:\n        graph = dataflow.DirectedGraph()\n        graph.register_cell(\"0\", parse_cell(\"x = 0\"))\n        graph.register_cell(\"1\", parse_cell(\"x = 1\"))\n        errors = check_for_errors(graph)\n        assert set(errors.keys()) == set([\"0\", \"1\"])\n>       assert errors[\"0\"] == (MultipleDefinitionError(name=\"x\", cells=(\"1\",)),)\nE       AssertionError: assert [MultipleDefi...ltiple-defs')] == (MultipleDefi...tiple-defs'),)\nE         \nE         Use -v to get more diff\n\ntests/_runtime/test_validate_graph.py:25: AssertionError\n__________________________ test_delete_nonlocal_error __________________________\n\n    def test_delete_nonlocal_error() -> None:\n        graph = dataflow.DirectedGraph()\n        graph.register_cell(\"0\", parse_cell(\"x = 0\"))\n        graph.register_cell(\"1\", parse_cell(\"del x\"))\n        errors = check_for_errors(graph)\n        assert set(errors.keys()) == set([\"1\"])\n>       assert errors[\"1\"] == (DeleteNonlocalError(name=\"x\", cells=(\"0\",)),)\nE       AssertionError: assert [DeleteNonloc...te-nonlocal')] == (DeleteNonloc...e-nonlocal'),)\nE         \nE         Use -v to get more diff\n\ntests/_runtime/test_validate_graph.py:77: AssertionError\n_________________ test_overlapping_multiple_definition_errors __________________\n\n    def test_overlapping_multiple_definition_errors() -> None:\n        graph = dataflow.DirectedGraph()\n        graph.register_cell(\"0\", parse_cell(\"x = 0\"))\n        graph.register_cell(\"1\", parse_cell(\"x, y = 1, 2\"))\n        graph.register_cell(\"2\", parse_cell(\"y, z = 3, 4\"))\n        errors = check_for_errors(graph)\n        assert set(errors.keys()) == set([\"0\", \"1\", \"2\"])\n>       assert errors[\"0\"] == (MultipleDefinitionError(name=\"x\", cells=(\"1\",)),)\nE       AssertionError: assert [MultipleDefi...ltiple-defs')] == (MultipleDefi...tiple-defs'),)\nE         \nE         Use -v to get more diff\n\ntests/_runtime/test_validate_graph.py:49: AssertionError\n_____________________________ test_two_node_cycle ______________________________\n\n    def test_two_node_cycle() -> None:\n        graph = dataflow.DirectedGraph()\n        graph.register_cell(\"0\", parse_cell(\"x = y\"))\n        graph.register_cell(\"1\", parse_cell(\"y = x\"))\n        errors = check_for_errors(graph)\n        assert set(errors.keys()) == set([\"0\", \"1\"])\n>       assert errors[\"0\"] == (\n            CycleError(edges_with_vars=((\"0\", [\"x\"], \"1\"), (\"1\", [\"y\"], \"0\"))),\n        )\nE       AssertionError: assert [CycleError(e...type='cycle')] == (CycleError(e...ype='cycle'),)\nE         \nE         Use -v to get more diff\n\ntests/_runtime/test_validate_graph.py:86: AssertionError\n=========================== short test summary info ============================\nFAILED tests/_runtime/test_validate_graph.py::test_multiple_definition_error\nFAILED tests/_runtime/test_validate_graph.py::test_delete_nonlocal_error - As...\nFAILED tests/_runtime/test_validate_graph.py::test_overlapping_multiple_definition_errors\nFAILED tests/_runtime/test_validate_graph.py::test_two_node_cycle - Assertion...\n========================= 4 failed, 3 passed in 0.07s ==========================\n\n"], "marimo-marimo/_runtime/runtime.py-_maybe_register_cell": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/marimo\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 2 items\n\ntests/_runtime/reload/test_module_watcher.py ..                          [100%]\n\n============================== 2 passed in 8.34s ===============================\n\n"], "marimo-marimo/_runtime/runtime.py-run": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/marimo\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 86 items\n\n============================ no tests ran in 0.06s =============================\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_descendant_status_reset_to_idle_on_interrupt\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_run_code_with_nbsp\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_empty_iteration_conditional_definition\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_run_pickle\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_set_ui_element_value\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_break_cycle_error_with_delete\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_run_in_processpool_executor\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_cell_state_invalidated\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_wont_execute_bad_ref\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_statuses_not_repeated_on_stop\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_patches.py::test_micropip_freeze\n(no match in any of [<Module test_patches.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_run\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_await_future_complex\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_disable_consecutive\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_messaging/test_streams.py::test_fileno\n(no match in any of [<Module test_streams.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_ref_local_var_from_nested_scope\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_set_ui_element_value_with_cell_run\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_resolve_make_local_with_global_keywd\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_enable_cycle_incremental\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_delete_nonlocal_missing_args_rets\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_multiple_definitions_missing_args_rets\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_resolve_var_not_local_from_nested_scope\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_app_run_matplotlib_figures_closed\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_app_comp_basic\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_dunder_rewritten_as_local\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_disable_and_reenable_tree\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_toplevel_gather\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_pickle\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_plugins/ui/_impl/test_altair_chart.py::test_altair_settings_when_set\n(no match in any of [<Module test_altair_chart.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_init_not_rewritten_as_local\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_statuses_not_repeated_ok_run\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_statuses_not_repeated_on_interruption\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_triangle\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_non_ui_elements_not_stored\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_disable_cycle\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_cell_lambda\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_cycle\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_exception_scope_not_captured\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_running_in_notebook\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_set_config_before_registering_cell\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_disable_and_reenable_not_stale\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_messaging/test_streams.py::test_input_installed\n(no match in any of [<Module test_streams.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_messaging/test_streams.py::test_readlines_installed\n(no match in any of [<Module test_streams.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_run_in_threadpool_executor\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_descendant_status_reset_to_idle_on_error\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_ui_element_in_nested_output_stored\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_patches.py::test_micropip_add_mock_package\n(no match in any of [<Module test_patches.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_cell_indirect_private\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_cell_copy_works\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_patches.py::test_micropip_list_mock_packages\n(no match in any of [<Module test_patches.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_plugins/ui/_impl/test_anywidget.py::test_value\n(no match in any of [<Module test_anywidget.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_cell_output_cleared_on_rerun\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_interrupt\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_dunder_dunder_not_local\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_file_path\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_plugins/ui/_impl/test_anywidget.py::test_instances\n(no match in any of [<Module test_anywidget.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_await_future\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_toplevel_await_allowed\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_cycle_missing_args_rets\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_marimo_mpl_backend_not_used\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_cycle_error\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_run_in_default_executor\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_cell_zero_copy_works\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_wait_for\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_statuses_not_repeated_on_exception\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_syntax_error\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_run_referrers_not_stale\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_patches.py::test_micropip_set_index_urls\n(no match in any of [<Module test_patches.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_exception_not_captured\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_patches.py::test_micropip_install\n(no match in any of [<Module test_patches.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_disable_and_reenable_stale\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_clear_multiple_definition_error_with_delete\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_multiple_definitions\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_messaging/test_streams.py::test_readline_installed\n(no match in any of [<Module test_streams.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_patches.py::test_micropip_available\n(no match in any of [<Module test_patches.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_patches.py::test_micropip_list\n(no match in any of [<Module test_patches.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_set_local_var_ui_element_value\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_set_ui_element_value_lensed_with_state\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_clear_multiple_definition_error\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_cell_indirect_lambda\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_app_comp_multiple_ui_elements\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_disable_cycle_incremental\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_run_async\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_new_errors_update_old_ones\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_locals_dont_leak\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_set_ui_element_value_lensed_bound_child\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_disable_syntax_error\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_delete_nonlocal_error\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_kernel_new_multiple_definition_does_not_invalidate\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_set_ui_element_value_lensed\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_kernel_simultaneous_multiple_definition_error\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_ui_element_in_output_stored\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_conditional_definition\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_ast/test_app.py::test_unparsable_cell\n(no match in any of [<Module test_app.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_runtime.py::test_defs_with_no_definers_are_removed_from_cell\n(no match in any of [<Module test_runtime.py>])\n\nERROR: not found: /root/repos/py_data/marimo/tests/_runtime/test_patches.py::test_micropip_uninstall\n(no match in any of [<Module test_patches.py>])\n\n"], "marimo-marimo/_runtime/packages/utils.py-is_python_isolated": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/marimo\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 1 item\n\ntests/_runtime/packages/test_package_utils.py F                          [100%]\n\n=================================== FAILURES ===================================\n___________________________ test_is_python_isolated ____________________________\n\n    @pytest.mark.skipif(sys.platform == \"win32\", reason=\"Failing on Windows CI\")\n    def test_is_python_isolated() -> None:\n        # tests should always be run in an isolated (non-system) environment;\n        # we only run them in a virtualenv, venv, or conda env ...\n>       assert is_python_isolated()\nE       assert False\nE        +  where False = is_python_isolated()\n\ntests/_runtime/packages/test_package_utils.py:13: AssertionError\n=========================== short test summary info ============================\nFAILED tests/_runtime/packages/test_package_utils.py::test_is_python_isolated\n============================== 1 failed in 0.06s ===============================\n\n"], "marimo-marimo/_runtime/packages/module_registry.py-missing_modules": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/marimo\nconfigfile: pyproject.toml\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=auto\ncollected 1 item\n\ntests/_runtime/packages/test_module_registry.py .                        [100%]\n\n============================== 1 passed in 0.03s ===============================\n\n"], "TaskWeaver-taskweaver/misc/example.py-load_examples": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/TaskWeaver\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/unit_tests/test_example.py F                                       [100%]\n\n=================================== FAILURES ===================================\n______________________________ test_load_examples ______________________________\n\n    def test_load_examples():\n        example_path = os.path.join(\n            os.path.dirname(os.path.abspath(__file__)),\n            \"data\",\n            \"examples\",\n            \"planner_examples\",\n        )\n        examples = load_examples(example_path, {\"Planner\", \"User\", \"CodeInterpreter\"})\n>       assert len(examples) == 1\nE       assert 0 == 1\nE        +  where 0 = len([])\n\ntests/unit_tests/test_example.py:14: AssertionError\n=========================== short test summary info ============================\nFAILED tests/unit_tests/test_example.py::test_load_examples - assert 0 == 1\n============================== 1 failed in 0.06s ===============================\n\n"], "TaskWeaver-taskweaver/code_interpreter/plugin_selection.py-add_selected_plugins": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/TaskWeaver\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/unit_tests/test_plugin_pool.py .                                   [100%]\n\n============================== 1 passed in 0.16s ===============================\n\n"], "TaskWeaver-taskweaver/code_interpreter/plugin_selection.py-filter_unused_plugins": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/TaskWeaver\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/unit_tests/test_plugin_pool.py F                                   [100%]\n\n=================================== FAILURES ===================================\n_______________________________ test_plugin_pool _______________________________\n\n    def test_plugin_pool():\n        app_injector = Injector(\n            [PluginModule, LoggingModule],\n        )\n        app_config = AppConfigSource(\n            config={\n                \"app_dir\": os.path.dirname(os.path.abspath(__file__)),\n                \"llm.api_key\": \"this_is_not_a_real_key\",  # pragma: allowlist secret\n                \"plugin.base_path\": os.path.join(os.path.dirname(os.path.abspath(__file__)), \"data/plugins\"),\n            },\n        )\n        app_injector.binder.bind(AppConfigSource, to=app_config)\n    \n        plugin_registry = app_injector.get(PluginRegistry)\n    \n        plugins = plugin_registry.get_list()\n    \n        selected_plugin_pool = SelectedPluginPool()\n    \n        selected_plugin_pool.add_selected_plugins(plugins[:1])\n        assert len(selected_plugin_pool) == 1\n    \n        selected_plugin_pool.add_selected_plugins(plugins[:1])\n        assert len(selected_plugin_pool) == 1\n    \n        selected_plugin_pool.add_selected_plugins(plugins[1:3])\n        assert len(selected_plugin_pool) == 3\n    \n        selected_plugin_pool.add_selected_plugins(plugins[2:4])\n        assert len(selected_plugin_pool) == 4\n    \n        selected_plugin_pool.filter_unused_plugins(\"xcxcxc anomaly_detection() ababab\")\n        assert len(selected_plugin_pool) == 1\n        assert selected_plugin_pool.get_plugins()[0].name == \"anomaly_detection\"\n    \n        selected_plugin_pool.filter_unused_plugins(\"\")\n>       assert len(selected_plugin_pool) == 1\nE       assert 0 == 1\nE        +  where 0 = len(<taskweaver.code_interpreter.plugin_selection.SelectedPluginPool object at 0x7fea1e000280>)\n\ntests/unit_tests/test_plugin_pool.py:47: AssertionError\n=========================== short test summary info ============================\nFAILED tests/unit_tests/test_plugin_pool.py::test_plugin_pool - assert 0 == 1\n============================== 1 failed in 0.18s ===============================\n\n"], "TaskWeaver-taskweaver/module/prompt_util.py-remove_all_delimiters": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/TaskWeaver\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/unit_tests/test_prompt_util.py .                                   [100%]\n\n============================== 1 passed in 0.03s ===============================\n\n"], "reflex-reflex/app.py-_enable_state": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/test_app.py F                                                      [100%]\n\n=================================== FAILURES ===================================\n____________________________ test_app_state_manager ____________________________\n\n    def test_app_state_manager():\n        app = App()\n        with pytest.raises(ValueError):\n            app.state_manager\n>       app._enable_state()\n\ntests/test_app.py:1439: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <App state=None>\n\n    def _enable_state(self) -> None:\n        \"\"\"Enable state for the app.\"\"\"\n        # Import the State class\n        from reflex.state import State\n    \n        # Get the app module\n>       module = importlib.import_module(self.module)\nE       NameError: name 'importlib' is not defined\n\nreflex/app.py:237: NameError\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_app.py::test_app_state_manager - NameError: name 'importlib...\n======================== 1 failed, 5 warnings in 0.14s =========================\n\n"], "reflex-reflex/app.py-_add_optional_endpoints": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/test_app.py F                                                      [100%]\n\n=================================== FAILURES ===================================\n_______________________ test_app_with_optional_endpoints _______________________\n\n    def test_app_with_optional_endpoints():\n        from reflex.components.core.upload import Upload\n    \n        app = App()\n        Upload.is_used = True\n>       app._add_optional_endpoints()\n\ntests/test_app.py:1431: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <App state=None>\n\n    def _add_optional_endpoints(self):\n        \"\"\"Add optional api endpoints (_upload).\"\"\"\n        # Import the upload endpoint if the upload component is used\n>       if any(\"upload\" in str(c) for c in self.components):\nE       AttributeError: 'App' object has no attribute 'components'\n\nreflex/app.py:306: AttributeError\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_app.py::test_app_with_optional_endpoints - AttributeError: ...\n======================== 1 failed, 5 warnings in 0.14s =========================\n\n"], "reflex-reflex/app.py-add_page": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 24 items\n\ntests/test_app.py FFFFFFFFFFFFFFFFFFFFFFFF                               [100%]\n\n=================================== FAILURES ===================================\n_________________________ test_add_page_default_route __________________________\n\napp = <App state=None>\nindex_page = <function index_page.<locals>.index at 0x7f9c6ac36830>\nabout_page = <function about_page.<locals>.about at 0x7f9c6ac36dd0>\n\n    def test_add_page_default_route(app: App, index_page, about_page):\n        \"\"\"Test adding a page to an app.\n    \n        Args:\n            app: The app to test.\n            index_page: The index page.\n            about_page: The about page.\n        \"\"\"\n        assert app.pages == {}\n        app.add_page(index_page)\n>       assert app.pages.keys() == {\"index\"}\nE       AssertionError: assert dict_keys([]) == {'index'}\nE         \nE         Use -v to get more diff\n\ntests/test_app.py:238: AssertionError\n_______________________ test_add_page_invalid_api_route ________________________\n\napp = <App state=None>\nindex_page = <function index_page.<locals>.index at 0x7f9c6ab2a560>\n\n    def test_add_page_invalid_api_route(app: App, index_page):\n        \"\"\"Test adding a page with an invalid route to an app.\n    \n        Args:\n            app: The app to test.\n            index_page: The index page.\n        \"\"\"\n>       with pytest.raises(ValueError):\nE       Failed: DID NOT RAISE <class 'ValueError'>\n\ntests/test_app.py:300: Failed\n_______________________ test_add_page_set_route_dynamic ________________________\n\nindex_page = <function index_page.<locals>.index at 0x7f9c6ab2a8c0>\nwindows_platform = False\n\n    def test_add_page_set_route_dynamic(index_page, windows_platform: bool):\n        \"\"\"Test adding a page with dynamic route variable to an app.\n    \n        Args:\n            index_page: The index page.\n            windows_platform: Whether the system is windows.\n        \"\"\"\n        app = App(state=EmptyState)\n        assert app.state is not None\n        route = \"/test/[dynamic]\"\n        if windows_platform:\n            route.lstrip(\"/\").replace(\"/\", \"\\\\\")\n        assert app.pages == {}\n        app.add_page(index_page, route=route)\n>       assert app.pages.keys() == {\"test/[dynamic]\"}\nE       AssertionError: assert dict_keys([]) == {'test/[dynamic]'}\nE         \nE         Use -v to get more diff\n\ntests/test_app.py:271: AssertionError\n___________ test_add_duplicate_page_route_error[<lambda>-<lambda>-/] ___________\n\napp = <App state=None>, first_page = <function <lambda> at 0x7f9c6adc6320>\nsecond_page = <function <lambda> at 0x7f9c6adc63b0>, route = '/'\n\n    @pytest.mark.parametrize(\n        \"first_page,second_page, route\",\n        [\n            (lambda: rx.fragment(), lambda: rx.fragment(rx.text(\"second\")), \"/\"),\n            (rx.fragment(rx.text(\"first\")), rx.fragment(rx.text(\"second\")), \"/page1\"),\n            (\n                lambda: rx.fragment(rx.text(\"first\")),\n                rx.fragment(rx.text(\"second\")),\n                \"page3\",\n            ),\n            (page1, page2, \"page1\"),\n            (index, index, None),\n            (page1, page1, None),\n        ],\n    )\n    def test_add_duplicate_page_route_error(app, first_page, second_page, route):\n        app.add_page(first_page, route=route)\n>       with pytest.raises(ValueError):\nE       Failed: DID NOT RAISE <class 'ValueError'>\n\ntests/test_app.py:344: Failed\n_____ test_add_duplicate_page_route_error[first_page1-second_page1-/page1] _____\n\napp = <App state=None>\nfirst_page = {\"name\": \"Fragment\", \"props\": [], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{\"name\": \"RadixThe...\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}], \"autofocus\": false}\nsecond_page = {\"name\": \"Fragment\", \"props\": [], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{\"name\": \"RadixThe...\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}], \"autofocus\": false}\nroute = '/page1'\n\n    @pytest.mark.parametrize(\n        \"first_page,second_page, route\",\n        [\n            (lambda: rx.fragment(), lambda: rx.fragment(rx.text(\"second\")), \"/\"),\n            (rx.fragment(rx.text(\"first\")), rx.fragment(rx.text(\"second\")), \"/page1\"),\n            (\n                lambda: rx.fragment(rx.text(\"first\")),\n                rx.fragment(rx.text(\"second\")),\n                \"page3\",\n            ),\n            (page1, page2, \"page1\"),\n            (index, index, None),\n            (page1, page1, None),\n        ],\n    )\n    def test_add_duplicate_page_route_error(app, first_page, second_page, route):\n        app.add_page(first_page, route=route)\n>       with pytest.raises(ValueError):\nE       Failed: DID NOT RAISE <class 'ValueError'>\n\ntests/test_app.py:344: Failed\n_______ test_add_duplicate_page_route_error[<lambda>-second_page2-page3] _______\n\napp = <App state=None>, first_page = <function <lambda> at 0x7f9c6adc6d40>\nsecond_page = {\"name\": \"Fragment\", \"props\": [], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{\"name\": \"RadixThe...\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}], \"autofocus\": false}\nroute = 'page3'\n\n    @pytest.mark.parametrize(\n        \"first_page,second_page, route\",\n        [\n            (lambda: rx.fragment(), lambda: rx.fragment(rx.text(\"second\")), \"/\"),\n            (rx.fragment(rx.text(\"first\")), rx.fragment(rx.text(\"second\")), \"/page1\"),\n            (\n                lambda: rx.fragment(rx.text(\"first\")),\n                rx.fragment(rx.text(\"second\")),\n                \"page3\",\n            ),\n            (page1, page2, \"page1\"),\n            (index, index, None),\n            (page1, page1, None),\n        ],\n    )\n    def test_add_duplicate_page_route_error(app, first_page, second_page, route):\n        app.add_page(first_page, route=route)\n>       with pytest.raises(ValueError):\nE       Failed: DID NOT RAISE <class 'ValueError'>\n\ntests/test_app.py:344: Failed\n____________ test_add_duplicate_page_route_error[page1-page2-page1] ____________\n\napp = <App state=None>, first_page = <function page1 at 0x7f9c6adc6170>\nsecond_page = <function page2 at 0x7f9c6adc6200>, route = 'page1'\n\n    @pytest.mark.parametrize(\n        \"first_page,second_page, route\",\n        [\n            (lambda: rx.fragment(), lambda: rx.fragment(rx.text(\"second\")), \"/\"),\n            (rx.fragment(rx.text(\"first\")), rx.fragment(rx.text(\"second\")), \"/page1\"),\n            (\n                lambda: rx.fragment(rx.text(\"first\")),\n                rx.fragment(rx.text(\"second\")),\n                \"page3\",\n            ),\n            (page1, page2, \"page1\"),\n            (index, index, None),\n            (page1, page1, None),\n        ],\n    )\n    def test_add_duplicate_page_route_error(app, first_page, second_page, route):\n        app.add_page(first_page, route=route)\n>       with pytest.raises(ValueError):\nE       Failed: DID NOT RAISE <class 'ValueError'>\n\ntests/test_app.py:344: Failed\n____________ test_add_duplicate_page_route_error[index-index-None] _____________\n\napp = <App state=None>, first_page = <function index at 0x7f9c6adc6290>\nsecond_page = <function index at 0x7f9c6adc6290>, route = None\n\n    @pytest.mark.parametrize(\n        \"first_page,second_page, route\",\n        [\n            (lambda: rx.fragment(), lambda: rx.fragment(rx.text(\"second\")), \"/\"),\n            (rx.fragment(rx.text(\"first\")), rx.fragment(rx.text(\"second\")), \"/page1\"),\n            (\n                lambda: rx.fragment(rx.text(\"first\")),\n                rx.fragment(rx.text(\"second\")),\n                \"page3\",\n            ),\n            (page1, page2, \"page1\"),\n            (index, index, None),\n            (page1, page1, None),\n        ],\n    )\n    def test_add_duplicate_page_route_error(app, first_page, second_page, route):\n        app.add_page(first_page, route=route)\n>       with pytest.raises(ValueError):\nE       Failed: DID NOT RAISE <class 'ValueError'>\n\ntests/test_app.py:344: Failed\n____________ test_add_duplicate_page_route_error[page1-page1-None] _____________\n\napp = <App state=None>, first_page = <function page1 at 0x7f9c6adc6170>\nsecond_page = <function page1 at 0x7f9c6adc6170>, route = None\n\n    @pytest.mark.parametrize(\n        \"first_page,second_page, route\",\n        [\n            (lambda: rx.fragment(), lambda: rx.fragment(rx.text(\"second\")), \"/\"),\n            (rx.fragment(rx.text(\"first\")), rx.fragment(rx.text(\"second\")), \"/page1\"),\n            (\n                lambda: rx.fragment(rx.text(\"first\")),\n                rx.fragment(rx.text(\"second\")),\n                \"page3\",\n            ),\n            (page1, page2, \"page1\"),\n            (index, index, None),\n            (page1, page1, None),\n        ],\n    )\n    def test_add_duplicate_page_route_error(app, first_page, second_page, route):\n        app.add_page(first_page, route=route)\n>       with pytest.raises(ValueError):\nE       Failed: DID NOT RAISE <class 'ValueError'>\n\ntests/test_app.py:344: Failed\n____________ test_dynamic_route_var_route_change_completed_on_load _____________\n\nindex_page = <function index_page.<locals>.index at 0x7f9c6ac340d0>\nwindows_platform = False, token = 'd1b5a529-e8d4-4c6e-a447-fb053fe177a6'\napp_module_mock = <Mock id='140309784326592'>\nmocker = <pytest_mock.plugin.MockerFixture object at 0x7f9c6ada7520>\n\n    @pytest.mark.asyncio\n    async def test_dynamic_route_var_route_change_completed_on_load(\n        index_page,\n        windows_platform: bool,\n        token: str,\n        app_module_mock: unittest.mock.Mock,\n        mocker,\n    ):\n        \"\"\"Create app with dynamic route var, and simulate navigation.\n    \n        on_load should fire, allowing any additional vars to be updated before the\n        initial page hydrate.\n    \n        Args:\n            index_page: The index page.\n            windows_platform: Whether the system is windows.\n            token: a Token.\n            app_module_mock: Mocked app module.\n            mocker: pytest mocker object.\n        \"\"\"\n        arg_name = \"dynamic\"\n        route = f\"/test/[{arg_name}]\"\n        if windows_platform:\n            route.lstrip(\"/\").replace(\"/\", \"\\\\\")\n        app = app_module_mock.app = App(state=DynamicState)\n        assert app.state is not None\n        assert arg_name not in app.state.vars\n        app.add_page(index_page, route=route, on_load=DynamicState.on_load)  # type: ignore\n>       assert arg_name in app.state.vars\nE       AssertionError: assert 'dynamic' in {'comp_dynamic': ComputedVar(_cache=False, _backend=False, _initial_value=Unset, _static_deps=set(), _auto_deps=True, ...pile=False)]}, hooks={'const dynamic_state = useContext(StateContexts.dynamic_state)': None}, interpolations=[])), ...}\nE        +  where {'comp_dynamic': ComputedVar(_cache=False, _backend=False, _initial_value=Unset, _static_deps=set(), _auto_deps=True, ...pile=False)]}, hooks={'const dynamic_state = useContext(StateContexts.dynamic_state)': None}, interpolations=[])), ...} = <class 'tests.test_app.DynamicState'>.vars\nE        +    where <class 'tests.test_app.DynamicState'> = <App state=DynamicState>.state\n\ntests/test_app.py:995: AssertionError\n____________________ test_app_with_transpile_packages[True] ____________________\n\ncompilable_app = (<App state=None>, PosixPath('/tmp/pytest-of-root/pytest-2563/test_app_with_transpile_packag0/app/.web'))\nexport = True\n\n    @pytest.mark.parametrize(\"export\", (True, False))\n    def test_app_with_transpile_packages(compilable_app: tuple[App, Path], export: bool):\n        class C1(rx.Component):\n            library = \"foo@1.2.3\"\n            tag = \"Foo\"\n            transpile_packages: List[str] = [\"foo\"]\n    \n        class C2(rx.Component):\n            library = \"bar@4.5.6\"\n            tag = \"Bar\"\n            transpile_packages: List[str] = [\"bar@4.5.6\"]\n    \n        class C3(rx.NoSSRComponent):\n            library = \"baz@7.8.10\"\n            tag = \"Baz\"\n            transpile_packages: List[str] = [\"baz@7.8.9\"]\n    \n        class C4(rx.NoSSRComponent):\n            library = \"quuc@2.3.4\"\n            tag = \"Quuc\"\n            transpile_packages: List[str] = [\"quuc\"]\n    \n        class C5(rx.Component):\n            library = \"quuc\"\n            tag = \"Quuc\"\n    \n        app, web_dir = compilable_app\n        page = Fragment.create(\n            C1.create(), C2.create(), C3.create(), C4.create(), C5.create()\n        )\n        app.add_page(page, route=\"/\")\n        app._compile(export=export)\n    \n        next_config = (web_dir / \"next.config.js\").read_text()\n        transpile_packages_match = re.search(r\"transpilePackages: (\\[.*?\\])\", next_config)\n>       transpile_packages_json = transpile_packages_match.group(1)  # type: ignore\nE       AttributeError: 'NoneType' object has no attribute 'group'\n\n/root/repos/py_data/reflex/tests/test_app.py:1527: AttributeError\n----------------------------- Captured stdout call -----------------------------\n[23:43:17] Compiling: \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 100% 11/11 0:00:00\n___________________ test_app_with_transpile_packages[False] ____________________\n\ncompilable_app = (<App state=None>, PosixPath('/tmp/pytest-of-root/pytest-2563/test_app_with_transpile_packag1/app/.web'))\nexport = False\n\n    @pytest.mark.parametrize(\"export\", (True, False))\n    def test_app_with_transpile_packages(compilable_app: tuple[App, Path], export: bool):\n        class C1(rx.Component):\n            library = \"foo@1.2.3\"\n            tag = \"Foo\"\n            transpile_packages: List[str] = [\"foo\"]\n    \n        class C2(rx.Component):\n            library = \"bar@4.5.6\"\n            tag = \"Bar\"\n            transpile_packages: List[str] = [\"bar@4.5.6\"]\n    \n        class C3(rx.NoSSRComponent):\n            library = \"baz@7.8.10\"\n            tag = \"Baz\"\n            transpile_packages: List[str] = [\"baz@7.8.9\"]\n    \n        class C4(rx.NoSSRComponent):\n            library = \"quuc@2.3.4\"\n            tag = \"Quuc\"\n            transpile_packages: List[str] = [\"quuc\"]\n    \n        class C5(rx.Component):\n            library = \"quuc\"\n            tag = \"Quuc\"\n    \n        app, web_dir = compilable_app\n        page = Fragment.create(\n            C1.create(), C2.create(), C3.create(), C4.create(), C5.create()\n        )\n        app.add_page(page, route=\"/\")\n        app._compile(export=export)\n    \n        next_config = (web_dir / \"next.config.js\").read_text()\n        transpile_packages_match = re.search(r\"transpilePackages: (\\[.*?\\])\", next_config)\n>       transpile_packages_json = transpile_packages_match.group(1)  # type: ignore\nE       AttributeError: 'NoneType' object has no attribute 'group'\n\n/root/repos/py_data/reflex/tests/test_app.py:1527: AttributeError\n----------------------------- Captured stdout call -----------------------------\n[23:43:17] Compiling: \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 100% 11/11 0:00:00\n____________________________ test_app_wrap_priority ____________________________\n\ncompilable_app = (<App state=None>, PosixPath('/tmp/pytest-of-root/pytest-2563/test_app_wrap_priority0/app/.web'))\n\n    def test_app_wrap_priority(compilable_app: tuple[App, Path]):\n        \"\"\"Test that the app wrap components are wrapped in the correct order.\n    \n        Args:\n            compilable_app: compilable_app fixture.\n        \"\"\"\n        app, web_dir = compilable_app\n    \n        class Fragment1(Component):\n            tag = \"Fragment1\"\n    \n            def _get_app_wrap_components(self) -> dict[tuple[int, str], Component]:\n                return {(99, \"Box\"): rx.chakra.box()}\n    \n        class Fragment2(Component):\n            tag = \"Fragment2\"\n    \n            def _get_app_wrap_components(self) -> dict[tuple[int, str], Component]:\n                return {(50, \"Text\"): rx.chakra.text()}\n    \n        class Fragment3(Component):\n            tag = \"Fragment3\"\n    \n            def _get_app_wrap_components(self) -> dict[tuple[int, str], Component]:\n                return {(10, \"Fragment2\"): Fragment2.create()}\n    \n        def page():\n            return Fragment1.create(Fragment3.create())\n    \n        app.add_page(page)\n        app._compile()\n        app_js_contents = (web_dir / \"pages\" / \"_app.js\").read_text()\n        app_js_lines = [\n            line.strip() for line in app_js_contents.splitlines() if line.strip()\n        ]\n>       assert (\n            \"function AppWrap({children}) {\"\n            \"return (\"\n            \"<Box>\"\n            \"<ChakraProvider theme={extendTheme(theme)}>\"\n            \"<ChakraColorModeProvider>\"\n            \"<Text>\"\n            \"<Fragment2>\"\n            \"<Fragment>\"\n            \"{children}\"\n            \"</Fragment>\"\n            \"</Fragment2>\"\n            \"</Text>\"\n            \"</ChakraColorModeProvider>\"\n            \"</ChakraProvider>\"\n            \"</Box>\"\n            \")\"\n            \"}\"\n        ) in \"\".join(app_js_lines)\nE       assert 'function AppWrap({children}) {return (<Box><ChakraProvider theme={extendTheme(theme)}><ChakraColorModeProvider><Text><Fragment2><Fragment>{children}</Fragment></Fragment2></Text></ChakraColorModeProvider></ChakraProvider></Box>)}' in '/** @jsxImportSource @emotion/react */import \\'/styles/styles.css\\'import { Fragment } from \"react\"import { EventLoop...vider><EventLoopProvider><Component {...pageProps} /></EventLoopProvider></StateProvider></AppWrap></ThemeProvider>);}'\nE        +  where '/** @jsxImportSource @emotion/react */import \\'/styles/styles.css\\'import { Fragment } from \"react\"import { EventLoop...vider><EventLoopProvider><Component {...pageProps} /></EventLoopProvider></StateProvider></AppWrap></ThemeProvider>);}' = <built-in method join of str object at 0x7f9cbdf78030>(['/** @jsxImportSource @emotion/react */', \"import '/styles/styles.css'\", 'import { Fragment } from \"react\"', 'import ...ode } from \"/utils/context.js\";', \"import { ThemeProvider } from 'next-themes'\", 'function AppWrap({children}) {', ...])\nE        +    where <built-in method join of str object at 0x7f9cbdf78030> = ''.join\n\n/root/repos/py_data/reflex/tests/test_app.py:1344: AssertionError\n----------------------------- Captured stdout call -----------------------------\n[23:43:17] Compiling: \u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501 100% 11/11 0:00:00\n___________________________ test_add_page_set_route ____________________________\n\napp = <App state=None>\nindex_page = <function index_page.<locals>.index at 0x7f9c6aad9090>\nwindows_platform = False\n\n    def test_add_page_set_route(app: App, index_page, windows_platform: bool):\n        \"\"\"Test adding a page to an app.\n    \n        Args:\n            app: The app to test.\n            index_page: The index page.\n            windows_platform: Whether the system is windows.\n        \"\"\"\n        route = \"test\" if windows_platform else \"/test\"\n        assert app.pages == {}\n        app.add_page(index_page, route=route)\n>       assert app.pages.keys() == {\"test\"}\nE       AssertionError: assert dict_keys([]) == {'test'}\nE         \nE         Use -v to get more diff\n\ntests/test_app.py:254: AssertionError\n_________ test_overlay_component[None-default_overlay_component-None] __________\n\nstate = None\noverlay_component = <function default_overlay_component at 0x7f9cb7360700>\nexp_page_child = None\n\n    @pytest.mark.parametrize(\n        (\"state\", \"overlay_component\", \"exp_page_child\"),\n        [\n            (None, default_overlay_component, None),\n            (None, None, None),\n            (None, Text.create(\"foo\"), Text),\n            (State, default_overlay_component, Fragment),\n            (State, None, None),\n            (State, Text.create(\"foo\"), Text),\n            (State, lambda: Text.create(\"foo\"), Text),\n        ],\n    )\n    def test_overlay_component(\n        state: State | None,\n        overlay_component: Component | ComponentCallable | None,\n        exp_page_child: Type[Component] | None,\n    ):\n        \"\"\"Test that the overlay component is set correctly.\n    \n        Args:\n            state: The state class to pass to App.\n            overlay_component: The overlay_component to pass to App.\n            exp_page_child: The type of the expected child in the page fragment.\n        \"\"\"\n        app = App(state=state, overlay_component=overlay_component)\n        app._setup_overlay_component()\n        if exp_page_child is None:\n            assert app.overlay_component is None\n        elif isinstance(exp_page_child, OverlayFragment):\n            assert app.overlay_component is not None\n            generated_component = app._generate_component(app.overlay_component)  # type: ignore\n            assert isinstance(generated_component, OverlayFragment)\n            assert isinstance(\n                generated_component.children[0],\n                Cond,  # ConnectionModal is a Cond under the hood\n            )\n        else:\n            assert app.overlay_component is not None\n            assert isinstance(\n                app._generate_component(app.overlay_component),  # type: ignore\n                exp_page_child,\n            )\n    \n        app.add_page(rx.box(\"Index\"), route=\"/test\")\n        # overlay components are wrapped during compile only\n        app._setup_overlay_component()\n>       page = app.pages[\"test\"]\nE       KeyError: 'test'\n\ntests/test_app.py:1248: KeyError\n____________________ test_overlay_component[None-None-None] ____________________\n\nstate = None, overlay_component = None, exp_page_child = None\n\n    @pytest.mark.parametrize(\n        (\"state\", \"overlay_component\", \"exp_page_child\"),\n        [\n            (None, default_overlay_component, None),\n            (None, None, None),\n            (None, Text.create(\"foo\"), Text),\n            (State, default_overlay_component, Fragment),\n            (State, None, None),\n            (State, Text.create(\"foo\"), Text),\n            (State, lambda: Text.create(\"foo\"), Text),\n        ],\n    )\n    def test_overlay_component(\n        state: State | None,\n        overlay_component: Component | ComponentCallable | None,\n        exp_page_child: Type[Component] | None,\n    ):\n        \"\"\"Test that the overlay component is set correctly.\n    \n        Args:\n            state: The state class to pass to App.\n            overlay_component: The overlay_component to pass to App.\n            exp_page_child: The type of the expected child in the page fragment.\n        \"\"\"\n        app = App(state=state, overlay_component=overlay_component)\n        app._setup_overlay_component()\n        if exp_page_child is None:\n            assert app.overlay_component is None\n        elif isinstance(exp_page_child, OverlayFragment):\n            assert app.overlay_component is not None\n            generated_component = app._generate_component(app.overlay_component)  # type: ignore\n            assert isinstance(generated_component, OverlayFragment)\n            assert isinstance(\n                generated_component.children[0],\n                Cond,  # ConnectionModal is a Cond under the hood\n            )\n        else:\n            assert app.overlay_component is not None\n            assert isinstance(\n                app._generate_component(app.overlay_component),  # type: ignore\n                exp_page_child,\n            )\n    \n        app.add_page(rx.box(\"Index\"), route=\"/test\")\n        # overlay components are wrapped during compile only\n        app._setup_overlay_component()\n>       page = app.pages[\"test\"]\nE       KeyError: 'test'\n\ntests/test_app.py:1248: KeyError\n_____________ test_overlay_component[None-overlay_component2-Text] _____________\n\nstate = None\noverlay_component = {\"name\": \"RadixThemesText\", \"props\": [\"as={`p`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{..., \"contents\": \"{`foo`}\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}\nexp_page_child = <class 'reflex.components.radix.themes.typography.text.Text'>\n\n    @pytest.mark.parametrize(\n        (\"state\", \"overlay_component\", \"exp_page_child\"),\n        [\n            (None, default_overlay_component, None),\n            (None, None, None),\n            (None, Text.create(\"foo\"), Text),\n            (State, default_overlay_component, Fragment),\n            (State, None, None),\n            (State, Text.create(\"foo\"), Text),\n            (State, lambda: Text.create(\"foo\"), Text),\n        ],\n    )\n    def test_overlay_component(\n        state: State | None,\n        overlay_component: Component | ComponentCallable | None,\n        exp_page_child: Type[Component] | None,\n    ):\n        \"\"\"Test that the overlay component is set correctly.\n    \n        Args:\n            state: The state class to pass to App.\n            overlay_component: The overlay_component to pass to App.\n            exp_page_child: The type of the expected child in the page fragment.\n        \"\"\"\n        app = App(state=state, overlay_component=overlay_component)\n        app._setup_overlay_component()\n        if exp_page_child is None:\n            assert app.overlay_component is None\n        elif isinstance(exp_page_child, OverlayFragment):\n            assert app.overlay_component is not None\n            generated_component = app._generate_component(app.overlay_component)  # type: ignore\n            assert isinstance(generated_component, OverlayFragment)\n            assert isinstance(\n                generated_component.children[0],\n                Cond,  # ConnectionModal is a Cond under the hood\n            )\n        else:\n            assert app.overlay_component is not None\n            assert isinstance(\n                app._generate_component(app.overlay_component),  # type: ignore\n                exp_page_child,\n            )\n    \n        app.add_page(rx.box(\"Index\"), route=\"/test\")\n        # overlay components are wrapped during compile only\n        app._setup_overlay_component()\n>       page = app.pages[\"test\"]\nE       KeyError: 'test'\n\ntests/test_app.py:1248: KeyError\n_______ test_overlay_component[State-default_overlay_component-Fragment] _______\n\nstate = <class 'reflex.state.State'>\noverlay_component = <function default_overlay_component at 0x7f9cb7360700>\nexp_page_child = <class 'reflex.components.base.fragment.Fragment'>\n\n    @pytest.mark.parametrize(\n        (\"state\", \"overlay_component\", \"exp_page_child\"),\n        [\n            (None, default_overlay_component, None),\n            (None, None, None),\n            (None, Text.create(\"foo\"), Text),\n            (State, default_overlay_component, Fragment),\n            (State, None, None),\n            (State, Text.create(\"foo\"), Text),\n            (State, lambda: Text.create(\"foo\"), Text),\n        ],\n    )\n    def test_overlay_component(\n        state: State | None,\n        overlay_component: Component | ComponentCallable | None,\n        exp_page_child: Type[Component] | None,\n    ):\n        \"\"\"Test that the overlay component is set correctly.\n    \n        Args:\n            state: The state class to pass to App.\n            overlay_component: The overlay_component to pass to App.\n            exp_page_child: The type of the expected child in the page fragment.\n        \"\"\"\n        app = App(state=state, overlay_component=overlay_component)\n        app._setup_overlay_component()\n        if exp_page_child is None:\n            assert app.overlay_component is None\n        elif isinstance(exp_page_child, OverlayFragment):\n            assert app.overlay_component is not None\n            generated_component = app._generate_component(app.overlay_component)  # type: ignore\n            assert isinstance(generated_component, OverlayFragment)\n            assert isinstance(\n                generated_component.children[0],\n                Cond,  # ConnectionModal is a Cond under the hood\n            )\n        else:\n            assert app.overlay_component is not None\n            assert isinstance(\n                app._generate_component(app.overlay_component),  # type: ignore\n                exp_page_child,\n            )\n    \n        app.add_page(rx.box(\"Index\"), route=\"/test\")\n        # overlay components are wrapped during compile only\n        app._setup_overlay_component()\n>       page = app.pages[\"test\"]\nE       KeyError: 'test'\n\ntests/test_app.py:1248: KeyError\n___________________ test_overlay_component[State-None-None] ____________________\n\nstate = <class 'reflex.state.State'>, overlay_component = None\nexp_page_child = None\n\n    @pytest.mark.parametrize(\n        (\"state\", \"overlay_component\", \"exp_page_child\"),\n        [\n            (None, default_overlay_component, None),\n            (None, None, None),\n            (None, Text.create(\"foo\"), Text),\n            (State, default_overlay_component, Fragment),\n            (State, None, None),\n            (State, Text.create(\"foo\"), Text),\n            (State, lambda: Text.create(\"foo\"), Text),\n        ],\n    )\n    def test_overlay_component(\n        state: State | None,\n        overlay_component: Component | ComponentCallable | None,\n        exp_page_child: Type[Component] | None,\n    ):\n        \"\"\"Test that the overlay component is set correctly.\n    \n        Args:\n            state: The state class to pass to App.\n            overlay_component: The overlay_component to pass to App.\n            exp_page_child: The type of the expected child in the page fragment.\n        \"\"\"\n        app = App(state=state, overlay_component=overlay_component)\n        app._setup_overlay_component()\n        if exp_page_child is None:\n            assert app.overlay_component is None\n        elif isinstance(exp_page_child, OverlayFragment):\n            assert app.overlay_component is not None\n            generated_component = app._generate_component(app.overlay_component)  # type: ignore\n            assert isinstance(generated_component, OverlayFragment)\n            assert isinstance(\n                generated_component.children[0],\n                Cond,  # ConnectionModal is a Cond under the hood\n            )\n        else:\n            assert app.overlay_component is not None\n            assert isinstance(\n                app._generate_component(app.overlay_component),  # type: ignore\n                exp_page_child,\n            )\n    \n        app.add_page(rx.box(\"Index\"), route=\"/test\")\n        # overlay components are wrapped during compile only\n        app._setup_overlay_component()\n>       page = app.pages[\"test\"]\nE       KeyError: 'test'\n\ntests/test_app.py:1248: KeyError\n____________ test_overlay_component[State-overlay_component5-Text] _____________\n\nstate = <class 'reflex.state.State'>\noverlay_component = {\"name\": \"RadixThemesText\", \"props\": [\"as={`p`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{..., \"contents\": \"{`foo`}\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}\nexp_page_child = <class 'reflex.components.radix.themes.typography.text.Text'>\n\n    @pytest.mark.parametrize(\n        (\"state\", \"overlay_component\", \"exp_page_child\"),\n        [\n            (None, default_overlay_component, None),\n            (None, None, None),\n            (None, Text.create(\"foo\"), Text),\n            (State, default_overlay_component, Fragment),\n            (State, None, None),\n            (State, Text.create(\"foo\"), Text),\n            (State, lambda: Text.create(\"foo\"), Text),\n        ],\n    )\n    def test_overlay_component(\n        state: State | None,\n        overlay_component: Component | ComponentCallable | None,\n        exp_page_child: Type[Component] | None,\n    ):\n        \"\"\"Test that the overlay component is set correctly.\n    \n        Args:\n            state: The state class to pass to App.\n            overlay_component: The overlay_component to pass to App.\n            exp_page_child: The type of the expected child in the page fragment.\n        \"\"\"\n        app = App(state=state, overlay_component=overlay_component)\n        app._setup_overlay_component()\n        if exp_page_child is None:\n            assert app.overlay_component is None\n        elif isinstance(exp_page_child, OverlayFragment):\n            assert app.overlay_component is not None\n            generated_component = app._generate_component(app.overlay_component)  # type: ignore\n            assert isinstance(generated_component, OverlayFragment)\n            assert isinstance(\n                generated_component.children[0],\n                Cond,  # ConnectionModal is a Cond under the hood\n            )\n        else:\n            assert app.overlay_component is not None\n            assert isinstance(\n                app._generate_component(app.overlay_component),  # type: ignore\n                exp_page_child,\n            )\n    \n        app.add_page(rx.box(\"Index\"), route=\"/test\")\n        # overlay components are wrapped during compile only\n        app._setup_overlay_component()\n>       page = app.pages[\"test\"]\nE       KeyError: 'test'\n\ntests/test_app.py:1248: KeyError\n_________________ test_overlay_component[State-<lambda>-Text] __________________\n\nstate = <class 'reflex.state.State'>\noverlay_component = <function <lambda> at 0x7f9c6adc75b0>\nexp_page_child = <class 'reflex.components.radix.themes.typography.text.Text'>\n\n    @pytest.mark.parametrize(\n        (\"state\", \"overlay_component\", \"exp_page_child\"),\n        [\n            (None, default_overlay_component, None),\n            (None, None, None),\n            (None, Text.create(\"foo\"), Text),\n            (State, default_overlay_component, Fragment),\n            (State, None, None),\n            (State, Text.create(\"foo\"), Text),\n            (State, lambda: Text.create(\"foo\"), Text),\n        ],\n    )\n    def test_overlay_component(\n        state: State | None,\n        overlay_component: Component | ComponentCallable | None,\n        exp_page_child: Type[Component] | None,\n    ):\n        \"\"\"Test that the overlay component is set correctly.\n    \n        Args:\n            state: The state class to pass to App.\n            overlay_component: The overlay_component to pass to App.\n            exp_page_child: The type of the expected child in the page fragment.\n        \"\"\"\n        app = App(state=state, overlay_component=overlay_component)\n        app._setup_overlay_component()\n        if exp_page_child is None:\n            assert app.overlay_component is None\n        elif isinstance(exp_page_child, OverlayFragment):\n            assert app.overlay_component is not None\n            generated_component = app._generate_component(app.overlay_component)  # type: ignore\n            assert isinstance(generated_component, OverlayFragment)\n            assert isinstance(\n                generated_component.children[0],\n                Cond,  # ConnectionModal is a Cond under the hood\n            )\n        else:\n            assert app.overlay_component is not None\n            assert isinstance(\n                app._generate_component(app.overlay_component),  # type: ignore\n                exp_page_child,\n            )\n    \n        app.add_page(rx.box(\"Index\"), route=\"/test\")\n        # overlay components are wrapped during compile only\n        app._setup_overlay_component()\n>       page = app.pages[\"test\"]\nE       KeyError: 'test'\n\ntests/test_app.py:1248: KeyError\n___________________ test_add_page_component_returning_tuple ____________________\n\n    def test_add_page_component_returning_tuple():\n        \"\"\"Test that a component or render method returning a\n        tuple is unpacked in a Fragment.\n        \"\"\"\n        app = App()\n    \n        def index():\n            return rx.text(\"first\"), rx.text(\"second\")\n    \n        def page2():\n            return (rx.text(\"third\"),)\n    \n        app.add_page(index)  # type: ignore\n        app.add_page(page2)  # type: ignore\n    \n>       assert isinstance((fragment_wrapper := app.pages[\"index\"].children[0]), Fragment)\nE       KeyError: 'index'\n\ntests/test_app.py:1478: KeyError\n________________________ test_add_page_set_route_nested ________________________\n\napp = <App state=None>\nindex_page = <function index_page.<locals>.index at 0x7f9c6aadb1c0>\nwindows_platform = False\n\n    def test_add_page_set_route_nested(app: App, index_page, windows_platform: bool):\n        \"\"\"Test adding a page to an app.\n    \n        Args:\n            app: The app to test.\n            index_page: The index page.\n            windows_platform: Whether the system is windows.\n        \"\"\"\n        route = \"test\\\\nested\" if windows_platform else \"/test/nested\"\n        assert app.pages == {}\n        app.add_page(index_page, route=route)\n>       assert app.pages.keys() == {route.strip(os.path.sep)}\nE       AssertionError: assert dict_keys([]) == {'test/nested'}\nE         \nE         Use -v to get more diff\n\ntests/test_app.py:290: AssertionError\n_________________________ test_app_state_determination _________________________\n\n    def test_app_state_determination():\n        \"\"\"Test that the stateless status of an app is determined correctly.\"\"\"\n        a1 = App()\n        assert a1.state is None\n    \n        # No state, no router, no event handlers.\n        a1.add_page(rx.box(\"Index\"), route=\"/\")\n        assert a1.state is None\n    \n        # Add a page with `on_load` enables state.\n        a1.add_page(rx.box(\"About\"), route=\"/about\", on_load=rx.console_log(\"\"))\n>       assert a1.state is not None\nE       assert None is not None\nE        +  where None = <App state=None>.state\n\ntests/test_app.py:1376: AssertionError\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_app.py::test_add_page_default_route - AssertionError: asser...\nFAILED tests/test_app.py::test_add_page_invalid_api_route - Failed: DID NOT R...\nFAILED tests/test_app.py::test_add_page_set_route_dynamic - AssertionError: a...\nFAILED tests/test_app.py::test_add_duplicate_page_route_error[<lambda>-<lambda>-/]\nFAILED tests/test_app.py::test_add_duplicate_page_route_error[first_page1-second_page1-/page1]\nFAILED tests/test_app.py::test_add_duplicate_page_route_error[<lambda>-second_page2-page3]\nFAILED tests/test_app.py::test_add_duplicate_page_route_error[page1-page2-page1]\nFAILED tests/test_app.py::test_add_duplicate_page_route_error[index-index-None]\nFAILED tests/test_app.py::test_add_duplicate_page_route_error[page1-page1-None]\nFAILED tests/test_app.py::test_dynamic_route_var_route_change_completed_on_load\nFAILED tests/test_app.py::test_app_with_transpile_packages[True] - AttributeE...\nFAILED tests/test_app.py::test_app_with_transpile_packages[False] - Attribute...\nFAILED tests/test_app.py::test_app_wrap_priority - assert 'function AppWrap({...\nFAILED tests/test_app.py::test_add_page_set_route - AssertionError: assert di...\nFAILED tests/test_app.py::test_overlay_component[None-default_overlay_component-None]\nFAILED tests/test_app.py::test_overlay_component[None-None-None] - KeyError: ...\nFAILED tests/test_app.py::test_overlay_component[None-overlay_component2-Text]\nFAILED tests/test_app.py::test_overlay_component[State-default_overlay_component-Fragment]\nFAILED tests/test_app.py::test_overlay_component[State-None-None] - KeyError:...\nFAILED tests/test_app.py::test_overlay_component[State-overlay_component5-Text]\nFAILED tests/test_app.py::test_overlay_component[State-<lambda>-Text] - KeyEr...\nFAILED tests/test_app.py::test_add_page_component_returning_tuple - KeyError:...\nFAILED tests/test_app.py::test_add_page_set_route_nested - AssertionError: as...\nFAILED tests/test_app.py::test_app_state_determination - assert None is not None\n======================== 24 failed, 5 warnings in 0.60s ========================\n\n"], "reflex-reflex/app.py-_setup_overlay_component": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 7 items\n\ntests/test_app.py FFFF.FF                                                [100%]\n\n=================================== FAILURES ===================================\n_________ test_overlay_component[None-default_overlay_component-None] __________\n\nstate = None\noverlay_component = <function default_overlay_component at 0x7fe285cbc670>\nexp_page_child = None\n\n    @pytest.mark.parametrize(\n        (\"state\", \"overlay_component\", \"exp_page_child\"),\n        [\n            (None, default_overlay_component, None),\n            (None, None, None),\n            (None, Text.create(\"foo\"), Text),\n            (State, default_overlay_component, Fragment),\n            (State, None, None),\n            (State, Text.create(\"foo\"), Text),\n            (State, lambda: Text.create(\"foo\"), Text),\n        ],\n    )\n    def test_overlay_component(\n        state: State | None,\n        overlay_component: Component | ComponentCallable | None,\n        exp_page_child: Type[Component] | None,\n    ):\n        \"\"\"Test that the overlay component is set correctly.\n    \n        Args:\n            state: The state class to pass to App.\n            overlay_component: The overlay_component to pass to App.\n            exp_page_child: The type of the expected child in the page fragment.\n        \"\"\"\n        app = App(state=state, overlay_component=overlay_component)\n        app._setup_overlay_component()\n        if exp_page_child is None:\n>           assert app.overlay_component is None\nE           assert <function default_overlay_component at 0x7fe285cbc670> is None\nE            +  where <function default_overlay_component at 0x7fe285cbc670> = <App state=None>.overlay_component\n\ntests/test_app.py:1229: AssertionError\n____________________ test_overlay_component[None-None-None] ____________________\n\nstate = None, overlay_component = None, exp_page_child = None\n\n    @pytest.mark.parametrize(\n        (\"state\", \"overlay_component\", \"exp_page_child\"),\n        [\n            (None, default_overlay_component, None),\n            (None, None, None),\n            (None, Text.create(\"foo\"), Text),\n            (State, default_overlay_component, Fragment),\n            (State, None, None),\n            (State, Text.create(\"foo\"), Text),\n            (State, lambda: Text.create(\"foo\"), Text),\n        ],\n    )\n    def test_overlay_component(\n        state: State | None,\n        overlay_component: Component | ComponentCallable | None,\n        exp_page_child: Type[Component] | None,\n    ):\n        \"\"\"Test that the overlay component is set correctly.\n    \n        Args:\n            state: The state class to pass to App.\n            overlay_component: The overlay_component to pass to App.\n            exp_page_child: The type of the expected child in the page fragment.\n        \"\"\"\n        app = App(state=state, overlay_component=overlay_component)\n        app._setup_overlay_component()\n        if exp_page_child is None:\n>           assert app.overlay_component is None\nE           assert <function App._setup_overlay_component.<locals>.<lambda> at 0x7fe239537c70> is None\nE            +  where <function App._setup_overlay_component.<locals>.<lambda> at 0x7fe239537c70> = <App state=None>.overlay_component\n\ntests/test_app.py:1229: AssertionError\n_____________ test_overlay_component[None-overlay_component2-Text] _____________\n\nstate = None\noverlay_component = {\"name\": \"RadixThemesText\", \"props\": [\"as={`p`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{..., \"contents\": \"{`foo`}\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}\nexp_page_child = <class 'reflex.components.radix.themes.typography.text.Text'>\n\n    @pytest.mark.parametrize(\n        (\"state\", \"overlay_component\", \"exp_page_child\"),\n        [\n            (None, default_overlay_component, None),\n            (None, None, None),\n            (None, Text.create(\"foo\"), Text),\n            (State, default_overlay_component, Fragment),\n            (State, None, None),\n            (State, Text.create(\"foo\"), Text),\n            (State, lambda: Text.create(\"foo\"), Text),\n        ],\n    )\n    def test_overlay_component(\n        state: State | None,\n        overlay_component: Component | ComponentCallable | None,\n        exp_page_child: Type[Component] | None,\n    ):\n        \"\"\"Test that the overlay component is set correctly.\n    \n        Args:\n            state: The state class to pass to App.\n            overlay_component: The overlay_component to pass to App.\n            exp_page_child: The type of the expected child in the page fragment.\n        \"\"\"\n        app = App(state=state, overlay_component=overlay_component)\n        app._setup_overlay_component()\n        if exp_page_child is None:\n            assert app.overlay_component is None\n        elif isinstance(exp_page_child, OverlayFragment):\n            assert app.overlay_component is not None\n            generated_component = app._generate_component(app.overlay_component)  # type: ignore\n            assert isinstance(generated_component, OverlayFragment)\n            assert isinstance(\n                generated_component.children[0],\n                Cond,  # ConnectionModal is a Cond under the hood\n            )\n        else:\n            assert app.overlay_component is not None\n            assert isinstance(\n                app._generate_component(app.overlay_component),  # type: ignore\n                exp_page_child,\n            )\n    \n        app.add_page(rx.box(\"Index\"), route=\"/test\")\n        # overlay components are wrapped during compile only\n        app._setup_overlay_component()\n        page = app.pages[\"test\"]\n    \n        if exp_page_child is not None:\n>           assert len(page.children) == 3\nE           assert 2 == 3\nE            +  where 2 = len([{\"name\": \"RadixThemesBox\", \"props\": [], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{\"name\": \"\"...ge`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}])\nE            +    where [{\"name\": \"RadixThemesBox\", \"props\": [], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{\"name\": \"\"...ge`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}] = {\"name\": \"Fragment\", \"props\": [], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{\"name\": \"RadixThe...\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}], \"autofocus\": false}.children\n\ntests/test_app.py:1251: AssertionError\n_______ test_overlay_component[State-default_overlay_component-Fragment] _______\n\nstate = <class 'reflex.state.State'>\noverlay_component = <function default_overlay_component at 0x7fe285cbc670>\nexp_page_child = <class 'reflex.components.base.fragment.Fragment'>\n\n    @pytest.mark.parametrize(\n        (\"state\", \"overlay_component\", \"exp_page_child\"),\n        [\n            (None, default_overlay_component, None),\n            (None, None, None),\n            (None, Text.create(\"foo\"), Text),\n            (State, default_overlay_component, Fragment),\n            (State, None, None),\n            (State, Text.create(\"foo\"), Text),\n            (State, lambda: Text.create(\"foo\"), Text),\n        ],\n    )\n    def test_overlay_component(\n        state: State | None,\n        overlay_component: Component | ComponentCallable | None,\n        exp_page_child: Type[Component] | None,\n    ):\n        \"\"\"Test that the overlay component is set correctly.\n    \n        Args:\n            state: The state class to pass to App.\n            overlay_component: The overlay_component to pass to App.\n            exp_page_child: The type of the expected child in the page fragment.\n        \"\"\"\n        app = App(state=state, overlay_component=overlay_component)\n        app._setup_overlay_component()\n        if exp_page_child is None:\n            assert app.overlay_component is None\n        elif isinstance(exp_page_child, OverlayFragment):\n            assert app.overlay_component is not None\n            generated_component = app._generate_component(app.overlay_component)  # type: ignore\n            assert isinstance(generated_component, OverlayFragment)\n            assert isinstance(\n                generated_component.children[0],\n                Cond,  # ConnectionModal is a Cond under the hood\n            )\n        else:\n            assert app.overlay_component is not None\n            assert isinstance(\n                app._generate_component(app.overlay_component),  # type: ignore\n                exp_page_child,\n            )\n    \n        app.add_page(rx.box(\"Index\"), route=\"/test\")\n        # overlay components are wrapped during compile only\n        app._setup_overlay_component()\n        page = app.pages[\"test\"]\n    \n        if exp_page_child is not None:\n>           assert len(page.children) == 3\nE           assert 2 == 3\nE            +  where 2 = len([{\"name\": \"RadixThemesBox\", \"props\": [], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{\"name\": \"\"...ge`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}])\nE            +    where [{\"name\": \"RadixThemesBox\", \"props\": [], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{\"name\": \"\"...ge`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}] = {\"name\": \"Fragment\", \"props\": [], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{\"name\": \"RadixThe...\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}], \"autofocus\": false}.children\n\ntests/test_app.py:1251: AssertionError\n____________ test_overlay_component[State-overlay_component5-Text] _____________\n\nstate = <class 'reflex.state.State'>\noverlay_component = {\"name\": \"RadixThemesText\", \"props\": [\"as={`p`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{..., \"contents\": \"{`foo`}\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}\nexp_page_child = <class 'reflex.components.radix.themes.typography.text.Text'>\n\n    @pytest.mark.parametrize(\n        (\"state\", \"overlay_component\", \"exp_page_child\"),\n        [\n            (None, default_overlay_component, None),\n            (None, None, None),\n            (None, Text.create(\"foo\"), Text),\n            (State, default_overlay_component, Fragment),\n            (State, None, None),\n            (State, Text.create(\"foo\"), Text),\n            (State, lambda: Text.create(\"foo\"), Text),\n        ],\n    )\n    def test_overlay_component(\n        state: State | None,\n        overlay_component: Component | ComponentCallable | None,\n        exp_page_child: Type[Component] | None,\n    ):\n        \"\"\"Test that the overlay component is set correctly.\n    \n        Args:\n            state: The state class to pass to App.\n            overlay_component: The overlay_component to pass to App.\n            exp_page_child: The type of the expected child in the page fragment.\n        \"\"\"\n        app = App(state=state, overlay_component=overlay_component)\n        app._setup_overlay_component()\n        if exp_page_child is None:\n            assert app.overlay_component is None\n        elif isinstance(exp_page_child, OverlayFragment):\n            assert app.overlay_component is not None\n            generated_component = app._generate_component(app.overlay_component)  # type: ignore\n            assert isinstance(generated_component, OverlayFragment)\n            assert isinstance(\n                generated_component.children[0],\n                Cond,  # ConnectionModal is a Cond under the hood\n            )\n        else:\n            assert app.overlay_component is not None\n            assert isinstance(\n                app._generate_component(app.overlay_component),  # type: ignore\n                exp_page_child,\n            )\n    \n        app.add_page(rx.box(\"Index\"), route=\"/test\")\n        # overlay components are wrapped during compile only\n        app._setup_overlay_component()\n        page = app.pages[\"test\"]\n    \n        if exp_page_child is not None:\n>           assert len(page.children) == 3\nE           assert 2 == 3\nE            +  where 2 = len([{\"name\": \"RadixThemesBox\", \"props\": [], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{\"name\": \"\"...ge`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}])\nE            +    where [{\"name\": \"RadixThemesBox\", \"props\": [], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{\"name\": \"\"...ge`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}] = {\"name\": \"Fragment\", \"props\": [], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{\"name\": \"RadixThe...\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}], \"autofocus\": false}.children\n\ntests/test_app.py:1251: AssertionError\n_________________ test_overlay_component[State-<lambda>-Text] __________________\n\nstate = <class 'reflex.state.State'>\noverlay_component = <function <lambda> at 0x7fe2395d3640>\nexp_page_child = <class 'reflex.components.radix.themes.typography.text.Text'>\n\n    @pytest.mark.parametrize(\n        (\"state\", \"overlay_component\", \"exp_page_child\"),\n        [\n            (None, default_overlay_component, None),\n            (None, None, None),\n            (None, Text.create(\"foo\"), Text),\n            (State, default_overlay_component, Fragment),\n            (State, None, None),\n            (State, Text.create(\"foo\"), Text),\n            (State, lambda: Text.create(\"foo\"), Text),\n        ],\n    )\n    def test_overlay_component(\n        state: State | None,\n        overlay_component: Component | ComponentCallable | None,\n        exp_page_child: Type[Component] | None,\n    ):\n        \"\"\"Test that the overlay component is set correctly.\n    \n        Args:\n            state: The state class to pass to App.\n            overlay_component: The overlay_component to pass to App.\n            exp_page_child: The type of the expected child in the page fragment.\n        \"\"\"\n        app = App(state=state, overlay_component=overlay_component)\n        app._setup_overlay_component()\n        if exp_page_child is None:\n            assert app.overlay_component is None\n        elif isinstance(exp_page_child, OverlayFragment):\n            assert app.overlay_component is not None\n            generated_component = app._generate_component(app.overlay_component)  # type: ignore\n            assert isinstance(generated_component, OverlayFragment)\n            assert isinstance(\n                generated_component.children[0],\n                Cond,  # ConnectionModal is a Cond under the hood\n            )\n        else:\n            assert app.overlay_component is not None\n            assert isinstance(\n                app._generate_component(app.overlay_component),  # type: ignore\n                exp_page_child,\n            )\n    \n        app.add_page(rx.box(\"Index\"), route=\"/test\")\n        # overlay components are wrapped during compile only\n        app._setup_overlay_component()\n        page = app.pages[\"test\"]\n    \n        if exp_page_child is not None:\n>           assert len(page.children) == 3\nE           assert 2 == 3\nE            +  where 2 = len([{\"name\": \"RadixThemesBox\", \"props\": [], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{\"name\": \"\"...ge`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}])\nE            +    where [{\"name\": \"RadixThemesBox\", \"props\": [], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{\"name\": \"\"...ge`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}] = {\"name\": \"Fragment\", \"props\": [], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{\"name\": \"RadixThe...\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}], \"autofocus\": false}.children\n\ntests/test_app.py:1251: AssertionError\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_app.py::test_overlay_component[None-default_overlay_component-None]\nFAILED tests/test_app.py::test_overlay_component[None-None-None] - assert <fu...\nFAILED tests/test_app.py::test_overlay_component[None-overlay_component2-Text]\nFAILED tests/test_app.py::test_overlay_component[State-default_overlay_component-Fragment]\nFAILED tests/test_app.py::test_overlay_component[State-overlay_component5-Text]\nFAILED tests/test_app.py::test_overlay_component[State-<lambda>-Text] - asser...\n=================== 6 failed, 1 passed, 5 warnings in 0.20s ====================\n\n"], "reflex-reflex/app.py-_compile": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 6 items\n\ntests/test_app.py FFFFFF                                                 [100%]\n\n=================================== FAILURES ===================================\n_________________________ test_app_wrap_compile_theme __________________________\n\ncompilable_app = (<App state=None>, PosixPath('/tmp/pytest-of-root/pytest-2564/test_app_wrap_compile_theme0/app/.web'))\n\n    def test_app_wrap_compile_theme(compilable_app: tuple[App, Path]):\n        \"\"\"Test that the radix theme component wraps the app.\n    \n        Args:\n            compilable_app: compilable_app fixture.\n        \"\"\"\n        app, web_dir = compilable_app\n        app.theme = rx.theme(accent_color=\"plum\")\n>       app._compile()\n\n/root/repos/py_data/reflex/tests/test_app.py:1289: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <App state=None>, export = False\n\n    def _compile(self, export: bool = False):\n        \"\"\"Compile the app and output it to the pages folder.\n    \n        Args:\n            export: Whether to compile the app for export.\n    \n        Raises:\n            ReflexRuntimeError: When any page uses state, but no rx.State subclass is defined.\n        \"\"\"\n        from reflex.compiler import compiler\n        from reflex.utils.exceptions import ReflexRuntimeError\n    \n        # Compile the app\n>       compiler.compile_app(self, export=export)\nE       TypeError: compile_app() got an unexpected keyword argument 'export'\n\n/root/repos/py_data/reflex/reflex/app.py:747: TypeError\n____________________ test_app_with_transpile_packages[True] ____________________\n\ncompilable_app = (<App state=None>, PosixPath('/tmp/pytest-of-root/pytest-2564/test_app_with_transpile_packag0/app/.web'))\nexport = True\n\n    @pytest.mark.parametrize(\"export\", (True, False))\n    def test_app_with_transpile_packages(compilable_app: tuple[App, Path], export: bool):\n        class C1(rx.Component):\n            library = \"foo@1.2.3\"\n            tag = \"Foo\"\n            transpile_packages: List[str] = [\"foo\"]\n    \n        class C2(rx.Component):\n            library = \"bar@4.5.6\"\n            tag = \"Bar\"\n            transpile_packages: List[str] = [\"bar@4.5.6\"]\n    \n        class C3(rx.NoSSRComponent):\n            library = \"baz@7.8.10\"\n            tag = \"Baz\"\n            transpile_packages: List[str] = [\"baz@7.8.9\"]\n    \n        class C4(rx.NoSSRComponent):\n            library = \"quuc@2.3.4\"\n            tag = \"Quuc\"\n            transpile_packages: List[str] = [\"quuc\"]\n    \n        class C5(rx.Component):\n            library = \"quuc\"\n            tag = \"Quuc\"\n    \n        app, web_dir = compilable_app\n        page = Fragment.create(\n            C1.create(), C2.create(), C3.create(), C4.create(), C5.create()\n        )\n        app.add_page(page, route=\"/\")\n>       app._compile(export=export)\n\n/root/repos/py_data/reflex/tests/test_app.py:1523: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <App state=None>, export = True\n\n    def _compile(self, export: bool = False):\n        \"\"\"Compile the app and output it to the pages folder.\n    \n        Args:\n            export: Whether to compile the app for export.\n    \n        Raises:\n            ReflexRuntimeError: When any page uses state, but no rx.State subclass is defined.\n        \"\"\"\n        from reflex.compiler import compiler\n        from reflex.utils.exceptions import ReflexRuntimeError\n    \n        # Compile the app\n>       compiler.compile_app(self, export=export)\nE       TypeError: compile_app() got an unexpected keyword argument 'export'\n\n/root/repos/py_data/reflex/reflex/app.py:747: TypeError\n___________________ test_app_with_transpile_packages[False] ____________________\n\ncompilable_app = (<App state=None>, PosixPath('/tmp/pytest-of-root/pytest-2564/test_app_with_transpile_packag1/app/.web'))\nexport = False\n\n    @pytest.mark.parametrize(\"export\", (True, False))\n    def test_app_with_transpile_packages(compilable_app: tuple[App, Path], export: bool):\n        class C1(rx.Component):\n            library = \"foo@1.2.3\"\n            tag = \"Foo\"\n            transpile_packages: List[str] = [\"foo\"]\n    \n        class C2(rx.Component):\n            library = \"bar@4.5.6\"\n            tag = \"Bar\"\n            transpile_packages: List[str] = [\"bar@4.5.6\"]\n    \n        class C3(rx.NoSSRComponent):\n            library = \"baz@7.8.10\"\n            tag = \"Baz\"\n            transpile_packages: List[str] = [\"baz@7.8.9\"]\n    \n        class C4(rx.NoSSRComponent):\n            library = \"quuc@2.3.4\"\n            tag = \"Quuc\"\n            transpile_packages: List[str] = [\"quuc\"]\n    \n        class C5(rx.Component):\n            library = \"quuc\"\n            tag = \"Quuc\"\n    \n        app, web_dir = compilable_app\n        page = Fragment.create(\n            C1.create(), C2.create(), C3.create(), C4.create(), C5.create()\n        )\n        app.add_page(page, route=\"/\")\n>       app._compile(export=export)\n\n/root/repos/py_data/reflex/tests/test_app.py:1523: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <App state=None>, export = False\n\n    def _compile(self, export: bool = False):\n        \"\"\"Compile the app and output it to the pages folder.\n    \n        Args:\n            export: Whether to compile the app for export.\n    \n        Raises:\n            ReflexRuntimeError: When any page uses state, but no rx.State subclass is defined.\n        \"\"\"\n        from reflex.compiler import compiler\n        from reflex.utils.exceptions import ReflexRuntimeError\n    \n        # Compile the app\n>       compiler.compile_app(self, export=export)\nE       TypeError: compile_app() got an unexpected keyword argument 'export'\n\n/root/repos/py_data/reflex/reflex/app.py:747: TypeError\n____________________________ test_app_wrap_priority ____________________________\n\ncompilable_app = (<App state=None>, PosixPath('/tmp/pytest-of-root/pytest-2564/test_app_wrap_priority0/app/.web'))\n\n    def test_app_wrap_priority(compilable_app: tuple[App, Path]):\n        \"\"\"Test that the app wrap components are wrapped in the correct order.\n    \n        Args:\n            compilable_app: compilable_app fixture.\n        \"\"\"\n        app, web_dir = compilable_app\n    \n        class Fragment1(Component):\n            tag = \"Fragment1\"\n    \n            def _get_app_wrap_components(self) -> dict[tuple[int, str], Component]:\n                return {(99, \"Box\"): rx.chakra.box()}\n    \n        class Fragment2(Component):\n            tag = \"Fragment2\"\n    \n            def _get_app_wrap_components(self) -> dict[tuple[int, str], Component]:\n                return {(50, \"Text\"): rx.chakra.text()}\n    \n        class Fragment3(Component):\n            tag = \"Fragment3\"\n    \n            def _get_app_wrap_components(self) -> dict[tuple[int, str], Component]:\n                return {(10, \"Fragment2\"): Fragment2.create()}\n    \n        def page():\n            return Fragment1.create(Fragment3.create())\n    \n        app.add_page(page)\n>       app._compile()\n\n/root/repos/py_data/reflex/tests/test_app.py:1339: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <App state=None>, export = False\n\n    def _compile(self, export: bool = False):\n        \"\"\"Compile the app and output it to the pages folder.\n    \n        Args:\n            export: Whether to compile the app for export.\n    \n        Raises:\n            ReflexRuntimeError: When any page uses state, but no rx.State subclass is defined.\n        \"\"\"\n        from reflex.compiler import compiler\n        from reflex.utils.exceptions import ReflexRuntimeError\n    \n        # Compile the app\n>       compiler.compile_app(self, export=export)\nE       TypeError: compile_app() got an unexpected keyword argument 'export'\n\n/root/repos/py_data/reflex/reflex/app.py:747: TypeError\n____________________ test_app_with_invalid_var_dependencies ____________________\n\ncompilable_app = (<App state=InvalidDepState>, PosixPath('/tmp/pytest-of-root/pytest-2564/test_app_with_invalid_var_depe0/app/.web'))\n\n    def test_app_with_invalid_var_dependencies(compilable_app: tuple[App, Path]):\n        app, _ = compilable_app\n    \n        class InvalidDepState(BaseState):\n            @computed_var(deps=[\"foolksjdf\"], cache=True)\n            def bar(self) -> str:\n                return \"bar\"\n    \n        app.state = InvalidDepState\n        with pytest.raises(exceptions.VarDependencyError):\n>           app._compile()\n\n/root/repos/py_data/reflex/tests/test_app.py:1573: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <App state=InvalidDepState>, export = False\n\n    def _compile(self, export: bool = False):\n        \"\"\"Compile the app and output it to the pages folder.\n    \n        Args:\n            export: Whether to compile the app for export.\n    \n        Raises:\n            ReflexRuntimeError: When any page uses state, but no rx.State subclass is defined.\n        \"\"\"\n        from reflex.compiler import compiler\n        from reflex.utils.exceptions import ReflexRuntimeError\n    \n        # Compile the app\n>       compiler.compile_app(self, export=export)\nE       TypeError: compile_app() got an unexpected keyword argument 'export'\n\n/root/repos/py_data/reflex/reflex/app.py:747: TypeError\n_____________________ test_app_with_valid_var_dependencies _____________________\n\ncompilable_app = (<App state=ValidDepState>, PosixPath('/tmp/pytest-of-root/pytest-2564/test_app_with_valid_var_depend0/app/.web'))\n\n    def test_app_with_valid_var_dependencies(compilable_app: tuple[App, Path]):\n        app, _ = compilable_app\n    \n        class ValidDepState(BaseState):\n            base: int = 0\n            _backend: int = 0\n    \n            @computed_var(cache=True)\n            def foo(self) -> str:\n                return \"foo\"\n    \n            @computed_var(deps=[\"_backend\", \"base\", foo], cache=True)\n            def bar(self) -> str:\n                return \"bar\"\n    \n        app.state = ValidDepState\n>       app._compile()\n\n/root/repos/py_data/reflex/tests/test_app.py:1560: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <App state=ValidDepState>, export = False\n\n    def _compile(self, export: bool = False):\n        \"\"\"Compile the app and output it to the pages folder.\n    \n        Args:\n            export: Whether to compile the app for export.\n    \n        Raises:\n            ReflexRuntimeError: When any page uses state, but no rx.State subclass is defined.\n        \"\"\"\n        from reflex.compiler import compiler\n        from reflex.utils.exceptions import ReflexRuntimeError\n    \n        # Compile the app\n>       compiler.compile_app(self, export=export)\nE       TypeError: compile_app() got an unexpected keyword argument 'export'\n\n/root/repos/py_data/reflex/reflex/app.py:747: TypeError\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_app.py::test_app_wrap_compile_theme - TypeError: compile_ap...\nFAILED tests/test_app.py::test_app_with_transpile_packages[True] - TypeError:...\nFAILED tests/test_app.py::test_app_with_transpile_packages[False] - TypeError...\nFAILED tests/test_app.py::test_app_wrap_priority - TypeError: compile_app() g...\nFAILED tests/test_app.py::test_app_with_invalid_var_dependencies - TypeError:...\nFAILED tests/test_app.py::test_app_with_valid_var_dependencies - TypeError: c...\n======================== 6 failed, 5 warnings in 0.31s =========================\n\n"], "reflex-reflex/app.py-modify_state": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 6 items\n\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n============================= 5 warnings in 0.23s ==============================\n\nERROR: not found: /root/repos/py_data/reflex/tests/test_state.py::_coro\n(no match in any of [<Module test_state.py>])\n\nERROR: not found: /root/repos/py_data/reflex/tests/test_state.py::_coro_waiter\n(no match in any of [<Module test_state.py>])\n\nERROR: not found: /root/repos/py_data/reflex/tests/test_state.py::_coro_blocker\n(no match in any of [<Module test_state.py>])\n\n"], "reflex-reflex/vars.py-create": ["\nImportError while loading conftest '/root/repos/py_data/reflex/tests/conftest.py'.\ntests/conftest.py:13: in <module>\n    from reflex.app import App\nreflex/app.py:44: in <module>\n    from reflex.compiler import compiler\nreflex/compiler/compiler.py:11: in <module>\n    from reflex.compiler import templates, utils\nreflex/compiler/utils.py:18: in <module>\n    from reflex.components.base import (\n/usr/local/lib/python3.10/site-packages/lazy_loader/__init__.py:82: in __getattr__\n    submod = importlib.import_module(submod_path)\nreflex/components/base/meta.py:7: in <module>\n    from reflex.components.base.bare import Bare\nreflex/components/base/bare.py:13: in <module>\n    class Bare(Component):\n/usr/local/lib/python3.10/site-packages/pydantic/v1/main.py:282: in __new__\n    cls = super().__new__(mcs, name, bases, new_namespace, **kwargs)\n/usr/local/lib/python3.10/abc.py:106: in __new__\n    cls = super().__new__(mcls, name, bases, namespace, **kwargs)\nreflex/components/component.py:322: in __init_subclass__\n    field.default = Var.create(\nreflex/vars.py:401: in create\n    name = format.format_var(value, _var_is_string)\nE   TypeError: format_var() takes 1 positional argument but 2 were given\n"], "reflex-reflex/vars.py-create_safe": ["\nImportError while loading conftest '/root/repos/py_data/reflex/tests/conftest.py'.\ntests/conftest.py:13: in <module>\n    from reflex.app import App\nreflex/app.py:54: in <module>\n    from reflex.components.core.banner import connection_pulser, connection_toaster\nreflex/components/core/banner.py:31: in <module>\n    connect_errors: Var = Var.create_safe(\nE   TypeError: Var.create_safe() got multiple values for argument 'value'\n"], "reflex-reflex/vars.py-foreach": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/components/core/test_foreach.py .                                  [100%]\n\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n======================== 1 passed, 5 warnings in 0.06s =========================\n\n"], "reflex-reflex/vars.py-get_default_value": ["\nImportError while loading conftest '/root/repos/py_data/reflex/tests/conftest.py'.\ntests/conftest.py:18: in <module>\n    from .states import (\ntests/states/__init__.py:7: in <module>\n    from .upload import (\ntests/states/upload.py:42: in <module>\n    class FileUploadState(State):\n/usr/local/lib/python3.10/site-packages/pydantic/v1/main.py:282: in __new__\n    cls = super().__new__(mcs, name, bases, new_namespace, **kwargs)\n/usr/local/lib/python3.10/abc.py:106: in __new__\n    cls = super().__new__(mcls, name, bases, namespace, **kwargs)\nreflex/state.py:516: in __init_subclass__\n    cls._init_var(prop)\nreflex/state.py:845: in _init_var\n    cls._set_default_value(prop)\nreflex/state.py:936: in _set_default_value\n    default_value = prop.get_default_value()\nreflex/vars.py:1861: in get_default_value\n    default_value = self._var_type()\n/usr/local/lib/python3.10/typing.py:941: in __call__\n    raise TypeError(f\"Type {self._name} cannot be instantiated; \"\nE   TypeError: Type List cannot be instantiated; use list() instead\n"], "reflex-reflex/state.py-get_skip_vars": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/test_state.py E                                                    [100%]\n\n==================================== ERRORS ====================================\n____________________ ERROR at setup of test_base_class_vars ____________________\n\n    @pytest.fixture\n    def test_state() -> TestState:\n        \"\"\"A state.\n    \n        Returns:\n            A test state.\n        \"\"\"\n>       return TestState()  # type: ignore\n\ntests/test_state.py:206: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nreflex/state.py:396: in __init__\n    self.substates[substate.get_name()] = substate(\nreflex/state.py:396: in __init__\n    self.substates[substate.get_name()] = substate(\nreflex/state.py:3079: in __setitem__\n    self._mark_dirty(super().__setitem__, args=(key, value))\nreflex/state.py:2949: in _mark_dirty\n    self._self_state.dirty_vars.add(self._self_field_name)\nreflex/state.py:2949: in _mark_dirty\n    self._self_state.dirty_vars.add(self._self_field_name)\nreflex/state.py:2949: in _mark_dirty\n    self._self_state.dirty_vars.add(self._self_field_name)\nreflex/state.py:2949: in _mark_dirty\n    self._self_state.dirty_vars.add(self._self_field_name)\nreflex/state.py:2949: in _mark_dirty\n    self._self_state.dirty_vars.add(self._self_field_name)\nreflex/state.py:2949: in _mark_dirty\n    self._self_state.dirty_vars.add(self._self_field_name)\nreflex/state.py:2949: in _mark_dirty\n    self._self_state.dirty_vars.add(self._self_field_name)\nreflex/state.py:2949: in _mark_dirty\n    self._self_state.dirty_vars.add(self._self_field_name)\nreflex/state.py:2949: in _mark_dirty\n    self._self_state.dirty_vars.add(self._self_field_name)\nreflex/state.py:2949: in _mark_dirty\n    self._self_state.dirty_vars.add(self._self_field_name)\nreflex/state.py:2949: in _mark_dirty\n    self._self_state.dirty_vars.add(self._self_field_name)\nreflex/state.py:2949: in _mark_dirty\n    self._self_state.dirty_vars.add(self._self_field_name)\nreflex/state.py:2949: in _mark_dirty\n    self._self_state.dirty_vars.add(self._self_field_name)\nreflex/state.py:2949: in _mark_dirty\n    self._self_state.dirty_vars.add(self._self_field_name)\nreflex/state.py:3024: in __getattr__\n    if isinstance(value, self.__mutable_types__) and __name not in (\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <class 'reflex.base.Base'>\ninstance = <FunctionWrapper at 0x7f1ecc1055a0 for builtin_function_or_method at 0x7f1ecc0e2b60>\n\n    def __instancecheck__(self, instance: Any) -> bool:\n        \"\"\"\n        Avoid calling ABC _abc_subclasscheck unless we're pretty sure.\n    \n        See #3829 and python/cpython#92810\n        \"\"\"\n>       return hasattr(instance, '__fields__') and super().__instancecheck__(instance)\nE       RecursionError: maximum recursion depth exceeded while calling a Python object\n\n/usr/local/lib/python3.10/site-packages/pydantic/v1/main.py:304: RecursionError\n!!! Recursion error detected, but an error occurred locating the origin of recursion.\n  The following exception happened when comparing locals in the stack frame:\n    RecursionError: maximum recursion depth exceeded while calling a Python object\n  Displaying first and last 10 stack frames out of 1480.\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nERROR tests/test_state.py::test_base_class_vars - RecursionError: maximum rec...\n========================= 5 warnings, 1 error in 0.68s =========================\n\n"], "reflex-reflex/state.py-add_var": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 3 items\n\ntests/test_state.py FF                                                   [ 66%]\ntests/test_app.py F                                                      [100%]\n\n=================================== FAILURES ===================================\n________________________ test_add_var_default_handlers _________________________\n\ntest_state = TestState({'test_state': {'array': [1, 2, 3.14], 'complex': {1: {'prop1': 42, 'prop2': 'hello'}, 2: {'prop1': 42, 'pro... ''}, 'test_state.child_state': {'count': 23, 'value': ''}, 'test_state.child_state.grandchild_state': {'value2': ''}})\n\n    def test_add_var_default_handlers(test_state):\n>       test_state.add_var(\"rand_int\", int, 10)\n\ntests/test_state.py:889: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nreflex/state.py:880: in add_var\n    cls._init_var(new_var)\nreflex/state.py:845: in _init_var\n    cls._set_default_value(prop)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'tests.test_state.TestState'>\nprop = BaseVar(_var_name='rand_int', _var_type=<class 'int'>, _var_is_local=False, _var_is_string=False, _var_full_name_needs...=True, transpile=False)]}, hooks={'const test_state = useContext(StateContexts.test_state)': None}, interpolations=[]))\n\n    @classmethod\n    def _set_default_value(cls, prop: BaseVar):\n        \"\"\"Set the default value for the var.\n    \n        Args:\n            prop: The var to set the default value for.\n        \"\"\"\n        # Get the pydantic field for the var.\n        field = cls.get_fields()[prop._var_name]\n>       if field.required:\nE       AttributeError: 'FieldInfo' object has no attribute 'required'\n\nreflex/state.py:931: AttributeError\n_________________________________ test_add_var _________________________________\n\n    def test_add_var():\n        class DynamicState(BaseState):\n            pass\n    \n        ds1 = DynamicState()\n        assert \"dynamic_int\" not in ds1.__dict__\n        assert not hasattr(ds1, \"dynamic_int\")\n>       ds1.add_var(\"dynamic_int\", int, 42)\n\ntests/test_state.py:867: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nreflex/state.py:880: in add_var\n    cls._init_var(new_var)\nreflex/state.py:845: in _init_var\n    cls._set_default_value(prop)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'tests.test_state.test_add_var.<locals>.DynamicState'>\nprop = BaseVar(_var_name='dynamic_int', _var_type=<class 'int'>, _var_is_local=False, _var_is_string=False, _var_full_name_ne... transpile=False)]}, hooks={'const dynamic_state = useContext(StateContexts.dynamic_state)': None}, interpolations=[]))\n\n    @classmethod\n    def _set_default_value(cls, prop: BaseVar):\n        \"\"\"Set the default value for the var.\n    \n        Args:\n            prop: The var to set the default value for.\n        \"\"\"\n        # Get the pydantic field for the var.\n        field = cls.get_fields()[prop._var_name]\n>       if field.required:\nE       AttributeError: 'FieldInfo' object has no attribute 'required'\n\nreflex/state.py:931: AttributeError\n____________________________ test_dynamic_var_event ____________________________\n\ntest_state = <class 'tests.test_app.ATestState'>\ntoken = 'dd7b0423-5b35-4a14-aed1-b2b097fae43c'\n\n    @pytest.mark.asyncio\n    async def test_dynamic_var_event(test_state: Type[ATestState], token: str):\n        \"\"\"Test that the default handler of a dynamic generated var\n        works as expected.\n    \n        Args:\n            test_state: State Fixture.\n            token: a Token.\n        \"\"\"\n        state = test_state()  # type: ignore\n>       state.add_var(\"int_val\", int, 0)\n\ntests/test_app.py:467: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nreflex/state.py:880: in add_var\n    cls._init_var(new_var)\nreflex/state.py:845: in _init_var\n    cls._set_default_value(prop)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'tests.test_app.ATestState'>\nprop = BaseVar(_var_name='int_val', _var_type=<class 'int'>, _var_is_local=False, _var_is_string=False, _var_full_name_needs_...e, transpile=False)]}, hooks={'const a_test_state = useContext(StateContexts.a_test_state)': None}, interpolations=[]))\n\n    @classmethod\n    def _set_default_value(cls, prop: BaseVar):\n        \"\"\"Set the default value for the var.\n    \n        Args:\n            prop: The var to set the default value for.\n        \"\"\"\n        # Get the pydantic field for the var.\n        field = cls.get_fields()[prop._var_name]\n>       if field.required:\nE       AttributeError: 'FieldInfo' object has no attribute 'required'\n\nreflex/state.py:931: AttributeError\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_state.py::test_add_var_default_handlers - AttributeError: '...\nFAILED tests/test_state.py::test_add_var - AttributeError: 'FieldInfo' object...\nFAILED tests/test_app.py::test_dynamic_var_event - AttributeError: 'FieldInfo...\n======================== 3 failed, 5 warnings in 0.71s =========================\n\n"], "reflex-reflex/state.py-reset": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 2 items\n\ntests/test_state.py FF                                                   [100%]\n\n=================================== FAILURES ===================================\n__________________________________ test_reset __________________________________\n\ntest_state = TestState({'test_state': {'array': [1, 2, 3.14], 'complex': {1: {'prop1': 42, 'prop2': 'hello'}, 2: {'prop1': 42, 'pro..., 'test_state.child_state': {'count': 23, 'value': 'test'}, 'test_state.child_state.grandchild_state': {'value2': ''}})\nchild_state = ChildState({'test_state.child_state': {'count': 23, 'value': 'test'}, 'test_state.child_state.grandchild_state': {'value2': ''}})\n\n    def test_reset(test_state, child_state):\n        \"\"\"Test resetting the state.\n    \n        Args:\n            test_state: A state.\n            child_state: A child state.\n        \"\"\"\n        # Set some values.\n        test_state.num1 = 1\n        test_state.num2 = 2\n        child_state.value = \"test\"\n    \n        # Reset the state.\n>       test_state.reset()\n\ntests/test_state.py:673: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nreflex/state.py:1098: in reset\n    if field_name not in self._non_default_attributes:\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = TestState({'test_state': {'array': [1, 2, 3.14], 'complex': {1: {'prop1': 42, 'prop2': 'hello'}, 2: {'prop1': 42, 'pro..., 'test_state.child_state': {'count': 23, 'value': 'test'}, 'test_state.child_state.grandchild_state': {'value2': ''}})\nname = '_non_default_attributes'\n\n    def __getattribute__(self, name: str) -> Any:\n        \"\"\"Get the state var.\n    \n        If the var is inherited, get the var from the parent state.\n    \n        Args:\n            name: The name of the var.\n    \n        Returns:\n            The value of the var.\n        \"\"\"\n        # If the state hasn't been initialized yet, return the default value.\n        if not super().__getattribute__(\"__dict__\"):\n            return super().__getattribute__(name)\n    \n        inherited_vars = {\n            **super().__getattribute__(\"inherited_vars\"),\n            **super().__getattribute__(\"inherited_backend_vars\"),\n        }\n    \n        # For now, handle router_data updates as a special case.\n        if name in inherited_vars or name == constants.ROUTER_DATA:\n            parent_state = super().__getattribute__(\"parent_state\")\n            if parent_state is not None:\n                return getattr(parent_state, name)\n    \n        # Allow event handlers to be called on the instance directly.\n        event_handlers = super().__getattribute__(\"event_handlers\")\n        if name in event_handlers:\n            handler = event_handlers[name]\n            if handler.is_background:\n                fn = _no_chain_background_task(type(self), name, handler.fn)\n            else:\n                fn = functools.partial(handler.fn, self)\n            fn.__module__ = handler.fn.__module__  # type: ignore\n            fn.__qualname__ = handler.fn.__qualname__  # type: ignore\n            return fn\n    \n        backend_vars = super().__getattribute__(\"_backend_vars\")\n        if name in backend_vars:\n            value = backend_vars[name]\n        else:\n>           value = super().__getattribute__(name)\nE           AttributeError: 'TestState' object has no attribute '_non_default_attributes'\n\nreflex/state.py:1040: AttributeError\n___________________________ test_reset_with_mutables ___________________________\n\n    def test_reset_with_mutables():\n        \"\"\"Calling reset should always reset fields to a copy of the defaults.\"\"\"\n        default = [[0, 0], [0, 1], [1, 1]]\n        copied_default = copy.deepcopy(default)\n    \n        class MutableResetState(BaseState):\n            items: List[List[int]] = default\n    \n        instance = MutableResetState()\n        assert instance.items.__wrapped__ is not default  # type: ignore\n        assert instance.items == default == copied_default\n        instance.items.append([3, 3])\n        assert instance.items != default\n        assert instance.items != copied_default\n    \n>       instance.reset()\n\ntests/test_state.py:2418: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nreflex/state.py:1098: in reset\n    if field_name not in self._non_default_attributes:\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MutableResetState({'mutable_reset_state': {'items': [[0, 0], [0, 1], [1, 1], [3, 3]], 'router': {'session': {'client_t...anguage': ''}, 'page': {'host': '', 'path': '', 'raw_path': '', 'full_path': '', 'full_raw_path': '', 'params': {}}}}})\nname = '_non_default_attributes'\n\n    def __getattribute__(self, name: str) -> Any:\n        \"\"\"Get the state var.\n    \n        If the var is inherited, get the var from the parent state.\n    \n        Args:\n            name: The name of the var.\n    \n        Returns:\n            The value of the var.\n        \"\"\"\n        # If the state hasn't been initialized yet, return the default value.\n        if not super().__getattribute__(\"__dict__\"):\n            return super().__getattribute__(name)\n    \n        inherited_vars = {\n            **super().__getattribute__(\"inherited_vars\"),\n            **super().__getattribute__(\"inherited_backend_vars\"),\n        }\n    \n        # For now, handle router_data updates as a special case.\n        if name in inherited_vars or name == constants.ROUTER_DATA:\n            parent_state = super().__getattribute__(\"parent_state\")\n            if parent_state is not None:\n                return getattr(parent_state, name)\n    \n        # Allow event handlers to be called on the instance directly.\n        event_handlers = super().__getattribute__(\"event_handlers\")\n        if name in event_handlers:\n            handler = event_handlers[name]\n            if handler.is_background:\n                fn = _no_chain_background_task(type(self), name, handler.fn)\n            else:\n                fn = functools.partial(handler.fn, self)\n            fn.__module__ = handler.fn.__module__  # type: ignore\n            fn.__qualname__ = handler.fn.__qualname__  # type: ignore\n            return fn\n    \n        backend_vars = super().__getattribute__(\"_backend_vars\")\n        if name in backend_vars:\n            value = backend_vars[name]\n        else:\n>           value = super().__getattribute__(name)\nE           AttributeError: 'MutableResetState' object has no attribute '_non_default_attributes'\n\nreflex/state.py:1040: AttributeError\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_state.py::test_reset - AttributeError: 'TestState' object h...\nFAILED tests/test_state.py::test_reset_with_mutables - AttributeError: 'Mutab...\n======================== 2 failed, 5 warnings in 0.58s =========================\n\n"], "reflex-reflex/state.py-get_state": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 18 items\n\ntests/test_state.py .s.s.s                                               [ 33%]\ntests/test_state_tree.py sssssssss                                       [ 83%]\ntests/test_state.py s.s                                                  [100%]\n\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n================== 4 passed, 14 skipped, 5 warnings in 0.75s ===================\n\n"], "reflex-reflex/state.py-_process": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 21 items\n\ntests/test_app.py ...........                                            [ 52%]\ntests/test_state.py .........s                                           [100%]\n\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n================== 20 passed, 1 skipped, 5 warnings in 0.57s ===================\n\n"], "reflex-reflex/state.py-_dirty_computed_vars": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/test_state.py .                                                    [100%]\n\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n======================== 1 passed, 5 warnings in 0.25s =========================\n\n"], "reflex-reflex/state.py-_potentially_dirty_substates": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/test_state.py F                                                    [100%]\n\n=================================== FAILURES ===================================\n_______________________ test_potentially_dirty_substates _______________________\n\n    def test_potentially_dirty_substates():\n        \"\"\"Test that potentially_dirty_substates returns the correct substates.\n    \n        Even if the name \"State\" is shadowed, it should still work correctly.\n        \"\"\"\n    \n        class State(RxState):\n            @ComputedVar\n            def foo(self) -> str:\n                return \"\"\n    \n        class C1(State):\n            @ComputedVar\n            def bar(self) -> str:\n                return \"\"\n    \n>       assert RxState._potentially_dirty_substates() == {State}\n\ntests/test_state.py:2930: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'reflex.state.State'>\n\n    @classmethod\n    def _potentially_dirty_substates(cls) -> set[Type[BaseState]]:\n        \"\"\"Determine substates which could be affected by dirty vars in this state.\n    \n        Returns:\n            Set of State classes that may need to be fetched to recalc computed vars.\n        \"\"\"\n        potentially_dirty = set()\n        for substate in cls.get_substates():\n            if substate.get_name() in cls._always_dirty_substates:\n                potentially_dirty.add(substate)\n            else:\n>               for var in cls.dirty_vars:\nE               AttributeError: type object 'State' has no attribute 'dirty_vars'\n\nreflex/state.py:1558: AttributeError\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_state.py::test_potentially_dirty_substates - AttributeError...\n======================== 1 failed, 5 warnings in 0.46s =========================\n\n"], "reflex-reflex/state.py-get_delta": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 15 items\n\ntests/test_state.py FFF                                                  [ 20%]\ntests/test_state_tree.py sssssssss                                       [ 80%]\ntests/test_state.py FFs                                                  [100%]\n\n=================================== FAILURES ===================================\n_______________________ test_dirty_computed_var_from_var _______________________\n\ninterdependent_state = InterdependentState({'interdependent_state': {'router': {'session': {'client_token': '', 'client_ip': '', 'session_id'... 'full_path': '', 'full_raw_path': '', 'params': {}}}, 'v1': 1, 'v1x2': 2, 'v1x2x2': 4, 'v2x2': 2, 'v3x2': 2, 'x': 0}})\n\n    def test_dirty_computed_var_from_var(interdependent_state: InterdependentState) -> None:\n        \"\"\"Set Var that ComputedVar depends on, expect recalculation.\n    \n        The other ComputedVar depends on the changed ComputedVar and should also be\n        recalculated. No other ComputedVars should be recalculated.\n    \n        Args:\n            interdependent_state: A state with varying Var dependencies.\n        \"\"\"\n        interdependent_state.v1 = 1\n>       assert interdependent_state.get_delta() == {\n            interdependent_state.get_full_name(): {\"v1\": 1, \"v1x2\": 2, \"v1x2x2\": 4},\n        }\nE       AssertionError: assert {'v1': 1, 'v1..., 'v1x2x2': 4} == {'interdepend... 'v1x2x2': 4}}\nE         \nE         Left contains 3 more items:\nE         {'v1': 1, 'v1x2': 2, 'v1x2x2': 4}\nE         Right contains 1 more item:\nE         {'interdependent_state': {'v1': 1, 'v1x2': 2, 'v1x2x2': 4}}\nE         Use -v to get more diff\n\ntests/test_state.py:1001: AssertionError\n___________________ test_dirty_computed_var_from_backend_var ___________________\n\ninterdependent_state = InterdependentState({'interdependent_state': {'router': {'session': {'client_token': '', 'client_ip': '', 'session_id'... 'full_path': '', 'full_raw_path': '', 'params': {}}}, 'v1': 0, 'v1x2': 0, 'v1x2x2': 0, 'v2x2': 4, 'v3x2': 4, 'x': 0}})\n\n    def test_dirty_computed_var_from_backend_var(\n        interdependent_state: InterdependentState,\n    ) -> None:\n        \"\"\"Set backend var that ComputedVar depends on, expect recalculation.\n    \n        Args:\n            interdependent_state: A state with varying Var dependencies.\n        \"\"\"\n        assert InterdependentState._v3._backend is True\n        interdependent_state._v2 = 2\n>       assert interdependent_state.get_delta() == {\n            interdependent_state.get_full_name(): {\"v2x2\": 4, \"v3x2\": 4},\n        }\nE       AssertionError: assert {'_v3': 2, 'v... 4, 'v3x2': 4} == {'interdepend...4, 'v3x2': 4}}\nE         \nE         Left contains 4 more items:\nE         {'_v3': 2, 'v2x2': 4, 'v2x2_backend': 4, 'v3x2': 4}\nE         Right contains 1 more item:\nE         {'interdependent_state': {'v2x2': 4, 'v3x2': 4}}\nE         Use -v to get more diff\n\ntests/test_state.py:1016: AssertionError\n_____________________ test_not_dirty_computed_var_from_var _____________________\n\ninterdependent_state = InterdependentState({'interdependent_state': {'router': {'session': {'client_token': '', 'client_ip': '', 'session_id'... 'full_path': '', 'full_raw_path': '', 'params': {}}}, 'v1': 0, 'v1x2': 0, 'v1x2x2': 0, 'v2x2': 2, 'v3x2': 2, 'x': 5}})\n\n    def test_not_dirty_computed_var_from_var(\n        interdependent_state: InterdependentState,\n    ) -> None:\n        \"\"\"Set Var that no ComputedVar depends on, expect no recalculation.\n    \n        Args:\n            interdependent_state: A state with varying Var dependencies.\n        \"\"\"\n        interdependent_state.x = 5\n>       assert interdependent_state.get_delta() == {\n            interdependent_state.get_full_name(): {\"x\": 5},\n        }\nE       AssertionError: assert {'x': 5} == {'interdepend...te': {'x': 5}}\nE         \nE         Left contains 1 more item:\nE         {'x': 5}\nE         Right contains 1 more item:\nE         {'interdependent_state': {'x': 5}}\nE         Use -v to get more diff\n\ntests/test_state.py:986: AssertionError\n________________ test_computed_var_cached_depends_on_non_cached ________________\n\n    def test_computed_var_cached_depends_on_non_cached():\n        \"\"\"Test that a cached var is recalculated if it depends on non-cached ComputedVar.\"\"\"\n    \n        class ComputedState(BaseState):\n            v: int = 0\n    \n            @rx.var\n            def no_cache_v(self) -> int:\n                return self.v\n    \n            @rx.var(cache=True)\n            def dep_v(self) -> int:\n                return self.no_cache_v  # type: ignore\n    \n            @rx.var(cache=True)\n            def comp_v(self) -> int:\n                return self.v\n    \n        cs = ComputedState()\n        assert cs.dirty_vars == set()\n>       assert cs.get_delta() == {cs.get_name(): {\"no_cache_v\": 0, \"dep_v\": 0}}\nE       AssertionError: assert {} == {'computed_st..._cache_v': 0}}\nE         \nE         Right contains 1 more item:\nE         {'computed_state': {'dep_v': 0, 'no_cache_v': 0}}\nE         Use -v to get more diff\n\ntests/test_state.py:1183: AssertionError\n__________________________ test_get_state[in_process] __________________________\n\nmock_app = <App state=TestState>, token = '56c26dcd-a3ac-417c-8da6-e46a2b8f6e94'\n\n    @pytest.mark.asyncio\n    async def test_get_state(mock_app: rx.App, token: str):\n        \"\"\"Test that a get_state populates the top level state and delta calculation is correct.\n    \n        Args:\n            mock_app: An app that will be returned by `get_app()`\n            token: A token.\n        \"\"\"\n        mock_app.state_manager.state = mock_app.state = TestState\n    \n        # Get instance of ChildState2.\n        test_state = await mock_app.state_manager.get_state(\n            _substate_key(token, ChildState2)\n        )\n        assert isinstance(test_state, TestState)\n        if isinstance(mock_app.state_manager, StateManagerMemory):\n            # All substates are available\n            assert tuple(sorted(test_state.substates)) == (\n                \"child_state\",\n                \"child_state2\",\n                \"child_state3\",\n            )\n        else:\n            # Sibling states are only populated if they have computed vars\n            assert tuple(sorted(test_state.substates)) == (\"child_state2\", \"child_state3\")\n    \n        # Because ChildState3 has a computed var, it is always dirty, and always populated.\n        assert (\n            test_state.substates[\"child_state3\"].substates[\"grandchild_state3\"].computed\n            == \"\"\n        )\n    \n        # Get the child_state2 directly.\n        child_state2_direct = test_state.get_substate([\"child_state2\"])\n        child_state2_get_state = await test_state.get_state(ChildState2)\n        # These should be the same object.\n        assert child_state2_direct is child_state2_get_state\n    \n        # Get arbitrary GrandchildState.\n        grandchild_state = await child_state2_get_state.get_state(GrandchildState)\n        assert isinstance(grandchild_state, GrandchildState)\n    \n        # Now the original root should have all substates populated.\n        assert tuple(sorted(test_state.substates)) == (\n            \"child_state\",\n            \"child_state2\",\n            \"child_state3\",\n        )\n    \n        # ChildState should be retrievable\n        child_state_direct = test_state.get_substate([\"child_state\"])\n        child_state_get_state = await test_state.get_state(ChildState)\n        # These should be the same object.\n        assert child_state_direct is child_state_get_state\n    \n        # GrandchildState instance should be the same as the one retrieved from the child_state2.\n        assert grandchild_state is child_state_direct.get_substate([\"grandchild_state\"])\n        grandchild_state.value2 = \"set_value\"\n    \n>       assert test_state.get_delta() == {\n            TestState.get_full_name(): {\n                \"sum\": 3.14,\n                \"upper\": \"\",\n            },\n            GrandchildState.get_full_name(): {\n                \"value2\": \"set_value\",\n            },\n            GrandchildState3.get_full_name(): {\n                \"computed\": \"\",\n            },\n        }\nE       AssertionError: assert {'child_state...'set_value'}}} == {'test_state'...omputed': ''}}\nE         \nE         Left contains 1 more item:\nE         {'child_state': {'grandchild_state': {'value2': 'set_value'}}}\nE         Right contains 3 more items:\nE         {'test_state': {'sum': 3.14, 'upper': ''},\nE          'test_state.child_state.grandchild_state': {'value2': 'set_value'},\nE          'test_state.child_state3.grandchild_state3': {'computed': ''}}\nE         Use -v to get more diff\n\ntests/test_state.py:2759: AssertionError\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_state.py::test_dirty_computed_var_from_var - AssertionError...\nFAILED tests/test_state.py::test_dirty_computed_var_from_backend_var - Assert...\nFAILED tests/test_state.py::test_not_dirty_computed_var_from_var - AssertionE...\nFAILED tests/test_state.py::test_computed_var_cached_depends_on_non_cached - ...\nFAILED tests/test_state.py::test_get_state[in_process] - AssertionError: asse...\n================== 5 failed, 10 skipped, 5 warnings in 0.66s ===================\n\n"], "reflex-reflex/model.py-get_db_engine": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 2 items\n\ntests/test_model.py F                                                    [ 50%]\ntests/test_sqlalchemy.py F                                               [100%]\n\n=================================== FAILURES ===================================\n______________________________ test_automigration ______________________________\n\ntmp_working_dir = PosixPath('/tmp/pytest-of-root/pytest-2565/test_automigration0/working_dir')\nmonkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x7fa977b24eb0>\nmodel_registry = <class 'reflex.model.ModelRegistry'>\n\n    @pytest.mark.filterwarnings(\n        \"ignore:This declarative base already contains a class with the same class name\",\n    )\n    def test_automigration(\n        tmp_working_dir: Path,\n        monkeypatch: pytest.MonkeyPatch,\n        model_registry: Type[ModelRegistry],\n    ):\n        \"\"\"Test alembic automigration with add and drop table and column.\n    \n        Args:\n            tmp_working_dir: directory where database and migrations are stored\n            monkeypatch: pytest fixture to overwrite attributes\n            model_registry: clean reflex ModelRegistry\n        \"\"\"\n        alembic_ini = tmp_working_dir / \"alembic.ini\"\n        versions = tmp_working_dir / \"alembic\" / \"versions\"\n        monkeypatch.setattr(reflex.constants, \"ALEMBIC_CONFIG\", str(alembic_ini))\n    \n        config_mock = mock.Mock()\n        config_mock.db_url = f\"sqlite:///{tmp_working_dir}/reflex.db\"\n        monkeypatch.setattr(reflex.model, \"get_config\", mock.Mock(return_value=config_mock))\n    \n        Model.alembic_init()\n        assert alembic_ini.exists()\n        assert versions.exists()\n    \n        # initial table\n        class AlembicThing(Model, table=True):  # type: ignore\n            t1: str\n    \n>       with Model.get_db_engine().connect() as connection:\nE       TypeError: Model.get_db_engine() missing 1 required positional argument: 'self'\n\n/root/repos/py_data/reflex/tests/test_model.py:92: TypeError\n----------------------------- Captured stdout call -----------------------------\nCreating directory '/tmp/pytest-of-root/pytest-2565/test_automigration0/working_dir/alembic' ...  done\nCreating directory '/tmp/pytest-of-root/pytest-2565/test_automigration0/working_dir/alembic/versions' ...  done\nGenerating /tmp/pytest-of-root/pytest-2565/test_automigration0/working_dir/alembic.ini ...  done\nGenerating /tmp/pytest-of-root/pytest-2565/test_automigration0/working_dir/alembic/script.py.mako ...  done\nGenerating /tmp/pytest-of-root/pytest-2565/test_automigration0/working_dir/alembic/env.py ...  done\nGenerating /tmp/pytest-of-root/pytest-2565/test_automigration0/working_dir/alembic/README ...  done\nPlease edit configuration/connection/logging settings in '/tmp/pytest-of-root/pytest-2565/test_automigration0/working_dir/alembic.ini' before proceeding.\n______________________________ test_automigration ______________________________\n\ntmp_working_dir = PosixPath('/tmp/pytest-of-root/pytest-2565/test_automigration1/working_dir')\nmonkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x7fa977cd1a50>\nmodel_registry = <class 'reflex.model.ModelRegistry'>\n\n    @pytest.mark.filterwarnings(\n        \"ignore:This declarative base already contains a class with the same class name\",\n    )\n    def test_automigration(\n        tmp_working_dir: Path,\n        monkeypatch: pytest.MonkeyPatch,\n        model_registry: Type[ModelRegistry],\n    ):\n        \"\"\"Test alembic automigration with add and drop table and column.\n    \n        Args:\n            tmp_working_dir: directory where database and migrations are stored\n            monkeypatch: pytest fixture to overwrite attributes\n            model_registry: clean reflex ModelRegistry\n        \"\"\"\n        alembic_ini = tmp_working_dir / \"alembic.ini\"\n        versions = tmp_working_dir / \"alembic\" / \"versions\"\n        monkeypatch.setattr(reflex.constants, \"ALEMBIC_CONFIG\", str(alembic_ini))\n    \n        config_mock = mock.Mock()\n        config_mock.db_url = f\"sqlite:///{tmp_working_dir}/reflex.db\"\n        monkeypatch.setattr(reflex.model, \"get_config\", mock.Mock(return_value=config_mock))\n    \n        assert alembic_ini.exists() is False\n        assert versions.exists() is False\n        Model.alembic_init()\n        assert alembic_ini.exists()\n        assert versions.exists()\n    \n        class Base(DeclarativeBase):\n            @declared_attr.directive\n            def __tablename__(cls) -> str:\n                return cls.__name__.lower()\n    \n        assert model_registry.register(Base)\n    \n        class ModelBase(Base, MappedAsDataclass):\n            __abstract__ = True\n            id: Mapped[Optional[int]] = mapped_column(primary_key=True, default=None)\n    \n        # initial table\n        class AlembicThing(ModelBase):  # pyright: ignore[reportGeneralTypeIssues]\n            t1: Mapped[str] = mapped_column(default=\"\")\n    \n>       with Model.get_db_engine().connect() as connection:\nE       TypeError: Model.get_db_engine() missing 1 required positional argument: 'self'\n\n/root/repos/py_data/reflex/tests/test_sqlalchemy.py:65: TypeError\n----------------------------- Captured stdout call -----------------------------\nCreating directory '/tmp/pytest-of-root/pytest-2565/test_automigration1/working_dir/alembic' ...  done\nCreating directory '/tmp/pytest-of-root/pytest-2565/test_automigration1/working_dir/alembic/versions' ...  done\nGenerating /tmp/pytest-of-root/pytest-2565/test_automigration1/working_dir/alembic.ini ...  done\nGenerating /tmp/pytest-of-root/pytest-2565/test_automigration1/working_dir/alembic/script.py.mako ...  done\nGenerating /tmp/pytest-of-root/pytest-2565/test_automigration1/working_dir/alembic/env.py ...  done\nGenerating /tmp/pytest-of-root/pytest-2565/test_automigration1/working_dir/alembic/README ...  done\nPlease edit configuration/connection/logging settings in '/tmp/pytest-of-root/pytest-2565/test_automigration1/working_dir/alembic.ini' before proceeding.\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_model.py::test_automigration - TypeError: Model.get_db_engi...\nFAILED tests/test_sqlalchemy.py::test_automigration - TypeError: Model.get_db...\n======================== 2 failed, 5 warnings in 0.12s =========================\n\n"], "reflex-reflex/model.py-alembic_autogenerate": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 2 items\n\ntests/test_model.py F                                                    [ 50%]\ntests/test_sqlalchemy.py F                                               [100%]\n\n=================================== FAILURES ===================================\n______________________________ test_automigration ______________________________\n\ntmp_working_dir = PosixPath('/tmp/pytest-of-root/pytest-2566/test_automigration0/working_dir')\nmonkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x7f586eb20fa0>\nmodel_registry = <class 'reflex.model.ModelRegistry'>\n\n    @pytest.mark.filterwarnings(\n        \"ignore:This declarative base already contains a class with the same class name\",\n    )\n    def test_automigration(\n        tmp_working_dir: Path,\n        monkeypatch: pytest.MonkeyPatch,\n        model_registry: Type[ModelRegistry],\n    ):\n        \"\"\"Test alembic automigration with add and drop table and column.\n    \n        Args:\n            tmp_working_dir: directory where database and migrations are stored\n            monkeypatch: pytest fixture to overwrite attributes\n            model_registry: clean reflex ModelRegistry\n        \"\"\"\n        alembic_ini = tmp_working_dir / \"alembic.ini\"\n        versions = tmp_working_dir / \"alembic\" / \"versions\"\n        monkeypatch.setattr(reflex.constants, \"ALEMBIC_CONFIG\", str(alembic_ini))\n    \n        config_mock = mock.Mock()\n        config_mock.db_url = f\"sqlite:///{tmp_working_dir}/reflex.db\"\n        monkeypatch.setattr(reflex.model, \"get_config\", mock.Mock(return_value=config_mock))\n    \n        Model.alembic_init()\n        assert alembic_ini.exists()\n        assert versions.exists()\n    \n        # initial table\n        class AlembicThing(Model, table=True):  # type: ignore\n            t1: str\n    \n        with Model.get_db_engine().connect() as connection:\n>           assert Model.alembic_autogenerate(\n                connection=connection, message=\"Initial Revision\"\n            )\n\n/root/repos/py_data/reflex/tests/test_model.py:93: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <class 'reflex.model.Model'>\nconnection = <sqlalchemy.engine.base.Connection object at 0x7f586eb217b0>\nmessage = 'Initial Revision', write_migration_scripts = True\n\n    @classmethod\n    def alembic_autogenerate(\n        self,\n        connection: Any,\n        message: Optional[str] = None,\n        write_migration_scripts: bool = True,\n    ) -> bool:\n        \"\"\"Generate migration scripts for alembic-detectable changes.\n    \n        Args:\n            connection: SQLAlchemy connection to use when detecting changes.\n            message: Human readable identifier describing the generated revision.\n            write_migration_scripts: If True, write autogenerated revisions to script directory.\n    \n        Returns:\n            True when changes have been detected.\n        \"\"\"\n        from alembic.autogenerate import compare_metadata\n        from alembic.migration import MigrationContext\n        from alembic.operations import Operations\n    \n        context = MigrationContext.configure(connection)\n        metadata = self.metadata\n    \n        diff = compare_metadata(context, metadata)\n    \n        if not diff:\n            return False\n    \n        if write_migration_scripts:\n            op = Operations(context)\n>           revision = context.revision(message)\nE           AttributeError: 'MigrationContext' object has no attribute 'revision'\n\n/root/repos/py_data/reflex/reflex/model.py:286: AttributeError\n----------------------------- Captured stdout call -----------------------------\nCreating directory '/tmp/pytest-of-root/pytest-2566/test_automigration0/working_dir/alembic' ...  done\nCreating directory '/tmp/pytest-of-root/pytest-2566/test_automigration0/working_dir/alembic/versions' ...  done\nGenerating /tmp/pytest-of-root/pytest-2566/test_automigration0/working_dir/alembic.ini ...  done\nGenerating /tmp/pytest-of-root/pytest-2566/test_automigration0/working_dir/alembic/script.py.mako ...  done\nGenerating /tmp/pytest-of-root/pytest-2566/test_automigration0/working_dir/alembic/env.py ...  done\nGenerating /tmp/pytest-of-root/pytest-2566/test_automigration0/working_dir/alembic/README ...  done\nPlease edit configuration/connection/logging settings in '/tmp/pytest-of-root/pytest-2566/test_automigration0/working_dir/alembic.ini' before proceeding.\n______________________________ test_automigration ______________________________\n\ntmp_working_dir = PosixPath('/tmp/pytest-of-root/pytest-2566/test_automigration1/working_dir')\nmonkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x7f586eae7a00>\nmodel_registry = <class 'reflex.model.ModelRegistry'>\n\n    @pytest.mark.filterwarnings(\n        \"ignore:This declarative base already contains a class with the same class name\",\n    )\n    def test_automigration(\n        tmp_working_dir: Path,\n        monkeypatch: pytest.MonkeyPatch,\n        model_registry: Type[ModelRegistry],\n    ):\n        \"\"\"Test alembic automigration with add and drop table and column.\n    \n        Args:\n            tmp_working_dir: directory where database and migrations are stored\n            monkeypatch: pytest fixture to overwrite attributes\n            model_registry: clean reflex ModelRegistry\n        \"\"\"\n        alembic_ini = tmp_working_dir / \"alembic.ini\"\n        versions = tmp_working_dir / \"alembic\" / \"versions\"\n        monkeypatch.setattr(reflex.constants, \"ALEMBIC_CONFIG\", str(alembic_ini))\n    \n        config_mock = mock.Mock()\n        config_mock.db_url = f\"sqlite:///{tmp_working_dir}/reflex.db\"\n        monkeypatch.setattr(reflex.model, \"get_config\", mock.Mock(return_value=config_mock))\n    \n        assert alembic_ini.exists() is False\n        assert versions.exists() is False\n        Model.alembic_init()\n        assert alembic_ini.exists()\n        assert versions.exists()\n    \n        class Base(DeclarativeBase):\n            @declared_attr.directive\n            def __tablename__(cls) -> str:\n                return cls.__name__.lower()\n    \n        assert model_registry.register(Base)\n    \n        class ModelBase(Base, MappedAsDataclass):\n            __abstract__ = True\n            id: Mapped[Optional[int]] = mapped_column(primary_key=True, default=None)\n    \n        # initial table\n        class AlembicThing(ModelBase):  # pyright: ignore[reportGeneralTypeIssues]\n            t1: Mapped[str] = mapped_column(default=\"\")\n    \n        with Model.get_db_engine().connect() as connection:\n>           assert Model.alembic_autogenerate(\n                connection=connection, message=\"Initial Revision\"\n            )\n\n/root/repos/py_data/reflex/tests/test_sqlalchemy.py:66: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <class 'reflex.model.Model'>\nconnection = <sqlalchemy.engine.base.Connection object at 0x7f586eae4be0>\nmessage = 'Initial Revision', write_migration_scripts = True\n\n    @classmethod\n    def alembic_autogenerate(\n        self,\n        connection: Any,\n        message: Optional[str] = None,\n        write_migration_scripts: bool = True,\n    ) -> bool:\n        \"\"\"Generate migration scripts for alembic-detectable changes.\n    \n        Args:\n            connection: SQLAlchemy connection to use when detecting changes.\n            message: Human readable identifier describing the generated revision.\n            write_migration_scripts: If True, write autogenerated revisions to script directory.\n    \n        Returns:\n            True when changes have been detected.\n        \"\"\"\n        from alembic.autogenerate import compare_metadata\n        from alembic.migration import MigrationContext\n        from alembic.operations import Operations\n    \n        context = MigrationContext.configure(connection)\n        metadata = self.metadata\n    \n        diff = compare_metadata(context, metadata)\n    \n        if not diff:\n            return False\n    \n        if write_migration_scripts:\n            op = Operations(context)\n>           revision = context.revision(message)\nE           AttributeError: 'MigrationContext' object has no attribute 'revision'\n\n/root/repos/py_data/reflex/reflex/model.py:286: AttributeError\n----------------------------- Captured stdout call -----------------------------\nCreating directory '/tmp/pytest-of-root/pytest-2566/test_automigration1/working_dir/alembic' ...  done\nCreating directory '/tmp/pytest-of-root/pytest-2566/test_automigration1/working_dir/alembic/versions' ...  done\nGenerating /tmp/pytest-of-root/pytest-2566/test_automigration1/working_dir/alembic.ini ...  done\nGenerating /tmp/pytest-of-root/pytest-2566/test_automigration1/working_dir/alembic/script.py.mako ...  done\nGenerating /tmp/pytest-of-root/pytest-2566/test_automigration1/working_dir/alembic/env.py ...  done\nGenerating /tmp/pytest-of-root/pytest-2566/test_automigration1/working_dir/alembic/README ...  done\nPlease edit configuration/connection/logging settings in '/tmp/pytest-of-root/pytest-2566/test_automigration1/working_dir/alembic.ini' before proceeding.\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_model.py::test_automigration - AttributeError: 'MigrationCo...\nFAILED tests/test_sqlalchemy.py::test_automigration - AttributeError: 'Migrat...\n======================== 2 failed, 5 warnings in 0.13s =========================\n\n"], "reflex-reflex/model.py-migrate": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 2 items\n\ntests/test_model.py F                                                    [ 50%]\ntests/test_sqlalchemy.py F                                               [100%]\n\n=================================== FAILURES ===================================\n______________________________ test_automigration ______________________________\n\ntmp_working_dir = PosixPath('/tmp/pytest-of-root/pytest-2567/test_automigration0/working_dir')\nmonkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x7f4a54430fd0>\nmodel_registry = <class 'reflex.model.ModelRegistry'>\n\n    @pytest.mark.filterwarnings(\n        \"ignore:This declarative base already contains a class with the same class name\",\n    )\n    def test_automigration(\n        tmp_working_dir: Path,\n        monkeypatch: pytest.MonkeyPatch,\n        model_registry: Type[ModelRegistry],\n    ):\n        \"\"\"Test alembic automigration with add and drop table and column.\n    \n        Args:\n            tmp_working_dir: directory where database and migrations are stored\n            monkeypatch: pytest fixture to overwrite attributes\n            model_registry: clean reflex ModelRegistry\n        \"\"\"\n        alembic_ini = tmp_working_dir / \"alembic.ini\"\n        versions = tmp_working_dir / \"alembic\" / \"versions\"\n        monkeypatch.setattr(reflex.constants, \"ALEMBIC_CONFIG\", str(alembic_ini))\n    \n        config_mock = mock.Mock()\n        config_mock.db_url = f\"sqlite:///{tmp_working_dir}/reflex.db\"\n        monkeypatch.setattr(reflex.model, \"get_config\", mock.Mock(return_value=config_mock))\n    \n        Model.alembic_init()\n        assert alembic_ini.exists()\n        assert versions.exists()\n    \n        # initial table\n        class AlembicThing(Model, table=True):  # type: ignore\n            t1: str\n    \n        with Model.get_db_engine().connect() as connection:\n            assert Model.alembic_autogenerate(\n                connection=connection, message=\"Initial Revision\"\n            )\n>       assert Model.migrate()\nE       AssertionError: assert None\nE        +  where None = <bound method Model.migrate of <class 'reflex.model.Model'>>()\nE        +    where <bound method Model.migrate of <class 'reflex.model.Model'>> = Model.migrate\n\n/root/repos/py_data/reflex/tests/test_model.py:96: AssertionError\n----------------------------- Captured stdout call -----------------------------\nCreating directory '/tmp/pytest-of-root/pytest-2567/test_automigration0/working_dir/alembic' ...  done\nCreating directory '/tmp/pytest-of-root/pytest-2567/test_automigration0/working_dir/alembic/versions' ...  done\nGenerating /tmp/pytest-of-root/pytest-2567/test_automigration0/working_dir/alembic.ini ...  done\nGenerating /tmp/pytest-of-root/pytest-2567/test_automigration0/working_dir/alembic/script.py.mako ...  done\nGenerating /tmp/pytest-of-root/pytest-2567/test_automigration0/working_dir/alembic/env.py ...  done\nGenerating /tmp/pytest-of-root/pytest-2567/test_automigration0/working_dir/alembic/README ...  done\nPlease edit configuration/connection/logging settings in '/tmp/pytest-of-root/pytest-2567/test_automigration0/working_dir/alembic.ini' before proceeding.\nGenerating /tmp/pytest-of-root/pytest-2567/test_automigration0/working_dir/alembic/versions/6d5bd334cbeb_initial_revision.py ...  done\nError during migration: Can't load plugin: sqlalchemy.dialects:driver\n______________________________ test_automigration ______________________________\n\ntmp_working_dir = PosixPath('/tmp/pytest-of-root/pytest-2567/test_automigration1/working_dir')\nmonkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x7f4a54233c40>\nmodel_registry = <class 'reflex.model.ModelRegistry'>\n\n    @pytest.mark.filterwarnings(\n        \"ignore:This declarative base already contains a class with the same class name\",\n    )\n    def test_automigration(\n        tmp_working_dir: Path,\n        monkeypatch: pytest.MonkeyPatch,\n        model_registry: Type[ModelRegistry],\n    ):\n        \"\"\"Test alembic automigration with add and drop table and column.\n    \n        Args:\n            tmp_working_dir: directory where database and migrations are stored\n            monkeypatch: pytest fixture to overwrite attributes\n            model_registry: clean reflex ModelRegistry\n        \"\"\"\n        alembic_ini = tmp_working_dir / \"alembic.ini\"\n        versions = tmp_working_dir / \"alembic\" / \"versions\"\n        monkeypatch.setattr(reflex.constants, \"ALEMBIC_CONFIG\", str(alembic_ini))\n    \n        config_mock = mock.Mock()\n        config_mock.db_url = f\"sqlite:///{tmp_working_dir}/reflex.db\"\n        monkeypatch.setattr(reflex.model, \"get_config\", mock.Mock(return_value=config_mock))\n    \n        assert alembic_ini.exists() is False\n        assert versions.exists() is False\n        Model.alembic_init()\n        assert alembic_ini.exists()\n        assert versions.exists()\n    \n        class Base(DeclarativeBase):\n            @declared_attr.directive\n            def __tablename__(cls) -> str:\n                return cls.__name__.lower()\n    \n        assert model_registry.register(Base)\n    \n        class ModelBase(Base, MappedAsDataclass):\n            __abstract__ = True\n            id: Mapped[Optional[int]] = mapped_column(primary_key=True, default=None)\n    \n        # initial table\n        class AlembicThing(ModelBase):  # pyright: ignore[reportGeneralTypeIssues]\n            t1: Mapped[str] = mapped_column(default=\"\")\n    \n        with Model.get_db_engine().connect() as connection:\n            assert Model.alembic_autogenerate(\n                connection=connection, message=\"Initial Revision\"\n            )\n>       assert Model.migrate()\nE       AssertionError: assert None\nE        +  where None = <bound method Model.migrate of <class 'reflex.model.Model'>>()\nE        +    where <bound method Model.migrate of <class 'reflex.model.Model'>> = Model.migrate\n\n/root/repos/py_data/reflex/tests/test_sqlalchemy.py:69: AssertionError\n----------------------------- Captured stdout call -----------------------------\nCreating directory '/tmp/pytest-of-root/pytest-2567/test_automigration1/working_dir/alembic' ...  done\nCreating directory '/tmp/pytest-of-root/pytest-2567/test_automigration1/working_dir/alembic/versions' ...  done\nGenerating /tmp/pytest-of-root/pytest-2567/test_automigration1/working_dir/alembic.ini ...  done\nGenerating /tmp/pytest-of-root/pytest-2567/test_automigration1/working_dir/alembic/script.py.mako ...  done\nGenerating /tmp/pytest-of-root/pytest-2567/test_automigration1/working_dir/alembic/env.py ...  done\nGenerating /tmp/pytest-of-root/pytest-2567/test_automigration1/working_dir/alembic/README ...  done\nPlease edit configuration/connection/logging settings in '/tmp/pytest-of-root/pytest-2567/test_automigration1/working_dir/alembic.ini' before proceeding.\nGenerating /tmp/pytest-of-root/pytest-2567/test_automigration1/working_dir/alembic/versions/626d4ac54b6d_initial_revision.py ...  done\nError during migration: Can't load plugin: sqlalchemy.dialects:driver\n----------------------------- Captured stderr call -----------------------------\nINFO  [alembic.runtime.migration] Context impl SQLiteImpl.\nINFO  [alembic.runtime.migration] Will assume non-transactional DDL.\nINFO  [alembic.autogenerate.compare] Detected added table 'alembicthing'\n------------------------------ Captured log call -------------------------------\nINFO     alembic.runtime.migration:migration.py:215 Context impl SQLiteImpl.\nINFO     alembic.runtime.migration:migration.py:218 Will assume non-transactional DDL.\nINFO     alembic.autogenerate.compare:compare.py:189 Detected added table 'alembicthing'\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\ntests/test_sqlalchemy.py::test_automigration\n  /root/repos/py_data/reflex/reflex/model.py:128: SAWarning:\n  \n  Table 'alembicthing' already exists within the given MetaData - not copying.\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_model.py::test_automigration - AssertionError: assert None\nFAILED tests/test_sqlalchemy.py::test_automigration - AssertionError: assert ...\n======================== 2 failed, 6 warnings in 0.15s =========================\n\n"], "reflex-reflex/model.py-select": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 2 items\n\ntests/test_model.py .                                                    [ 50%]\ntests/test_sqlalchemy.py .                                               [100%]\n\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n======================== 2 passed, 5 warnings in 0.27s =========================\n\n"], "reflex-reflex/compiler/compiler.py-compile_components": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/components/test_component.py F                                     [100%]\n\n=================================== FAILURES ===================================\n______________________ test_custom_component_get_imports _______________________\n\n    def test_custom_component_get_imports():\n        class Inner(Component):\n            tag = \"Inner\"\n            library = \"inner\"\n    \n        class Other(Component):\n            tag = \"Other\"\n            library = \"other\"\n    \n        @rx.memo\n        def wrapper():\n            return Inner.create()\n    \n        @rx.memo\n        def outer(c: Component):\n            return Other.create(c)\n    \n        custom_comp = wrapper()\n    \n        # Inner is not imported directly, but it is imported by the custom component.\n        assert \"inner\" not in custom_comp._get_all_imports()\n    \n        # The imports are only resolved during compilation.\n>       _, _, imports_inner = compile_components(custom_comp._get_all_custom_components())\nE       ValueError: not enough values to unpack (expected 3, got 2)\n\ntests/components/test_component.py:1686: ValueError\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/components/test_component.py::test_custom_component_get_imports\n======================== 1 failed, 5 warnings in 0.81s =========================\n\n"], "reflex-reflex/utils/prerequisites.py-get_or_set_last_reflex_version_check_datetime": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 0 items\n\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n============================= 5 warnings in 0.76s ==============================\n\nERROR: not found: /root/repos/py_data/reflex/reflex/utils/prerequisites.py::check_latest_package_version\n(no match in any of [<Module prerequisites.py>])\n\n"], "reflex-reflex/middleware/hydrate_middleware.py-preprocess": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/middleware/test_hydrate_middleware.py F                            [100%]\n\n=================================== FAILURES ===================================\n__________________________ test_preprocess_no_events ___________________________\n\nhydrate_middleware = HydrateMiddleware()\nevent1 = Event(token='<token>', name='state.hydrate', router_data={'pathname': '/', 'query': {}, 'token': '<token>', 'sid': '<sid>', 'headers': {}, 'ip': '127.0.0.1'}, payload={})\nmocker = <pytest_mock.plugin.MockerFixture object at 0x7f5a73141d20>\n\n    @pytest.mark.asyncio\n    async def test_preprocess_no_events(hydrate_middleware, event1, mocker):\n        \"\"\"Test that app without on_load is processed correctly.\n    \n        Args:\n            hydrate_middleware: Instance of HydrateMiddleware\n            event1: An Event.\n            mocker: pytest mock object.\n        \"\"\"\n        mocker.patch(\"reflex.state.State.class_subclasses\", {TestState})\n        state = State()\n>       update = await hydrate_middleware.preprocess(\n            app=App(state=State),\n            event=event1,\n            state=state,\n        )\n\ntests/middleware/test_hydrate_middleware.py:43: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = HydrateMiddleware(), app = <App state=State>\nstate = State({'state': {'is_hydrated': False, 'router': {'session': {'client_token': '', 'client_ip': '', 'session_id': ''}, ...'', 'path': '', 'raw_path': '', 'full_path': '', 'full_raw_path': '', 'params': {}}}}, 'state.test_state': {'num': 0}})\nevent = Event(token='<token>', name='state.hydrate', router_data={'pathname': '/', 'query': {}, 'token': '<token>', 'sid': '<sid>', 'headers': {}, 'ip': '127.0.0.1'}, payload={})\n\n    async def preprocess(\n        self, app: App, state: BaseState, event: Event\n    ) -> Optional[StateUpdate]:\n        \"\"\"Preprocess the event.\n    \n        Args:\n            app: The app to apply the middleware to.\n            state: The client state.\n            event: The event to preprocess.\n    \n        Returns:\n            An optional delta or list of state updates to return.\n        \"\"\"\n        # Check if the event is a hydrate event\n>       if event.name == constants.HYDRATE:\nE       AttributeError: module 'reflex.constants' has no attribute 'HYDRATE'\n\nreflex/middleware/hydrate_middleware.py:34: AttributeError\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/middleware/test_hydrate_middleware.py::test_preprocess_no_events\n======================== 1 failed, 5 warnings in 0.11s =========================\n\n"], "reflex-reflex/components/component.py-get_event_triggers": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item / 1 error\n\n==================================== ERRORS ====================================\n_____________ ERROR collecting tests/components/test_component.py ______________\ntests/components/test_component.py:1225: in <module>\n    rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\nreflex/components/component.py:784: in create\n    return cls(children=children, **props)\nreflex/components/component.py:382: in __init__\n    raise ValueError(\nE   ValueError: The Fragment does not take in an `on_click` event trigger. If Fragment is a third party component make sure to add `on_click` to the component's event triggers. visit https://reflex.dev/docs/wrapping-react/guide/#event-triggers for more info.\n------------------------------- Captured stdout --------------------------------\nDeprecationWarning: Creating a Var (hello) from a string without specifying \n_var_is_string has been deprecated in version 0.5.4 Specify _var_is_string=False\nto create a Var that is not a string literal. In the future, creating a Var from\na string will be treated as a string literal by default. It will be completely \nremoved in 0.6.0\nDeprecationWarning: Creating a Var (1) from a string without specifying \n_var_is_string has been deprecated in version 0.5.4 Specify _var_is_string=False\nto create a Var that is not a string literal. In the future, creating a Var from\na string will be treated as a string literal by default. It will be completely \nremoved in 0.6.0\nDeprecationWarning: Creating a Var (test) from a string without specifying \n_var_is_string has been deprecated in version 0.5.4 Specify _var_is_string=False\nto create a Var that is not a string literal. In the future, creating a Var from\na string will be treated as a string literal by default. It will be completely \nremoved in 0.6.0\nDeprecationWarning: Creating a Var (foo<reflex.Var>{\"state\": \"Test\", \n\"interpolations\": [], \"imports\": {\"test\": [{\"tag\": \"test\", \"is_default\": false, \n\"alias\": null, \"install\": true, \"render\": true, \"transpile\": false}]}, \"hooks\": \n{\"useTest\": null}, \"string_length\": 4}</reflex.Var>testbar) from a string \nwithout specifying _var_is_string has been deprecated in version 0.5.4 Specify \n_var_is_string=False to create a Var that is not a string literal. In the \nfuture, creating a Var from a string will be treated as a string literal by \ndefault. It will be completely removed in 0.6.0\nDeprecationWarning: Creating a Var (arg) from a string without specifying \n_var_is_string has been deprecated in version 0.5.4 Specify _var_is_string=False\nto create a Var that is not a string literal. In the future, creating a Var from\na string will be treated as a string literal by default. It will be completely \nremoved in 0.6.0\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nERROR tests/components/test_component.py - ValueError: The Fragment does not ...\n========================= 5 warnings, 1 error in 0.76s =========================\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_custom_component_declare_event_handlers_in_fields\n\n"], "reflex-reflex/components/component.py-get_props": ["\nImportError while loading conftest '/root/repos/py_data/reflex/tests/conftest.py'.\ntests/conftest.py:13: in <module>\n    from reflex.app import App\nreflex/app.py:44: in <module>\n    from reflex.compiler import compiler\nreflex/compiler/compiler.py:11: in <module>\n    from reflex.compiler import templates, utils\nreflex/compiler/utils.py:18: in <module>\n    from reflex.components.base import (\n/usr/local/lib/python3.10/site-packages/lazy_loader/__init__.py:82: in __getattr__\n    submod = importlib.import_module(submod_path)\nreflex/components/base/body.py:3: in <module>\n    from reflex.components.component import Component\nreflex/components/component.py:165: in <module>\n    class Component(BaseComponent, ABC):\nreflex/components/component.py:716: in Component\n    def get_props(cls) -> Set[str]:\n/usr/local/lib/python3.10/functools.py:519: in decorating_function\n    wrapper = _lru_cache_wrapper(user_function, maxsize, typed, _CacheInfo)\nE   TypeError: the first argument must be callable\n"], "reflex-reflex/components/component.py-create": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 16 items / 1 error\n\n==================================== ERRORS ====================================\n_____________ ERROR collecting tests/components/test_component.py ______________\ntests/components/test_component.py:627: in <module>\n    (rx.text(\"first_text\"),),\nreflex/components/radix/themes/base.py:110: in create\n    component = super().create(*children, **props)\nreflex/components/component.py:761: in create\n    component = cls(children=list(children), **props)\nreflex/components/component.py:361: in __init__\n    super().__init__(**initial_kwargs)\n/usr/local/lib/python3.10/site-packages/pydantic/v1/main.py:341: in __init__\n    raise validation_error\nE   pydantic.v1.error_wrappers.ValidationError: 1 validation error for Text\nE   children -> 0\nE     value is not a valid dict (type=type_error.dict)\n------------------------------- Captured stdout --------------------------------\nDeprecationWarning: Creating a Var (hello) from a string without specifying \n_var_is_string has been deprecated in version 0.5.4 Specify _var_is_string=False\nto create a Var that is not a string literal. In the future, creating a Var from\na string will be treated as a string literal by default. It will be completely \nremoved in 0.6.0\nDeprecationWarning: Creating a Var (1) from a string without specifying \n_var_is_string has been deprecated in version 0.5.4 Specify _var_is_string=False\nto create a Var that is not a string literal. In the future, creating a Var from\na string will be treated as a string literal by default. It will be completely \nremoved in 0.6.0\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nERROR tests/components/test_component.py - pydantic.v1.error_wrappers.Validat...\n========================= 5 warnings, 1 error in 0.67s =========================\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_unsupported_parent_components\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_instantiate_all_components\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_create_component\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_create_component_prop_validation\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_component_add_imports\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_validate_valid_parents\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_validate_invalid_children\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_add_style_foreach\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_component_with_only_valid_children\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_get_hooks_nested2\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_component_create_unallowed_types\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_component_event_trigger_arbitrary_args\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_invalid_event_handler_args\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::wrapper\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::outer\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_component_create_unpack_tuple_child\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_get_custom_code\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_create_filters_none_props\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_validate_valid_children\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_get_hooks_nested\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_invalid_prop_type\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_var_props\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_custom_component_declare_event_handlers_in_fields\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_rename_props\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_valid_props\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_unsupported_child_components\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_custom_component_wrapper\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_get_imports\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_component_add_hooks\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_custom_component_get_imports\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_component_add_hooks_var\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_deprecated_props\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_add_style_embedded_vars\n\nERROR: found no collectors for /root/repos/py_data/reflex/tests/components/test_component.py::test_component_add_custom_code\n\n"], "reflex-reflex/components/component.py-_add_style_recursive": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 3 items\n\ntests/components/core/test_foreach.py .                                  [ 33%]\ntests/components/test_component.py .F                                    [100%]\n\n=================================== FAILURES ===================================\n_________________________ test_add_style_embedded_vars _________________________\n\ntest_state = <class 'tests.components.test_component.test_state.<locals>.TestState'>\n\n    def test_add_style_embedded_vars(test_state: BaseState):\n        \"\"\"Test that add_style works with embedded vars when returning a plain dict.\n    \n        Args:\n            test_state: A test state.\n        \"\"\"\n        v0 = Var.create_safe(\"parent\")._replace(\n            merge_var_data=VarData(hooks={\"useParent\": None}),  # type: ignore\n        )\n        v1 = rx.color(\"plum\", 10)\n        v2 = Var.create_safe(\"text\")._replace(\n            merge_var_data=VarData(hooks={\"useText\": None}),  # type: ignore\n        )\n    \n        class ParentComponent(Component):\n            def add_style(self):\n                return Style(\n                    {\n                        \"fake_parent\": v0,\n                    }\n                )\n    \n        class StyledComponent(ParentComponent):\n            tag = \"StyledComponent\"\n    \n            def add_style(self):\n                return {\n                    \"color\": v1,\n                    \"fake\": v2,\n                    \"margin\": f\"{test_state.num}%\",\n                }\n    \n        page = rx.vstack(StyledComponent.create())\n        page._add_style_recursive(Style())\n    \n>       assert (\n            \"const test_state = useContext(StateContexts.test_state)\"\n            in page._get_all_hooks_internal()\n        )\nE       assert 'const test_state = useContext(StateContexts.test_state)' in {}\nE        +  where {} = <bound method Component._get_all_hooks_internal of {\"name\": \"RadixThemesFlex\", \"props\": [\"align={`start`}\", \"className...%`}}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}>()\nE        +    where <bound method Component._get_all_hooks_internal of {\"name\": \"RadixThemesFlex\", \"props\": [\"align={`start`}\", \"className...%`}}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}> = {\"name\": \"RadixThemesFlex\", \"props\": [\"align={`start`}\", \"className={`rx-Stack`}\", \"direction={`column`}\", \"gap={`3`}\"...}%`}}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}._get_all_hooks_internal\n\ntests/components/test_component.py:2039: AssertionError\n----------------------------- Captured stdout call -----------------------------\nDeprecationWarning: Creating a Var (parent) from a string without specifying \n_var_is_string has been deprecated in version 0.5.4 Specify _var_is_string=False\nto create a Var that is not a string literal. In the future, creating a Var from\na string will be treated as a string literal by default. It will be completely \nremoved in 0.6.0\nDeprecationWarning: Creating a Var (text) from a string without specifying \n_var_is_string has been deprecated in version 0.5.4 Specify _var_is_string=False\nto create a Var that is not a string literal. In the future, creating a Var from\na string will be treated as a string literal by default. It will be completely \nremoved in 0.6.0\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/components/test_component.py::test_add_style_embedded_vars - ass...\n=================== 1 failed, 2 passed, 5 warnings in 0.85s ====================\n\n"], "reflex-reflex/components/component.py-render": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 21 items\n\ntests/components/test_component.py FFFF..                                [ 28%]\ntests/components/core/test_foreach.py ...........                        [ 80%]\ntests/components/test_component.py ..FF                                  [100%]\n\n=================================== FAILURES ===================================\n______________________________ test_rename_props _______________________________\n\n    def test_rename_props():\n        \"\"\"Test that _rename_props works and is inherited.\"\"\"\n    \n        class C1(Component):\n            tag = \"C1\"\n    \n            prop1: Var[str]\n            prop2: Var[str]\n    \n            _rename_props = {\"prop1\": \"renamed_prop1\", \"prop2\": \"renamed_prop2\"}\n    \n        class C2(C1):\n            tag = \"C2\"\n    \n            prop3: Var[str]\n    \n            _rename_props = {\"prop2\": \"subclass_prop2\", \"prop3\": \"renamed_prop3\"}\n    \n        c1 = C1.create(prop1=\"prop1_1\", prop2=\"prop2_1\")\n>       rendered_c1 = c1.render()\n\ntests/components/test_component.py:1596: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <[AttributeError(\"'Tag' object has no attribute 'render'\") raised in repr()] C1 object at 0x7f2505781fc0>\n\n    def render(self) -> Dict:\n        \"\"\"Render the component.\n    \n        Returns:\n            The dictionary for template of component.\n        \"\"\"\n        # Create the base tag\n        tag = self._render()\n    \n        # Add the children to the tag\n        for child in self.children:\n            tag.add_child(child)\n    \n        # Return the rendered tag\n>       return tag.render()\nE       AttributeError: 'Tag' object has no attribute 'render'\n\nreflex/components/component.py:948: AttributeError\n_________ test_component_create_unpack_tuple_child[element0-expected0] _________\n\ntest_component = <class 'tests.components.test_component.test_component.<locals>.TestComponent'>\nelement = (<[AttributeError(\"'Tag' object has no attribute 'add_child'\") raised in repr()] Text object at 0x7f2505aa5cf0>,)\nexpected = {'args': None, 'autofocus': False, 'children': [{'args': None, 'autofocus': False, 'children': [{'args': None, 'autofocus': False, 'children': [], 'contents': '{`first_text`}', ...}], 'contents': '', ...}], 'contents': '', ...}\n\n    @pytest.mark.parametrize(\n        \"element, expected\",\n        [\n            (\n                (rx.text(\"first_text\"),),\n                {\n                    \"name\": \"Fragment\",\n                    \"props\": [],\n                    \"contents\": \"\",\n                    \"args\": None,\n                    \"special_props\": set(),\n                    \"children\": [\n                        {\n                            \"name\": \"RadixThemesText\",\n                            \"props\": [\"as={`p`}\"],\n                            \"contents\": \"\",\n                            \"args\": None,\n                            \"special_props\": set(),\n                            \"children\": [\n                                {\n                                    \"name\": \"\",\n                                    \"props\": [],\n                                    \"contents\": \"{`first_text`}\",\n                                    \"args\": None,\n                                    \"special_props\": set(),\n                                    \"children\": [],\n                                    \"autofocus\": False,\n                                }\n                            ],\n                            \"autofocus\": False,\n                        }\n                    ],\n                    \"autofocus\": False,\n                },\n            ),\n            (\n                (rx.text(\"first_text\"), rx.text(\"second_text\")),\n                {\n                    \"args\": None,\n                    \"autofocus\": False,\n                    \"children\": [\n                        {\n                            \"args\": None,\n                            \"autofocus\": False,\n                            \"children\": [\n                                {\n                                    \"args\": None,\n                                    \"autofocus\": False,\n                                    \"children\": [],\n                                    \"contents\": \"{`first_text`}\",\n                                    \"name\": \"\",\n                                    \"props\": [],\n                                    \"special_props\": set(),\n                                }\n                            ],\n                            \"contents\": \"\",\n                            \"name\": \"RadixThemesText\",\n                            \"props\": [\"as={`p`}\"],\n                            \"special_props\": set(),\n                        },\n                        {\n                            \"args\": None,\n                            \"autofocus\": False,\n                            \"children\": [\n                                {\n                                    \"args\": None,\n                                    \"autofocus\": False,\n                                    \"children\": [],\n                                    \"contents\": \"{`second_text`}\",\n                                    \"name\": \"\",\n                                    \"props\": [],\n                                    \"special_props\": set(),\n                                }\n                            ],\n                            \"contents\": \"\",\n                            \"name\": \"RadixThemesText\",\n                            \"props\": [\"as={`p`}\"],\n                            \"special_props\": set(),\n                        },\n                    ],\n                    \"contents\": \"\",\n                    \"name\": \"Fragment\",\n                    \"props\": [],\n                    \"special_props\": set(),\n                },\n            ),\n            (\n                (rx.text(\"first_text\"), rx.box((rx.text(\"second_text\"),))),\n                {\n                    \"args\": None,\n                    \"autofocus\": False,\n                    \"children\": [\n                        {\n                            \"args\": None,\n                            \"autofocus\": False,\n                            \"children\": [\n                                {\n                                    \"args\": None,\n                                    \"autofocus\": False,\n                                    \"children\": [],\n                                    \"contents\": \"{`first_text`}\",\n                                    \"name\": \"\",\n                                    \"props\": [],\n                                    \"special_props\": set(),\n                                }\n                            ],\n                            \"contents\": \"\",\n                            \"name\": \"RadixThemesText\",\n                            \"props\": [\"as={`p`}\"],\n                            \"special_props\": set(),\n                        },\n                        {\n                            \"args\": None,\n                            \"autofocus\": False,\n                            \"children\": [\n                                {\n                                    \"args\": None,\n                                    \"autofocus\": False,\n                                    \"children\": [\n                                        {\n                                            \"args\": None,\n                                            \"autofocus\": False,\n                                            \"children\": [\n                                                {\n                                                    \"args\": None,\n                                                    \"autofocus\": False,\n                                                    \"children\": [],\n                                                    \"contents\": \"{`second_text`}\",\n                                                    \"name\": \"\",\n                                                    \"props\": [],\n                                                    \"special_props\": set(),\n                                                }\n                                            ],\n                                            \"contents\": \"\",\n                                            \"name\": \"RadixThemesText\",\n                                            \"props\": [\"as={`p`}\"],\n                                            \"special_props\": set(),\n                                        }\n                                    ],\n                                    \"contents\": \"\",\n                                    \"name\": \"Fragment\",\n                                    \"props\": [],\n                                    \"special_props\": set(),\n                                }\n                            ],\n                            \"contents\": \"\",\n                            \"name\": \"RadixThemesBox\",\n                            \"props\": [],\n                            \"special_props\": set(),\n                        },\n                    ],\n                    \"contents\": \"\",\n                    \"name\": \"Fragment\",\n                    \"props\": [],\n                    \"special_props\": set(),\n                },\n            ),\n        ],\n    )\n    def test_component_create_unpack_tuple_child(test_component, element, expected):\n        \"\"\"Test that component in tuples are unwrapped into an rx.Fragment.\n    \n        Args:\n            test_component: Component fixture.\n            element: The children to pass to the component.\n            expected: The expected render dict.\n        \"\"\"\n        comp = test_component.create(element)\n    \n        assert len(comp.children) == 1\n        assert isinstance((fragment_wrapper := comp.children[0]), Fragment)\n>       assert fragment_wrapper.render() == expected\n\ntests/components/test_component.py:794: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <[AttributeError(\"'Tag' object has no attribute 'add_child'\") raised in repr()] Fragment object at 0x7f2505945330>\n\n    def render(self) -> Dict:\n        \"\"\"Render the component.\n    \n        Returns:\n            The dictionary for template of component.\n        \"\"\"\n        # Create the base tag\n        tag = self._render()\n    \n        # Add the children to the tag\n        for child in self.children:\n>           tag.add_child(child)\nE           AttributeError: 'Tag' object has no attribute 'add_child'. Did you mean: 'add_field'?\n\nreflex/components/component.py:945: AttributeError\n_________ test_component_create_unpack_tuple_child[element1-expected1] _________\n\ntest_component = <class 'tests.components.test_component.test_component.<locals>.TestComponent'>\nelement = (<[AttributeError(\"'Tag' object has no attribute 'add_child'\") raised in repr()] Text object at 0x7f2505aa5d80>, <[AttributeError(\"'Tag' object has no attribute 'add_child'\") raised in repr()] Text object at 0x7f2505aa5e70>)\nexpected = {'args': None, 'autofocus': False, 'children': [{'args': None, 'autofocus': False, 'children': [{'args': None, 'autofo..., 'autofocus': False, 'children': [], 'contents': '{`second_text`}', ...}], 'contents': '', ...}], 'contents': '', ...}\n\n    @pytest.mark.parametrize(\n        \"element, expected\",\n        [\n            (\n                (rx.text(\"first_text\"),),\n                {\n                    \"name\": \"Fragment\",\n                    \"props\": [],\n                    \"contents\": \"\",\n                    \"args\": None,\n                    \"special_props\": set(),\n                    \"children\": [\n                        {\n                            \"name\": \"RadixThemesText\",\n                            \"props\": [\"as={`p`}\"],\n                            \"contents\": \"\",\n                            \"args\": None,\n                            \"special_props\": set(),\n                            \"children\": [\n                                {\n                                    \"name\": \"\",\n                                    \"props\": [],\n                                    \"contents\": \"{`first_text`}\",\n                                    \"args\": None,\n                                    \"special_props\": set(),\n                                    \"children\": [],\n                                    \"autofocus\": False,\n                                }\n                            ],\n                            \"autofocus\": False,\n                        }\n                    ],\n                    \"autofocus\": False,\n                },\n            ),\n            (\n                (rx.text(\"first_text\"), rx.text(\"second_text\")),\n                {\n                    \"args\": None,\n                    \"autofocus\": False,\n                    \"children\": [\n                        {\n                            \"args\": None,\n                            \"autofocus\": False,\n                            \"children\": [\n                                {\n                                    \"args\": None,\n                                    \"autofocus\": False,\n                                    \"children\": [],\n                                    \"contents\": \"{`first_text`}\",\n                                    \"name\": \"\",\n                                    \"props\": [],\n                                    \"special_props\": set(),\n                                }\n                            ],\n                            \"contents\": \"\",\n                            \"name\": \"RadixThemesText\",\n                            \"props\": [\"as={`p`}\"],\n                            \"special_props\": set(),\n                        },\n                        {\n                            \"args\": None,\n                            \"autofocus\": False,\n                            \"children\": [\n                                {\n                                    \"args\": None,\n                                    \"autofocus\": False,\n                                    \"children\": [],\n                                    \"contents\": \"{`second_text`}\",\n                                    \"name\": \"\",\n                                    \"props\": [],\n                                    \"special_props\": set(),\n                                }\n                            ],\n                            \"contents\": \"\",\n                            \"name\": \"RadixThemesText\",\n                            \"props\": [\"as={`p`}\"],\n                            \"special_props\": set(),\n                        },\n                    ],\n                    \"contents\": \"\",\n                    \"name\": \"Fragment\",\n                    \"props\": [],\n                    \"special_props\": set(),\n                },\n            ),\n            (\n                (rx.text(\"first_text\"), rx.box((rx.text(\"second_text\"),))),\n                {\n                    \"args\": None,\n                    \"autofocus\": False,\n                    \"children\": [\n                        {\n                            \"args\": None,\n                            \"autofocus\": False,\n                            \"children\": [\n                                {\n                                    \"args\": None,\n                                    \"autofocus\": False,\n                                    \"children\": [],\n                                    \"contents\": \"{`first_text`}\",\n                                    \"name\": \"\",\n                                    \"props\": [],\n                                    \"special_props\": set(),\n                                }\n                            ],\n                            \"contents\": \"\",\n                            \"name\": \"RadixThemesText\",\n                            \"props\": [\"as={`p`}\"],\n                            \"special_props\": set(),\n                        },\n                        {\n                            \"args\": None,\n                            \"autofocus\": False,\n                            \"children\": [\n                                {\n                                    \"args\": None,\n                                    \"autofocus\": False,\n                                    \"children\": [\n                                        {\n                                            \"args\": None,\n                                            \"autofocus\": False,\n                                            \"children\": [\n                                                {\n                                                    \"args\": None,\n                                                    \"autofocus\": False,\n                                                    \"children\": [],\n                                                    \"contents\": \"{`second_text`}\",\n                                                    \"name\": \"\",\n                                                    \"props\": [],\n                                                    \"special_props\": set(),\n                                                }\n                                            ],\n                                            \"contents\": \"\",\n                                            \"name\": \"RadixThemesText\",\n                                            \"props\": [\"as={`p`}\"],\n                                            \"special_props\": set(),\n                                        }\n                                    ],\n                                    \"contents\": \"\",\n                                    \"name\": \"Fragment\",\n                                    \"props\": [],\n                                    \"special_props\": set(),\n                                }\n                            ],\n                            \"contents\": \"\",\n                            \"name\": \"RadixThemesBox\",\n                            \"props\": [],\n                            \"special_props\": set(),\n                        },\n                    ],\n                    \"contents\": \"\",\n                    \"name\": \"Fragment\",\n                    \"props\": [],\n                    \"special_props\": set(),\n                },\n            ),\n        ],\n    )\n    def test_component_create_unpack_tuple_child(test_component, element, expected):\n        \"\"\"Test that component in tuples are unwrapped into an rx.Fragment.\n    \n        Args:\n            test_component: Component fixture.\n            element: The children to pass to the component.\n            expected: The expected render dict.\n        \"\"\"\n        comp = test_component.create(element)\n    \n        assert len(comp.children) == 1\n        assert isinstance((fragment_wrapper := comp.children[0]), Fragment)\n>       assert fragment_wrapper.render() == expected\n\ntests/components/test_component.py:794: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <[AttributeError(\"'Tag' object has no attribute 'add_child'\") raised in repr()] Fragment object at 0x7f2505783520>\n\n    def render(self) -> Dict:\n        \"\"\"Render the component.\n    \n        Returns:\n            The dictionary for template of component.\n        \"\"\"\n        # Create the base tag\n        tag = self._render()\n    \n        # Add the children to the tag\n        for child in self.children:\n>           tag.add_child(child)\nE           AttributeError: 'Tag' object has no attribute 'add_child'. Did you mean: 'add_field'?\n\nreflex/components/component.py:945: AttributeError\n_________ test_component_create_unpack_tuple_child[element2-expected2] _________\n\ntest_component = <class 'tests.components.test_component.test_component.<locals>.TestComponent'>\nelement = (<[AttributeError(\"'Tag' object has no attribute 'add_child'\") raised in repr()] Text object at 0x7f2505aa6050>, <[AttributeError(\"'Tag' object has no attribute 'add_child'\") raised in repr()] Box object at 0x7f2505aa6410>)\nexpected = {'args': None, 'autofocus': False, 'children': [{'args': None, 'autofocus': False, 'children': [{'args': None, 'autofo...rgs': None, 'autofocus': False, 'children': [{...}], 'contents': '', ...}], 'contents': '', ...}], 'contents': '', ...}\n\n    @pytest.mark.parametrize(\n        \"element, expected\",\n        [\n            (\n                (rx.text(\"first_text\"),),\n                {\n                    \"name\": \"Fragment\",\n                    \"props\": [],\n                    \"contents\": \"\",\n                    \"args\": None,\n                    \"special_props\": set(),\n                    \"children\": [\n                        {\n                            \"name\": \"RadixThemesText\",\n                            \"props\": [\"as={`p`}\"],\n                            \"contents\": \"\",\n                            \"args\": None,\n                            \"special_props\": set(),\n                            \"children\": [\n                                {\n                                    \"name\": \"\",\n                                    \"props\": [],\n                                    \"contents\": \"{`first_text`}\",\n                                    \"args\": None,\n                                    \"special_props\": set(),\n                                    \"children\": [],\n                                    \"autofocus\": False,\n                                }\n                            ],\n                            \"autofocus\": False,\n                        }\n                    ],\n                    \"autofocus\": False,\n                },\n            ),\n            (\n                (rx.text(\"first_text\"), rx.text(\"second_text\")),\n                {\n                    \"args\": None,\n                    \"autofocus\": False,\n                    \"children\": [\n                        {\n                            \"args\": None,\n                            \"autofocus\": False,\n                            \"children\": [\n                                {\n                                    \"args\": None,\n                                    \"autofocus\": False,\n                                    \"children\": [],\n                                    \"contents\": \"{`first_text`}\",\n                                    \"name\": \"\",\n                                    \"props\": [],\n                                    \"special_props\": set(),\n                                }\n                            ],\n                            \"contents\": \"\",\n                            \"name\": \"RadixThemesText\",\n                            \"props\": [\"as={`p`}\"],\n                            \"special_props\": set(),\n                        },\n                        {\n                            \"args\": None,\n                            \"autofocus\": False,\n                            \"children\": [\n                                {\n                                    \"args\": None,\n                                    \"autofocus\": False,\n                                    \"children\": [],\n                                    \"contents\": \"{`second_text`}\",\n                                    \"name\": \"\",\n                                    \"props\": [],\n                                    \"special_props\": set(),\n                                }\n                            ],\n                            \"contents\": \"\",\n                            \"name\": \"RadixThemesText\",\n                            \"props\": [\"as={`p`}\"],\n                            \"special_props\": set(),\n                        },\n                    ],\n                    \"contents\": \"\",\n                    \"name\": \"Fragment\",\n                    \"props\": [],\n                    \"special_props\": set(),\n                },\n            ),\n            (\n                (rx.text(\"first_text\"), rx.box((rx.text(\"second_text\"),))),\n                {\n                    \"args\": None,\n                    \"autofocus\": False,\n                    \"children\": [\n                        {\n                            \"args\": None,\n                            \"autofocus\": False,\n                            \"children\": [\n                                {\n                                    \"args\": None,\n                                    \"autofocus\": False,\n                                    \"children\": [],\n                                    \"contents\": \"{`first_text`}\",\n                                    \"name\": \"\",\n                                    \"props\": [],\n                                    \"special_props\": set(),\n                                }\n                            ],\n                            \"contents\": \"\",\n                            \"name\": \"RadixThemesText\",\n                            \"props\": [\"as={`p`}\"],\n                            \"special_props\": set(),\n                        },\n                        {\n                            \"args\": None,\n                            \"autofocus\": False,\n                            \"children\": [\n                                {\n                                    \"args\": None,\n                                    \"autofocus\": False,\n                                    \"children\": [\n                                        {\n                                            \"args\": None,\n                                            \"autofocus\": False,\n                                            \"children\": [\n                                                {\n                                                    \"args\": None,\n                                                    \"autofocus\": False,\n                                                    \"children\": [],\n                                                    \"contents\": \"{`second_text`}\",\n                                                    \"name\": \"\",\n                                                    \"props\": [],\n                                                    \"special_props\": set(),\n                                                }\n                                            ],\n                                            \"contents\": \"\",\n                                            \"name\": \"RadixThemesText\",\n                                            \"props\": [\"as={`p`}\"],\n                                            \"special_props\": set(),\n                                        }\n                                    ],\n                                    \"contents\": \"\",\n                                    \"name\": \"Fragment\",\n                                    \"props\": [],\n                                    \"special_props\": set(),\n                                }\n                            ],\n                            \"contents\": \"\",\n                            \"name\": \"RadixThemesBox\",\n                            \"props\": [],\n                            \"special_props\": set(),\n                        },\n                    ],\n                    \"contents\": \"\",\n                    \"name\": \"Fragment\",\n                    \"props\": [],\n                    \"special_props\": set(),\n                },\n            ),\n        ],\n    )\n    def test_component_create_unpack_tuple_child(test_component, element, expected):\n        \"\"\"Test that component in tuples are unwrapped into an rx.Fragment.\n    \n        Args:\n            test_component: Component fixture.\n            element: The children to pass to the component.\n            expected: The expected render dict.\n        \"\"\"\n        comp = test_component.create(element)\n    \n        assert len(comp.children) == 1\n        assert isinstance((fragment_wrapper := comp.children[0]), Fragment)\n>       assert fragment_wrapper.render() == expected\n\ntests/components/test_component.py:794: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <[AttributeError(\"'Tag' object has no attribute 'add_child'\") raised in repr()] Fragment object at 0x7f2505718370>\n\n    def render(self) -> Dict:\n        \"\"\"Render the component.\n    \n        Returns:\n            The dictionary for template of component.\n        \"\"\"\n        # Create the base tag\n        tag = self._render()\n    \n        # Add the children to the tag\n        for child in self.children:\n>           tag.add_child(child)\nE           AttributeError: 'Tag' object has no attribute 'add_child'. Did you mean: 'add_field'?\n\nreflex/components/component.py:945: AttributeError\n_________________ test_component_event_trigger_arbitrary_args __________________\n\n    def test_component_event_trigger_arbitrary_args():\n        \"\"\"Test that we can define arbitrary types for the args of an event trigger.\"\"\"\n    \n        class Obj(Base):\n            custom: int = 0\n    \n        def on_foo_spec(_e, alpha: str, bravo: Dict[str, Any], charlie: Obj):\n            return [_e.target.value, bravo[\"nested\"], charlie.custom + 42]\n    \n        class C1(Component):\n            library = \"/local\"\n            tag = \"C1\"\n    \n            def get_event_triggers(self) -> Dict[str, Any]:\n                return {\n                    **super().get_event_triggers(),\n                    \"on_foo\": on_foo_spec,\n                }\n    \n        comp = C1.create(on_foo=C1State.mock_handler)\n    \n        assert comp.render()[\"props\"][0] == (\n            \"onFoo={(__e,_alpha,_bravo,_charlie) => addEvents(\"\n            '[Event(\"c1_state.mock_handler\", {_e:__e.target.value,_bravo:_bravo[\"nested\"],_charlie:((_charlie.custom) + (42))})], '\n            \"(__e,_alpha,_bravo,_charlie), {})}\"\n>       )\n\ntests/components/test_component.py:830: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <[AttributeError(\"'Tag' object has no attribute 'render'\") raised in repr()] C1 object at 0x7f2506da5e40>\n\n    def render(self) -> Dict:\n        \"\"\"Render the component.\n    \n        Returns:\n            The dictionary for template of component.\n        \"\"\"\n        # Create the base tag\n        tag = self._render()\n    \n        # Add the children to the tag\n        for child in self.children:\n            tag.add_child(child)\n    \n        # Return the rendered tag\n>       return tag.render()\nE       AttributeError: 'Tag' object has no attribute 'render'\n\nreflex/components/component.py:948: AttributeError\n____________________________ test_deprecated_props _____________________________\n\ncapsys = <_pytest.capture.CaptureFixture object at 0x7f250571b700>\n\n    def test_deprecated_props(capsys):\n        \"\"\"Assert that deprecated underscore suffix props are translated.\n    \n        Args:\n            capsys: Pytest fixture for capturing stdout and stderr.\n        \"\"\"\n    \n        class C1(Component):\n            tag = \"C1\"\n    \n            type: Var[str]\n            min: Var[str]\n            max: Var[str]\n    \n        # No warnings are emitted when using the new prop names.\n        c1_1 = C1.create(type=\"type1\", min=\"min1\", max=\"max1\")\n        out_err = capsys.readouterr()\n        assert not out_err.err\n        assert not out_err.out\n    \n>       c1_1_render = c1_1.render()\n\ntests/components/test_component.py:1627: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <[AttributeError(\"'Tag' object has no attribute 'render'\") raised in repr()] C1 object at 0x7f250571b5e0>\n\n    def render(self) -> Dict:\n        \"\"\"Render the component.\n    \n        Returns:\n            The dictionary for template of component.\n        \"\"\"\n        # Create the base tag\n        tag = self._render()\n    \n        # Add the children to the tag\n        for child in self.children:\n            tag.add_child(child)\n    \n        # Return the rendered tag\n>       return tag.render()\nE       AttributeError: 'Tag' object has no attribute 'render'\n\nreflex/components/component.py:948: AttributeError\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/components/test_component.py::test_rename_props - AttributeError...\nFAILED tests/components/test_component.py::test_component_create_unpack_tuple_child[element0-expected0]\nFAILED tests/components/test_component.py::test_component_create_unpack_tuple_child[element1-expected1]\nFAILED tests/components/test_component.py::test_component_create_unpack_tuple_child[element2-expected2]\nFAILED tests/components/test_component.py::test_component_event_trigger_arbitrary_args\nFAILED tests/components/test_component.py::test_deprecated_props - AttributeE...\n=================== 6 failed, 15 passed, 5 warnings in 1.06s ===================\n\n"], "reflex-reflex/components/component.py-_get_vars": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 31 items\n\ntests/components/test_component.py ..FFFFFFFFFFFFFFFFFFFFFFFFFFFFF       [100%]\n\n=================================== FAILURES ===================================\n__________________________ test_get_vars[direct-prop] __________________________\n\ncomponent = {\"name\": \"RadixThemesText\", \"props\": [\"as={`test`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='test', _var_type=<class 'str'>, _var_is_local=True, _var_is_string=False, _var_full_name_needs_sta...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"RadixThemesText\", \"props\": [\"as={`test`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Text' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n_________________________ test_get_vars[fstring-prop] __________________________\n\ncomponent = {\"name\": \"RadixThemesHeading\", \"props\": [\"as={`footestbar`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='footestbar', _var_type=<class 'str'>, _var_is_local=True, _var_is_string=False, _var_full_name_nee...t=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[(3, 7)]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"RadixThemesHeading\", \"props\": [\"as={`footestbar`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Heading' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n___________________________ test_get_vars[direct-id] ___________________________\n\ncomponent = {\"name\": \"Fragment\", \"props\": [\"id={`test`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='test', _var_type=<class 'str'>, _var_is_local=True, _var_is_string=False, _var_full_name_needs_sta...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Fragment\", \"props\": [\"id={`test`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Fragment' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n__________________________ test_get_vars[fstring-id] ___________________________\n\ncomponent = {\"name\": \"Fragment\", \"props\": [\"id={`footestbar`}\", \"ref={ref_foo_reflex_Var_state_Test_interpolations_imports_test_ta...ength_4_reflex_Var_testbar}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='footestbar', _var_type=<class 'str'>, _var_is_local=True, _var_is_string=False, _var_full_name_nee...t=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[(3, 7)]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Fragment\", \"props\": [\"id={`footestbar`}\", \"ref={ref_foo_reflex_Var_state_Test_interpolations_imports_test_ta...ength_4_reflex_Var_testbar}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Fragment' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n__________________________ test_get_vars[direct-key] ___________________________\n\ncomponent = {\"name\": \"Fragment\", \"props\": [\"key={`test`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='test', _var_type=<class 'str'>, _var_is_local=True, _var_is_string=False, _var_full_name_needs_sta...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Fragment\", \"props\": [\"key={`test`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Fragment' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n__________________________ test_get_vars[fstring-key] __________________________\n\ncomponent = {\"name\": \"Fragment\", \"props\": [\"key={`footestbar`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='footestbar', _var_type=<class 'str'>, _var_is_local=True, _var_is_string=False, _var_full_name_nee...t=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[(3, 7)]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Fragment\", \"props\": [\"key={`footestbar`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Fragment' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n_______________________ test_get_vars[direct-class_name] _______________________\n\ncomponent = {\"name\": \"Fragment\", \"props\": [\"className={`test`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='test', _var_type=<class 'str'>, _var_is_local=True, _var_is_string=False, _var_full_name_needs_sta...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Fragment\", \"props\": [\"className={`test`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Fragment' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n______________________ test_get_vars[fstring-class_name] _______________________\n\ncomponent = {\"name\": \"Fragment\", \"props\": [\"className={`footestbar`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='footestbar', _var_type=<class 'str'>, _var_is_local=True, _var_is_string=False, _var_full_name_nee...t=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[(3, 7)]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Fragment\", \"props\": [\"className={`footestbar`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Fragment' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n_____________________ test_get_vars[direct-special_props] ______________________\n\ncomponent = {\"name\": \"Fragment\", \"props\": [\"test\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[\\\"<reflex.Var>{\\\\\\\"state\\\\\\\":...hooks\\\\\\\": {\\\\\\\"useTest\\\\\\\": null}, \\\\\\\"string_length\\\\\\\": 4}</reflex.Var>test\\\"]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='test', _var_type=<class 'str'>, _var_is_local=True, _var_is_string=False, _var_full_name_needs_sta...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Fragment\", \"props\": [\"test\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[\\\"<reflex.Var>{\\\\\\\"state\\\\\\\":...hooks\\\\\\\": {\\\\\\\"useTest\\\\\\\": null}, \\\\\\\"string_length\\\\\\\": 4}</reflex.Var>test\\\"]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Fragment' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n_____________________ test_get_vars[fstring-special_props] _____________________\n\ncomponent = {\"name\": \"Fragment\", \"props\": [\"footestbar\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[\\\"<reflex.Var>{\\\\\\\"stat...\\\": {\\\\\\\"useTest\\\\\\\": null}, \\\\\\\"string_length\\\\\\\": 10}</reflex.Var>footestbar\\\"]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='footestbar', _var_type=<class 'str'>, _var_is_local=True, _var_is_string=False, _var_full_name_nee...t=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[(3, 7)]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Fragment\", \"props\": [\"footestbar\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[\\\"<reflex.Var>{\\\\\\\"stat...\\\": {\\\\\\\"useTest\\\\\\\": null}, \\\\\\\"string_length\\\\\\\": 10}</reflex.Var>footestbar\\\"]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Fragment' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n__________________ test_get_vars[fstring-custom_attrs-nofmt] ___________________\n\ncomponent = {\"name\": \"Fragment\", \"props\": [\"href={`test`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='test', _var_type=<class 'str'>, _var_is_local=True, _var_is_string=False, _var_full_name_needs_sta...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Fragment\", \"props\": [\"href={`test`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Fragment' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n_____________________ test_get_vars[fstring-custom_attrs] ______________________\n\ncomponent = {\"name\": \"Fragment\", \"props\": [\"href={`footestbar`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='footestbar', _var_type=<class 'str'>, _var_is_local=True, _var_is_string=False, _var_full_name_nee...t=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[(3, 7)]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Fragment\", \"props\": [\"href={`footestbar`}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Fragment' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n____________________ test_get_vars[direct-background_color] ____________________\n\ncomponent = {\"name\": \"Fragment\", \"props\": [\"css={{\\\"backgroundColor\\\": \\\"test\\\"}}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='style', _var_type=<class 'str'>, _var_is_local=False, _var_is_string=False, _var_full_name_needs_s...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Fragment\", \"props\": [\"css={{\\\"backgroundColor\\\": \\\"test\\\"}}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Fragment' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n___________________ test_get_vars[fstring-background_color] ____________________\n\ncomponent = {\"name\": \"Fragment\", \"props\": [\"css={{\\\"backgroundColor\\\": `footestbar`}}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='style', _var_type=<class 'str'>, _var_is_local=False, _var_is_string=False, _var_full_name_needs_s...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Fragment\", \"props\": [\"css={{\\\"backgroundColor\\\": `footestbar`}}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Fragment' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n_________________ test_get_vars[direct-style-background_color] _________________\n\ncomponent = {\"name\": \"Fragment\", \"props\": [\"css={{\\\"backgroundColor\\\": \\\"test\\\"}}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='style', _var_type=<class 'str'>, _var_is_local=False, _var_is_string=False, _var_full_name_needs_s...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Fragment\", \"props\": [\"css={{\\\"backgroundColor\\\": \\\"test\\\"}}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Fragment' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n________________ test_get_vars[fstring-style-background_color] _________________\n\ncomponent = {\"name\": \"Fragment\", \"props\": [\"css={{\\\"backgroundColor\\\": `footestbar`}}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='style', _var_type=<class 'str'>, _var_is_local=False, _var_is_string=False, _var_full_name_needs_s...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Fragment\", \"props\": [\"css={{\\\"backgroundColor\\\": `footestbar`}}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Fragment' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n______________________ test_get_vars[direct-event-chain] _______________________\n\ncomponent = {\"name\": \"Fragment\", \"props\": [\"onClick={test}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='test', _var_type=<class 'reflex.event.EventChain'>, _var_is_local=True, _var_is_string=False, _var...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Fragment\", \"props\": [\"onClick={test}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Fragment' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n_____________________ test_get_vars[direct-event-handler] ______________________\n\ncomponent = {\"name\": \"Fragment\", \"props\": [\"onClick={(_e) => addEvents([Event(\\\"state.event_state.handler\\\", {})], (_e), {})}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nexp_vars = []\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Fragment\", \"props\": [\"onClick={(_e) => addEvents([Event(\\\"state.event_state.handler\\\", {})], (_e), {})}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Fragment' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n___________________ test_get_vars[direct-event-handler-arg] ____________________\n\ncomponent = {\"name\": \"Fragment\", \"props\": [\"onClick={(_e) => addEvents([Event(\\\"state.event_state.handler2\\\", {arg:test})], (_e), {})}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='arg', _var_type=<class 'str'>, _var_is_local=True, _var_is_string=False, _var_full_name_needs_stat...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Fragment\", \"props\": [\"onClick={(_e) => addEvents([Event(\\\"state.event_state.handler2\\\", {arg:test})], (_e), {})}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Fragment' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n___________________ test_get_vars[direct-event-handler-arg2] ___________________\n\ncomponent = {\"name\": \"Fragment\", \"props\": [\"onClick={(_e) => addEvents([Event(\\\"state.event_state.handler2\\\", {arg:state__event_state.v})], (_e), {})}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='arg', _var_type=<class 'str'>, _var_is_local=True, _var_is_string=False, _var_full_name_needs_stat...False)]}, hooks={'const state__event_state = useContext(StateContexts.state__event_state)': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Fragment\", \"props\": [\"onClick={(_e) => addEvents([Event(\\\"state.event_state.handler2\\\", {arg:state__event_state.v})], (_e), {})}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Fragment' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n__________________ test_get_vars[direct-event-handler-lambda] __________________\n\ncomponent = {\"name\": \"Fragment\", \"props\": [\"onClick={(_e) => addEvents([Event(\\\"state.event_state.handler2\\\", {arg:test})], (_e), {})}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nexp_vars = [BaseVar(_var_name='arg', _var_type=<class 'str'>, _var_is_local=True, _var_is_string=False, _var_full_name_needs_stat...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Fragment\", \"props\": [\"onClick={(_e) => addEvents([Event(\\\"state.event_state.handler2\\\", {arg:test})], (_e), {})}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'Fragment' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n______________________ test_get_vars[direct-dict_of_dict] ______________________\n\ncomponent = <[ValidationError(model='Tag', errors=[{'loc': ('name',), 'msg': 'none is not an allowed value', 'type': 'type_error.none.not_allowed'}]) raised in repr()] ComponentNestedVar object at 0x7f4090f65930>\nexp_vars = [BaseVar(_var_name='{\"a\": {\"b\": \"test\"}}', _var_type=<class 'dict'>, _var_is_local=True, _var_is_string=False, _var_fu...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <[ValidationError(model='Tag', errors=[{'loc': ('name',), 'msg': 'none is not an allowed value', 'type': 'type_error.none.not_allowed'}]) raised in repr()] ComponentNestedVar object at 0x7f4090f65930>\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'ComponentNestedVar' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n_____________________ test_get_vars[fstring-dict_of_dict] ______________________\n\ncomponent = <[ValidationError(model='Tag', errors=[{'loc': ('name',), 'msg': 'none is not an allowed value', 'type': 'type_error.none.not_allowed'}]) raised in repr()] ComponentNestedVar object at 0x7f4090f65fc0>\nexp_vars = [BaseVar(_var_name='{\"a\": {\"b\": \"footestbar\"}}', _var_type=<class 'dict'>, _var_is_local=True, _var_is_string=False, _...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <[ValidationError(model='Tag', errors=[{'loc': ('name',), 'msg': 'none is not an allowed value', 'type': 'type_error.none.not_allowed'}]) raised in repr()] ComponentNestedVar object at 0x7f4090f65fc0>\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'ComponentNestedVar' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n______________________ test_get_vars[direct-list_of_list] ______________________\n\ncomponent = <[ValidationError(model='Tag', errors=[{'loc': ('name',), 'msg': 'none is not an allowed value', 'type': 'type_error.none.not_allowed'}]) raised in repr()] ComponentNestedVar object at 0x7f4090f65ed0>\nexp_vars = [BaseVar(_var_name='[[\"test\"]]', _var_type=<class 'list'>, _var_is_local=True, _var_is_string=False, _var_full_name_ne...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <[ValidationError(model='Tag', errors=[{'loc': ('name',), 'msg': 'none is not an allowed value', 'type': 'type_error.none.not_allowed'}]) raised in repr()] ComponentNestedVar object at 0x7f4090f65ed0>\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'ComponentNestedVar' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n_____________________ test_get_vars[fstring-list_of_list] ______________________\n\ncomponent = <[ValidationError(model='Tag', errors=[{'loc': ('name',), 'msg': 'none is not an allowed value', 'type': 'type_error.none.not_allowed'}]) raised in repr()] ComponentNestedVar object at 0x7f4090f65840>\nexp_vars = [BaseVar(_var_name='[[\"footestbar\"]]', _var_type=<class 'list'>, _var_is_local=True, _var_is_string=False, _var_full_n...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <[ValidationError(model='Tag', errors=[{'loc': ('name',), 'msg': 'none is not an allowed value', 'type': 'type_error.none.not_allowed'}]) raised in repr()] ComponentNestedVar object at 0x7f4090f65840>\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'ComponentNestedVar' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n__________________ test_get_vars[direct-list_of_list_of_list] __________________\n\ncomponent = <[ValidationError(model='Tag', errors=[{'loc': ('name',), 'msg': 'none is not an allowed value', 'type': 'type_error.none.not_allowed'}]) raised in repr()] ComponentNestedVar object at 0x7f4090f65060>\nexp_vars = [BaseVar(_var_name='[[[\"test\"]]]', _var_type=<class 'list'>, _var_is_local=True, _var_is_string=False, _var_full_name_...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <[ValidationError(model='Tag', errors=[{'loc': ('name',), 'msg': 'none is not an allowed value', 'type': 'type_error.none.not_allowed'}]) raised in repr()] ComponentNestedVar object at 0x7f4090f65060>\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'ComponentNestedVar' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n_________________ test_get_vars[fstring-list_of_list_of_list] __________________\n\ncomponent = <[ValidationError(model='Tag', errors=[{'loc': ('name',), 'msg': 'none is not an allowed value', 'type': 'type_error.none.not_allowed'}]) raised in repr()] ComponentNestedVar object at 0x7f4090f662f0>\nexp_vars = [BaseVar(_var_name='[[[\"footestbar\"]]]', _var_type=<class 'list'>, _var_is_local=True, _var_is_string=False, _var_full...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <[ValidationError(model='Tag', errors=[{'loc': ('name',), 'msg': 'none is not an allowed value', 'type': 'type_error.none.not_allowed'}]) raised in repr()] ComponentNestedVar object at 0x7f4090f662f0>\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'ComponentNestedVar' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n______________________ test_get_vars[direct-list_of_dict] ______________________\n\ncomponent = <[ValidationError(model='Tag', errors=[{'loc': ('name',), 'msg': 'none is not an allowed value', 'type': 'type_error.none.not_allowed'}]) raised in repr()] ComponentNestedVar object at 0x7f4090f65d20>\nexp_vars = [BaseVar(_var_name='[{\"a\": \"test\"}]', _var_type=<class 'list'>, _var_is_local=True, _var_is_string=False, _var_full_na...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <[ValidationError(model='Tag', errors=[{'loc': ('name',), 'msg': 'none is not an allowed value', 'type': 'type_error.none.not_allowed'}]) raised in repr()] ComponentNestedVar object at 0x7f4090f65d20>\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'ComponentNestedVar' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n_____________________ test_get_vars[fstring-list_of_dict] ______________________\n\ncomponent = <[ValidationError(model='Tag', errors=[{'loc': ('name',), 'msg': 'none is not an allowed value', 'type': 'type_error.none.not_allowed'}]) raised in repr()] ComponentNestedVar object at 0x7f4090f66560>\nexp_vars = [BaseVar(_var_name='[{\"a\": \"footestbar\"}]', _var_type=<class 'list'>, _var_is_local=True, _var_is_string=False, _var_f...default=False, alias=None, install=True, render=True, transpile=False)]}, hooks={'useTest': None}, interpolations=[]))]\n\n    @pytest.mark.parametrize(\n        (\"component\", \"exp_vars\"),\n        (\n            pytest.param(\n                Bare.create(TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-bare\",\n            ),\n            pytest.param(\n                Bare.create(f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-bare\",\n            ),\n            pytest.param(\n                rx.text(as_=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-prop\",\n            ),\n            pytest.param(\n                rx.heading(as_=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-prop\",\n            ),\n            pytest.param(\n                rx.fragment(id=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-id\",\n            ),\n            pytest.param(\n                rx.fragment(id=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-id\",\n            ),\n            pytest.param(\n                rx.fragment(key=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-key\",\n            ),\n            pytest.param(\n                rx.fragment(key=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-key\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=TEST_VAR),\n                [TEST_VAR],\n                id=\"direct-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(class_name=f\"foo{TEST_VAR}bar\"),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-class_name\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={TEST_VAR}),\n                [TEST_VAR],\n                id=\"direct-special_props\",\n            ),\n            pytest.param(\n                rx.fragment(special_props={Var.create(f\"foo{TEST_VAR}bar\")}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-special_props\",\n            ),\n            pytest.param(\n                # custom_attrs cannot accept a Var directly as a value\n                rx.fragment(custom_attrs={\"href\": f\"{TEST_VAR}\"}),\n                [TEST_VAR],\n                id=\"fstring-custom_attrs-nofmt\",\n            ),\n            pytest.param(\n                rx.fragment(custom_attrs={\"href\": f\"foo{TEST_VAR}bar\"}),\n                [FORMATTED_TEST_VAR],\n                id=\"fstring-custom_attrs\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=TEST_VAR),\n                [STYLE_VAR],\n                id=\"direct-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(background_color=f\"foo{TEST_VAR}bar\"),\n                [STYLE_VAR],\n                id=\"fstring-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": TEST_VAR}),  # type: ignore\n                [STYLE_VAR],\n                id=\"direct-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(style={\"background_color\": f\"foo{TEST_VAR}bar\"}),  # type: ignore\n                [STYLE_VAR],\n                id=\"fstring-style-background_color\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EVENT_CHAIN_VAR),  # type: ignore\n                [EVENT_CHAIN_VAR],\n                id=\"direct-event-chain\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler),\n                [],\n                id=\"direct-event-handler\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-arg\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=EventState.handler2(EventState.v)),  # type: ignore\n                [ARG_VAR, EventState.v],\n                id=\"direct-event-handler-arg2\",\n            ),\n            pytest.param(\n                rx.fragment(on_click=lambda: EventState.handler2(TEST_VAR)),  # type: ignore\n                [ARG_VAR, TEST_VAR],\n                id=\"direct-event-handler-lambda\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": TEST_VAR}}),\n                [TEST_VAR_DICT_OF_DICT],\n                id=\"direct-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(dict_of_dict={\"a\": {\"b\": f\"foo{TEST_VAR}bar\"}}),\n                [FORMATTED_TEST_VAR_DICT_OF_DICT],\n                id=\"fstring-dict_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[TEST_VAR]]),\n                [TEST_VAR_LIST_OF_LIST],\n                id=\"direct-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list=[[f\"foo{TEST_VAR}bar\"]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST],\n                id=\"fstring-list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[TEST_VAR]]]),\n                [TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"direct-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_list_of_list=[[[f\"foo{TEST_VAR}bar\"]]]),\n                [FORMATTED_TEST_VAR_LIST_OF_LIST_OF_LIST],\n                id=\"fstring-list_of_list_of_list\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": TEST_VAR}]),\n                [TEST_VAR_LIST_OF_DICT],\n                id=\"direct-list_of_dict\",\n            ),\n            pytest.param(\n                ComponentNestedVar.create(list_of_dict=[{\"a\": f\"foo{TEST_VAR}bar\"}]),\n                [FORMATTED_TEST_VAR_LIST_OF_DICT],\n                id=\"fstring-list_of_dict\",\n            ),\n        ),\n    )\n    def test_get_vars(component, exp_vars):\n>       comp_vars = sorted(component._get_vars(), key=lambda v: v._var_name)\n\ntests/components/test_component.py:1292: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <[ValidationError(model='Tag', errors=[{'loc': ('name',), 'msg': 'none is not an allowed value', 'type': 'type_error.none.not_allowed'}]) raised in repr()] ComponentNestedVar object at 0x7f4090f66560>\ninclude_children = False\n\n    def _get_vars(self, include_children: bool = False) -> list[Var]:\n        \"\"\"Walk all Vars used in this component.\n    \n        Args:\n            include_children: Whether to include Vars from children.\n    \n        Returns:\n            Each var referenced by the component (props, styles, event handlers).\n        \"\"\"\n        vars = []\n    \n        # Add vars from props\n>       for prop in self.props.values():\nE       AttributeError: 'ComponentNestedVar' object has no attribute 'props'\n\nreflex/components/component.py:1073: AttributeError\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/components/test_component.py::test_get_vars[direct-prop] - Attri...\nFAILED tests/components/test_component.py::test_get_vars[fstring-prop] - Attr...\nFAILED tests/components/test_component.py::test_get_vars[direct-id] - Attribu...\nFAILED tests/components/test_component.py::test_get_vars[fstring-id] - Attrib...\nFAILED tests/components/test_component.py::test_get_vars[direct-key] - Attrib...\nFAILED tests/components/test_component.py::test_get_vars[fstring-key] - Attri...\nFAILED tests/components/test_component.py::test_get_vars[direct-class_name]\nFAILED tests/components/test_component.py::test_get_vars[fstring-class_name]\nFAILED tests/components/test_component.py::test_get_vars[direct-special_props]\nFAILED tests/components/test_component.py::test_get_vars[fstring-special_props]\nFAILED tests/components/test_component.py::test_get_vars[fstring-custom_attrs-nofmt]\nFAILED tests/components/test_component.py::test_get_vars[fstring-custom_attrs]\nFAILED tests/components/test_component.py::test_get_vars[direct-background_color]\nFAILED tests/components/test_component.py::test_get_vars[fstring-background_color]\nFAILED tests/components/test_component.py::test_get_vars[direct-style-background_color]\nFAILED tests/components/test_component.py::test_get_vars[fstring-style-background_color]\nFAILED tests/components/test_component.py::test_get_vars[direct-event-chain]\nFAILED tests/components/test_component.py::test_get_vars[direct-event-handler]\nFAILED tests/components/test_component.py::test_get_vars[direct-event-handler-arg]\nFAILED tests/components/test_component.py::test_get_vars[direct-event-handler-arg2]\nFAILED tests/components/test_component.py::test_get_vars[direct-event-handler-lambda]\nFAILED tests/components/test_component.py::test_get_vars[direct-dict_of_dict]\nFAILED tests/components/test_component.py::test_get_vars[fstring-dict_of_dict]\nFAILED tests/components/test_component.py::test_get_vars[direct-list_of_list]\nFAILED tests/components/test_component.py::test_get_vars[fstring-list_of_list]\nFAILED tests/components/test_component.py::test_get_vars[direct-list_of_list_of_list]\nFAILED tests/components/test_component.py::test_get_vars[fstring-list_of_list_of_list]\nFAILED tests/components/test_component.py::test_get_vars[direct-list_of_dict]\nFAILED tests/components/test_component.py::test_get_vars[fstring-list_of_dict]\n=================== 29 failed, 2 passed, 5 warnings in 1.97s ===================\n\n"], "reflex-reflex/components/component.py-_has_stateful_event_triggers": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 8 items\n\ntests/components/test_component.py ........                              [100%]\n\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n======================== 8 passed, 5 warnings in 0.71s =========================\n\n"], "reflex-reflex/components/component.py-_get_all_custom_code": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/components/test_component.py .                                     [100%]\n\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n======================== 1 passed, 5 warnings in 0.71s =========================\n\n"], "reflex-reflex/components/component.py-_get_all_imports": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 7 items\n\ntests/components/test_component.py .....FF                               [100%]\n\n=================================== FAILURES ===================================\n______________________ test_custom_component_get_imports _______________________\n\n    def test_custom_component_get_imports():\n        class Inner(Component):\n            tag = \"Inner\"\n            library = \"inner\"\n    \n        class Other(Component):\n            tag = \"Other\"\n            library = \"other\"\n    \n        @rx.memo\n        def wrapper():\n            return Inner.create()\n    \n        @rx.memo\n        def outer(c: Component):\n            return Other.create(c)\n    \n        custom_comp = wrapper()\n    \n        # Inner is not imported directly, but it is imported by the custom component.\n        assert \"inner\" not in custom_comp._get_all_imports()\n    \n        # The imports are only resolved during compilation.\n        _, _, imports_inner = compile_components(custom_comp._get_all_custom_components())\n        assert \"inner\" in imports_inner\n    \n        outer_comp = outer(c=wrapper())\n    \n        # Libraries are not imported directly, but are imported by the custom component.\n        assert \"inner\" not in outer_comp._get_all_imports()\n        assert \"other\" not in outer_comp._get_all_imports()\n    \n        # The imports are only resolved during compilation.\n>       _, _, imports_outer = compile_components(outer_comp._get_all_custom_components())\n\ntests/components/test_component.py:1696: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nreflex/compiler/compiler.py:439: in compile_components\n    code, imports = _compile_components(components)\nreflex/compiler/compiler.py:214: in _compile_components\n    component_render, component_imports = utils.compile_custom_component(component)\nreflex/compiler/utils.py:264: in compile_custom_component\n    for lib, fields in render._get_all_imports().items()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Other\", \"props\": [], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [{\"name\": \"\", \"props\": [], \"contents\": \"{c}\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}], \"autofocus\": false}\ncollapse = False\n\n    def _get_all_imports(self, collapse: bool = False) -> ParsedImportDict:\n        \"\"\"Get all the libraries and fields that are used by the component and its children.\n    \n        Args:\n            collapse: Whether to collapse the imports by removing duplicates.\n    \n        Returns:\n            The import dict with the required imports.\n        \"\"\"\n        # Get imports for this component\n        imports = self._get_imports()\n    \n        # Get imports for all children\n        for child in self.children:\n            if isinstance(child, Component):\n                child_imports = child._get_all_imports(collapse=collapse)\n>               imports = imports.merge(child_imports)\nE               AttributeError: 'collections.defaultdict' object has no attribute 'merge'\n\nreflex/components/component.py:1394: AttributeError\n_______________________________ test_get_imports _______________________________\n\ncomponent1 = <class 'tests.components.test_component.component1.<locals>.TestComponent1'>\ncomponent2 = <class 'tests.components.test_component.component2.<locals>.TestComponent2'>\n\n    def test_get_imports(component1, component2):\n        \"\"\"Test getting the imports of a component.\n    \n        Args:\n            component1: A test component.\n            component2: A test component.\n        \"\"\"\n        c1 = component1.create()\n        c2 = component2.create(c1)\n        assert c1._get_all_imports() == {\"react\": [ImportVar(tag=\"Component\")]}\n>       assert c2._get_all_imports() == {\n            \"react-redux\": [ImportVar(tag=\"connect\")],\n            \"react\": [ImportVar(tag=\"Component\")],\n        }\n\ntests/components/test_component.py:452: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <[ValidationError(model='Tag', errors=[{'loc': ('name',), 'msg': 'none is not an allowed value', 'type': 'type_error.none.not_allowed'}]) raised in repr()] TestComponent2 object at 0x7fdd2f397e50>\ncollapse = False\n\n    def _get_all_imports(self, collapse: bool = False) -> ParsedImportDict:\n        \"\"\"Get all the libraries and fields that are used by the component and its children.\n    \n        Args:\n            collapse: Whether to collapse the imports by removing duplicates.\n    \n        Returns:\n            The import dict with the required imports.\n        \"\"\"\n        # Get imports for this component\n        imports = self._get_imports()\n    \n        # Get imports for all children\n        for child in self.children:\n            if isinstance(child, Component):\n                child_imports = child._get_all_imports(collapse=collapse)\n>               imports = imports.merge(child_imports)\nE               AttributeError: 'dict' object has no attribute 'merge'\n\nreflex/components/component.py:1394: AttributeError\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/components/test_component.py::test_custom_component_get_imports\nFAILED tests/components/test_component.py::test_get_imports - AttributeError:...\n=================== 2 failed, 5 passed, 5 warnings in 0.92s ====================\n\n"], "reflex-reflex/components/component.py-_get_all_hooks_internal": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/components/test_component.py .                                     [100%]\n\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n======================== 1 passed, 5 warnings in 0.76s =========================\n\n"], "reflex-reflex/components/component.py-_get_all_hooks": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/components/test_component.py F                                     [100%]\n\n=================================== FAILURES ===================================\n____________________________ test_get_hooks_nested _____________________________\n\ncomponent1 = <class 'tests.components.test_component.component1.<locals>.TestComponent1'>\ncomponent2 = <class 'tests.components.test_component.component2.<locals>.TestComponent2'>\ncomponent3 = <class 'tests.components.test_component.component3.<locals>.TestComponent3'>\n\n    def test_get_hooks_nested(component1, component2, component3):\n        \"\"\"Test that a component returns hooks from child components.\n    \n        Args:\n            component1: test component.\n            component2: another component.\n            component3: component with hooks defined.\n        \"\"\"\n        c = component1.create(\n            component2.create(arr=[]),\n            component3.create(),\n            component3.create(),\n            component3.create(),\n            text=\"a\",\n            number=1,\n        )\n>       assert c._get_all_hooks() == component3()._get_all_hooks()\n\ntests/components/test_component.py:926: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nreflex/components/component.py:1542: in _get_all_hooks\n    hooks.update(child._get_all_hooks())\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <[ValidationError(model='Tag', errors=[{'loc': ('name',), 'msg': 'none is not an allowed value', 'type': 'type_error.none.not_allowed'}]) raised in repr()] TestComponent3 object at 0x7f20550a6710>\n\n    def _get_all_hooks(self) -> dict[str, None]:\n        \"\"\"Get the React hooks for this component and its children.\n    \n        Returns:\n            The code that should appear just before returning the rendered component.\n        \"\"\"\n        hooks = {}\n    \n        # Get hooks for this component\n>       hooks.update(self._get_hooks() or {})\nE       ValueError: dictionary update sequence element #0 has length 1; 2 is required\n\nreflex/components/component.py:1537: ValueError\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/components/test_component.py::test_get_hooks_nested - ValueError...\n======================== 1 failed, 5 warnings in 0.83s =========================\n\n"], "reflex-reflex/components/component.py-_get_all_custom_components": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 2 items\n\ntests/components/test_component.py FF                                    [100%]\n\n=================================== FAILURES ===================================\n_________________________ test_create_custom_component _________________________\n\nmy_component = <function my_component.<locals>.my_component at 0x7f9c6b541ab0>\n\n    def test_create_custom_component(my_component):\n        \"\"\"Test that we can create a custom component.\n    \n        Args:\n            my_component: A test custom component.\n        \"\"\"\n        component = CustomComponent(component_fn=my_component, prop1=\"test\", prop2=1)\n        assert component.tag == \"MyComponent\"\n        assert component.get_props() == set()\n>       assert component._get_all_custom_components() == {component}\n\ntests/components/test_component.py:842: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nreflex/components/component.py:1780: in _get_all_custom_components\n    custom_components = {self} | super()._get_all_custom_components(seen=seen)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"MyComponent\", \"props\": [\"prop1={`test`}\", \"prop2={1}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nseen = set()\n\n    def _get_all_custom_components(self, seen: set[str] | None = None) -> Set[CustomComponent]:\n        \"\"\"Get all the custom components used by the component.\n    \n        Args:\n            seen: The tags of the components that have already been seen.\n    \n        Returns:\n            The set of custom components.\n        \"\"\"\n        assert self.tag is not None, \"The tag must be set.\"\n    \n        # Store the seen components in a set to avoid infinite recursion.\n        if seen is None:\n            seen = set()\n>       custom_components = {self} | super()._get_all_custom_components(seen=seen)\nE       AttributeError: 'super' object has no attribute '_get_all_custom_components'\n\nreflex/components/component.py:1589: AttributeError\n______________________ test_custom_component_get_imports _______________________\n\n    def test_custom_component_get_imports():\n        class Inner(Component):\n            tag = \"Inner\"\n            library = \"inner\"\n    \n        class Other(Component):\n            tag = \"Other\"\n            library = \"other\"\n    \n        @rx.memo\n        def wrapper():\n            return Inner.create()\n    \n        @rx.memo\n        def outer(c: Component):\n            return Other.create(c)\n    \n        custom_comp = wrapper()\n    \n        # Inner is not imported directly, but it is imported by the custom component.\n        assert \"inner\" not in custom_comp._get_all_imports()\n    \n        # The imports are only resolved during compilation.\n>       _, _, imports_inner = compile_components(custom_comp._get_all_custom_components())\n\ntests/components/test_component.py:1686: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nreflex/components/component.py:1780: in _get_all_custom_components\n    custom_components = {self} | super()._get_all_custom_components(seen=seen)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = {\"name\": \"Wrapper\", \"props\": [], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}\nseen = set()\n\n    def _get_all_custom_components(self, seen: set[str] | None = None) -> Set[CustomComponent]:\n        \"\"\"Get all the custom components used by the component.\n    \n        Args:\n            seen: The tags of the components that have already been seen.\n    \n        Returns:\n            The set of custom components.\n        \"\"\"\n        assert self.tag is not None, \"The tag must be set.\"\n    \n        # Store the seen components in a set to avoid infinite recursion.\n        if seen is None:\n            seen = set()\n>       custom_components = {self} | super()._get_all_custom_components(seen=seen)\nE       AttributeError: 'super' object has no attribute '_get_all_custom_components'\n\nreflex/components/component.py:1589: AttributeError\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/components/test_component.py::test_create_custom_component - Att...\nFAILED tests/components/test_component.py::test_custom_component_get_imports\n======================== 2 failed, 5 warnings in 0.86s =========================\n\n"], "reflex-reflex/components/core/upload.py-create": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 3 items\n\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n============================= 5 warnings in 0.03s ==============================\n\nERROR: not found: /root/repos/py_data/reflex/tests/test_app.py::page\n(no match in any of [<Module test_app.py>])\n\n"], "reflex-reflex/components/next/image.py-create": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 2 items\n\ntests/components/media/test_image.py .F                                  [100%]\n\n=================================== FAILURES ===================================\n_________________________________ test_render __________________________________\n\npil_image = <PIL.Image.Image image mode=RGBA size=100x100 at 0x7F78CC2B7520>\n\n    def test_render(pil_image: Img):\n        \"\"\"Test that rendering an image works.\n    \n        Args:\n            pil_image: The image to serialize.\n        \"\"\"\n        image = Image.create(src=pil_image)\n>       assert image.src._var_is_string  # type: ignore\nE       assert False\nE        +  where False = BaseVar(_var_name='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAACJTElEQVR4nATBB0AIChRA0dtUmqLSV... 'PIL.Image.Image'>, _var_is_local=True, _var_is_string=False, _var_full_name_needs_state_prefix=False, _var_data=None)._var_is_string\nE        +    where BaseVar(_var_name='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAACJTElEQVR4nATBB0AIChRA0dtUmqLSV... 'PIL.Image.Image'>, _var_is_local=True, _var_is_string=False, _var_full_name_needs_state_prefix=False, _var_data=None) = {\"name\": \"Image\", \"props\": [\"src={data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAACJTElEQVR4nATBB0...H/v0tepM/aAAAAAElFTkSuQmCC}\"], \"contents\": \"\", \"args\": null, \"special_props\": \"[]\", \"children\": [], \"autofocus\": false}.src\n\ntests/components/media/test_image.py:61: AssertionError\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/components/media/test_image.py::test_render - assert False\n=================== 1 failed, 1 passed, 5 warnings in 0.13s ====================\n\n"], "reflex-reflex/components/lucide/icon.py-create": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 3 items\n\ntests/components/radix/test_icon_button.py .FF                           [100%]\n\n=================================== FAILURES ===================================\n__________________________ test_icon_button_size_prop __________________________\n\n    def test_icon_button_size_prop():\n>       ib1 = IconButton.create(\"activity\", size=\"2\")\n\ntests/components/radix/test_icon_button.py:26: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nreflex/components/radix/themes/components/icon_button.py:66: in create\n    Icon.create(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'reflex.components.lucide.icon.Icon'>, children = ('activity',)\nprops = {}\n\n    @classmethod\n    @classmethod\n    def create(cls, *children, **props) -> Component:\n        \"\"\"Initialize the Icon component.\n    \n        Run some additional checks on Icon component.\n    \n        Args:\n            *children: The positional arguments\n            **props: The keyword arguments\n    \n        Raises:\n            AttributeError: The errors tied to bad usage of the Icon component.\n            ValueError: If the icon tag is invalid.\n    \n        Returns:\n            The created component.\n        \"\"\"\n        # Check if children are provided\n        if len(children) > 0:\n>           raise AttributeError(\"Icon component does not accept children. Use the 'tag' prop to specify the icon.\")\nE           AttributeError: Icon component does not accept children. Use the 'tag' prop to specify the icon.\n\nreflex/components/lucide/icon.py:42: AttributeError\n_______________________________ test_icon_button _______________________________\n\n    def test_icon_button():\n>       ib1 = IconButton.create(\"activity\")\n\ntests/components/radix/test_icon_button.py:10: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nreflex/components/radix/themes/components/icon_button.py:66: in create\n    Icon.create(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'reflex.components.lucide.icon.Icon'>, children = ('activity',)\nprops = {}\n\n    @classmethod\n    @classmethod\n    def create(cls, *children, **props) -> Component:\n        \"\"\"Initialize the Icon component.\n    \n        Run some additional checks on Icon component.\n    \n        Args:\n            *children: The positional arguments\n            **props: The keyword arguments\n    \n        Raises:\n            AttributeError: The errors tied to bad usage of the Icon component.\n            ValueError: If the icon tag is invalid.\n    \n        Returns:\n            The created component.\n        \"\"\"\n        # Check if children are provided\n        if len(children) > 0:\n>           raise AttributeError(\"Icon component does not accept children. Use the 'tag' prop to specify the icon.\")\nE           AttributeError: Icon component does not accept children. Use the 'tag' prop to specify the icon.\n\nreflex/components/lucide/icon.py:42: AttributeError\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/components/radix/test_icon_button.py::test_icon_button_size_prop\nFAILED tests/components/radix/test_icon_button.py::test_icon_button - Attribu...\n=================== 2 failed, 1 passed, 5 warnings in 0.13s ====================\n\n"], "reflex-reflex/components/tags/tag.py-format_props": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/reflex\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/utils/test_format.py .                                             [100%]\n\n=============================== warnings summary ===============================\nreflex/utils/prerequisites.py:26\n  /root/repos/py_data/reflex/reflex/utils/prerequisites.py:26: DeprecationWarning:\n  \n  pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:3154: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google.cloud')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n../../../../usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563\n  /usr/local/lib/python3.10/site-packages/pkg_resources/__init__.py:2563: DeprecationWarning:\n  \n  Deprecated call to `pkg_resources.declare_namespace('google')`.\n  Implementing implicit namespace packages (as specified in PEP 420) is preferred to `pkg_resources.declare_namespace`. See https://setuptools.pypa.io/en/latest/references/keywords.html#keyword-namespace-packages\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n======================== 1 passed, 5 warnings in 0.38s =========================\n\n"], "textual-src/textual/screen.py-focus_next": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 8 items\n\ntests/test_focus.py ........                                             [100%]\n\n=============================== warnings summary ===============================\ntests/test_focus.py::test_focus_next_and_previous_with_str_selector_without_self\ntests/test_focus.py::test_focus_next_and_previous_with_type_selector_without_self\ntests/test_focus.py::test_wrap_around_selector\ntests/test_focus.py::test_focus_next_wrap_around\ntests/test_focus.py::test_no_focus_empty_selector\ntests/test_focus.py::test_focus_next_and_previous\ntests/test_focus.py::test_focus_next_and_previous_with_str_selector\ntests/test_focus.py::test_focus_next_and_previous_with_type_selector\n  /root/repos/py_data/textual/src/textual/app.py:2108: DeprecationWarning: There is no current event loop\n    future: asyncio.Future[ScreenResultType] = asyncio.Future()\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n======================== 8 passed, 8 warnings in 0.14s =========================\n\n"], "textual-src/textual/screen.py-focus_previous": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 8 items\n\ntests/test_focus.py ........                                             [100%]\n\n=============================== warnings summary ===============================\ntests/test_focus.py::test_focus_next_and_previous_with_str_selector_without_self\ntests/test_focus.py::test_focus_next_and_previous_with_type_selector_without_self\ntests/test_focus.py::test_wrap_around_selector\ntests/test_focus.py::test_no_focus_empty_selector\ntests/test_focus.py::test_focus_next_and_previous\ntests/test_focus.py::test_focus_next_and_previous_with_str_selector\ntests/test_focus.py::test_focus_next_and_previous_with_type_selector\ntests/test_focus.py::test_focus_previous_wrap_around\n  /root/repos/py_data/textual/src/textual/app.py:2108: DeprecationWarning: There is no current event loop\n    future: asyncio.Future[ScreenResultType] = asyncio.Future()\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n======================== 8 passed, 8 warnings in 0.14s =========================\n\n"], "textual-src/textual/screen.py-set_focus": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 8 items\n\ntests/test_focus.py FFFFFFFF                                             [100%]\n\n=================================== FAILURES ===================================\n_________ test_focus_next_and_previous_with_str_selector_without_self __________\n\nscreen = Screen()\n\n    def test_focus_next_and_previous_with_str_selector_without_self(screen: Screen):\n        \"\"\"Test moving the focus with a selector that does not match the currently focused node.\"\"\"\n>       screen.set_focus(screen.query_one(\"#foo\"))\n\ntests/test_focus.py:236: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Screen(), widget = Focusable(id='foo'), scroll_visible = True\n\n    def set_focus(self, widget: Widget | None, scroll_visible: bool = True) -> None:\n        \"\"\"Focus (or un-focus) a widget. A focused widget will receive key events first.\n    \n        Args:\n            widget: Widget to focus, or None to un-focus.\n            scroll_visible: Scroll widget in to view.\n        \"\"\"\n        if widget is not None and not widget.can_focus:\n            return\n    \n        if widget is self.focused:\n            return\n    \n        if self.focused is not None:\n            self.focused.blur()\n    \n        self.focused = widget\n    \n        if widget is not None:\n>           widget._on_focus(scroll_visible=scroll_visible)\nE           TypeError: Widget._on_focus() got an unexpected keyword argument 'scroll_visible'\n\nsrc/textual/screen.py:709: TypeError\n_________ test_focus_next_and_previous_with_type_selector_without_self _________\n\n    def test_focus_next_and_previous_with_type_selector_without_self():\n        \"\"\"Test moving the focus with a selector that does not match the currently focused node.\"\"\"\n        app = App()\n        app._set_active()\n        app.push_screen(Screen())\n    \n        screen = app.screen\n    \n        from textual.containers import Horizontal, VerticalScroll\n        from textual.widgets import Button, Input, Switch\n    \n        screen._add_children(\n            VerticalScroll(\n                Horizontal(\n                    Input(id=\"w3\"),\n                    Switch(id=\"w4\"),\n                    Input(id=\"w5\"),\n                    Button(id=\"w6\"),\n                    Switch(id=\"w7\"),\n                    id=\"w2\",\n                ),\n                Horizontal(\n                    Button(id=\"w9\"),\n                    Switch(id=\"w10\"),\n                    Button(id=\"w11\"),\n                    Input(id=\"w12\"),\n                    Input(id=\"w13\"),\n                    id=\"w8\",\n                ),\n                id=\"w1\",\n            )\n        )\n    \n>       screen.set_focus(screen.query_one(\"#w3\"))\n\ntests/test_focus.py:221: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Screen(), widget = Input(id='w3'), scroll_visible = True\n\n    def set_focus(self, widget: Widget | None, scroll_visible: bool = True) -> None:\n        \"\"\"Focus (or un-focus) a widget. A focused widget will receive key events first.\n    \n        Args:\n            widget: Widget to focus, or None to un-focus.\n            scroll_visible: Scroll widget in to view.\n        \"\"\"\n        if widget is not None and not widget.can_focus:\n            return\n    \n        if widget is self.focused:\n            return\n    \n        if self.focused is not None:\n            self.focused.blur()\n    \n        self.focused = widget\n    \n        if widget is not None:\n>           widget._on_focus(scroll_visible=scroll_visible)\nE           TypeError: Input._on_focus() got an unexpected keyword argument 'scroll_visible'\n\nsrc/textual/screen.py:709: TypeError\n__________________________ test_wrap_around_selector ___________________________\n\nscreen = Screen()\n\n    def test_wrap_around_selector(screen: Screen):\n        \"\"\"Ensure moving focus in both directions wraps around the focus chain.\"\"\"\n>       screen.set_focus(screen.query_one(\"#foo\"))\n\ntests/test_focus.py:138: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Screen(), widget = Focusable(id='foo'), scroll_visible = True\n\n    def set_focus(self, widget: Widget | None, scroll_visible: bool = True) -> None:\n        \"\"\"Focus (or un-focus) a widget. A focused widget will receive key events first.\n    \n        Args:\n            widget: Widget to focus, or None to un-focus.\n            scroll_visible: Scroll widget in to view.\n        \"\"\"\n        if widget is not None and not widget.can_focus:\n            return\n    \n        if widget is self.focused:\n            return\n    \n        if self.focused is not None:\n            self.focused.blur()\n    \n        self.focused = widget\n    \n        if widget is not None:\n>           widget._on_focus(scroll_visible=scroll_visible)\nE           TypeError: Widget._on_focus() got an unexpected keyword argument 'scroll_visible'\n\nsrc/textual/screen.py:709: TypeError\n_________________________ test_focus_next_wrap_around __________________________\n\nscreen = Screen()\n\n    def test_focus_next_wrap_around(screen: Screen):\n        \"\"\"Ensure focusing the next widget wraps around the focus chain.\"\"\"\n>       screen.set_focus(screen.query_one(\"#child\"))\n\ntests/test_focus.py:122: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Screen(), widget = Focusable(id='child'), scroll_visible = True\n\n    def set_focus(self, widget: Widget | None, scroll_visible: bool = True) -> None:\n        \"\"\"Focus (or un-focus) a widget. A focused widget will receive key events first.\n    \n        Args:\n            widget: Widget to focus, or None to un-focus.\n            scroll_visible: Scroll widget in to view.\n        \"\"\"\n        if widget is not None and not widget.can_focus:\n            return\n    \n        if widget is self.focused:\n            return\n    \n        if self.focused is not None:\n            self.focused.blur()\n    \n        self.focused = widget\n    \n        if widget is not None:\n>           widget._on_focus(scroll_visible=scroll_visible)\nE           TypeError: Widget._on_focus() got an unexpected keyword argument 'scroll_visible'\n\nsrc/textual/screen.py:709: TypeError\n_________________________ test_no_focus_empty_selector _________________________\n\nscreen = Screen()\n\n    def test_no_focus_empty_selector(screen: Screen):\n        \"\"\"Ensure focus is cleared when selector matches nothing.\"\"\"\n        assert screen.focus_next(\"#bananas\") is None\n        assert screen.focus_previous(\"#bananas\") is None\n    \n>       screen.set_focus(screen.query_one(\"#foo\"))\n\ntests/test_focus.py:150: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Screen(), widget = Focusable(id='foo'), scroll_visible = True\n\n    def set_focus(self, widget: Widget | None, scroll_visible: bool = True) -> None:\n        \"\"\"Focus (or un-focus) a widget. A focused widget will receive key events first.\n    \n        Args:\n            widget: Widget to focus, or None to un-focus.\n            scroll_visible: Scroll widget in to view.\n        \"\"\"\n        if widget is not None and not widget.can_focus:\n            return\n    \n        if widget is self.focused:\n            return\n    \n        if self.focused is not None:\n            self.focused.blur()\n    \n        self.focused = widget\n    \n        if widget is not None:\n>           widget._on_focus(scroll_visible=scroll_visible)\nE           TypeError: Widget._on_focus() got an unexpected keyword argument 'scroll_visible'\n\nsrc/textual/screen.py:709: TypeError\n________________ test_focus_next_and_previous_with_str_selector ________________\n\nscreen = Screen()\n\n    def test_focus_next_and_previous_with_str_selector(screen: Screen):\n        \"\"\"Move focus with a selector that matches the currently focused node.\"\"\"\n>       screen.set_focus(screen.query_one(\"#foo\"))\n\ntests/test_focus.py:177: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Screen(), widget = Focusable(id='foo'), scroll_visible = True\n\n    def set_focus(self, widget: Widget | None, scroll_visible: bool = True) -> None:\n        \"\"\"Focus (or un-focus) a widget. A focused widget will receive key events first.\n    \n        Args:\n            widget: Widget to focus, or None to un-focus.\n            scroll_visible: Scroll widget in to view.\n        \"\"\"\n        if widget is not None and not widget.can_focus:\n            return\n    \n        if widget is self.focused:\n            return\n    \n        if self.focused is not None:\n            self.focused.blur()\n    \n        self.focused = widget\n    \n        if widget is not None:\n>           widget._on_focus(scroll_visible=scroll_visible)\nE           TypeError: Widget._on_focus() got an unexpected keyword argument 'scroll_visible'\n\nsrc/textual/screen.py:709: TypeError\n_______________ test_focus_next_and_previous_with_type_selector ________________\n\nscreen = Screen()\n\n    def test_focus_next_and_previous_with_type_selector(screen: Screen):\n        \"\"\"Move focus with a selector that matches the currently focused node.\"\"\"\n>       screen.set_focus(screen.query_one(\"#Paul\"))\n\ntests/test_focus.py:163: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Screen(), widget = Focusable(id='Paul'), scroll_visible = True\n\n    def set_focus(self, widget: Widget | None, scroll_visible: bool = True) -> None:\n        \"\"\"Focus (or un-focus) a widget. A focused widget will receive key events first.\n    \n        Args:\n            widget: Widget to focus, or None to un-focus.\n            scroll_visible: Scroll widget in to view.\n        \"\"\"\n        if widget is not None and not widget.can_focus:\n            return\n    \n        if widget is self.focused:\n            return\n    \n        if self.focused is not None:\n            self.focused.blur()\n    \n        self.focused = widget\n    \n        if widget is not None:\n>           widget._on_focus(scroll_visible=scroll_visible)\nE           TypeError: Widget._on_focus() got an unexpected keyword argument 'scroll_visible'\n\nsrc/textual/screen.py:709: TypeError\n_______________________ test_focus_previous_wrap_around ________________________\n\nscreen = Screen()\n\n    def test_focus_previous_wrap_around(screen: Screen):\n        \"\"\"Ensure focusing the previous widget wraps around the focus chain.\"\"\"\n>       screen.set_focus(screen.query_one(\"#foo\"))\n\ntests/test_focus.py:130: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Screen(), widget = Focusable(id='foo'), scroll_visible = True\n\n    def set_focus(self, widget: Widget | None, scroll_visible: bool = True) -> None:\n        \"\"\"Focus (or un-focus) a widget. A focused widget will receive key events first.\n    \n        Args:\n            widget: Widget to focus, or None to un-focus.\n            scroll_visible: Scroll widget in to view.\n        \"\"\"\n        if widget is not None and not widget.can_focus:\n            return\n    \n        if widget is self.focused:\n            return\n    \n        if self.focused is not None:\n            self.focused.blur()\n    \n        self.focused = widget\n    \n        if widget is not None:\n>           widget._on_focus(scroll_visible=scroll_visible)\nE           TypeError: Widget._on_focus() got an unexpected keyword argument 'scroll_visible'\n\nsrc/textual/screen.py:709: TypeError\n=============================== warnings summary ===============================\ntests/test_focus.py::test_focus_next_and_previous_with_str_selector_without_self\ntests/test_focus.py::test_focus_next_and_previous_with_type_selector_without_self\ntests/test_focus.py::test_wrap_around_selector\ntests/test_focus.py::test_focus_next_wrap_around\ntests/test_focus.py::test_no_focus_empty_selector\ntests/test_focus.py::test_focus_next_and_previous_with_str_selector\ntests/test_focus.py::test_focus_next_and_previous_with_type_selector\ntests/test_focus.py::test_focus_previous_wrap_around\n  /root/repos/py_data/textual/src/textual/app.py:2108: DeprecationWarning: There is no current event loop\n    future: asyncio.Future[ScreenResultType] = asyncio.Future()\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_focus.py::test_focus_next_and_previous_with_str_selector_without_self\nFAILED tests/test_focus.py::test_focus_next_and_previous_with_type_selector_without_self\nFAILED tests/test_focus.py::test_wrap_around_selector - TypeError: Widget._on...\nFAILED tests/test_focus.py::test_focus_next_wrap_around - TypeError: Widget._...\nFAILED tests/test_focus.py::test_no_focus_empty_selector - TypeError: Widget....\nFAILED tests/test_focus.py::test_focus_next_and_previous_with_str_selector - ...\nFAILED tests/test_focus.py::test_focus_next_and_previous_with_type_selector\nFAILED tests/test_focus.py::test_focus_previous_wrap_around - TypeError: Widg...\n======================== 8 failed, 8 warnings in 0.26s =========================\n\n"], "textual-src/textual/strip.py-index_to_cell_position": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 14 items\n\ntests/test_strip.py .FFFFFFFFFFFFF                                       [100%]\n\n=================================== FAILURES ===================================\n_______________________ test_index_to_cell_position[1-1] _______________________\n\nindex = 1, cell_position = 1\n\n    @pytest.mark.parametrize(\n        \"index,cell_position\",\n        [\n            (0, 0),\n            (1, 1),\n            (2, 2),\n            (3, 3),\n            (4, 4),\n            (5, 6),\n            (6, 8),\n            (7, 10),\n            (8, 11),\n            (9, 12),\n            (10, 13),\n            (11, 14),\n        ],\n    )\n    def test_index_to_cell_position(index, cell_position):\n        strip = Strip([Segment(\"ab\"), Segment(\"cd\u65e5\u672c\u8a9eef\"), Segment(\"gh\")])\n>       assert cell_position == strip.index_to_cell_position(index)\n\ntests/test_strip.py:180: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Strip([Segment('ab'), Segment('cd\u65e5\u672c\u8a9eef'), Segment('gh')], 14), index = 1\n\n    def index_to_cell_position(self, index: int) -> int:\n        \"\"\"Given a character index, return the cell position of that character.\n        This is the sum of the cell lengths of all the characters *before* the character\n        at `index`.\n    \n        Args:\n            index: The index to convert.\n    \n        Returns:\n            The cell position of the character at `index`.\n        \"\"\"\n        cell_position = 0\n        for i, char in enumerate(self.text):\n            if i == index:\n                return cell_position\n>           cell_position += self.get_cell_length(char)\nE           AttributeError: 'Strip' object has no attribute 'get_cell_length'. Did you mean: '_cell_length'?\n\nsrc/textual/strip.py:173: AttributeError\n_______________________ test_index_to_cell_position[2-2] _______________________\n\nindex = 2, cell_position = 2\n\n    @pytest.mark.parametrize(\n        \"index,cell_position\",\n        [\n            (0, 0),\n            (1, 1),\n            (2, 2),\n            (3, 3),\n            (4, 4),\n            (5, 6),\n            (6, 8),\n            (7, 10),\n            (8, 11),\n            (9, 12),\n            (10, 13),\n            (11, 14),\n        ],\n    )\n    def test_index_to_cell_position(index, cell_position):\n        strip = Strip([Segment(\"ab\"), Segment(\"cd\u65e5\u672c\u8a9eef\"), Segment(\"gh\")])\n>       assert cell_position == strip.index_to_cell_position(index)\n\ntests/test_strip.py:180: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Strip([Segment('ab'), Segment('cd\u65e5\u672c\u8a9eef'), Segment('gh')], 14), index = 2\n\n    def index_to_cell_position(self, index: int) -> int:\n        \"\"\"Given a character index, return the cell position of that character.\n        This is the sum of the cell lengths of all the characters *before* the character\n        at `index`.\n    \n        Args:\n            index: The index to convert.\n    \n        Returns:\n            The cell position of the character at `index`.\n        \"\"\"\n        cell_position = 0\n        for i, char in enumerate(self.text):\n            if i == index:\n                return cell_position\n>           cell_position += self.get_cell_length(char)\nE           AttributeError: 'Strip' object has no attribute 'get_cell_length'. Did you mean: '_cell_length'?\n\nsrc/textual/strip.py:173: AttributeError\n_______________________ test_index_to_cell_position[3-3] _______________________\n\nindex = 3, cell_position = 3\n\n    @pytest.mark.parametrize(\n        \"index,cell_position\",\n        [\n            (0, 0),\n            (1, 1),\n            (2, 2),\n            (3, 3),\n            (4, 4),\n            (5, 6),\n            (6, 8),\n            (7, 10),\n            (8, 11),\n            (9, 12),\n            (10, 13),\n            (11, 14),\n        ],\n    )\n    def test_index_to_cell_position(index, cell_position):\n        strip = Strip([Segment(\"ab\"), Segment(\"cd\u65e5\u672c\u8a9eef\"), Segment(\"gh\")])\n>       assert cell_position == strip.index_to_cell_position(index)\n\ntests/test_strip.py:180: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Strip([Segment('ab'), Segment('cd\u65e5\u672c\u8a9eef'), Segment('gh')], 14), index = 3\n\n    def index_to_cell_position(self, index: int) -> int:\n        \"\"\"Given a character index, return the cell position of that character.\n        This is the sum of the cell lengths of all the characters *before* the character\n        at `index`.\n    \n        Args:\n            index: The index to convert.\n    \n        Returns:\n            The cell position of the character at `index`.\n        \"\"\"\n        cell_position = 0\n        for i, char in enumerate(self.text):\n            if i == index:\n                return cell_position\n>           cell_position += self.get_cell_length(char)\nE           AttributeError: 'Strip' object has no attribute 'get_cell_length'. Did you mean: '_cell_length'?\n\nsrc/textual/strip.py:173: AttributeError\n_______________________ test_index_to_cell_position[4-4] _______________________\n\nindex = 4, cell_position = 4\n\n    @pytest.mark.parametrize(\n        \"index,cell_position\",\n        [\n            (0, 0),\n            (1, 1),\n            (2, 2),\n            (3, 3),\n            (4, 4),\n            (5, 6),\n            (6, 8),\n            (7, 10),\n            (8, 11),\n            (9, 12),\n            (10, 13),\n            (11, 14),\n        ],\n    )\n    def test_index_to_cell_position(index, cell_position):\n        strip = Strip([Segment(\"ab\"), Segment(\"cd\u65e5\u672c\u8a9eef\"), Segment(\"gh\")])\n>       assert cell_position == strip.index_to_cell_position(index)\n\ntests/test_strip.py:180: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Strip([Segment('ab'), Segment('cd\u65e5\u672c\u8a9eef'), Segment('gh')], 14), index = 4\n\n    def index_to_cell_position(self, index: int) -> int:\n        \"\"\"Given a character index, return the cell position of that character.\n        This is the sum of the cell lengths of all the characters *before* the character\n        at `index`.\n    \n        Args:\n            index: The index to convert.\n    \n        Returns:\n            The cell position of the character at `index`.\n        \"\"\"\n        cell_position = 0\n        for i, char in enumerate(self.text):\n            if i == index:\n                return cell_position\n>           cell_position += self.get_cell_length(char)\nE           AttributeError: 'Strip' object has no attribute 'get_cell_length'. Did you mean: '_cell_length'?\n\nsrc/textual/strip.py:173: AttributeError\n_______________________ test_index_to_cell_position[5-6] _______________________\n\nindex = 5, cell_position = 6\n\n    @pytest.mark.parametrize(\n        \"index,cell_position\",\n        [\n            (0, 0),\n            (1, 1),\n            (2, 2),\n            (3, 3),\n            (4, 4),\n            (5, 6),\n            (6, 8),\n            (7, 10),\n            (8, 11),\n            (9, 12),\n            (10, 13),\n            (11, 14),\n        ],\n    )\n    def test_index_to_cell_position(index, cell_position):\n        strip = Strip([Segment(\"ab\"), Segment(\"cd\u65e5\u672c\u8a9eef\"), Segment(\"gh\")])\n>       assert cell_position == strip.index_to_cell_position(index)\n\ntests/test_strip.py:180: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Strip([Segment('ab'), Segment('cd\u65e5\u672c\u8a9eef'), Segment('gh')], 14), index = 5\n\n    def index_to_cell_position(self, index: int) -> int:\n        \"\"\"Given a character index, return the cell position of that character.\n        This is the sum of the cell lengths of all the characters *before* the character\n        at `index`.\n    \n        Args:\n            index: The index to convert.\n    \n        Returns:\n            The cell position of the character at `index`.\n        \"\"\"\n        cell_position = 0\n        for i, char in enumerate(self.text):\n            if i == index:\n                return cell_position\n>           cell_position += self.get_cell_length(char)\nE           AttributeError: 'Strip' object has no attribute 'get_cell_length'. Did you mean: '_cell_length'?\n\nsrc/textual/strip.py:173: AttributeError\n_______________________ test_index_to_cell_position[6-8] _______________________\n\nindex = 6, cell_position = 8\n\n    @pytest.mark.parametrize(\n        \"index,cell_position\",\n        [\n            (0, 0),\n            (1, 1),\n            (2, 2),\n            (3, 3),\n            (4, 4),\n            (5, 6),\n            (6, 8),\n            (7, 10),\n            (8, 11),\n            (9, 12),\n            (10, 13),\n            (11, 14),\n        ],\n    )\n    def test_index_to_cell_position(index, cell_position):\n        strip = Strip([Segment(\"ab\"), Segment(\"cd\u65e5\u672c\u8a9eef\"), Segment(\"gh\")])\n>       assert cell_position == strip.index_to_cell_position(index)\n\ntests/test_strip.py:180: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Strip([Segment('ab'), Segment('cd\u65e5\u672c\u8a9eef'), Segment('gh')], 14), index = 6\n\n    def index_to_cell_position(self, index: int) -> int:\n        \"\"\"Given a character index, return the cell position of that character.\n        This is the sum of the cell lengths of all the characters *before* the character\n        at `index`.\n    \n        Args:\n            index: The index to convert.\n    \n        Returns:\n            The cell position of the character at `index`.\n        \"\"\"\n        cell_position = 0\n        for i, char in enumerate(self.text):\n            if i == index:\n                return cell_position\n>           cell_position += self.get_cell_length(char)\nE           AttributeError: 'Strip' object has no attribute 'get_cell_length'. Did you mean: '_cell_length'?\n\nsrc/textual/strip.py:173: AttributeError\n______________________ test_index_to_cell_position[7-10] _______________________\n\nindex = 7, cell_position = 10\n\n    @pytest.mark.parametrize(\n        \"index,cell_position\",\n        [\n            (0, 0),\n            (1, 1),\n            (2, 2),\n            (3, 3),\n            (4, 4),\n            (5, 6),\n            (6, 8),\n            (7, 10),\n            (8, 11),\n            (9, 12),\n            (10, 13),\n            (11, 14),\n        ],\n    )\n    def test_index_to_cell_position(index, cell_position):\n        strip = Strip([Segment(\"ab\"), Segment(\"cd\u65e5\u672c\u8a9eef\"), Segment(\"gh\")])\n>       assert cell_position == strip.index_to_cell_position(index)\n\ntests/test_strip.py:180: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Strip([Segment('ab'), Segment('cd\u65e5\u672c\u8a9eef'), Segment('gh')], 14), index = 7\n\n    def index_to_cell_position(self, index: int) -> int:\n        \"\"\"Given a character index, return the cell position of that character.\n        This is the sum of the cell lengths of all the characters *before* the character\n        at `index`.\n    \n        Args:\n            index: The index to convert.\n    \n        Returns:\n            The cell position of the character at `index`.\n        \"\"\"\n        cell_position = 0\n        for i, char in enumerate(self.text):\n            if i == index:\n                return cell_position\n>           cell_position += self.get_cell_length(char)\nE           AttributeError: 'Strip' object has no attribute 'get_cell_length'. Did you mean: '_cell_length'?\n\nsrc/textual/strip.py:173: AttributeError\n______________________ test_index_to_cell_position[8-11] _______________________\n\nindex = 8, cell_position = 11\n\n    @pytest.mark.parametrize(\n        \"index,cell_position\",\n        [\n            (0, 0),\n            (1, 1),\n            (2, 2),\n            (3, 3),\n            (4, 4),\n            (5, 6),\n            (6, 8),\n            (7, 10),\n            (8, 11),\n            (9, 12),\n            (10, 13),\n            (11, 14),\n        ],\n    )\n    def test_index_to_cell_position(index, cell_position):\n        strip = Strip([Segment(\"ab\"), Segment(\"cd\u65e5\u672c\u8a9eef\"), Segment(\"gh\")])\n>       assert cell_position == strip.index_to_cell_position(index)\n\ntests/test_strip.py:180: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Strip([Segment('ab'), Segment('cd\u65e5\u672c\u8a9eef'), Segment('gh')], 14), index = 8\n\n    def index_to_cell_position(self, index: int) -> int:\n        \"\"\"Given a character index, return the cell position of that character.\n        This is the sum of the cell lengths of all the characters *before* the character\n        at `index`.\n    \n        Args:\n            index: The index to convert.\n    \n        Returns:\n            The cell position of the character at `index`.\n        \"\"\"\n        cell_position = 0\n        for i, char in enumerate(self.text):\n            if i == index:\n                return cell_position\n>           cell_position += self.get_cell_length(char)\nE           AttributeError: 'Strip' object has no attribute 'get_cell_length'. Did you mean: '_cell_length'?\n\nsrc/textual/strip.py:173: AttributeError\n______________________ test_index_to_cell_position[9-12] _______________________\n\nindex = 9, cell_position = 12\n\n    @pytest.mark.parametrize(\n        \"index,cell_position\",\n        [\n            (0, 0),\n            (1, 1),\n            (2, 2),\n            (3, 3),\n            (4, 4),\n            (5, 6),\n            (6, 8),\n            (7, 10),\n            (8, 11),\n            (9, 12),\n            (10, 13),\n            (11, 14),\n        ],\n    )\n    def test_index_to_cell_position(index, cell_position):\n        strip = Strip([Segment(\"ab\"), Segment(\"cd\u65e5\u672c\u8a9eef\"), Segment(\"gh\")])\n>       assert cell_position == strip.index_to_cell_position(index)\n\ntests/test_strip.py:180: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Strip([Segment('ab'), Segment('cd\u65e5\u672c\u8a9eef'), Segment('gh')], 14), index = 9\n\n    def index_to_cell_position(self, index: int) -> int:\n        \"\"\"Given a character index, return the cell position of that character.\n        This is the sum of the cell lengths of all the characters *before* the character\n        at `index`.\n    \n        Args:\n            index: The index to convert.\n    \n        Returns:\n            The cell position of the character at `index`.\n        \"\"\"\n        cell_position = 0\n        for i, char in enumerate(self.text):\n            if i == index:\n                return cell_position\n>           cell_position += self.get_cell_length(char)\nE           AttributeError: 'Strip' object has no attribute 'get_cell_length'. Did you mean: '_cell_length'?\n\nsrc/textual/strip.py:173: AttributeError\n______________________ test_index_to_cell_position[10-13] ______________________\n\nindex = 10, cell_position = 13\n\n    @pytest.mark.parametrize(\n        \"index,cell_position\",\n        [\n            (0, 0),\n            (1, 1),\n            (2, 2),\n            (3, 3),\n            (4, 4),\n            (5, 6),\n            (6, 8),\n            (7, 10),\n            (8, 11),\n            (9, 12),\n            (10, 13),\n            (11, 14),\n        ],\n    )\n    def test_index_to_cell_position(index, cell_position):\n        strip = Strip([Segment(\"ab\"), Segment(\"cd\u65e5\u672c\u8a9eef\"), Segment(\"gh\")])\n>       assert cell_position == strip.index_to_cell_position(index)\n\ntests/test_strip.py:180: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Strip([Segment('ab'), Segment('cd\u65e5\u672c\u8a9eef'), Segment('gh')], 14), index = 10\n\n    def index_to_cell_position(self, index: int) -> int:\n        \"\"\"Given a character index, return the cell position of that character.\n        This is the sum of the cell lengths of all the characters *before* the character\n        at `index`.\n    \n        Args:\n            index: The index to convert.\n    \n        Returns:\n            The cell position of the character at `index`.\n        \"\"\"\n        cell_position = 0\n        for i, char in enumerate(self.text):\n            if i == index:\n                return cell_position\n>           cell_position += self.get_cell_length(char)\nE           AttributeError: 'Strip' object has no attribute 'get_cell_length'. Did you mean: '_cell_length'?\n\nsrc/textual/strip.py:173: AttributeError\n______________________ test_index_to_cell_position[11-14] ______________________\n\nindex = 11, cell_position = 14\n\n    @pytest.mark.parametrize(\n        \"index,cell_position\",\n        [\n            (0, 0),\n            (1, 1),\n            (2, 2),\n            (3, 3),\n            (4, 4),\n            (5, 6),\n            (6, 8),\n            (7, 10),\n            (8, 11),\n            (9, 12),\n            (10, 13),\n            (11, 14),\n        ],\n    )\n    def test_index_to_cell_position(index, cell_position):\n        strip = Strip([Segment(\"ab\"), Segment(\"cd\u65e5\u672c\u8a9eef\"), Segment(\"gh\")])\n>       assert cell_position == strip.index_to_cell_position(index)\n\ntests/test_strip.py:180: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Strip([Segment('ab'), Segment('cd\u65e5\u672c\u8a9eef'), Segment('gh')], 14), index = 11\n\n    def index_to_cell_position(self, index: int) -> int:\n        \"\"\"Given a character index, return the cell position of that character.\n        This is the sum of the cell lengths of all the characters *before* the character\n        at `index`.\n    \n        Args:\n            index: The index to convert.\n    \n        Returns:\n            The cell position of the character at `index`.\n        \"\"\"\n        cell_position = 0\n        for i, char in enumerate(self.text):\n            if i == index:\n                return cell_position\n>           cell_position += self.get_cell_length(char)\nE           AttributeError: 'Strip' object has no attribute 'get_cell_length'. Did you mean: '_cell_length'?\n\nsrc/textual/strip.py:173: AttributeError\n___________________ test_index_cell_position_index_too_large ___________________\n\n    def test_index_cell_position_index_too_large():\n        strip = Strip([Segment(\"abcdef\"), Segment(\"ghi\")])\n        with pytest.raises(NoCellPositionForIndex):\n>           strip.index_to_cell_position(100)\n\ntests/test_strip.py:192: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Strip([Segment('abcdef'), Segment('ghi')], 9), index = 100\n\n    def index_to_cell_position(self, index: int) -> int:\n        \"\"\"Given a character index, return the cell position of that character.\n        This is the sum of the cell lengths of all the characters *before* the character\n        at `index`.\n    \n        Args:\n            index: The index to convert.\n    \n        Returns:\n            The cell position of the character at `index`.\n        \"\"\"\n        cell_position = 0\n        for i, char in enumerate(self.text):\n            if i == index:\n                return cell_position\n>           cell_position += self.get_cell_length(char)\nE           AttributeError: 'Strip' object has no attribute 'get_cell_length'. Did you mean: '_cell_length'?\n\nsrc/textual/strip.py:173: AttributeError\n_____________________ test_index_cell_position_no_segments _____________________\n\n    def test_index_cell_position_no_segments():\n        strip = Strip([])\n>       with pytest.raises(NoCellPositionForIndex):\nE       Failed: DID NOT RAISE <class 'textual._segment_tools.NoCellPositionForIndex'>\n\ntests/test_strip.py:185: Failed\n=========================== short test summary info ============================\nFAILED tests/test_strip.py::test_index_to_cell_position[1-1] - AttributeError...\nFAILED tests/test_strip.py::test_index_to_cell_position[2-2] - AttributeError...\nFAILED tests/test_strip.py::test_index_to_cell_position[3-3] - AttributeError...\nFAILED tests/test_strip.py::test_index_to_cell_position[4-4] - AttributeError...\nFAILED tests/test_strip.py::test_index_to_cell_position[5-6] - AttributeError...\nFAILED tests/test_strip.py::test_index_to_cell_position[6-8] - AttributeError...\nFAILED tests/test_strip.py::test_index_to_cell_position[7-10] - AttributeErro...\nFAILED tests/test_strip.py::test_index_to_cell_position[8-11] - AttributeErro...\nFAILED tests/test_strip.py::test_index_to_cell_position[9-12] - AttributeErro...\nFAILED tests/test_strip.py::test_index_to_cell_position[10-13] - AttributeErr...\nFAILED tests/test_strip.py::test_index_to_cell_position[11-14] - AttributeErr...\nFAILED tests/test_strip.py::test_index_cell_position_index_too_large - Attrib...\nFAILED tests/test_strip.py::test_index_cell_position_no_segments - Failed: DI...\n========================= 13 failed, 1 passed in 0.21s =========================\n\n"], "textual-src/textual/strip.py-render": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 7 items\n\ntests/test_styles_cache.py .......                                       [100%]\n\n============================== 7 passed in 0.09s ===============================\n\n"], "textual-src/textual/app.py-batch_update": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/test_app.py .                                                      [100%]\n\n============================== 1 passed in 0.12s ===============================\n\n"], "textual-src/textual/app.py-call_from_thread": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 2 items\n\n============================ no tests ran in 0.10s =============================\n\nERROR: not found: /root/repos/py_data/textual/tests/test_concurrency.py::on_ready\n(no match in any of [<Module test_concurrency.py>])\n\n"], "textual-src/textual/app.py-run_test": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 0 items / 79 errors\n\n==================================== ERRORS ====================================\n___________________ ERROR collecting tests/test_reactive.py ____________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_reactive.py:7: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_______________ ERROR collecting tests/test_dynamic_bindings.py ________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_dynamic_bindings.py:3: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n____________ ERROR collecting tests/text_area/test_edit_via_api.py _____________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/text_area/test_edit_via_api.py:11: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n____________________ ERROR collecting tests/test_header.py _____________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_header.py:1: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n______________________ ERROR collecting tests/test_app.py ______________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_app.py:5: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_________ ERROR collecting tests/text_area/test_selection_bindings.py __________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/text_area/test_selection_bindings.py:3: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n______ ERROR collecting tests/animations/test_tabs_underline_animation.py ______\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/animations/test_tabs_underline_animation.py:6: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_________________ ERROR collecting tests/test_progress_bar.py __________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_progress_bar.py:4: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n________________ ERROR collecting tests/test_tabbed_content.py _________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_tabbed_content.py:5: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n________________ ERROR collecting tests/test_overflow_change.py ________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_overflow_change.py:3: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n__________________ ERROR collecting tests/test_data_table.py ___________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_data_table.py:9: in <module>\n    from textual.app import App, ComposeResult, RenderableType\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_________ ERROR collecting tests/input/test_input_value_visibility.py __________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/input/test_input_value_visibility.py:3: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n________________ ERROR collecting tests/workers/test_worker.py _________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/workers/test_worker.py:5: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_______________ ERROR collecting tests/test_call_x_schedulers.py _______________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_call_x_schedulers.py:4: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n____________________ ERROR collecting tests/test_widget.py _____________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_widget.py:8: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n__________ ERROR collecting tests/text_area/test_edit_via_bindings.py __________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/text_area/test_edit_via_bindings.py:12: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n____ ERROR collecting tests/animations/test_loading_indicator_animation.py _____\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/animations/test_loading_indicator_animation.py:6: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n______________ ERROR collecting tests/text_area/test_messages.py _______________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/text_area/test_messages.py:4: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n______________ ERROR collecting tests/text_area/test_languages.py ______________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/text_area/test_languages.py:3: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_______________ ERROR collecting tests/css/test_css_reloading.py _______________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/css/test_css_reloading.py:4: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_____________________ ERROR collecting tests/test_pilot.py _____________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_pilot.py:6: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n__________ ERROR collecting tests/suggester/test_input_suggestions.py __________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/suggester/test_input_suggestions.py:5: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_____________________ ERROR collecting tests/test_query.py _____________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_query.py:3: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n____________ ERROR collecting tests/select/test_blank_and_clear.py _____________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/select/test_blank_and_clear.py:3: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_________________ ERROR collecting tests/select/test_value.py __________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/select/test_value.py:3: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_____________________ ERROR collecting tests/test_keys.py ______________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_keys.py:3: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_________________ ERROR collecting tests/select/test_prompt.py _________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/select/test_prompt.py:3: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n____________ ERROR collecting tests/input/test_input_validation.py _____________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/input/test_input_validation.py:4: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n___________ ERROR collecting tests/text_area/test_setting_themes.py ____________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/text_area/test_setting_themes.py:3: in <module>\n    from textual._text_area_theme import TextAreaTheme\nsrc/textual/_text_area_theme.py:8: in <module>\n    from textual.app import DEFAULT_COLORS\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n________________ ERROR collecting tests/css/test_inheritance.py ________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/css/test_inheritance.py:3: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n______________ ERROR collecting tests/tree/test_directory_tree.py ______________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/tree/test_directory_tree.py:8: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_____________________ ERROR collecting tests/test_lazy.py ______________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_lazy.py:1: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n______________ ERROR collecting tests/text_area/test_selection.py ______________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/text_area/test_selection.py:3: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n__________________ ERROR collecting tests/test_containers.py ___________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_containers.py:3: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_________________ ERROR collecting tests/test_message_pump.py __________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_message_pump.py:3: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n________________ ERROR collecting tests/css/test_screen_css.py _________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/css/test_screen_css.py:1: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n________ ERROR collecting tests/listview/test_listview_initial_index.py ________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/listview/test_listview_initial_index.py:3: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n___________________ ERROR collecting tests/test_animation.py ___________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_animation.py:3: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n________________ ERROR collecting tests/test_border_subtitle.py ________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_border_subtitle.py:1: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n______________ ERROR collecting tests/select/test_empty_select.py ______________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/select/test_empty_select.py:3: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n____________ ERROR collecting tests/tree/test_tree_availability.py _____________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/tree/test_tree_availability.py:6: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n____________________ ERROR collecting tests/test_driver.py _____________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_driver.py:2: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n__________ ERROR collecting tests/animations/test_switch_animation.py __________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/animations/test_switch_animation.py:6: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_____________________ ERROR collecting tests/test_focus.py _____________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_focus.py:3: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n________________ ERROR collecting tests/test_widget_removing.py ________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_widget_removing.py:1: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n____________ ERROR collecting tests/select/test_changed_message.py _____________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/select/test_changed_message.py:2: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n__________________ ERROR collecting tests/css/test_initial.py __________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/css/test_initial.py:1: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n____________________ ERROR collecting tests/test_unmount.py ____________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_unmount.py:4: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_______________ ERROR collecting tests/toggles/test_radioset.py ________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/toggles/test_radioset.py:3: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_____________________ ERROR collecting tests/test_mount.py _____________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_mount.py:8: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n____________ ERROR collecting tests/command_palette/test_events.py _____________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/command_palette/test_events.py:5: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n____________ ERROR collecting tests/workers/test_worker_manager.py _____________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/workers/test_worker_manager.py:4: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n____________________ ERROR collecting tests/test_screens.py ____________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_screens.py:8: in <module>\n    from textual.app import App, ComposeResult, ScreenError, ScreenStackError\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_______________ ERROR collecting tests/test_message_handling.py ________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_message_handling.py:1: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n__________ ERROR collecting tests/input/test_input_terminal_cursor.py __________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/input/test_input_terminal_cursor.py:1: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n____________________ ERROR collecting tests/test_loading.py ____________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_loading.py:1: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n______________________ ERROR collecting tests/test_on.py _______________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_on.py:9: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n________ ERROR collecting tests/animations/test_disabling_animations.py ________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/animations/test_disabling_animations.py:5: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n___________________ ERROR collecting tests/test_data_bind.py ___________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_data_bind.py:3: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n________________ ERROR collecting tests/css/test_nested_css.py _________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/css/test_nested_css.py:5: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_______ ERROR collecting tests/animations/test_progress_bar_animation.py _______\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/animations/test_progress_bar_animation.py:6: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n________ ERROR collecting tests/animations/test_scrolling_animation.py _________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/animations/test_scrolling_animation.py:6: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_____________________ ERROR collecting tests/test_paste.py _____________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_paste.py:2: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n__________________ ERROR collecting tests/test_issue_4248.py ___________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_issue_4248.py:3: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n____________ ERROR collecting tests/workers/test_work_decorator.py _____________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/workers/test_work_decorator.py:9: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n________ ERROR collecting tests/css/test_programmatic_style_changes.py _________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/css/test_programmatic_style_changes.py:3: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n___________ ERROR collecting tests/text_area/test_escape_binding.py ____________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/text_area/test_escape_binding.py:1: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_________ ERROR collecting tests/listview/test_listview_navigation.py __________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/listview/test_listview_navigation.py:1: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_______________ ERROR collecting tests/test_style_inheritance.py _______________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_style_inheritance.py:1: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n____________________ ERROR collecting tests/test_freeze.py _____________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_freeze.py:3: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n___________________ ERROR collecting tests/test_disabled.py ____________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_disabled.py:5: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n____________________ ERROR collecting tests/test_signal.py _____________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_signal.py:3: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n__________________ ERROR collecting tests/test_test_runner.py __________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_test_runner.py:2: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_____________ ERROR collecting tests/input/test_input_restrict.py ______________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/input/test_input_restrict.py:5: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n___________________ ERROR collecting tests/test_shutdown.py ____________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_shutdown.py:1: in <module>\n    from textual.app import App\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n___________________ ERROR collecting tests/test_markdown.py ____________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_markdown.py:13: in <module>\n    import textual.widgets._markdown as MD\nsrc/textual/widgets/_markdown.py:19: in <module>\n    from ..app import ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_______________ ERROR collecting tests/tree/test_node_refresh.py _______________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/tree/test_node_refresh.py:4: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n_______ ERROR collecting tests/option_list/test_option_list_movement.py ________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/option_list/test_option_list_movement.py:7: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n____________________ ERROR collecting tests/test_visible.py ____________________\n/usr/local/lib/python3.10/site-packages/_pytest/python.py:492: in importtestmodule\n    mod = import_path(\n/usr/local/lib/python3.10/site-packages/_pytest/pathlib.py:591: in import_path\n    importlib.import_module(module_name)\n/usr/local/lib/python3.10/importlib/__init__.py:126: in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n<frozen importlib._bootstrap>:1050: in _gcd_import\n    ???\n<frozen importlib._bootstrap>:1027: in _find_and_load\n    ???\n<frozen importlib._bootstrap>:1006: in _find_and_load_unlocked\n    ???\n<frozen importlib._bootstrap>:688: in _load_unlocked\n    ???\n/usr/local/lib/python3.10/site-packages/_pytest/assertion/rewrite.py:178: in exec_module\n    exec(co, module.__dict__)\ntests/test_visible.py:1: in <module>\n    from textual.app import App, ComposeResult\nE     File \"/root/repos/py_data/textual/src/textual/app.py\", line 1416\nE       Args:\nE   IndentationError: unexpected indent\n=========================== short test summary info ============================\nERROR tests/test_reactive.py\nERROR tests/test_dynamic_bindings.py\nERROR tests/text_area/test_edit_via_api.py\nERROR tests/test_header.py\nERROR tests/test_app.py\nERROR tests/text_area/test_selection_bindings.py\nERROR tests/animations/test_tabs_underline_animation.py\nERROR tests/test_progress_bar.py\nERROR tests/test_tabbed_content.py\nERROR tests/test_overflow_change.py\nERROR tests/test_data_table.py\nERROR tests/input/test_input_value_visibility.py\nERROR tests/workers/test_worker.py\nERROR tests/test_call_x_schedulers.py\nERROR tests/test_widget.py\nERROR tests/text_area/test_edit_via_bindings.py\nERROR tests/animations/test_loading_indicator_animation.py\nERROR tests/text_area/test_messages.py\nERROR tests/text_area/test_languages.py\nERROR tests/css/test_css_reloading.py\nERROR tests/test_pilot.py\nERROR tests/suggester/test_input_suggestions.py\nERROR tests/test_query.py\nERROR tests/select/test_blank_and_clear.py\nERROR tests/select/test_value.py\nERROR tests/test_keys.py\nERROR tests/select/test_prompt.py\nERROR tests/input/test_input_validation.py\nERROR tests/text_area/test_setting_themes.py\nERROR tests/css/test_inheritance.py\nERROR tests/tree/test_directory_tree.py\nERROR tests/test_lazy.py\nERROR tests/text_area/test_selection.py\nERROR tests/test_containers.py\nERROR tests/test_message_pump.py\nERROR tests/css/test_screen_css.py\nERROR tests/listview/test_listview_initial_index.py\nERROR tests/test_animation.py\nERROR tests/test_border_subtitle.py\nERROR tests/select/test_empty_select.py\nERROR tests/tree/test_tree_availability.py\nERROR tests/test_driver.py\nERROR tests/animations/test_switch_animation.py\nERROR tests/test_focus.py\nERROR tests/test_widget_removing.py\nERROR tests/select/test_changed_message.py\nERROR tests/css/test_initial.py\nERROR tests/test_unmount.py\nERROR tests/toggles/test_radioset.py\nERROR tests/test_mount.py\nERROR tests/command_palette/test_events.py\nERROR tests/workers/test_worker_manager.py\nERROR tests/test_screens.py\nERROR tests/test_message_handling.py\nERROR tests/input/test_input_terminal_cursor.py\nERROR tests/test_loading.py\nERROR tests/test_on.py\nERROR tests/animations/test_disabling_animations.py\nERROR tests/test_data_bind.py\nERROR tests/css/test_nested_css.py\nERROR tests/animations/test_progress_bar_animation.py\nERROR tests/animations/test_scrolling_animation.py\nERROR tests/test_paste.py\nERROR tests/test_issue_4248.py\nERROR tests/workers/test_work_decorator.py\nERROR tests/css/test_programmatic_style_changes.py\nERROR tests/text_area/test_escape_binding.py\nERROR tests/listview/test_listview_navigation.py\nERROR tests/test_style_inheritance.py\nERROR tests/test_freeze.py\nERROR tests/test_disabled.py\nERROR tests/test_signal.py\nERROR tests/test_test_runner.py\nERROR tests/input/test_input_restrict.py\nERROR tests/test_shutdown.py\nERROR tests/test_markdown.py\nERROR tests/tree/test_node_refresh.py\nERROR tests/option_list/test_option_list_movement.py\nERROR tests/test_visible.py\n============================== 79 errors in 3.33s ==============================\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_reactive.py::test_reactive_method_call_order\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_dynamic_bindings.py::test_dynamic_disabled\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_delete_within_line\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_header.py::test_screen_title_none_is_ignored\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_app.py::test_return_code_is_one_after_crash\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_mouse_click\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_tabs_underline_animation.py::test_tabs_underline_does_not_animate_on_none\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_cursor_selection_left_to_previous_line\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_reactive.py::test_watch_init_true\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_reactive.py::test_set_reactive\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_progress_bar.py::test_show_sub_widgets\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_tabbed_content_switch_via_code\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_overflow_change.py::test_overflow_change_updates_virtual_size_appropriately\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_reuse_row_key_after_clear\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/input/test_input_value_visibility.py::test_input_value_visible_on_instantiation\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_cursor_selection_up\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/workers/test_worker.py::test_run_success\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_call_x_schedulers.py::test_call_after_refresh\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_widget.py::test_compose_order\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_delete_word_left\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_cursor_selection_left\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_loading_indicator_animation.py::test_loading_indicator_is_not_static_on_full\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_disabling_nested_tabs\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_messages.py::test_changed_message_edit_via_api\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_languages.py::test_setting_builtin_language_via_constructor\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_css_reloading.py::test_css_reloading_applies_to_non_top_screen\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_hiding_nested_tabs\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_pilot.py::test_pilot_target_widget_under_another_widget\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/suggester/test_input_suggestions.py::test_no_suggestion_on_empty_value\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_query.py::test_query_set_styles_invalid_css_raises_error\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_reenabling_tab\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_cursor_word_right\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_show_unknown_tab\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_blank_and_clear.py::test_clear_fails_if_allow_blank_is_false\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/suggester/test_input_suggestions.py::test_suggestion_priority\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_value.py::test_value_assign_to_blank\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_row_at\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_keys.py::test_character_bindings\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_prompt.py::test_reactive_prompt_change\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_update_cell_invalid_column_key\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/input/test_input_validation.py::test_input_submitted_message_validation_failure\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_css_reloading.py::test_css_reloading_file_not_found\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_setting_themes.py::test_setting_builtin_themes\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_tabbed_content_initial\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_cell_coordinate_returns_coordinate\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_inheritance.py::test_inheritance\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/tree/test_directory_tree.py::test_directory_tree_reloading_preserves_state\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_lazy.py::test_lazy\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_remove_row\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_sort_reverse_coordinate_and_key_access\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_hide_unknown_tab\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_selected_text_backward\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/input/test_input_value_visibility.py::test_input_value_visible_if_mounted_later\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_update_cell_at_column_width\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_paste_read_only_does_nothing\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_widget.py::test_get_child_by_type\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_click_column_cursor\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_delete_fully_within_selection\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_containers.py::test_horizontal_vs_horizontalscroll_scrolling\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_message_pump.py::test_prevent_with_call_next\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_screen_css.py::test_screen_css_switch_mode_screen_type_by_name\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/listview/test_listview_initial_index.py::test_listview_initial_index\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/input/test_input_validation.py::test_input_changed_message_validation_failure\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_delete_word_right_delete_to_end_of_line\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_insert_newlines_end\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_cursor_vertical_movement_visual_alignment_snapping\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_insert_character_near_cursor_maintain_selection_offset\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_pilot.py::test_pilot_target_outside_screen_errors\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/input/test_input_validation.py::test_valid_empty\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/input/test_input_validation.py::test_validation_on_blur_should_not_happen_unless_specified\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_animation.py::test_wait_for_current_and_scheduled_animations\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_border_subtitle.py::test_border_subtitle\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_pilot.py::test_pilot_target_visible_widget\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_cursor_location_set_while_selecting\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_delete_line\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_row_invalid_row_key\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_empty_select.py::test_empty_set_options_raises_exception_if_allow_blank_is_false\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_reactive.py::test_reactive_compute_first_time_set\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_reactive.py::test_validate_init_true\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_cursor_word_right_select\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/tree/test_tree_availability.py::test_enabled_tree_node_selected_message\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_driver.py::test_driver_mouse_down_up_click\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_switch_animation.py::test_switch_animates_on_basic\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_cursor_to_line_home_basic_behaviour\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_focus.py::test_focus_pseudo_class\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_delete_word_left_with_tabs\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_insert_text_non_cursor_location_dont_maintain_offset\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_widget_removing.py::test_widget_remove_children_with_type_selector\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_messages.py::test_selection_changed_via_typing\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_widget_removing.py::test_widget_remove_children_container\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_sort_by_function_sum\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_changed_message.py::test_message_control\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/input/test_input_validation.py::test_on_blur_triggers_validation\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_initial.py::test_initial_default\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_update_cell_at_coordinate_doesnt_exist\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_cursor_selection_right_to_previous_line\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_insert_newlines_start\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_widget_removing.py::test_widget_remove_children_no_children_match_selector\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_hiding_tabs_moves_active_to_next_tab\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_cell_coordinate_invalid_row_key\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_unsetting_tabbed_content_active\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_insert_windows_newlines\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_unmount.py::test_unmount\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_screen_css.py::test_screen_css_switch_screen_type_by_name\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/toggles/test_radioset.py::test_keyboard_navigation_with_disabled_buttons\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_get_cursor_right_location\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_switch_animation.py::test_switch_does_not_animate_on_none\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_mount.py::test_render_only_after_mount\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_reenabling_via_tabbed_content\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_driver.py::test_driver_mouse_down_drag_inside_widget_up_click\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_replace_multiline_text\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_reactive.py::test_reactive_always_update\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_click_row_cursor\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/command_palette/test_events.py::test_command_palette_closed_event\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_coordinate_to_cell_key\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_row_cursor_highlight_events\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_header.py::test_screen_sub_title_none_is_ignored\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_select_all\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/workers/test_worker.py::test_run_cancel_immediately\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_hover_coordinate\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/workers/test_worker_manager.py::test_run_worker_thread_non_async\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_text_setter\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_get_cursor_left_location\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_reactive.py::test_watch_async_init_false\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_cursor_location_get\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_delete_left_end\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_cell_padding_updates_virtual_size\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/tree/test_tree_availability.py::test_disabled_tree_node_selected_message\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/workers/test_worker.py::test_progress_update\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_update_cell_at_coordinate_exists\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_enabling_unknown_tab\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_remove_row_and_update\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_screens.py::test_auto_focus_skips_non_focusable_widgets\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_unset_hover_highlight_when_no_table_cell_under_mouse\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_message_handling.py::test_message_inheritance_namespace\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_value.py::test_set_value_to_blank_with_allow_blank_false\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_screens.py::test_auto_focus_on_screen_if_app_auto_focus_is_disabled\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/input/test_input_terminal_cursor.py::test_terminal_cursor_position_update_on_cursor_move\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_reactive.py::test_compute\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_cursor_movement_with_home_pagedown_etc\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_app.py::test_no_return_code_while_running\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_move_cursor\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_datatable_click_cell_cursor\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_reenabling_via_tab_pane\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_mouse_click_clamp_from_right\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_driver.py::test_driver_mouse_down_drag_outside_widget_up_click\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_animation.py::test_schedule_reverse_animations\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_blank_and_clear.py::test_setting_and_checking_blank\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_loading.py::test_loading_disables_and_remove_scrollbars\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_pilot.py::test_pilot_target_screen_always_true\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_cursor_selection_right\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_on.py::test_on_arbitrary_attributes\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_cursor_selection_down\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_disabled_tab_cannot_be_clicked\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_reactive.py::test_watch_async_init_true\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/suggester/test_input_suggestions.py::test_suggestion\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_focus.py::test_focus_does_not_move_to_invisible_widgets\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_cell_invalid_row_key\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_select_all_binding\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_widget_removing.py::test_widget_remove_children_with_selector_does_not_leak\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_cursor_screen_offset_and_terminal_cursor_position_scrolling\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_widget.py::test__allow_scroll\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_cursor_screen_offset_and_terminal_cursor_position_update\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_insert_empty_string\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_screen_css.py::test_screen_css_push_screen_instance\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_reactive.py::test_no_duplicate_external_watchers\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_remove_column_and_update\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_disabling_animations.py::test_style_animations_via_animate_are_disabled_on_none\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_update_cell_cell_doesnt_exist\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_focus.py::test_mouse_up_does_not_give_focus\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/tree/test_tree_availability.py::test_creating_enabled_tree\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/command_palette/test_events.py::test_command_palette_closed_event_value\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_delete_to_start_of_line\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_bind.py::test_data_binding\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_cursor_page_up\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_cell_coordinate_invalid_column_key\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_value.py::test_set_options_resets_value_if_allow_blank_is_false\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_disabling_animations.py::test_style_animations_via_transition_work_on_full\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_column_index_returns_index\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_selected_text_forward\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_nested_css.py::test_pseudo_classes_work_in_nested_css\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/suggester/test_input_suggestions.py::test_suggestion_shows_up_after_deleting_extra_chars_in_middle_of_word\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_blank_and_clear.py::test_value_is_blank_by_default\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_animation.py::test_reverse_animations\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_row_index_returns_index\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_prompt.py::test_reactive_prompt_change_when_allow_blank_is_false\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_messages.py::test_changed_message_via_typing\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_initial.py::test_initial\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_progress_bar_animation.py::test_progress_bar_does_not_animate_on_none\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_on.py::test_on_inheritance\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_initial_column_widths\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_screens.py::test_default_custom_screen\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_message_pump.py::test_prevent_default\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_languages.py::test_register_language\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_widget.py::test_mount_error_bad_widget\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_setting_themes.py::test_registering_and_setting_theme\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_languages.py::test_setting_unknown_language\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_screens.py::test_screen_walk_children\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_call_x_schedulers.py::test_call_later\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_tabs_underline_animation.py::test_tabs_underline_animates_on_basic\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_screens.py::test_dismiss_action\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_row_label_selected\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_header.py::test_screen_sub_title_reactive_updates_sub_title\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_cell_cursor_highlight_events\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_delete_to_end_of_line\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_delete_word_left_to_start_of_line\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_messages.py::test_changed_message_edit_via_assignment\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_selection_clamp\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/input/test_input_value_visibility.py::test_input_value_visible_after_value_assignment\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_query.py::test_query_refresh\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_value.py::test_initial_value_inside_compose_is_validated\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_empty_select.py::test_empty_select_is_ok_with_blanks\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_mouse_click_gutter_clamp\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/input/test_input_value_visibility.py::test_input_value_visible_if_mounted_later_and_focused\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_column_index_invalid_column_key\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_pilot.py::test_pilot_resize_terminal\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_changed_message.py::test_same_selection_does_not_post_message\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_scrolling_animation.py::test_scrolling_animates_on_full\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_query.py::test_query_focus_blur\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_languages.py::test_setting_language_to_none\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_cursor_word_left_select\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_header_selected\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_paste.py::test_empty_paste\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_disabling_tab_within_tabbed_content_stays_isolated\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_widget.py::test_sort_children\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_pilot.py::test_pilot_target_inside_screen_is_fine_with_correct_coordinate_system\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_reactive.py::test_watch\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_languages.py::test_language_binary_missing\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_single_keypress_enter\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_delete_left\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_issue_4248.py::test_issue_4248\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_progress_bar_animation.py::test_progress_bar_animates_on_full\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_replace_empty_string\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_nested_css.py::test_rule_declaration_after_nested\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_widget_removing.py::test_widget_remove_children_with_star_selector\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/workers/test_work_decorator.py::test_calling_workers_from_within_workers\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_delete_word_right_at_end_of_line\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_widget.py::test_remove\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_programmatic_style_changes.py::test_programmatic_align_change_updates_children_position\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_disabling_animations.py::test_style_animations_via_transition_are_disabled_on_none\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_scrolling_animation.py::test_scrolling_does_not_animate_on_none\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_cursor_movement_basic\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_reactive.py::test_external_watch_init_does_not_propagate_to_externals\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_escape_binding.py::test_escape_key_when_tab_behavior_is_focus\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_screen_css.py::test_screen_css_switch_screen_instance_by_name\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_switch_animation.py::test_switch_animates_on_full\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_header.py::test_app_sub_title_reactive_does_not_update_sub_title_when_screen_sub_title_is_set\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_replace_fully_within_selection\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_nested_css.py::test_lists_of_selectors_in_nested_css\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/workers/test_worker.py::test_double_start\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/listview/test_listview_navigation.py::test_keyboard_navigation_with_disabled_items\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_app.py::test_default_return_code_is_zero\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_header.py::test_app_title_reactive_does_not_update_title_when_screen_title_is_set\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_nested_css.py::test_nest_app\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_style_inheritance.py::test_text_style_inheritance\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_screens.py::test_switch_screen_no_op\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/input/test_input_validation.py::test_validation_on_changed_should_not_happen\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_tab_with_spaces_goes_to_tab_stop\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_disabling_via_tabbed_content\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_add_column_with_width\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_query.py::test_query_set_styles_kwds\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/input/test_input_validation.py::test_none_validate_on_means_all_validations_happen\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_insert_text_multiline_selection_bottom\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_screen_css.py::test_screen_pushing_and_popping_does_not_reparse_css\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/workers/test_worker.py::test_run_cancel\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_empty_table_interactions\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_add_rows_user_defined_keys\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_cursor_to_line_end\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_clear\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_message_pump.py::test_message_queue_size\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_tabbed_content_messages\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_add_row_duplicate_key\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_move_cursor_respects_animate_parameter\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_clicking_border_link_doesnt_crash\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_value.py::test_initial_value_is_picked_if_allow_blank_is_false\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/suggester/test_input_suggestions.py::test_no_suggestion_on_empty_value_after_deleting\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_reactive.py::test_reactive_with_callable_default\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_loading_indicator_animation.py::test_loading_indicator_is_not_static_on_basic\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_widget.py::test_offset_getter_setter\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_query.py::test_query_set_styles_css_and_kwds\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_screen_css.py::test_screen_css_switch_screen_instance\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_creating_disabled_tab\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_reactive.py::test_external_watch_init_does_not_propagate\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_containers.py::test_center_container\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_select_line\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_delete_line_multiline_document\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/workers/test_worker_manager.py::test_run_worker_thread_async\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_app.py::test_set_return_code\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_animation.py::test_animate_height\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_freeze.py::test_freeze\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_cursor_selection_down_when_cursor_on_last_line\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_reuse_column_key_after_clear\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_disabling_animations.py::test_style_animations_via_animate_are_disabled_on_basic\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_insert_multiline_text_maintain_offset\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_focus.py::test_get_focusable_widget_at\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_progress_bar_animation.py::test_progress_bar_animates_on_basic\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_sort_by_multiple_columns_no_key\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_paste.py::test_paste_app\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_reactive.py::test_premature_reactive_call\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_cell_at_exception\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_header.py::test_screen_sub_title_overrides_app_sub_title\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_disabled.py::test_children_loses_focus_if_container_is_disabled\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_single_keypress_printable_character\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_hide_show_messages\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_header.py::test_screen_title_reactive_updates_title\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_cell_returns_value_at_cell\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_loading_indicator_animation.py::test_loading_indicator_is_static_on_none\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/suggester/test_input_suggestions.py::test_accept_suggestion\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_driver.py::test_driver_mouse_down_up_click_widget\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_cursor_word_left\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/workers/test_worker.py::test_initialize\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_containers.py::test_middle_container\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_cell_padding_cannot_be_negative\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_signal.py::test_signal\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_widget_removing.py::test_widget_remove_children_no_children\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_cursor_line_home_smart_home\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/input/test_input_terminal_cursor.py::test_initial_terminal_cursor_position\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_disabling_does_not_deactivate_tab\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_widget.py::test_sort_children_no_key\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_message_pump.py::test_prevent\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_move_cursor_relative\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_replace_multiline_text_maintain_selection\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_edits_on_read_only_mode\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_delete_empty_document\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_empty_select.py::test_empty_select_raises_exception_if_allow_blank_is_false\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_disabling_animations.py::test_style_animations_via_animate_work_on_full\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/workers/test_worker.py::test_wait_without_start\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_tabbed_content_switch_via_ui\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_paste\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_screens.py::test_push_screen_wait_for_dismiss\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_escape_binding.py::test_escape_key_when_tab_behavior_is_indent\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_tabs_nested_in_tabbed_content_doesnt_crash\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_focus.py::test_focus_moves_to_visible_widgets_inside_invisible_containers\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/suggester/test_input_suggestions.py::test_suggestion_shows_up_after_deleting_extra_chars\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_sort_coordinate_and_key_access\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_tabs_underline_animation.py::test_tabs_underline_animates_on_full\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/input/test_input_value_visibility.py::test_input_value_visible_if_mounted_later_and_assigned_after\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/command_palette/test_events.py::test_command_palette_opened_event\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_add_row_expands_column_widths\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_containers.py::test_vertical_vs_verticalscroll_scrolling\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_reactive.py::test_watch_compute\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_row_at_invalid_index\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/suggester/test_input_suggestions.py::test_no_suggestions\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_setting_themes.py::test_default_theme\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_select_line_binding\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_focus.py::test_mouse_down_gives_focus\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_messages.py::test_selection_changed_via_api\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_insert_newline_around_cursor_maintain_selection_offset\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_screens.py::test_auto_focus_on_screen_if_app_auto_focus_is_none\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_clear_empty_document\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_coordinate_to_cell_key_invalid_coordinate\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_value.py::test_initial_value_is_validated\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_animation.py::test_wait_for_current_animations\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_column\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_delete_right_end_of_line\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/command_palette/test_events.py::test_command_palette_option_highlighted_event\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_disabling_animations.py::test_style_animations_via_transition_are_disabled_on_basic\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_column_invalid_key\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_cursor_location_set\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_delete_multiple_lines_selection_above\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_add_column_duplicate_key\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_empty_select.py::test_empty_set_options_is_ok_with_blanks\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_test_runner.py::test_run_test\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/input/test_input_restrict.py::test_bad_type\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_pilot.py::test_pilot_target_on_widget_that_is_not_visible_errors\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_deletion_with_non_empty_selection\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/input/test_input_validation.py::test_validation_on_submitted_should_not_happen\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/input/test_input_validation.py::test_input_changed_message_validation_success\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_row_index_invalid_row_key\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_changed_message.py::test_selecting_posts_message\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_disabling_via_tab_pane\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_setting_themes.py::test_setting_unknown_theme_raises_exception\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_row\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_reactive.py::test_validate_init_true_set_before_dom_ready\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_remove_column\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_on.py::test_on_button_pressed\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_screens.py::test_push_screen_wait_for_dismiss_no_worker\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_default_selection\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_showing_tabs_does_not_change_active_tab\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_languages.py::test_setting_builtin_language_via_attribute\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/input/test_input_validation.py::test_input_submitted_message_validation_success\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_get_cursor_up_location\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_signal.py::test_signal_parameters\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_value.py::test_value_unknown_option_raises_error\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_replace_lines_with_fewer_lines\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_screens.py::test_auto_focus_inheritance\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/workers/test_worker.py::test_run_error\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_screens.py::test_dismiss_non_top_screen\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_add_columns\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_screens.py::test_installed_screens\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_showing_first_tab_activates_tab\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_app.py::test_ansi_theme\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_edit_read_only_mode_does_nothing\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_delete_word_right\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_widget.py::test_remove_unmounted\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_blank_and_clear.py::test_clear_with_allow_blanks\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_widget_removing.py::test_widget_remove_children_with_string_selector\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_insert_text_multiline_selection_top\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_screen_css.py::test_screen_css_push_screen_type_by_name\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_shutdown.py::test_shutdown\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/workers/test_worker.py::test_self_referential_deadlock\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_languages.py::test_register_language_existing_language\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_markdown.py::test_link_in_markdown_table_posts_message_when_clicked\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_add_columns_user_defined_keys\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_add_row_auto_height\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/tree/test_node_refresh.py::test_initial_state\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_screen_css.py::test_screen_css_switch_mode_screen_instance_by_name\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/suggester/test_input_suggestions.py::test_suggestion_with_special_characters\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_update_cell_cell_exists\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_widget.py::test_mount_error_not_widget\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_focus.py::test_focus_chain_handles_inherited_visibility\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_insert_text_start_maintain_selection_offset\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_insert_multiline_text\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/tree/test_tree_availability.py::test_creating_disabled_tree\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_reactive.py::test_watch_init_false_always_update_false\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_cell_invalid_column_key\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_screen_css.py::test_screen_css_push_screen_instance_by_name\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/workers/test_worker_manager.py::test_run_worker_async\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_screens.py::test_switch_screen_updates_results_callback_stack\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_containers.py::test_scrollbar_zero_thickness\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_column_at\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_scrolling_cursor_into_view\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_delete_left_start\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/workers/test_worker.py::test_get_worker\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_cursor_selection_up_when_cursor_on_first_line\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_app.py::test_hover_update_styles\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_tabs_nested_doesnt_interfere_with_ancestor_tabbed_content\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/select/test_value.py::test_set_options_resets_value_to_blank\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_screen_css.py::test_screen_css_switch_mode_screen_instance\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_query.py::test_query_set_styles_css\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_programmatic_style_changes.py::test_programmatic_style_change_updates_children\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_insert_text_start\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_animation.py::test_scheduling_animation\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_scrolling_animation.py::test_scrolling_animates_on_basic\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_cell_at_returns_value_at_cell\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection_bindings.py::test_cursor_page_down\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_header.py::test_screen_title_overrides_app_title\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_get_column_at_invalid_index\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_sort_by_all_columns_no_key\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_delete_within_line_dont_maintain_offset\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_column_labels\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_column_cursor_highlight_events\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_datatable_message_emission\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_cursor_word_left_location\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_hover_mouse_leave\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_insert_text_non_cursor_location\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/option_list/test_option_list_movement.py::test_keyboard_navigation_with_disabled_options\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_delete_word_left_at_line_start\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_add_rows\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_visible.py::test_visible_is_inherited\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_bind.py::test_data_binding_missing_reactive\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_query.py::test_universal_selector_doesnt_select_self\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_hide_last_tab_means_no_tab_active\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_bindings.py::test_delete_right\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_move_cursor_select\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_selected_text_multibyte\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_cursor_word_right_location\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_selection.py::test_get_cursor_down_location\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_disabling_unknown_tab\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_data_table.py::test_clear\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_tabbed_content.py::test_navigation_around_disabled_tabs\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/text_area/test_edit_via_api.py::test_insert_old_mac_newlines\n\n"], "textual-src/textual/app.py-run": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 3 items\n\ntests/test_auto_refresh.py .                                             [ 33%]\ntests/test_concurrency.py .                                              [ 66%]\ntests/test_win_sleep.py s                                                [100%]\n\n=============================== warnings summary ===============================\ntests/test_auto_refresh.py::test_auto_refresh\ntests/test_concurrency.py::test_call_from_thread\n  /root/repos/py_data/textual/src/textual/app.py:1602: DeprecationWarning: There is no current event loop\n    loop = asyncio.get_event_loop()\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=================== 2 passed, 1 skipped, 2 warnings in 1.14s ===================\n\n"], "textual-src/textual/app.py-switch_mode": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 3 items\n\ntests/css/test_screen_css.py FFF                                         [100%]\n\n=================================== FAILURES ===================================\n_________________ test_screen_css_switch_mode_screen_instance __________________\n\n    async def test_screen_css_switch_mode_screen_instance():\n        \"\"\"Check that screen CSS is loaded and applied when switching to a mode with a screen instance.\"\"\"\n    \n        class MyApp(BaseApp):\n            MODES = {\n                \"base\": BaseScreen(),\n                \"mode\": ScreenWithCSS(),\n            }\n    \n            def key_p(self):\n                self.switch_mode(\"mode\")\n    \n            def key_o(self):\n                self.switch_mode(\"base\")\n    \n        app = MyApp()\n        async with app.run_test() as pilot:\n            await pilot.press(\"o\")\n            check_colors_before_screen_css(app)\n>           await pilot.press(\"p\")\n\ntests/css/test_screen_css.py:247: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/pilot.py:83: in press\n    await self._wait_for_screen()\nsrc/textual/pilot.py:369: in _wait_for_screen\n    children = [self.app, *self.app.screen.walk_children(with_self=True)]\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'})\n\n    @property\n    def screen(self) -> Screen[object]:\n        \"\"\"The current active screen.\n    \n        Returns:\n            The currently active (visible) screen.\n    \n        Raises:\n            ScreenStackError: If there are no screens on the stack.\n        \"\"\"\n        try:\n            return self._screen_stack[-1]\n        except KeyError:\n>           raise UnknownModeError(f\"No known mode {self._current_mode!r}\") from None\nE           textual.app.UnknownModeError: No known mode 'mode'\n\nsrc/textual/app.py:1021: UnknownModeError\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_screen_css_switch_mode_screen_instance():\n        \"\"\"Check that screen CSS is loaded and applied when switching to a mode with a screen instance.\"\"\"\n    \n        class MyApp(BaseApp):\n            MODES = {\n                \"base\": BaseScreen(),\n                \"mode\": ScreenWithCSS(),\n            }\n    \n            def key_p(self):\n                self.switch_mode(\"mode\")\n    \n            def key_o(self):\n                self.switch_mode(\"base\")\n    \n        app = MyApp()\n>       async with app.run_test() as pilot:\n\ntests/css/test_screen_css.py:244: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/message_pump.py:589: in _process_messages_loop\n    await self._dispatch_message(message)\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3110: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:47: in _invoke\n    result = await result\nsrc/textual/app.py:3281: in _on_key\n    await self.dispatch_key(event)\nsrc/textual/message_pump.py:850: in dispatch_key\n    handled = (await invoke(key_method, event)) is not False\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/css/test_screen_css.py:238: in key_p\n    self.switch_mode(\"mode\")\nsrc/textual/app.py:1886: in switch_mode\n    await_mount = self._init_mode(mode)\nsrc/textual/app.py:1858: in _init_mode\n    self._load_screen_css(screen)\nsrc/textual/app.py:2040: in _load_screen_css\n    self.stylesheet.update(self)\nsrc/textual/css/stylesheet.py:673: in update\n    self.update_nodes(root.walk_children(with_self=True), animate=animate)\nsrc/textual/dom.py:1243: in walk_children\n    nodes = list(node_generator)\nsrc/textual/walk.py:61: in walk_depth_first\n    stack: list[Iterator[DOMNode]] = [iter(root.children)]\nsrc/textual/app.py:697: in children\n    for screen in reversed(self._screen_stack)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'})\n\n    @property\n    def _screen_stack(self) -> list[Screen[Any]]:\n        \"\"\"A reference to the current screen stack.\n    \n        Note:\n            Consider using [`screen_stack`][textual.app.App.screen_stack] instead.\n    \n        Returns:\n            A reference to the current screen stack.\n        \"\"\"\n>       return self._screen_stacks[self._current_mode]\nE       KeyError: 'mode'\n\nsrc/textual/app.py:823: KeyError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/css/test_screen_css.py:238 in key_p        \u2502\n\u2502                                                                              \u2502\n\u2502   235 \u2502   \u2502   }                                                              \u2502\n\u2502   236 \u2502   \u2502                                                                  \u2502\n\u2502   237 \u2502   \u2502   def key_p(self):                                               \u2502\n\u2502 \u2771 238 \u2502   \u2502   \u2502   self.switch_mode(\"mode\")                                   \u2502\n\u2502   239 \u2502   \u2502                                                                  \u2502\n\u2502   240 \u2502   \u2502   def key_o(self):                                               \u2502\n\u2502   241 \u2502   \u2502   \u2502   self.switch_mode(\"base\")                                   \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                      \u2502\n\u2502 \u2502 self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502                      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                      \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:1886 in switch_mode           \u2502\n\u2502                                                                              \u2502\n\u2502   1883 \u2502   \u2502   self._current_mode = mode                                     \u2502\n\u2502   1884 \u2502   \u2502                                                                 \u2502\n\u2502   1885 \u2502   \u2502   if mode not in self._screen_stacks:                           \u2502\n\u2502 \u2771 1886 \u2502   \u2502   \u2502   await_mount = self._init_mode(mode)                       \u2502\n\u2502   1887 \u2502   \u2502   else:                                                         \u2502\n\u2502   1888 \u2502   \u2502   \u2502   await_mount = AwaitMount(self, [])                        \u2502\n\u2502   1889                                                                       \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e              \u2502\n\u2502 \u2502 current_mode = 'base'                                       \u2502              \u2502\n\u2502 \u2502         mode = 'mode'                                       \u2502              \u2502\n\u2502 \u2502         self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502              \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f              \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:1858 in _init_mode            \u2502\n\u2502                                                                              \u2502\n\u2502   1855 \u2502   \u2502   \u2502   new_screen: Screen | str = _screen() if callable(_screen) \u2502\n\u2502   1856 \u2502   \u2502   \u2502   screen, await_mount = self._get_screen(new_screen)        \u2502\n\u2502   1857 \u2502   \u2502   \u2502   stack.append(screen)                                      \u2502\n\u2502 \u2771 1858 \u2502   \u2502   \u2502   self._load_screen_css(screen)                             \u2502\n\u2502   1859 \u2502   \u2502                                                                 \u2502\n\u2502   1860 \u2502   \u2502   self._screen_stacks[mode] = stack                             \u2502\n\u2502   1861 \u2502   \u2502   return await_mount                                            \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e       \u2502\n\u2502 \u2502     _screen = ScreenWithCSS()                                      \u2502       \u2502\n\u2502 \u2502 await_mount = <textual.widget.AwaitMount object at 0x7fd98db24b50> \u2502       \u2502\n\u2502 \u2502        mode = 'mode'                                               \u2502       \u2502\n\u2502 \u2502  new_screen = ScreenWithCSS()                                      \u2502       \u2502\n\u2502 \u2502      screen = ScreenWithCSS()                                      \u2502       \u2502\n\u2502 \u2502        self = MyApp(title='MyApp', classes={'-dark-mode'})         \u2502       \u2502\n\u2502 \u2502       stack = [ScreenWithCSS()]                                    \u2502       \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f       \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2040 in _load_screen_css      \u2502\n\u2502                                                                              \u2502\n\u2502   2037 \u2502   \u2502   \u2502   \u2502   update = True                                         \u2502\n\u2502   2038 \u2502   \u2502   if update:                                                    \u2502\n\u2502   2039 \u2502   \u2502   \u2502   self.stylesheet.reparse()                                 \u2502\n\u2502 \u2771 2040 \u2502   \u2502   \u2502   self.stylesheet.update(self)                              \u2502\n\u2502   2041 \u2502                                                                     \u2502\n\u2502   2042 \u2502   async def _replace_screen(self, screen: Screen) -> Screen:        \u2502\n\u2502   2043 \u2502   \u2502   \"\"\"Handle the replaced screen.                                \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502             path = PosixPath('/root/repos/py_data/textual/tests/css/tes\u2026 \u2502 \u2502\n\u2502 \u2502        read_from = (                                                     \u2502 \u2502\n\u2502 \u2502                    \u2502                                                     \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/tests/css/test_screen_c\u2026 \u2502 \u2502\n\u2502 \u2502                    \u2502   'ScreenWithCSS.CSS'                               \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502           screen = ScreenWithCSS()                                       \u2502 \u2502\n\u2502 \u2502 screen_class_var = 'ScreenWithCSS.CSS'                                   \u2502 \u2502\n\u2502 \u2502      screen_path = '/root/repos/py_data/textual/tests/css/test_screen_c\u2026 \u2502 \u2502\n\u2502 \u2502             self = MyApp(title='MyApp', classes={'-dark-mode'})          \u2502 \u2502\n\u2502 \u2502           update = True                                                  \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:673 in update      \u2502\n\u2502                                                                              \u2502\n\u2502   670 \u2502   \u2502   \u2502   animate: Enable CSS animation.                             \u2502\n\u2502   671 \u2502   \u2502   \"\"\"                                                            \u2502\n\u2502   672 \u2502   \u2502                                                                  \u2502\n\u2502 \u2771 673 \u2502   \u2502   self.update_nodes(root.walk_children(with_self=True), animate= \u2502\n\u2502   674 \u2502                                                                      \u2502\n\u2502   675 \u2502   def update_nodes(self, nodes: Iterable[DOMNode], animate: bool = F \u2502\n\u2502   676 \u2502   \u2502   \"\"\"Update styles for nodes.                                    \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 animate = False                                                          \u2502 \u2502\n\u2502 \u2502    root = MyApp(title='MyApp', classes={'-dark-mode'})                   \u2502 \u2502\n\u2502 \u2502    self = <Stylesheet                                                    \u2502 \u2502\n\u2502 \u2502           \u2502   [                                                          \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   '/root/repos/py_data/textual/src/textual/app.py',  \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                                  \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/tests/css/test_screen_css.py',    \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'MyApp.CSS'                                        \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/src/textual/screen.py',           \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                               \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/src/textual/widget.py',           \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                               \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/src/textual/widgets/_label.py',   \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'Label.DEFAULT_CSS'                                \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/src/textual/widgets/_static.py',  \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'Static.DEFAULT_CSS'                               \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/tests/css/test_screen_css.tcss',  \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   ''                                                 \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/tests/css/test_screen_css.py',    \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'ScreenWithCSS.CSS'                                \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   )                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   ]                                                          \u2502 \u2502\n\u2502 \u2502           >                                                              \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/dom.py:1243 in walk_children         \u2502\n\u2502                                                                              \u2502\n\u2502   1240 \u2502   \u2502                                                                 \u2502\n\u2502   1241 \u2502   \u2502   # We want a snapshot of the DOM at this point So that it does \u2502\n\u2502   1242 \u2502   \u2502   # change mid-walk                                             \u2502\n\u2502 \u2771 1243 \u2502   \u2502   nodes = list(node_generator)                                  \u2502\n\u2502   1244 \u2502   \u2502   if reverse:                                                   \u2502\n\u2502   1245 \u2502   \u2502   \u2502   nodes.reverse()                                           \u2502\n\u2502   1246 \u2502   \u2502   return cast(\"list[DOMNode]\", nodes)                           \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e   \u2502\n\u2502 \u2502     check_type = <class 'textual.dom.DOMNode'>                         \u2502   \u2502\n\u2502 \u2502    filter_type = None                                                  \u2502   \u2502\n\u2502 \u2502         method = 'depth'                                               \u2502   \u2502\n\u2502 \u2502 node_generator = <generator object walk_depth_first at 0x7fd98d88dc40> \u2502   \u2502\n\u2502 \u2502        reverse = False                                                 \u2502   \u2502\n\u2502 \u2502           self = MyApp(title='MyApp', classes={'-dark-mode'})          \u2502   \u2502\n\u2502 \u2502      with_self = True                                                  \u2502   \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f   \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/walk.py:61 in walk_depth_first       \u2502\n\u2502                                                                              \u2502\n\u2502    58 \u2502   \"\"\"                                                                \u2502\n\u2502    59 \u2502   from textual.dom import DOMNode                                    \u2502\n\u2502    60 \u2502                                                                      \u2502\n\u2502 \u2771  61 \u2502   stack: list[Iterator[DOMNode]] = [iter(root.children)]             \u2502\n\u2502    62 \u2502   pop = stack.pop                                                    \u2502\n\u2502    63 \u2502   push = stack.append                                                \u2502\n\u2502    64 \u2502   check_type = filter_type or DOMNode                                \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e               \u2502\n\u2502 \u2502     DOMNode = <class 'textual.dom.DOMNode'>                \u2502               \u2502\n\u2502 \u2502 filter_type = <class 'textual.dom.DOMNode'>                \u2502               \u2502\n\u2502 \u2502        root = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502               \u2502\n\u2502 \u2502   with_root = True                                         \u2502               \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f               \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:697 in children               \u2502\n\u2502                                                                              \u2502\n\u2502    694 \u2502   \u2502   \u2502   return (                                                  \u2502\n\u2502    695 \u2502   \u2502   \u2502   \u2502   next(                                                 \u2502\n\u2502    696 \u2502   \u2502   \u2502   \u2502   \u2502   screen                                            \u2502\n\u2502 \u2771  697 \u2502   \u2502   \u2502   \u2502   \u2502   for screen in reversed(self._screen_stack)        \u2502\n\u2502    698 \u2502   \u2502   \u2502   \u2502   \u2502   if not isinstance(screen, SystemModalScreen)      \u2502\n\u2502    699 \u2502   \u2502   \u2502   \u2502   ),                                                    \u2502\n\u2502    700 \u2502   \u2502   \u2502   )                                                         \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                      \u2502\n\u2502 \u2502 self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502                      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                      \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:823 in _screen_stack          \u2502\n\u2502                                                                              \u2502\n\u2502    820 \u2502   \u2502   Returns:                                                      \u2502\n\u2502    821 \u2502   \u2502   \u2502   A reference to the current screen stack.                  \u2502\n\u2502    822 \u2502   \u2502   \"\"\"                                                           \u2502\n\u2502 \u2771  823 \u2502   \u2502   return self._screen_stacks[self._current_mode]                \u2502\n\u2502    824 \u2502                                                                     \u2502\n\u2502    825 \u2502   @property                                                         \u2502\n\u2502    826 \u2502   def current_mode(self) -> str:                                    \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                      \u2502\n\u2502 \u2502 self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502                      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                      \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nKeyError: 'mode'\n\nNOTE: 1 of 2 errors shown. Run with textual run --dev to see all errors.\n_______________ test_screen_css_switch_mode_screen_type_by_name ________________\n\n    async def test_screen_css_switch_mode_screen_type_by_name():\n        \"\"\"Check that screen CSS is loaded and applied when switching to a mode with a screen type name.\"\"\"\n    \n        class MyApp(BaseApp):\n            SCREENS = {\n                \"screenwithcss\": ScreenWithCSS,\n            }\n    \n            MODES = {\n                \"base\": BaseScreen(),\n                \"mode\": \"screenwithcss\",\n            }\n    \n            def key_p(self):\n                self.switch_mode(\"mode\")\n    \n            def key_o(self):\n                self.switch_mode(\"base\")\n    \n        app = MyApp()\n        async with app.run_test() as pilot:\n            await pilot.press(\"o\")\n            check_colors_before_screen_css(app)\n>           await pilot.press(\"p\")\n\ntests/css/test_screen_css.py:305: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/pilot.py:83: in press\n    await self._wait_for_screen()\nsrc/textual/pilot.py:369: in _wait_for_screen\n    children = [self.app, *self.app.screen.walk_children(with_self=True)]\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'})\n\n    @property\n    def screen(self) -> Screen[object]:\n        \"\"\"The current active screen.\n    \n        Returns:\n            The currently active (visible) screen.\n    \n        Raises:\n            ScreenStackError: If there are no screens on the stack.\n        \"\"\"\n        try:\n            return self._screen_stack[-1]\n        except KeyError:\n>           raise UnknownModeError(f\"No known mode {self._current_mode!r}\") from None\nE           textual.app.UnknownModeError: No known mode 'mode'\n\nsrc/textual/app.py:1021: UnknownModeError\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_screen_css_switch_mode_screen_type_by_name():\n        \"\"\"Check that screen CSS is loaded and applied when switching to a mode with a screen type name.\"\"\"\n    \n        class MyApp(BaseApp):\n            SCREENS = {\n                \"screenwithcss\": ScreenWithCSS,\n            }\n    \n            MODES = {\n                \"base\": BaseScreen(),\n                \"mode\": \"screenwithcss\",\n            }\n    \n            def key_p(self):\n                self.switch_mode(\"mode\")\n    \n            def key_o(self):\n                self.switch_mode(\"base\")\n    \n        app = MyApp()\n>       async with app.run_test() as pilot:\n\ntests/css/test_screen_css.py:302: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/message_pump.py:589: in _process_messages_loop\n    await self._dispatch_message(message)\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3110: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:47: in _invoke\n    result = await result\nsrc/textual/app.py:3281: in _on_key\n    await self.dispatch_key(event)\nsrc/textual/message_pump.py:850: in dispatch_key\n    handled = (await invoke(key_method, event)) is not False\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/css/test_screen_css.py:296: in key_p\n    self.switch_mode(\"mode\")\nsrc/textual/app.py:1886: in switch_mode\n    await_mount = self._init_mode(mode)\nsrc/textual/app.py:1858: in _init_mode\n    self._load_screen_css(screen)\nsrc/textual/app.py:2040: in _load_screen_css\n    self.stylesheet.update(self)\nsrc/textual/css/stylesheet.py:673: in update\n    self.update_nodes(root.walk_children(with_self=True), animate=animate)\nsrc/textual/dom.py:1243: in walk_children\n    nodes = list(node_generator)\nsrc/textual/walk.py:61: in walk_depth_first\n    stack: list[Iterator[DOMNode]] = [iter(root.children)]\nsrc/textual/app.py:697: in children\n    for screen in reversed(self._screen_stack)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'})\n\n    @property\n    def _screen_stack(self) -> list[Screen[Any]]:\n        \"\"\"A reference to the current screen stack.\n    \n        Note:\n            Consider using [`screen_stack`][textual.app.App.screen_stack] instead.\n    \n        Returns:\n            A reference to the current screen stack.\n        \"\"\"\n>       return self._screen_stacks[self._current_mode]\nE       KeyError: 'mode'\n\nsrc/textual/app.py:823: KeyError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/css/test_screen_css.py:296 in key_p        \u2502\n\u2502                                                                              \u2502\n\u2502   293 \u2502   \u2502   }                                                              \u2502\n\u2502   294 \u2502   \u2502                                                                  \u2502\n\u2502   295 \u2502   \u2502   def key_p(self):                                               \u2502\n\u2502 \u2771 296 \u2502   \u2502   \u2502   self.switch_mode(\"mode\")                                   \u2502\n\u2502   297 \u2502   \u2502                                                                  \u2502\n\u2502   298 \u2502   \u2502   def key_o(self):                                               \u2502\n\u2502   299 \u2502   \u2502   \u2502   self.switch_mode(\"base\")                                   \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                      \u2502\n\u2502 \u2502 self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502                      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                      \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:1886 in switch_mode           \u2502\n\u2502                                                                              \u2502\n\u2502   1883 \u2502   \u2502   self._current_mode = mode                                     \u2502\n\u2502   1884 \u2502   \u2502                                                                 \u2502\n\u2502   1885 \u2502   \u2502   if mode not in self._screen_stacks:                           \u2502\n\u2502 \u2771 1886 \u2502   \u2502   \u2502   await_mount = self._init_mode(mode)                       \u2502\n\u2502   1887 \u2502   \u2502   else:                                                         \u2502\n\u2502   1888 \u2502   \u2502   \u2502   await_mount = AwaitMount(self, [])                        \u2502\n\u2502   1889                                                                       \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e              \u2502\n\u2502 \u2502 current_mode = 'base'                                       \u2502              \u2502\n\u2502 \u2502         mode = 'mode'                                       \u2502              \u2502\n\u2502 \u2502         self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502              \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f              \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:1858 in _init_mode            \u2502\n\u2502                                                                              \u2502\n\u2502   1855 \u2502   \u2502   \u2502   new_screen: Screen | str = _screen() if callable(_screen) \u2502\n\u2502   1856 \u2502   \u2502   \u2502   screen, await_mount = self._get_screen(new_screen)        \u2502\n\u2502   1857 \u2502   \u2502   \u2502   stack.append(screen)                                      \u2502\n\u2502 \u2771 1858 \u2502   \u2502   \u2502   self._load_screen_css(screen)                             \u2502\n\u2502   1859 \u2502   \u2502                                                                 \u2502\n\u2502   1860 \u2502   \u2502   self._screen_stacks[mode] = stack                             \u2502\n\u2502   1861 \u2502   \u2502   return await_mount                                            \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e       \u2502\n\u2502 \u2502     _screen = 'screenwithcss'                                      \u2502       \u2502\n\u2502 \u2502 await_mount = <textual.widget.AwaitMount object at 0x7fd98d692dd0> \u2502       \u2502\n\u2502 \u2502        mode = 'mode'                                               \u2502       \u2502\n\u2502 \u2502  new_screen = 'screenwithcss'                                      \u2502       \u2502\n\u2502 \u2502      screen = ScreenWithCSS()                                      \u2502       \u2502\n\u2502 \u2502        self = MyApp(title='MyApp', classes={'-dark-mode'})         \u2502       \u2502\n\u2502 \u2502       stack = [ScreenWithCSS()]                                    \u2502       \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f       \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2040 in _load_screen_css      \u2502\n\u2502                                                                              \u2502\n\u2502   2037 \u2502   \u2502   \u2502   \u2502   update = True                                         \u2502\n\u2502   2038 \u2502   \u2502   if update:                                                    \u2502\n\u2502   2039 \u2502   \u2502   \u2502   self.stylesheet.reparse()                                 \u2502\n\u2502 \u2771 2040 \u2502   \u2502   \u2502   self.stylesheet.update(self)                              \u2502\n\u2502   2041 \u2502                                                                     \u2502\n\u2502   2042 \u2502   async def _replace_screen(self, screen: Screen) -> Screen:        \u2502\n\u2502   2043 \u2502   \u2502   \"\"\"Handle the replaced screen.                                \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502             path = PosixPath('/root/repos/py_data/textual/tests/css/tes\u2026 \u2502 \u2502\n\u2502 \u2502        read_from = (                                                     \u2502 \u2502\n\u2502 \u2502                    \u2502                                                     \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/tests/css/test_screen_c\u2026 \u2502 \u2502\n\u2502 \u2502                    \u2502   'ScreenWithCSS.CSS'                               \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502           screen = ScreenWithCSS()                                       \u2502 \u2502\n\u2502 \u2502 screen_class_var = 'ScreenWithCSS.CSS'                                   \u2502 \u2502\n\u2502 \u2502      screen_path = '/root/repos/py_data/textual/tests/css/test_screen_c\u2026 \u2502 \u2502\n\u2502 \u2502             self = MyApp(title='MyApp', classes={'-dark-mode'})          \u2502 \u2502\n\u2502 \u2502           update = True                                                  \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:673 in update      \u2502\n\u2502                                                                              \u2502\n\u2502   670 \u2502   \u2502   \u2502   animate: Enable CSS animation.                             \u2502\n\u2502   671 \u2502   \u2502   \"\"\"                                                            \u2502\n\u2502   672 \u2502   \u2502                                                                  \u2502\n\u2502 \u2771 673 \u2502   \u2502   self.update_nodes(root.walk_children(with_self=True), animate= \u2502\n\u2502   674 \u2502                                                                      \u2502\n\u2502   675 \u2502   def update_nodes(self, nodes: Iterable[DOMNode], animate: bool = F \u2502\n\u2502   676 \u2502   \u2502   \"\"\"Update styles for nodes.                                    \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 animate = False                                                          \u2502 \u2502\n\u2502 \u2502    root = MyApp(title='MyApp', classes={'-dark-mode'})                   \u2502 \u2502\n\u2502 \u2502    self = <Stylesheet                                                    \u2502 \u2502\n\u2502 \u2502           \u2502   [                                                          \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   '/root/repos/py_data/textual/src/textual/app.py',  \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                                  \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/tests/css/test_screen_css.py',    \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'MyApp.CSS'                                        \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/src/textual/screen.py',           \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                               \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/src/textual/widget.py',           \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                               \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/src/textual/widgets/_label.py',   \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'Label.DEFAULT_CSS'                                \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/src/textual/widgets/_static.py',  \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'Static.DEFAULT_CSS'                               \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/tests/css/test_screen_css.tcss',  \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   ''                                                 \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/tests/css/test_screen_css.py',    \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'ScreenWithCSS.CSS'                                \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   )                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   ]                                                          \u2502 \u2502\n\u2502 \u2502           >                                                              \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/dom.py:1243 in walk_children         \u2502\n\u2502                                                                              \u2502\n\u2502   1240 \u2502   \u2502                                                                 \u2502\n\u2502   1241 \u2502   \u2502   # We want a snapshot of the DOM at this point So that it does \u2502\n\u2502   1242 \u2502   \u2502   # change mid-walk                                             \u2502\n\u2502 \u2771 1243 \u2502   \u2502   nodes = list(node_generator)                                  \u2502\n\u2502   1244 \u2502   \u2502   if reverse:                                                   \u2502\n\u2502   1245 \u2502   \u2502   \u2502   nodes.reverse()                                           \u2502\n\u2502   1246 \u2502   \u2502   return cast(\"list[DOMNode]\", nodes)                           \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e   \u2502\n\u2502 \u2502     check_type = <class 'textual.dom.DOMNode'>                         \u2502   \u2502\n\u2502 \u2502    filter_type = None                                                  \u2502   \u2502\n\u2502 \u2502         method = 'depth'                                               \u2502   \u2502\n\u2502 \u2502 node_generator = <generator object walk_depth_first at 0x7fd98d5c77d0> \u2502   \u2502\n\u2502 \u2502        reverse = False                                                 \u2502   \u2502\n\u2502 \u2502           self = MyApp(title='MyApp', classes={'-dark-mode'})          \u2502   \u2502\n\u2502 \u2502      with_self = True                                                  \u2502   \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f   \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/walk.py:61 in walk_depth_first       \u2502\n\u2502                                                                              \u2502\n\u2502    58 \u2502   \"\"\"                                                                \u2502\n\u2502    59 \u2502   from textual.dom import DOMNode                                    \u2502\n\u2502    60 \u2502                                                                      \u2502\n\u2502 \u2771  61 \u2502   stack: list[Iterator[DOMNode]] = [iter(root.children)]             \u2502\n\u2502    62 \u2502   pop = stack.pop                                                    \u2502\n\u2502    63 \u2502   push = stack.append                                                \u2502\n\u2502    64 \u2502   check_type = filter_type or DOMNode                                \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e               \u2502\n\u2502 \u2502     DOMNode = <class 'textual.dom.DOMNode'>                \u2502               \u2502\n\u2502 \u2502 filter_type = <class 'textual.dom.DOMNode'>                \u2502               \u2502\n\u2502 \u2502        root = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502               \u2502\n\u2502 \u2502   with_root = True                                         \u2502               \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f               \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:697 in children               \u2502\n\u2502                                                                              \u2502\n\u2502    694 \u2502   \u2502   \u2502   return (                                                  \u2502\n\u2502    695 \u2502   \u2502   \u2502   \u2502   next(                                                 \u2502\n\u2502    696 \u2502   \u2502   \u2502   \u2502   \u2502   screen                                            \u2502\n\u2502 \u2771  697 \u2502   \u2502   \u2502   \u2502   \u2502   for screen in reversed(self._screen_stack)        \u2502\n\u2502    698 \u2502   \u2502   \u2502   \u2502   \u2502   if not isinstance(screen, SystemModalScreen)      \u2502\n\u2502    699 \u2502   \u2502   \u2502   \u2502   ),                                                    \u2502\n\u2502    700 \u2502   \u2502   \u2502   )                                                         \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                      \u2502\n\u2502 \u2502 self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502                      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                      \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:823 in _screen_stack          \u2502\n\u2502                                                                              \u2502\n\u2502    820 \u2502   \u2502   Returns:                                                      \u2502\n\u2502    821 \u2502   \u2502   \u2502   A reference to the current screen stack.                  \u2502\n\u2502    822 \u2502   \u2502   \"\"\"                                                           \u2502\n\u2502 \u2771  823 \u2502   \u2502   return self._screen_stacks[self._current_mode]                \u2502\n\u2502    824 \u2502                                                                     \u2502\n\u2502    825 \u2502   @property                                                         \u2502\n\u2502    826 \u2502   def current_mode(self) -> str:                                    \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                      \u2502\n\u2502 \u2502 self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502                      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                      \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nKeyError: 'mode'\n\nNOTE: 1 of 2 errors shown. Run with textual run --dev to see all errors.\n_____________ test_screen_css_switch_mode_screen_instance_by_name ______________\n\n    async def test_screen_css_switch_mode_screen_instance_by_name():\n        \"\"\"Check that screen CSS is loaded and applied when switching to a mode with a screen instance name.\"\"\"\n    \n        class MyApp(BaseApp):\n            SCREENS = {\n                \"screenwithcss\": ScreenWithCSS(),\n            }\n    \n            MODES = {\n                \"base\": BaseScreen(),\n                \"mode\": \"screenwithcss\",\n            }\n    \n            def key_p(self):\n                self.switch_mode(\"mode\")\n    \n            def key_o(self):\n                self.switch_mode(\"base\")\n    \n        app = MyApp()\n        async with app.run_test() as pilot:\n            await pilot.press(\"o\")\n            check_colors_before_screen_css(app)\n>           await pilot.press(\"p\")\n\ntests/css/test_screen_css.py:276: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/pilot.py:83: in press\n    await self._wait_for_screen()\nsrc/textual/pilot.py:369: in _wait_for_screen\n    children = [self.app, *self.app.screen.walk_children(with_self=True)]\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'})\n\n    @property\n    def screen(self) -> Screen[object]:\n        \"\"\"The current active screen.\n    \n        Returns:\n            The currently active (visible) screen.\n    \n        Raises:\n            ScreenStackError: If there are no screens on the stack.\n        \"\"\"\n        try:\n            return self._screen_stack[-1]\n        except KeyError:\n>           raise UnknownModeError(f\"No known mode {self._current_mode!r}\") from None\nE           textual.app.UnknownModeError: No known mode 'mode'\n\nsrc/textual/app.py:1021: UnknownModeError\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_screen_css_switch_mode_screen_instance_by_name():\n        \"\"\"Check that screen CSS is loaded and applied when switching to a mode with a screen instance name.\"\"\"\n    \n        class MyApp(BaseApp):\n            SCREENS = {\n                \"screenwithcss\": ScreenWithCSS(),\n            }\n    \n            MODES = {\n                \"base\": BaseScreen(),\n                \"mode\": \"screenwithcss\",\n            }\n    \n            def key_p(self):\n                self.switch_mode(\"mode\")\n    \n            def key_o(self):\n                self.switch_mode(\"base\")\n    \n        app = MyApp()\n>       async with app.run_test() as pilot:\n\ntests/css/test_screen_css.py:273: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/message_pump.py:589: in _process_messages_loop\n    await self._dispatch_message(message)\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3110: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:47: in _invoke\n    result = await result\nsrc/textual/app.py:3281: in _on_key\n    await self.dispatch_key(event)\nsrc/textual/message_pump.py:850: in dispatch_key\n    handled = (await invoke(key_method, event)) is not False\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/css/test_screen_css.py:267: in key_p\n    self.switch_mode(\"mode\")\nsrc/textual/app.py:1886: in switch_mode\n    await_mount = self._init_mode(mode)\nsrc/textual/app.py:1858: in _init_mode\n    self._load_screen_css(screen)\nsrc/textual/app.py:2040: in _load_screen_css\n    self.stylesheet.update(self)\nsrc/textual/css/stylesheet.py:673: in update\n    self.update_nodes(root.walk_children(with_self=True), animate=animate)\nsrc/textual/dom.py:1243: in walk_children\n    nodes = list(node_generator)\nsrc/textual/walk.py:61: in walk_depth_first\n    stack: list[Iterator[DOMNode]] = [iter(root.children)]\nsrc/textual/app.py:697: in children\n    for screen in reversed(self._screen_stack)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'})\n\n    @property\n    def _screen_stack(self) -> list[Screen[Any]]:\n        \"\"\"A reference to the current screen stack.\n    \n        Note:\n            Consider using [`screen_stack`][textual.app.App.screen_stack] instead.\n    \n        Returns:\n            A reference to the current screen stack.\n        \"\"\"\n>       return self._screen_stacks[self._current_mode]\nE       KeyError: 'mode'\n\nsrc/textual/app.py:823: KeyError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/css/test_screen_css.py:267 in key_p        \u2502\n\u2502                                                                              \u2502\n\u2502   264 \u2502   \u2502   }                                                              \u2502\n\u2502   265 \u2502   \u2502                                                                  \u2502\n\u2502   266 \u2502   \u2502   def key_p(self):                                               \u2502\n\u2502 \u2771 267 \u2502   \u2502   \u2502   self.switch_mode(\"mode\")                                   \u2502\n\u2502   268 \u2502   \u2502                                                                  \u2502\n\u2502   269 \u2502   \u2502   def key_o(self):                                               \u2502\n\u2502   270 \u2502   \u2502   \u2502   self.switch_mode(\"base\")                                   \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                      \u2502\n\u2502 \u2502 self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502                      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                      \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:1886 in switch_mode           \u2502\n\u2502                                                                              \u2502\n\u2502   1883 \u2502   \u2502   self._current_mode = mode                                     \u2502\n\u2502   1884 \u2502   \u2502                                                                 \u2502\n\u2502   1885 \u2502   \u2502   if mode not in self._screen_stacks:                           \u2502\n\u2502 \u2771 1886 \u2502   \u2502   \u2502   await_mount = self._init_mode(mode)                       \u2502\n\u2502   1887 \u2502   \u2502   else:                                                         \u2502\n\u2502   1888 \u2502   \u2502   \u2502   await_mount = AwaitMount(self, [])                        \u2502\n\u2502   1889                                                                       \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e              \u2502\n\u2502 \u2502 current_mode = 'base'                                       \u2502              \u2502\n\u2502 \u2502         mode = 'mode'                                       \u2502              \u2502\n\u2502 \u2502         self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502              \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f              \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:1858 in _init_mode            \u2502\n\u2502                                                                              \u2502\n\u2502   1855 \u2502   \u2502   \u2502   new_screen: Screen | str = _screen() if callable(_screen) \u2502\n\u2502   1856 \u2502   \u2502   \u2502   screen, await_mount = self._get_screen(new_screen)        \u2502\n\u2502   1857 \u2502   \u2502   \u2502   stack.append(screen)                                      \u2502\n\u2502 \u2771 1858 \u2502   \u2502   \u2502   self._load_screen_css(screen)                             \u2502\n\u2502   1859 \u2502   \u2502                                                                 \u2502\n\u2502   1860 \u2502   \u2502   self._screen_stacks[mode] = stack                             \u2502\n\u2502   1861 \u2502   \u2502   return await_mount                                            \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e       \u2502\n\u2502 \u2502     _screen = 'screenwithcss'                                      \u2502       \u2502\n\u2502 \u2502 await_mount = <textual.widget.AwaitMount object at 0x7fd98d303610> \u2502       \u2502\n\u2502 \u2502        mode = 'mode'                                               \u2502       \u2502\n\u2502 \u2502  new_screen = 'screenwithcss'                                      \u2502       \u2502\n\u2502 \u2502      screen = ScreenWithCSS()                                      \u2502       \u2502\n\u2502 \u2502        self = MyApp(title='MyApp', classes={'-dark-mode'})         \u2502       \u2502\n\u2502 \u2502       stack = [ScreenWithCSS()]                                    \u2502       \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f       \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2040 in _load_screen_css      \u2502\n\u2502                                                                              \u2502\n\u2502   2037 \u2502   \u2502   \u2502   \u2502   update = True                                         \u2502\n\u2502   2038 \u2502   \u2502   if update:                                                    \u2502\n\u2502   2039 \u2502   \u2502   \u2502   self.stylesheet.reparse()                                 \u2502\n\u2502 \u2771 2040 \u2502   \u2502   \u2502   self.stylesheet.update(self)                              \u2502\n\u2502   2041 \u2502                                                                     \u2502\n\u2502   2042 \u2502   async def _replace_screen(self, screen: Screen) -> Screen:        \u2502\n\u2502   2043 \u2502   \u2502   \"\"\"Handle the replaced screen.                                \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502             path = PosixPath('/root/repos/py_data/textual/tests/css/tes\u2026 \u2502 \u2502\n\u2502 \u2502        read_from = (                                                     \u2502 \u2502\n\u2502 \u2502                    \u2502                                                     \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/tests/css/test_screen_c\u2026 \u2502 \u2502\n\u2502 \u2502                    \u2502   'ScreenWithCSS.CSS'                               \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502           screen = ScreenWithCSS()                                       \u2502 \u2502\n\u2502 \u2502 screen_class_var = 'ScreenWithCSS.CSS'                                   \u2502 \u2502\n\u2502 \u2502      screen_path = '/root/repos/py_data/textual/tests/css/test_screen_c\u2026 \u2502 \u2502\n\u2502 \u2502             self = MyApp(title='MyApp', classes={'-dark-mode'})          \u2502 \u2502\n\u2502 \u2502           update = True                                                  \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:673 in update      \u2502\n\u2502                                                                              \u2502\n\u2502   670 \u2502   \u2502   \u2502   animate: Enable CSS animation.                             \u2502\n\u2502   671 \u2502   \u2502   \"\"\"                                                            \u2502\n\u2502   672 \u2502   \u2502                                                                  \u2502\n\u2502 \u2771 673 \u2502   \u2502   self.update_nodes(root.walk_children(with_self=True), animate= \u2502\n\u2502   674 \u2502                                                                      \u2502\n\u2502   675 \u2502   def update_nodes(self, nodes: Iterable[DOMNode], animate: bool = F \u2502\n\u2502   676 \u2502   \u2502   \"\"\"Update styles for nodes.                                    \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 animate = False                                                          \u2502 \u2502\n\u2502 \u2502    root = MyApp(title='MyApp', classes={'-dark-mode'})                   \u2502 \u2502\n\u2502 \u2502    self = <Stylesheet                                                    \u2502 \u2502\n\u2502 \u2502           \u2502   [                                                          \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   '/root/repos/py_data/textual/src/textual/app.py',  \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                                  \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/tests/css/test_screen_css.py',    \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'MyApp.CSS'                                        \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/src/textual/screen.py',           \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                               \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/src/textual/widget.py',           \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                               \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/src/textual/widgets/_label.py',   \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'Label.DEFAULT_CSS'                                \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/src/textual/widgets/_static.py',  \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'Static.DEFAULT_CSS'                               \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/tests/css/test_screen_css.tcss',  \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   ''                                                 \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   ),                                                     \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   (                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502                                                      \u2502 \u2502\n\u2502 \u2502           '/root/repos/py_data/textual/tests/css/test_screen_css.py',    \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   \u2502   'ScreenWithCSS.CSS'                                \u2502 \u2502\n\u2502 \u2502           \u2502   \u2502   )                                                      \u2502 \u2502\n\u2502 \u2502           \u2502   ]                                                          \u2502 \u2502\n\u2502 \u2502           >                                                              \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/dom.py:1243 in walk_children         \u2502\n\u2502                                                                              \u2502\n\u2502   1240 \u2502   \u2502                                                                 \u2502\n\u2502   1241 \u2502   \u2502   # We want a snapshot of the DOM at this point So that it does \u2502\n\u2502   1242 \u2502   \u2502   # change mid-walk                                             \u2502\n\u2502 \u2771 1243 \u2502   \u2502   nodes = list(node_generator)                                  \u2502\n\u2502   1244 \u2502   \u2502   if reverse:                                                   \u2502\n\u2502   1245 \u2502   \u2502   \u2502   nodes.reverse()                                           \u2502\n\u2502   1246 \u2502   \u2502   return cast(\"list[DOMNode]\", nodes)                           \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e   \u2502\n\u2502 \u2502     check_type = <class 'textual.dom.DOMNode'>                         \u2502   \u2502\n\u2502 \u2502    filter_type = None                                                  \u2502   \u2502\n\u2502 \u2502         method = 'depth'                                               \u2502   \u2502\n\u2502 \u2502 node_generator = <generator object walk_depth_first at 0x7fd98d5c4900> \u2502   \u2502\n\u2502 \u2502        reverse = False                                                 \u2502   \u2502\n\u2502 \u2502           self = MyApp(title='MyApp', classes={'-dark-mode'})          \u2502   \u2502\n\u2502 \u2502      with_self = True                                                  \u2502   \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f   \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/walk.py:61 in walk_depth_first       \u2502\n\u2502                                                                              \u2502\n\u2502    58 \u2502   \"\"\"                                                                \u2502\n\u2502    59 \u2502   from textual.dom import DOMNode                                    \u2502\n\u2502    60 \u2502                                                                      \u2502\n\u2502 \u2771  61 \u2502   stack: list[Iterator[DOMNode]] = [iter(root.children)]             \u2502\n\u2502    62 \u2502   pop = stack.pop                                                    \u2502\n\u2502    63 \u2502   push = stack.append                                                \u2502\n\u2502    64 \u2502   check_type = filter_type or DOMNode                                \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e               \u2502\n\u2502 \u2502     DOMNode = <class 'textual.dom.DOMNode'>                \u2502               \u2502\n\u2502 \u2502 filter_type = <class 'textual.dom.DOMNode'>                \u2502               \u2502\n\u2502 \u2502        root = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502               \u2502\n\u2502 \u2502   with_root = True                                         \u2502               \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f               \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:697 in children               \u2502\n\u2502                                                                              \u2502\n\u2502    694 \u2502   \u2502   \u2502   return (                                                  \u2502\n\u2502    695 \u2502   \u2502   \u2502   \u2502   next(                                                 \u2502\n\u2502    696 \u2502   \u2502   \u2502   \u2502   \u2502   screen                                            \u2502\n\u2502 \u2771  697 \u2502   \u2502   \u2502   \u2502   \u2502   for screen in reversed(self._screen_stack)        \u2502\n\u2502    698 \u2502   \u2502   \u2502   \u2502   \u2502   if not isinstance(screen, SystemModalScreen)      \u2502\n\u2502    699 \u2502   \u2502   \u2502   \u2502   ),                                                    \u2502\n\u2502    700 \u2502   \u2502   \u2502   )                                                         \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                      \u2502\n\u2502 \u2502 self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502                      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                      \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:823 in _screen_stack          \u2502\n\u2502                                                                              \u2502\n\u2502    820 \u2502   \u2502   Returns:                                                      \u2502\n\u2502    821 \u2502   \u2502   \u2502   A reference to the current screen stack.                  \u2502\n\u2502    822 \u2502   \u2502   \"\"\"                                                           \u2502\n\u2502 \u2771  823 \u2502   \u2502   return self._screen_stacks[self._current_mode]                \u2502\n\u2502    824 \u2502                                                                     \u2502\n\u2502    825 \u2502   @property                                                         \u2502\n\u2502    826 \u2502   def current_mode(self) -> str:                                    \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                      \u2502\n\u2502 \u2502 self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502                      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                      \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nKeyError: 'mode'\n\nNOTE: 1 of 2 errors shown. Run with textual run --dev to see all errors.\n=============================== warnings summary ===============================\ntests/css/test_screen_css.py::test_screen_css_switch_mode_screen_instance\ntests/css/test_screen_css.py::test_screen_css_switch_mode_screen_type_by_name\ntests/css/test_screen_css.py::test_screen_css_switch_mode_screen_instance_by_name\n  /usr/local/lib/python3.10/site-packages/tornado/ioloop.py:274: DeprecationWarning: There is no current event loop\n    loop = asyncio.get_event_loop()\n\ntests/css/test_screen_css.py::test_screen_css_switch_mode_screen_instance\n  /usr/local/lib/python3.10/site-packages/tornado/platform/asyncio.py:288: DeprecationWarning: There is no current event loop\n    super().initialize(asyncio.get_event_loop(), **kwargs)\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/css/test_screen_css.py::test_screen_css_switch_mode_screen_instance\nFAILED tests/css/test_screen_css.py::test_screen_css_switch_mode_screen_type_by_name\nFAILED tests/css/test_screen_css.py::test_screen_css_switch_mode_screen_instance_by_name\n======================== 3 failed, 4 warnings in 2.36s =========================\n\n"], "textual-src/textual/app.py-push_screen": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 31 items\n\ntests/test_header.py F                                                   [  3%]\ntests/test_focus.py F                                                    [  6%]\ntests/css/test_screen_css.py F                                           [  9%]\ntests/test_focus.py F                                                    [ 12%]\ntests/test_header.py F                                                   [ 16%]\ntests/test_screens.py F.                                                 [ 22%]\ntests/test_header.py F                                                   [ 25%]\ntests/css/test_screen_css.py F                                           [ 29%]\ntests/test_screens.py F                                                  [ 32%]\ntests/test_widget.py F                                                   [ 35%]\ntests/test_header.py F                                                   [ 38%]\ntests/css/test_screen_css.py F                                           [ 41%]\ntests/test_screens.py FF                                                 [ 48%]\ntests/test_header.py F                                                   [ 51%]\ntests/test_screens.py FF                                                 [ 58%]\ntests/test_focus.py F                                                    [ 61%]\ntests/test_screens.py FF                                                 [ 67%]\ntests/test_unmount.py F                                                  [ 70%]\ntests/test_header.py F                                                   [ 74%]\ntests/test_screens.py F                                                  [ 77%]\ntests/test_header.py F                                                   [ 80%]\ntests/test_screens.py FF                                                 [ 87%]\ntests/css/test_screen_css.py F                                           [ 90%]\ntests/test_pilot.py F                                                    [ 93%]\ntests/test_screens.py F                                                  [ 96%]\ntests/test_header.py F                                                   [100%]\n\n=================================== FAILURES ===================================\n______________________ test_screen_title_none_is_ignored _______________________\n\n    async def test_screen_title_none_is_ignored():\n        class MyScreen(Screen):\n            def compose(self):\n                yield Header()\n    \n        class MyApp(App):\n            TITLE = \"app title\"\n    \n            def on_mount(self):\n                self.push_screen(MyScreen())\n    \n        app = MyApp()\n        async with app.run_test():\n>           assert app.query_one(\"HeaderTitle\").text == \"app title\"\n\ntests/test_header.py:19: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/dom.py:1347: in query_one\n    return query.only_one() if expect_type is None else query.only_one(expect_type)\nsrc/textual/css/query.py:278: in only_one\n    self.first(expect_type) if expect_type is not None else self.first()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <DOMQuery query='HeaderTitle'>, expect_type = None\n\n    def first(\n        self, expect_type: type[ExpectType] | None = None\n    ) -> QueryType | ExpectType:\n        \"\"\"Get the *first* matching node.\n    \n        Args:\n            expect_type: Require matched node is of this type,\n                or None for any type.\n    \n        Raises:\n            WrongType: If the wrong type was found.\n            NoMatches: If there are no matching nodes in the query.\n    \n        Returns:\n            The matching Widget.\n        \"\"\"\n        _rich_traceback_omit = True\n        if self.nodes:\n            first = self.nodes[0]\n            if expect_type is not None:\n                if not isinstance(first, expect_type):\n                    raise WrongType(\n                        f\"Query value is wrong type; expected {expect_type}, got {type(first)}\"\n                    )\n            return first\n        else:\n>           raise NoMatches(f\"No nodes match {self!r} on {self.node!r}\")\nE           textual.css.query.NoMatches: No nodes match <DOMQuery query='HeaderTitle'> on MyApp(title='app title', classes={'-dark-mode'})\n\nsrc/textual/css/query.py:247: NoMatches\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_screen_title_none_is_ignored():\n        class MyScreen(Screen):\n            def compose(self):\n                yield Header()\n    \n        class MyApp(App):\n            TITLE = \"app title\"\n    \n            def on_mount(self):\n                self.push_screen(MyScreen())\n    \n        app = MyApp()\n>       async with app.run_test():\n\ntests/test_header.py:18: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/test_header.py:15: in on_mount\n    self.push_screen(MyScreen())\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='app title', classes={'-dark-mode'}), screen = MyScreen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/test_header.py:15 in on_mount              \u2502\n\u2502                                                                              \u2502\n\u2502    12 \u2502   \u2502   TITLE = \"app title\"                                            \u2502\n\u2502    13 \u2502   \u2502                                                                  \u2502\n\u2502    14 \u2502   \u2502   def on_mount(self):                                            \u2502\n\u2502 \u2771  15 \u2502   \u2502   \u2502   self.push_screen(MyScreen())                               \u2502\n\u2502    16 \u2502                                                                      \u2502\n\u2502    17 \u2502   app = MyApp()                                                      \u2502\n\u2502    18 \u2502   async with app.run_test():                                         \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 MyScreen = <class                                                        \u2502 \u2502\n\u2502 \u2502            'tests.test_header.test_screen_title_none_is_ignored.<locals\u2026 \u2502 \u2502\n\u2502 \u2502     self = MyApp(title='app title', classes={'-dark-mode'})              \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e      \u2502\n\u2502 \u2502         callback = None                                             \u2502      \u2502\n\u2502 \u2502           screen = MyScreen()                                       \u2502      \u2502\n\u2502 \u2502             self = MyApp(title='app title', classes={'-dark-mode'}) \u2502      \u2502\n\u2502 \u2502 wait_for_dismiss = False                                            \u2502      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f      \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'MyApp' object has no attribute '_push_screen'\n_________ test_focus_next_and_previous_with_type_selector_without_self _________\n\n    def test_focus_next_and_previous_with_type_selector_without_self():\n        \"\"\"Test moving the focus with a selector that does not match the currently focused node.\"\"\"\n        app = App()\n        app._set_active()\n>       app.push_screen(Screen())\n\ntests/test_focus.py:192: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = App(title='App', classes={'-dark-mode'}), screen = Screen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'App' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n_____________________ test_screen_css_push_screen_instance _____________________\n\n    async def test_screen_css_push_screen_instance():\n        \"\"\"Check that screen CSS is loaded and applied when pushing a screen instance.\"\"\"\n    \n        class MyApp(BaseApp):\n            def key_p(self):\n                self.push_screen(ScreenWithCSS())\n    \n            def key_o(self):\n                self.pop_screen()\n    \n        app = MyApp()\n        async with app.run_test() as pilot:\n>           check_colors_before_screen_css(app)\n\ntests/css/test_screen_css.py:118: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/css/test_screen_css.py:61: in check_colors_before_screen_css\n    assert app.query_one(\"#app-css\").styles.background == GREEN\nsrc/textual/dom.py:1347: in query_one\n    return query.only_one() if expect_type is None else query.only_one(expect_type)\nsrc/textual/css/query.py:278: in only_one\n    self.first(expect_type) if expect_type is not None else self.first()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <DOMQuery query='#app-css'>, expect_type = None\n\n    def first(\n        self, expect_type: type[ExpectType] | None = None\n    ) -> QueryType | ExpectType:\n        \"\"\"Get the *first* matching node.\n    \n        Args:\n            expect_type: Require matched node is of this type,\n                or None for any type.\n    \n        Raises:\n            WrongType: If the wrong type was found.\n            NoMatches: If there are no matching nodes in the query.\n    \n        Returns:\n            The matching Widget.\n        \"\"\"\n        _rich_traceback_omit = True\n        if self.nodes:\n            first = self.nodes[0]\n            if expect_type is not None:\n                if not isinstance(first, expect_type):\n                    raise WrongType(\n                        f\"Query value is wrong type; expected {expect_type}, got {type(first)}\"\n                    )\n            return first\n        else:\n>           raise NoMatches(f\"No nodes match {self!r} on {self.node!r}\")\nE           textual.css.query.NoMatches: No nodes match <DOMQuery query='#app-css'> on MyApp(title='MyApp', classes={'-dark-mode'})\n\nsrc/textual/css/query.py:247: NoMatches\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_screen_css_push_screen_instance():\n        \"\"\"Check that screen CSS is loaded and applied when pushing a screen instance.\"\"\"\n    \n        class MyApp(BaseApp):\n            def key_p(self):\n                self.push_screen(ScreenWithCSS())\n    \n            def key_o(self):\n                self.pop_screen()\n    \n        app = MyApp()\n>       async with app.run_test() as pilot:\n\ntests/css/test_screen_css.py:117: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/css/test_screen_css.py:50: in on_mount\n    self.push_screen(BaseScreen())\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'}), screen = BaseScreen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/css/test_screen_css.py:50 in on_mount      \u2502\n\u2502                                                                              \u2502\n\u2502    47 \u2502   \"\"\"                                                                \u2502\n\u2502    48 \u2502                                                                      \u2502\n\u2502    49 \u2502   def on_mount(self):                                                \u2502\n\u2502 \u2771  50 \u2502   \u2502   self.push_screen(BaseScreen())                                 \u2502\n\u2502    51                                                                        \u2502\n\u2502    52                                                                        \u2502\n\u2502    53 class SwitchBaseApp(BaseApp):                                          \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                      \u2502\n\u2502 \u2502 self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502                      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                      \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e          \u2502\n\u2502 \u2502         callback = None                                         \u2502          \u2502\n\u2502 \u2502           screen = BaseScreen()                                 \u2502          \u2502\n\u2502 \u2502             self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502          \u2502\n\u2502 \u2502 wait_for_dismiss = False                                        \u2502          \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f          \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'MyApp' object has no attribute '_push_screen'\n_______________________________ test_allow_focus _______________________________\n\n    def test_allow_focus():\n        \"\"\"Test allow_focus and allow_focus_children are called and the result used.\"\"\"\n        focusable_allow_focus_called = False\n        non_focusable_allow_focus_called = False\n    \n        class Focusable(Widget, can_focus=False):\n            def allow_focus(self) -> bool:\n                nonlocal focusable_allow_focus_called\n                focusable_allow_focus_called = True\n                return True\n    \n        class NonFocusable(Container, can_focus=True):\n            def allow_focus(self) -> bool:\n                nonlocal non_focusable_allow_focus_called\n                non_focusable_allow_focus_called = True\n                return False\n    \n        class FocusableContainer(Container, can_focus_children=False):\n            def allow_focus_children(self) -> bool:\n                return True\n    \n        class NonFocusableContainer(Container, can_focus_children=True):\n            def allow_focus_children(self) -> bool:\n                return False\n    \n        app = App()\n        app._set_active()\n>       app.push_screen(Screen())\n\ntests/test_focus.py:94: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = App(title='App', classes={'-dark-mode'}), screen = Screen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'App' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n____________________ test_screen_sub_title_none_is_ignored _____________________\n\n    async def test_screen_sub_title_none_is_ignored():\n        class MyScreen(Screen):\n            def compose(self):\n                yield Header()\n    \n        class MyApp(App):\n            SUB_TITLE = \"app sub-title\"\n    \n            def on_mount(self):\n                self.push_screen(MyScreen())\n    \n        app = MyApp()\n        async with app.run_test():\n>           assert app.query_one(\"HeaderTitle\").sub_text == \"app sub-title\"\n\ntests/test_header.py:93: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/dom.py:1347: in query_one\n    return query.only_one() if expect_type is None else query.only_one(expect_type)\nsrc/textual/css/query.py:278: in only_one\n    self.first(expect_type) if expect_type is not None else self.first()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <DOMQuery query='HeaderTitle'>, expect_type = None\n\n    def first(\n        self, expect_type: type[ExpectType] | None = None\n    ) -> QueryType | ExpectType:\n        \"\"\"Get the *first* matching node.\n    \n        Args:\n            expect_type: Require matched node is of this type,\n                or None for any type.\n    \n        Raises:\n            WrongType: If the wrong type was found.\n            NoMatches: If there are no matching nodes in the query.\n    \n        Returns:\n            The matching Widget.\n        \"\"\"\n        _rich_traceback_omit = True\n        if self.nodes:\n            first = self.nodes[0]\n            if expect_type is not None:\n                if not isinstance(first, expect_type):\n                    raise WrongType(\n                        f\"Query value is wrong type; expected {expect_type}, got {type(first)}\"\n                    )\n            return first\n        else:\n>           raise NoMatches(f\"No nodes match {self!r} on {self.node!r}\")\nE           textual.css.query.NoMatches: No nodes match <DOMQuery query='HeaderTitle'> on MyApp(title='MyApp', classes={'-dark-mode'})\n\nsrc/textual/css/query.py:247: NoMatches\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_screen_sub_title_none_is_ignored():\n        class MyScreen(Screen):\n            def compose(self):\n                yield Header()\n    \n        class MyApp(App):\n            SUB_TITLE = \"app sub-title\"\n    \n            def on_mount(self):\n                self.push_screen(MyScreen())\n    \n        app = MyApp()\n>       async with app.run_test():\n\ntests/test_header.py:92: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/test_header.py:89: in on_mount\n    self.push_screen(MyScreen())\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'}), screen = MyScreen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/test_header.py:89 in on_mount              \u2502\n\u2502                                                                              \u2502\n\u2502    86 \u2502   \u2502   SUB_TITLE = \"app sub-title\"                                    \u2502\n\u2502    87 \u2502   \u2502                                                                  \u2502\n\u2502    88 \u2502   \u2502   def on_mount(self):                                            \u2502\n\u2502 \u2771  89 \u2502   \u2502   \u2502   self.push_screen(MyScreen())                               \u2502\n\u2502    90 \u2502                                                                      \u2502\n\u2502    91 \u2502   app = MyApp()                                                      \u2502\n\u2502    92 \u2502   async with app.run_test():                                         \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 MyScreen = <class                                                        \u2502 \u2502\n\u2502 \u2502            'tests.test_header.test_screen_sub_title_none_is_ignored.<lo\u2026 \u2502 \u2502\n\u2502 \u2502     self = MyApp(title='MyApp', classes={'-dark-mode'})                  \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e          \u2502\n\u2502 \u2502         callback = None                                         \u2502          \u2502\n\u2502 \u2502           screen = MyScreen()                                   \u2502          \u2502\n\u2502 \u2502             self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502          \u2502\n\u2502 \u2502 wait_for_dismiss = False                                        \u2502          \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f          \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'MyApp' object has no attribute '_push_screen'\n_____________________________ test_dismiss_action ______________________________\n\n    async def test_dismiss_action():\n        class ConfirmScreen(Screen[bool]):\n            BINDINGS = [(\"y\", \"dismiss(True)\", \"Dismiss\")]\n    \n        class MyApp(App[None]):\n            bingo = False\n    \n            def on_mount(self) -> None:\n                self.push_screen(ConfirmScreen(), callback=self.callback)\n    \n            def callback(self, result: bool) -> None:\n                self.bingo = result\n    \n        app = MyApp()\n        async with app.run_test() as pilot:\n            await pilot.press(\"y\")\n>           assert app.bingo\nE           AssertionError: assert False\nE            +  where False = MyApp(title='MyApp', classes={'-dark-mode'}).bingo\n\ntests/test_screens.py:324: AssertionError\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_dismiss_action():\n        class ConfirmScreen(Screen[bool]):\n            BINDINGS = [(\"y\", \"dismiss(True)\", \"Dismiss\")]\n    \n        class MyApp(App[None]):\n            bingo = False\n    \n            def on_mount(self) -> None:\n                self.push_screen(ConfirmScreen(), callback=self.callback)\n    \n            def callback(self, result: bool) -> None:\n                self.bingo = result\n    \n        app = MyApp()\n>       async with app.run_test() as pilot:\n\ntests/test_screens.py:322: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/test_screens.py:316: in on_mount\n    self.push_screen(ConfirmScreen(), callback=self.callback)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'}), screen = ConfirmScreen()\ncallback = <bound method test_dismiss_action.<locals>.MyApp.callback of MyApp(title='MyApp', classes={'-dark-mode'})>\nwait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/test_screens.py:316 in on_mount            \u2502\n\u2502                                                                              \u2502\n\u2502   313 \u2502   \u2502   bingo = False                                                  \u2502\n\u2502   314 \u2502   \u2502                                                                  \u2502\n\u2502   315 \u2502   \u2502   def on_mount(self) -> None:                                    \u2502\n\u2502 \u2771 316 \u2502   \u2502   \u2502   self.push_screen(ConfirmScreen(), callback=self.callback)  \u2502\n\u2502   317 \u2502   \u2502                                                                  \u2502\n\u2502   318 \u2502   \u2502   def callback(self, result: bool) -> None:                      \u2502\n\u2502   319 \u2502   \u2502   \u2502   self.bingo = result                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 ConfirmScreen = <class                                                   \u2502 \u2502\n\u2502 \u2502                 'tests.test_screens.test_dismiss_action.<locals>.Confir\u2026 \u2502 \u2502\n\u2502 \u2502          self = MyApp(title='MyApp', classes={'-dark-mode'})             \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502         callback = <bound method                                         \u2502 \u2502\n\u2502 \u2502                    test_dismiss_action.<locals>.MyApp.callback of        \u2502 \u2502\n\u2502 \u2502                    MyApp(title='MyApp', classes={'-dark-mode'})>         \u2502 \u2502\n\u2502 \u2502           screen = ConfirmScreen()                                       \u2502 \u2502\n\u2502 \u2502             self = MyApp(title='MyApp', classes={'-dark-mode'})          \u2502 \u2502\n\u2502 \u2502 wait_for_dismiss = False                                                 \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'MyApp' object has no attribute '_push_screen'\n_______________ test_screen_sub_title_reactive_updates_sub_title _______________\n\n    async def test_screen_sub_title_reactive_updates_sub_title():\n        class MyScreen(Screen):\n            SUB_TITLE = \"screen sub-title\"\n    \n            def compose(self):\n                yield Header()\n    \n        class MyApp(App):\n            SUB_TITLE = \"app sub-title\"\n    \n            def on_mount(self):\n                self.push_screen(MyScreen())\n    \n        app = MyApp()\n        async with app.run_test() as pilot:\n            app.screen.sub_title = \"new screen sub-title\"\n            await pilot.pause()\n>           assert app.query_one(\"HeaderTitle\").sub_text == \"new screen sub-title\"\n\ntests/test_header.py:131: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/dom.py:1347: in query_one\n    return query.only_one() if expect_type is None else query.only_one(expect_type)\nsrc/textual/css/query.py:278: in only_one\n    self.first(expect_type) if expect_type is not None else self.first()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <DOMQuery query='HeaderTitle'>, expect_type = None\n\n    def first(\n        self, expect_type: type[ExpectType] | None = None\n    ) -> QueryType | ExpectType:\n        \"\"\"Get the *first* matching node.\n    \n        Args:\n            expect_type: Require matched node is of this type,\n                or None for any type.\n    \n        Raises:\n            WrongType: If the wrong type was found.\n            NoMatches: If there are no matching nodes in the query.\n    \n        Returns:\n            The matching Widget.\n        \"\"\"\n        _rich_traceback_omit = True\n        if self.nodes:\n            first = self.nodes[0]\n            if expect_type is not None:\n                if not isinstance(first, expect_type):\n                    raise WrongType(\n                        f\"Query value is wrong type; expected {expect_type}, got {type(first)}\"\n                    )\n            return first\n        else:\n>           raise NoMatches(f\"No nodes match {self!r} on {self.node!r}\")\nE           textual.css.query.NoMatches: No nodes match <DOMQuery query='HeaderTitle'> on MyApp(title='MyApp', classes={'-dark-mode'})\n\nsrc/textual/css/query.py:247: NoMatches\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_screen_sub_title_reactive_updates_sub_title():\n        class MyScreen(Screen):\n            SUB_TITLE = \"screen sub-title\"\n    \n            def compose(self):\n                yield Header()\n    \n        class MyApp(App):\n            SUB_TITLE = \"app sub-title\"\n    \n            def on_mount(self):\n                self.push_screen(MyScreen())\n    \n        app = MyApp()\n>       async with app.run_test() as pilot:\n\ntests/test_header.py:128: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/test_header.py:125: in on_mount\n    self.push_screen(MyScreen())\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'}), screen = MyScreen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/test_header.py:125 in on_mount             \u2502\n\u2502                                                                              \u2502\n\u2502   122 \u2502   \u2502   SUB_TITLE = \"app sub-title\"                                    \u2502\n\u2502   123 \u2502   \u2502                                                                  \u2502\n\u2502   124 \u2502   \u2502   def on_mount(self):                                            \u2502\n\u2502 \u2771 125 \u2502   \u2502   \u2502   self.push_screen(MyScreen())                               \u2502\n\u2502   126 \u2502                                                                      \u2502\n\u2502   127 \u2502   app = MyApp()                                                      \u2502\n\u2502   128 \u2502   async with app.run_test() as pilot:                                \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 MyScreen = <class                                                        \u2502 \u2502\n\u2502 \u2502            'tests.test_header.test_screen_sub_title_reactive_updates_su\u2026 \u2502 \u2502\n\u2502 \u2502     self = MyApp(title='MyApp', classes={'-dark-mode'})                  \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e          \u2502\n\u2502 \u2502         callback = None                                         \u2502          \u2502\n\u2502 \u2502           screen = MyScreen()                                   \u2502          \u2502\n\u2502 \u2502             self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502          \u2502\n\u2502 \u2502 wait_for_dismiss = False                                        \u2502          \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f          \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'MyApp' object has no attribute '_push_screen'\n_____________ test_screen_pushing_and_popping_does_not_reparse_css _____________\n\n    async def test_screen_pushing_and_popping_does_not_reparse_css():\n        \"\"\"Check that pushing and popping the same screen doesn't trigger CSS reparses.\"\"\"\n    \n        class MyApp(BaseApp):\n            def key_p(self):\n                self.push_screen(ScreenWithCSS())\n    \n            def key_o(self):\n                self.pop_screen()\n    \n        counter = 0\n    \n        def reparse_wrapper(reparse):\n            def _reparse(*args, **kwargs):\n                nonlocal counter\n                counter += 1\n                return reparse(*args, **kwargs)\n    \n            return _reparse\n    \n        app = MyApp()\n        app.stylesheet.reparse = reparse_wrapper(app.stylesheet.reparse)\n        async with app.run_test() as pilot:\n            await pilot.press(\"p\")\n            await pilot.press(\"o\")\n            await pilot.press(\"p\")\n            await pilot.press(\"o\")\n            await pilot.press(\"p\")\n            await pilot.press(\"o\")\n            await pilot.press(\"p\")\n            await pilot.press(\"o\")\n>           assert counter == 1\nE           assert 0 == 1\n\ntests/css/test_screen_css.py:103: AssertionError\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_screen_pushing_and_popping_does_not_reparse_css():\n        \"\"\"Check that pushing and popping the same screen doesn't trigger CSS reparses.\"\"\"\n    \n        class MyApp(BaseApp):\n            def key_p(self):\n                self.push_screen(ScreenWithCSS())\n    \n            def key_o(self):\n                self.pop_screen()\n    \n        counter = 0\n    \n        def reparse_wrapper(reparse):\n            def _reparse(*args, **kwargs):\n                nonlocal counter\n                counter += 1\n                return reparse(*args, **kwargs)\n    \n            return _reparse\n    \n        app = MyApp()\n        app.stylesheet.reparse = reparse_wrapper(app.stylesheet.reparse)\n>       async with app.run_test() as pilot:\n\ntests/css/test_screen_css.py:94: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/css/test_screen_css.py:50: in on_mount\n    self.push_screen(BaseScreen())\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'}), screen = BaseScreen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/css/test_screen_css.py:50 in on_mount      \u2502\n\u2502                                                                              \u2502\n\u2502    47 \u2502   \"\"\"                                                                \u2502\n\u2502    48 \u2502                                                                      \u2502\n\u2502    49 \u2502   def on_mount(self):                                                \u2502\n\u2502 \u2771  50 \u2502   \u2502   self.push_screen(BaseScreen())                                 \u2502\n\u2502    51                                                                        \u2502\n\u2502    52                                                                        \u2502\n\u2502    53 class SwitchBaseApp(BaseApp):                                          \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                      \u2502\n\u2502 \u2502 self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502                      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                      \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e          \u2502\n\u2502 \u2502         callback = None                                         \u2502          \u2502\n\u2502 \u2502           screen = BaseScreen()                                 \u2502          \u2502\n\u2502 \u2502             self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502          \u2502\n\u2502 \u2502 wait_for_dismiss = False                                        \u2502          \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f          \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'MyApp' object has no attribute '_push_screen'\n_____________ test_auto_focus_on_screen_if_app_auto_focus_is_none ______________\n\n    async def test_auto_focus_on_screen_if_app_auto_focus_is_none():\n        \"\"\"Setting app.AUTO_FOCUS = `None` means it is not taken into consideration.\"\"\"\n    \n        class MyScreen(Screen[None]):\n            def compose(self):\n                yield Button()\n                yield Input(id=\"one\")\n                yield Input(id=\"two\")\n    \n        class MyApp(App[None]):\n            AUTO_FOCUS = None\n    \n        app = MyApp()\n        async with app.run_test():\n            MyScreen.AUTO_FOCUS = \"*\"\n>           await app.push_screen(MyScreen())\n\ntests/test_screens.py:175: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'}), screen = MyScreen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n______________________________ test_compose_order ______________________________\n\n    async def test_compose_order() -> None:\n        from textual.containers import Horizontal\n        from textual.screen import Screen\n        from textual.widgets import Select\n    \n        class MyScreen(Screen):\n            def on_mount(self) -> None:\n                self.query_one(Select).value = 1\n    \n            def compose(self) -> ComposeResult:\n                yield Horizontal(\n                    Select(((str(n), n) for n in range(10)), id=\"select\"),\n                    id=\"screen-horizontal\",\n                )\n    \n        class SelectBugApp(App[None]):\n            async def on_mount(self):\n                await self.push_screen(MyScreen(id=\"my-screen\"))\n                self.query_one(Select)\n    \n        app = SelectBugApp()\n        messages: list[Message] = []\n    \n>       async with app.run_test(message_hook=messages.append) as pilot:\n\ntests/test_widget.py:293: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:206: in __aexit__\n    await anext(self.gen)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:47: in _invoke\n    result = await result\ntests/test_widget.py:287: in on_mount\n    await self.push_screen(MyScreen(id=\"my-screen\"))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = SelectBugApp(title='SelectBugApp', classes={'-dark-mode'})\nscreen = MyScreen(id='my-screen'), callback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'SelectBugApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/test_widget.py:287 in on_mount             \u2502\n\u2502                                                                              \u2502\n\u2502   284 \u2502                                                                      \u2502\n\u2502   285 \u2502   class SelectBugApp(App[None]):                                     \u2502\n\u2502   286 \u2502   \u2502   async def on_mount(self):                                      \u2502\n\u2502 \u2771 287 \u2502   \u2502   \u2502   await self.push_screen(MyScreen(id=\"my-screen\"))           \u2502\n\u2502   288 \u2502   \u2502   \u2502   self.query_one(Select)                                     \u2502\n\u2502   289 \u2502                                                                      \u2502\n\u2502   290 \u2502   app = SelectBugApp()                                               \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 MyScreen = <class                                                        \u2502 \u2502\n\u2502 \u2502            'tests.test_widget.test_compose_order.<locals>.MyScreen'>     \u2502 \u2502\n\u2502 \u2502   Select = <class 'textual.widgets._select.Select'>                      \u2502 \u2502\n\u2502 \u2502     self = SelectBugApp(title='SelectBugApp', classes={'-dark-mode'})    \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                            \u2502\n\u2502 \u2502         callback = None                       \u2502                            \u2502\n\u2502 \u2502           screen = MyScreen(id='my-screen')   \u2502                            \u2502\n\u2502 \u2502             self = SelectBugApp(              \u2502                            \u2502\n\u2502 \u2502                    \u2502   title='SelectBugApp',  \u2502                            \u2502\n\u2502 \u2502                    \u2502   classes={              \u2502                            \u2502\n\u2502 \u2502                    \u2502   \u2502   '-dark-mode'       \u2502                            \u2502\n\u2502 \u2502                    \u2502   }                      \u2502                            \u2502\n\u2502 \u2502                    )                          \u2502                            \u2502\n\u2502 \u2502 wait_for_dismiss = False                      \u2502                            \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                            \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'SelectBugApp' object has no attribute '_push_screen'\n________________ test_screen_sub_title_overrides_app_sub_title _________________\n\n    async def test_screen_sub_title_overrides_app_sub_title():\n        class MyScreen(Screen):\n            SUB_TITLE = \"screen sub-title\"\n    \n            def compose(self):\n                yield Header()\n    \n        class MyApp(App):\n            SUB_TITLE = \"app sub-title\"\n    \n            def on_mount(self):\n                self.push_screen(MyScreen())\n    \n        app = MyApp()\n        async with app.run_test():\n>           assert app.query_one(\"HeaderTitle\").sub_text == \"screen sub-title\"\n\ntests/test_header.py:111: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/dom.py:1347: in query_one\n    return query.only_one() if expect_type is None else query.only_one(expect_type)\nsrc/textual/css/query.py:278: in only_one\n    self.first(expect_type) if expect_type is not None else self.first()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <DOMQuery query='HeaderTitle'>, expect_type = None\n\n    def first(\n        self, expect_type: type[ExpectType] | None = None\n    ) -> QueryType | ExpectType:\n        \"\"\"Get the *first* matching node.\n    \n        Args:\n            expect_type: Require matched node is of this type,\n                or None for any type.\n    \n        Raises:\n            WrongType: If the wrong type was found.\n            NoMatches: If there are no matching nodes in the query.\n    \n        Returns:\n            The matching Widget.\n        \"\"\"\n        _rich_traceback_omit = True\n        if self.nodes:\n            first = self.nodes[0]\n            if expect_type is not None:\n                if not isinstance(first, expect_type):\n                    raise WrongType(\n                        f\"Query value is wrong type; expected {expect_type}, got {type(first)}\"\n                    )\n            return first\n        else:\n>           raise NoMatches(f\"No nodes match {self!r} on {self.node!r}\")\nE           textual.css.query.NoMatches: No nodes match <DOMQuery query='HeaderTitle'> on MyApp(title='MyApp', classes={'-dark-mode'})\n\nsrc/textual/css/query.py:247: NoMatches\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_screen_sub_title_overrides_app_sub_title():\n        class MyScreen(Screen):\n            SUB_TITLE = \"screen sub-title\"\n    \n            def compose(self):\n                yield Header()\n    \n        class MyApp(App):\n            SUB_TITLE = \"app sub-title\"\n    \n            def on_mount(self):\n                self.push_screen(MyScreen())\n    \n        app = MyApp()\n>       async with app.run_test():\n\ntests/test_header.py:110: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/test_header.py:107: in on_mount\n    self.push_screen(MyScreen())\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'}), screen = MyScreen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/test_header.py:107 in on_mount             \u2502\n\u2502                                                                              \u2502\n\u2502   104 \u2502   \u2502   SUB_TITLE = \"app sub-title\"                                    \u2502\n\u2502   105 \u2502   \u2502                                                                  \u2502\n\u2502   106 \u2502   \u2502   def on_mount(self):                                            \u2502\n\u2502 \u2771 107 \u2502   \u2502   \u2502   self.push_screen(MyScreen())                               \u2502\n\u2502   108 \u2502                                                                      \u2502\n\u2502   109 \u2502   app = MyApp()                                                      \u2502\n\u2502   110 \u2502   async with app.run_test():                                         \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 MyScreen = <class                                                        \u2502 \u2502\n\u2502 \u2502            'tests.test_header.test_screen_sub_title_overrides_app_sub_t\u2026 \u2502 \u2502\n\u2502 \u2502     self = MyApp(title='MyApp', classes={'-dark-mode'})                  \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e          \u2502\n\u2502 \u2502         callback = None                                         \u2502          \u2502\n\u2502 \u2502           screen = MyScreen()                                   \u2502          \u2502\n\u2502 \u2502             self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502          \u2502\n\u2502 \u2502 wait_for_dismiss = False                                        \u2502          \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f          \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'MyApp' object has no attribute '_push_screen'\n_________________ test_screen_css_push_screen_instance_by_name _________________\n\n    async def test_screen_css_push_screen_instance_by_name():\n        \"\"\"Check that screen CSS is loaded and applied when pushing a screen name that points to a screen instance.\"\"\"\n    \n        class MyApp(BaseApp):\n            SCREENS = {\"screenwithcss\": ScreenWithCSS()}\n    \n            def key_p(self):\n                self.push_screen(\"screenwithcss\")\n    \n            def key_o(self):\n                self.pop_screen()\n    \n        app = MyApp()\n        async with app.run_test() as pilot:\n>           check_colors_before_screen_css(app)\n\ntests/css/test_screen_css.py:139: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/css/test_screen_css.py:61: in check_colors_before_screen_css\n    assert app.query_one(\"#app-css\").styles.background == GREEN\nsrc/textual/dom.py:1347: in query_one\n    return query.only_one() if expect_type is None else query.only_one(expect_type)\nsrc/textual/css/query.py:278: in only_one\n    self.first(expect_type) if expect_type is not None else self.first()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <DOMQuery query='#app-css'>, expect_type = None\n\n    def first(\n        self, expect_type: type[ExpectType] | None = None\n    ) -> QueryType | ExpectType:\n        \"\"\"Get the *first* matching node.\n    \n        Args:\n            expect_type: Require matched node is of this type,\n                or None for any type.\n    \n        Raises:\n            WrongType: If the wrong type was found.\n            NoMatches: If there are no matching nodes in the query.\n    \n        Returns:\n            The matching Widget.\n        \"\"\"\n        _rich_traceback_omit = True\n        if self.nodes:\n            first = self.nodes[0]\n            if expect_type is not None:\n                if not isinstance(first, expect_type):\n                    raise WrongType(\n                        f\"Query value is wrong type; expected {expect_type}, got {type(first)}\"\n                    )\n            return first\n        else:\n>           raise NoMatches(f\"No nodes match {self!r} on {self.node!r}\")\nE           textual.css.query.NoMatches: No nodes match <DOMQuery query='#app-css'> on MyApp(title='MyApp', classes={'-dark-mode'})\n\nsrc/textual/css/query.py:247: NoMatches\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_screen_css_push_screen_instance_by_name():\n        \"\"\"Check that screen CSS is loaded and applied when pushing a screen name that points to a screen instance.\"\"\"\n    \n        class MyApp(BaseApp):\n            SCREENS = {\"screenwithcss\": ScreenWithCSS()}\n    \n            def key_p(self):\n                self.push_screen(\"screenwithcss\")\n    \n            def key_o(self):\n                self.pop_screen()\n    \n        app = MyApp()\n>       async with app.run_test() as pilot:\n\ntests/css/test_screen_css.py:138: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/css/test_screen_css.py:50: in on_mount\n    self.push_screen(BaseScreen())\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'}), screen = BaseScreen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/css/test_screen_css.py:50 in on_mount      \u2502\n\u2502                                                                              \u2502\n\u2502    47 \u2502   \"\"\"                                                                \u2502\n\u2502    48 \u2502                                                                      \u2502\n\u2502    49 \u2502   def on_mount(self):                                                \u2502\n\u2502 \u2771  50 \u2502   \u2502   self.push_screen(BaseScreen())                                 \u2502\n\u2502    51                                                                        \u2502\n\u2502    52                                                                        \u2502\n\u2502    53 class SwitchBaseApp(BaseApp):                                          \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                      \u2502\n\u2502 \u2502 self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502                      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                      \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e          \u2502\n\u2502 \u2502         callback = None                                         \u2502          \u2502\n\u2502 \u2502           screen = BaseScreen()                                 \u2502          \u2502\n\u2502 \u2502             self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502          \u2502\n\u2502 \u2502 wait_for_dismiss = False                                        \u2502          \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f          \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'MyApp' object has no attribute '_push_screen'\n______________ test_switch_screen_updates_results_callback_stack _______________\n\n    async def test_switch_screen_updates_results_callback_stack():\n        \"\"\"Regression test for https://github.com/Textualize/textual/issues/2650\"\"\"\n    \n        class ScreenA(Screen):\n            pass\n    \n        class ScreenB(Screen):\n            pass\n    \n        class MyApp(App[None]):\n            SCREENS = {\n                \"a\": ScreenA(),\n                \"b\": ScreenB(),\n            }\n    \n            def callback(self, _):\n                return 42\n    \n            def on_mount(self):\n                self.push_screen(\"a\", self.callback)\n    \n        app = MyApp()\n        async with app.run_test():\n>           assert len(app.screen._result_callbacks) == 1\nE           AssertionError: assert 0 == 1\nE            +  where 0 = len([])\nE            +    where [] = Screen(id='_default')._result_callbacks\nE            +      where Screen(id='_default') = MyApp(title='MyApp', classes={'-dark-mode'}).screen\n\ntests/test_screens.py:371: AssertionError\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_switch_screen_updates_results_callback_stack():\n        \"\"\"Regression test for https://github.com/Textualize/textual/issues/2650\"\"\"\n    \n        class ScreenA(Screen):\n            pass\n    \n        class ScreenB(Screen):\n            pass\n    \n        class MyApp(App[None]):\n            SCREENS = {\n                \"a\": ScreenA(),\n                \"b\": ScreenB(),\n            }\n    \n            def callback(self, _):\n                return 42\n    \n            def on_mount(self):\n                self.push_screen(\"a\", self.callback)\n    \n        app = MyApp()\n>       async with app.run_test():\n\ntests/test_screens.py:370: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/test_screens.py:367: in on_mount\n    self.push_screen(\"a\", self.callback)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'}), screen = 'a'\ncallback = <bound method test_switch_screen_updates_results_callback_stack.<locals>.MyApp.callback of MyApp(title='MyApp', classes={'-dark-mode'})>\nwait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/test_screens.py:367 in on_mount            \u2502\n\u2502                                                                              \u2502\n\u2502   364 \u2502   \u2502   \u2502   return 42                                                  \u2502\n\u2502   365 \u2502   \u2502                                                                  \u2502\n\u2502   366 \u2502   \u2502   def on_mount(self):                                            \u2502\n\u2502 \u2771 367 \u2502   \u2502   \u2502   self.push_screen(\"a\", self.callback)                       \u2502\n\u2502   368 \u2502                                                                      \u2502\n\u2502   369 \u2502   app = MyApp()                                                      \u2502\n\u2502   370 \u2502   async with app.run_test():                                         \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                      \u2502\n\u2502 \u2502 self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502                      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                      \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502         callback = <bound method                                         \u2502 \u2502\n\u2502 \u2502                    test_switch_screen_updates_results_callback_stack.<l\u2026 \u2502 \u2502\n\u2502 \u2502                    of MyApp(title='MyApp', classes={'-dark-mode'})>      \u2502 \u2502\n\u2502 \u2502           screen = 'a'                                                   \u2502 \u2502\n\u2502 \u2502             self = MyApp(title='MyApp', classes={'-dark-mode'})          \u2502 \u2502\n\u2502 \u2502 wait_for_dismiss = False                                                 \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'MyApp' object has no attribute '_push_screen'\n______________________ test_push_screen_wait_for_dismiss _______________________\n\n    async def test_push_screen_wait_for_dismiss() -> None:\n        \"\"\"Test push_screen returns result.\"\"\"\n    \n        class QuitScreen(Screen[bool]):\n            BINDINGS = [\n                (\"y\", \"quit(True)\"),\n                (\"n\", \"quit(False)\"),\n            ]\n    \n            def action_quit(self, quit: bool) -> None:\n                self.dismiss(quit)\n    \n        results: list[bool] = []\n    \n        class ScreensApp(App):\n            BINDINGS = [(\"x\", \"exit\")]\n    \n            @work\n            async def action_exit(self) -> None:\n                result = await self.push_screen(QuitScreen(), wait_for_dismiss=True)\n                results.append(result)\n    \n        app = ScreensApp()\n        # Press X to exit, then Y to dismiss, expect True result\n>       async with app.run_test() as pilot:\n\ntests/test_screens.py:462: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:206: in __aexit__\n    await anext(self.gen)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = ScreensApp(title='ScreensApp', classes={'-dark-mode'})\n\n    @asynccontextmanager\n    async def run_test(\n        self,\n        *,\n        headless: bool = True,\n        size: tuple[int, int] | None = (80, 24),\n        tooltips: bool = False,\n        notifications: bool = False,\n        message_hook: Callable[[Message], None] | None = None,\n    ) -> AsyncGenerator[Pilot[ReturnType], None]:\n        \"\"\"An asynchronous context manager for testing apps.\n    \n        !!! tip\n    \n            See the guide for [testing](/guide/testing) Textual apps.\n    \n        Use this to run your app in \"headless\" mode (no output) and drive the app via a [Pilot][textual.pilot.Pilot] object.\n    \n        Example:\n    \n            ```python\n            async with app.run_test() as pilot:\n                await pilot.click(\"#Button.ok\")\n                assert ...\n            ```\n    \n        Args:\n            headless: Run in headless mode (no output or input).\n            size: Force terminal size to `(WIDTH, HEIGHT)`,\n                or None to auto-detect.\n            tooltips: Enable tooltips when testing.\n            notifications: Enable notifications when testing.\n            message_hook: An optional callback that will be called each time any message arrives at any\n                message pump in the app.\n        \"\"\"\n        from .pilot import Pilot\n    \n        app = self\n        app._disable_tooltips = not tooltips\n        app._disable_notifications = not notifications\n        app_ready_event = asyncio.Event()\n    \n        def on_app_ready() -> None:\n            \"\"\"Called when app is ready to process events.\"\"\"\n            app_ready_event.set()\n    \n        async def run_app(app: App) -> None:\n            if message_hook is not None:\n                message_hook_context_var.set(message_hook)\n            app._loop = asyncio.get_running_loop()\n            app._thread_id = threading.get_ident()\n            await app._process_messages(\n                ready_callback=on_app_ready,\n                headless=headless,\n                terminal_size=size,\n            )\n    \n        # Launch the app in the \"background\"\n        active_message_pump.set(app)\n        app_task = create_task(run_app(app), name=f\"run_test {app}\")\n    \n        # Wait until the app has performed all startup routines.\n        await app_ready_event.wait()\n    \n        # Get the app in an active state.\n        app._set_active()\n    \n        # Context manager returns pilot object to manipulate the app\n        try:\n            pilot = Pilot(app)\n            await pilot._wait_for_screen()\n            yield pilot\n        finally:\n            # Shutdown the app cleanly\n            await app._shutdown()\n            await app_task\n            # Re-raise the exception which caused panic so test frameworks are aware\n            if self._exception:\n>               raise self._exception\nE               textual.worker.WorkerFailed: Worker raised exception: AttributeError(\"'ScreensApp' object has no attribute '_push_screen'\")\n\nsrc/textual/app.py:1492: WorkerFailed\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/src/textual/worker.py:365 in _run                \u2502\n\u2502                                                                              \u2502\n\u2502   362 \u2502   \u2502   self.state = WorkerState.RUNNING                               \u2502\n\u2502   363 \u2502   \u2502   app.log.worker(self)                                           \u2502\n\u2502   364 \u2502   \u2502   try:                                                           \u2502\n\u2502 \u2771 365 \u2502   \u2502   \u2502   self._result = await self.run()                            \u2502\n\u2502   366 \u2502   \u2502   except asyncio.CancelledError as error:                        \u2502\n\u2502   367 \u2502   \u2502   \u2502   self.state = WorkerState.CANCELLED                         \u2502\n\u2502   368 \u2502   \u2502   \u2502   self._error = error                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502           app = ScreensApp(title='ScreensApp', classes={'-dark-mode'})   \u2502 \u2502\n\u2502 \u2502         error = AttributeError(\"'ScreensApp' object has no attribute     \u2502 \u2502\n\u2502 \u2502                 '_push_screen'\")                                         \u2502 \u2502\n\u2502 \u2502          self = <Worker                                                  \u2502 \u2502\n\u2502 \u2502                 \u2502   ERROR                                                \u2502 \u2502\n\u2502 \u2502                 \u2502   name='action_exit'                                   \u2502 \u2502\n\u2502 \u2502                 \u2502   description='action_exit()'                          \u2502 \u2502\n\u2502 \u2502                 >                                                        \u2502 \u2502\n\u2502 \u2502     Traceback = <class 'rich.traceback.Traceback'>                       \u2502 \u2502\n\u2502 \u2502 worker_failed = WorkerFailed('Worker raised exception:                   \u2502 \u2502\n\u2502 \u2502                 AttributeError(\"\\'ScreensApp\\' object has no attribute   \u2502 \u2502\n\u2502 \u2502                 \\'_push_screen\\'\")')                                     \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/worker.py:349 in run                 \u2502\n\u2502                                                                              \u2502\n\u2502   346 \u2502   \u2502   Returns:                                                       \u2502\n\u2502   347 \u2502   \u2502   \u2502   Return value of the work.                                  \u2502\n\u2502   348 \u2502   \u2502   \"\"\"                                                            \u2502\n\u2502 \u2771 349 \u2502   \u2502   return await (                                                 \u2502\n\u2502   350 \u2502   \u2502   \u2502   self._run_threaded() if self._thread_worker else self._run \u2502\n\u2502   351 \u2502   \u2502   )                                                              \u2502\n\u2502   352                                                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e     \u2502\n\u2502 \u2502 self = <Worker ERROR name='action_exit' description='action_exit()'> \u2502     \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f     \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/worker.py:334 in _run_async          \u2502\n\u2502                                                                              \u2502\n\u2502   331 \u2502   \u2502   \u2502   or hasattr(self._work, \"func\")                             \u2502\n\u2502   332 \u2502   \u2502   \u2502   and inspect.iscoroutinefunction(self._work.func)           \u2502\n\u2502   333 \u2502   \u2502   ):                                                             \u2502\n\u2502 \u2771 334 \u2502   \u2502   \u2502   return await self._work()                                  \u2502\n\u2502   335 \u2502   \u2502   elif inspect.isawaitable(self._work):                          \u2502\n\u2502   336 \u2502   \u2502   \u2502   return await self._work                                    \u2502\n\u2502   337 \u2502   \u2502   elif callable(self._work):                                     \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e     \u2502\n\u2502 \u2502 self = <Worker ERROR name='action_exit' description='action_exit()'> \u2502     \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f     \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/tests/test_screens.py:457 in action_exit         \u2502\n\u2502                                                                              \u2502\n\u2502   454 \u2502   \u2502                                                                  \u2502\n\u2502   455 \u2502   \u2502   @work                                                          \u2502\n\u2502   456 \u2502   \u2502   async def action_exit(self) -> None:                           \u2502\n\u2502 \u2771 457 \u2502   \u2502   \u2502   result = await self.push_screen(QuitScreen(), wait_for_dis \u2502\n\u2502   458 \u2502   \u2502   \u2502   results.append(result)                                     \u2502\n\u2502   459 \u2502                                                                      \u2502\n\u2502   460 \u2502   app = ScreensApp()                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 QuitScreen = <class                                                      \u2502 \u2502\n\u2502 \u2502              'tests.test_screens.test_push_screen_wait_for_dismiss.<loc\u2026 \u2502 \u2502\n\u2502 \u2502    results = []                                                          \u2502 \u2502\n\u2502 \u2502       self = ScreensApp(title='ScreensApp', classes={'-dark-mode'})      \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2107 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2104 \u2502   \u2502   \u2502   \u2502   \u2502   \"App.push_screen with wait_for_dismiss=True may o \u2502\n\u2502   2105 \u2502   \u2502   \u2502   \u2502   )                                                     \u2502\n\u2502   2106 \u2502   \u2502   \u2502   future: asyncio.Future[ScreenResultType] = asyncio.Future \u2502\n\u2502 \u2771 2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502   2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502           callback = None                                                \u2502 \u2502\n\u2502 \u2502             future = <Future pending>                                    \u2502 \u2502\n\u2502 \u2502 get_current_worker = <function get_current_worker at 0x7f6451e48310>     \u2502 \u2502\n\u2502 \u2502             screen = QuitScreen()                                        \u2502 \u2502\n\u2502 \u2502               self = ScreensApp(                                         \u2502 \u2502\n\u2502 \u2502                      \u2502   title='ScreensApp',                             \u2502 \u2502\n\u2502 \u2502                      \u2502   classes={'-dark-mode'}                          \u2502 \u2502\n\u2502 \u2502                      )                                                   \u2502 \u2502\n\u2502 \u2502   wait_for_dismiss = True                                                \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'ScreensApp' object has no attribute '_push_screen'\n___________________ test_screen_title_reactive_updates_title ___________________\n\n    async def test_screen_title_reactive_updates_title():\n        class MyScreen(Screen):\n            TITLE = \"screen title\"\n    \n            def compose(self):\n                yield Header()\n    \n        class MyApp(App):\n            TITLE = \"app title\"\n    \n            def on_mount(self):\n                self.push_screen(MyScreen())\n    \n        app = MyApp()\n        async with app.run_test() as pilot:\n            app.screen.title = \"new screen title\"\n            await pilot.pause()\n>           assert app.query_one(\"HeaderTitle\").text == \"new screen title\"\n\ntests/test_header.py:57: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/dom.py:1347: in query_one\n    return query.only_one() if expect_type is None else query.only_one(expect_type)\nsrc/textual/css/query.py:278: in only_one\n    self.first(expect_type) if expect_type is not None else self.first()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <DOMQuery query='HeaderTitle'>, expect_type = None\n\n    def first(\n        self, expect_type: type[ExpectType] | None = None\n    ) -> QueryType | ExpectType:\n        \"\"\"Get the *first* matching node.\n    \n        Args:\n            expect_type: Require matched node is of this type,\n                or None for any type.\n    \n        Raises:\n            WrongType: If the wrong type was found.\n            NoMatches: If there are no matching nodes in the query.\n    \n        Returns:\n            The matching Widget.\n        \"\"\"\n        _rich_traceback_omit = True\n        if self.nodes:\n            first = self.nodes[0]\n            if expect_type is not None:\n                if not isinstance(first, expect_type):\n                    raise WrongType(\n                        f\"Query value is wrong type; expected {expect_type}, got {type(first)}\"\n                    )\n            return first\n        else:\n>           raise NoMatches(f\"No nodes match {self!r} on {self.node!r}\")\nE           textual.css.query.NoMatches: No nodes match <DOMQuery query='HeaderTitle'> on MyApp(title='app title', classes={'-dark-mode'})\n\nsrc/textual/css/query.py:247: NoMatches\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_screen_title_reactive_updates_title():\n        class MyScreen(Screen):\n            TITLE = \"screen title\"\n    \n            def compose(self):\n                yield Header()\n    \n        class MyApp(App):\n            TITLE = \"app title\"\n    \n            def on_mount(self):\n                self.push_screen(MyScreen())\n    \n        app = MyApp()\n>       async with app.run_test() as pilot:\n\ntests/test_header.py:54: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/test_header.py:51: in on_mount\n    self.push_screen(MyScreen())\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='app title', classes={'-dark-mode'}), screen = MyScreen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/test_header.py:51 in on_mount              \u2502\n\u2502                                                                              \u2502\n\u2502    48 \u2502   \u2502   TITLE = \"app title\"                                            \u2502\n\u2502    49 \u2502   \u2502                                                                  \u2502\n\u2502    50 \u2502   \u2502   def on_mount(self):                                            \u2502\n\u2502 \u2771  51 \u2502   \u2502   \u2502   self.push_screen(MyScreen())                               \u2502\n\u2502    52 \u2502                                                                      \u2502\n\u2502    53 \u2502   app = MyApp()                                                      \u2502\n\u2502    54 \u2502   async with app.run_test() as pilot:                                \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 MyScreen = <class                                                        \u2502 \u2502\n\u2502 \u2502            'tests.test_header.test_screen_title_reactive_updates_title.\u2026 \u2502 \u2502\n\u2502 \u2502     self = MyApp(title='app title', classes={'-dark-mode'})              \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e      \u2502\n\u2502 \u2502         callback = None                                             \u2502      \u2502\n\u2502 \u2502           screen = MyScreen()                                       \u2502      \u2502\n\u2502 \u2502             self = MyApp(title='app title', classes={'-dark-mode'}) \u2502      \u2502\n\u2502 \u2502 wait_for_dismiss = False                                            \u2502      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f      \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'MyApp' object has no attribute '_push_screen'\n_________________________ test_auto_focus_inheritance __________________________\n\n    async def test_auto_focus_inheritance():\n        \"\"\"Setting app.AUTO_FOCUS = `None` means it is not taken into consideration.\"\"\"\n    \n        class MyScreen(Screen[None]):\n            def compose(self):\n                yield Button()\n                yield Input(id=\"one\")\n                yield Input(id=\"two\")\n    \n        class MyApp(App[None]):\n            pass\n    \n        app = MyApp()\n        async with app.run_test():\n            MyApp.AUTO_FOCUS = \"Input\"\n            MyScreen.AUTO_FOCUS = \"*\"\n>           await app.push_screen(MyScreen())\n\ntests/test_screens.py:262: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'}), screen = MyScreen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n____________________ test_screen_receives_mouse_move_events ____________________\n\n    async def test_screen_receives_mouse_move_events():\n        class MouseMoveRecordingScreen(Screen):\n            mouse_events = []\n    \n            def on_mouse_move(self, event: MouseMove) -> None:\n                MouseMoveRecordingScreen.mouse_events.append(event)\n    \n        class SimpleApp(App[None]):\n            SCREENS = {\"a\": MouseMoveRecordingScreen()}\n    \n            def on_mount(self):\n                self.push_screen(\"a\")\n    \n        mouse_offset = Offset(1, 1)\n    \n>       async with SimpleApp().run_test() as pilot:\n\ntests/test_screens.py:394: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:206: in __aexit__\n    await anext(self.gen)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/test_screens.py:390: in on_mount\n    self.push_screen(\"a\")\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = SimpleApp(title='SimpleApp', classes={'-dark-mode'}), screen = 'a'\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'SimpleApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/test_screens.py:390 in on_mount            \u2502\n\u2502                                                                              \u2502\n\u2502   387 \u2502   \u2502   SCREENS = {\"a\": MouseMoveRecordingScreen()}                    \u2502\n\u2502   388 \u2502   \u2502                                                                  \u2502\n\u2502   389 \u2502   \u2502   def on_mount(self):                                            \u2502\n\u2502 \u2771 390 \u2502   \u2502   \u2502   self.push_screen(\"a\")                                      \u2502\n\u2502   391 \u2502                                                                      \u2502\n\u2502   392 \u2502   mouse_offset = Offset(1, 1)                                        \u2502\n\u2502   393                                                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e              \u2502\n\u2502 \u2502 self = SimpleApp(title='SimpleApp', classes={'-dark-mode'}) \u2502              \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f              \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e  \u2502\n\u2502 \u2502         callback = None                                                 \u2502  \u2502\n\u2502 \u2502           screen = 'a'                                                  \u2502  \u2502\n\u2502 \u2502             self = SimpleApp(title='SimpleApp', classes={'-dark-mode'}) \u2502  \u2502\n\u2502 \u2502 wait_for_dismiss = False                                                \u2502  \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f  \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'SimpleApp' object has no attribute '_push_screen'\n_______________________________ test_focus_chain _______________________________\n\n    def test_focus_chain():\n        app = App()\n        app._set_active()\n>       app.push_screen(Screen())\n\ntests/test_focus.py:47: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = App(title='App', classes={'-dark-mode'}), screen = Screen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'App' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n_________________________________ test_screens _________________________________\n\n    async def test_screens():\n        app = App()\n        app._loop = asyncio.get_running_loop()\n        app._thread_id = threading.get_ident()\n        # There should be nothing in the children since the app hasn't run yet\n        assert not app._nodes\n        assert not app.children\n        app._set_active()\n    \n        with pytest.raises(ScreenStackError):\n            app.screen\n    \n        assert not app._installed_screens\n    \n        screen1 = Screen(name=\"screen1\")\n        screen2 = Screen(name=\"screen2\")\n        screen3 = Screen(name=\"screen3\")\n    \n        # installs screens\n        app.install_screen(screen1, \"screen1\")\n        app.install_screen(screen2, \"screen2\")\n    \n        # Installing a screen does not add it to the DOM\n        assert not app._nodes\n        assert not app.children\n    \n        # Check they are installed\n        assert app.is_screen_installed(\"screen1\")\n        assert app.is_screen_installed(\"screen2\")\n    \n        assert app.get_screen(\"screen1\") is screen1\n        with pytest.raises(KeyError):\n            app.get_screen(\"foo\")\n    \n        # Check screen3 is not installed\n        assert not app.is_screen_installed(\"screen3\")\n    \n        # Installs screen3\n        app.install_screen(screen3, \"screen3\")\n        # Confirm installed\n        assert app.is_screen_installed(\"screen3\")\n    \n        # Check screen stack is empty\n        assert app.screen_stack == []\n        # Push a screen\n>       await app.push_screen(\"screen1\")\n\ntests/test_screens.py:113: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = App(title='App', classes={'-dark-mode'}), screen = 'screen1'\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'App' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n_________________________ test_dismiss_non_top_screen __________________________\n\n    async def test_dismiss_non_top_screen():\n        class MyApp(App[None]):\n            async def key_p(self) -> None:\n                self.bottom = Screen()\n                top = Screen()\n                await self.push_screen(self.bottom)\n                await self.push_screen(top)\n    \n        app = MyApp()\n>       async with app.run_test() as pilot:\n\ntests/test_screens.py:302: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:206: in __aexit__\n    await anext(self.gen)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/message_pump.py:589: in _process_messages_loop\n    await self._dispatch_message(message)\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:47: in _invoke\n    result = await result\nsrc/textual/app.py:3254: in _on_key\n    await self.dispatch_key(event)\nsrc/textual/message_pump.py:850: in dispatch_key\n    handled = (await invoke(key_method, event)) is not False\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:47: in _invoke\n    result = await result\ntests/test_screens.py:298: in key_p\n    await self.push_screen(self.bottom)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'}), screen = Screen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/test_screens.py:298 in key_p               \u2502\n\u2502                                                                              \u2502\n\u2502   295 \u2502   \u2502   async def key_p(self) -> None:                                 \u2502\n\u2502   296 \u2502   \u2502   \u2502   self.bottom = Screen()                                     \u2502\n\u2502   297 \u2502   \u2502   \u2502   top = Screen()                                             \u2502\n\u2502 \u2771 298 \u2502   \u2502   \u2502   await self.push_screen(self.bottom)                        \u2502\n\u2502   299 \u2502   \u2502   \u2502   await self.push_screen(top)                                \u2502\n\u2502   300 \u2502                                                                      \u2502\n\u2502   301 \u2502   app = MyApp()                                                      \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                      \u2502\n\u2502 \u2502 self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502                      \u2502\n\u2502 \u2502  top = Screen()                                     \u2502                      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                      \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e          \u2502\n\u2502 \u2502         callback = None                                         \u2502          \u2502\n\u2502 \u2502           screen = Screen()                                     \u2502          \u2502\n\u2502 \u2502             self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502          \u2502\n\u2502 \u2502 wait_for_dismiss = False                                        \u2502          \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f          \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'MyApp' object has no attribute '_push_screen'\n_________________________________ test_unmount _________________________________\n\n    async def test_unmount():\n        \"\"\"Test unmount events are received in reverse DOM order.\"\"\"\n        unmount_ids: list[str] = []\n    \n        class UnmountWidget(Container):\n            def on_unmount(self, event: events.Unmount):\n                unmount_ids.append(\n                    f\"{self.__class__.__name__}#{self.id}-{self.parent is not None}-{len(self._nodes)}\"\n                )\n    \n        class MyScreen(Screen):\n            def compose(self) -> ComposeResult:\n                yield UnmountWidget(\n                    UnmountWidget(\n                        UnmountWidget(id=\"bar1\"), UnmountWidget(id=\"bar2\"), id=\"bar\"\n                    ),\n                    UnmountWidget(\n                        UnmountWidget(id=\"baz1\"), UnmountWidget(id=\"baz2\"), id=\"baz\"\n                    ),\n                    id=\"top\",\n                )\n    \n            def on_unmount(self, event: events.Unmount):\n                unmount_ids.append(f\"{self.__class__.__name__}#{self.id}\")\n    \n        class UnmountApp(App):\n            async def on_mount(self) -> None:\n                await self.push_screen(MyScreen(id=\"main\"))\n    \n        app = UnmountApp()\n>       async with app.run_test() as pilot:\n\ntests/test_unmount.py:39: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:206: in __aexit__\n    await anext(self.gen)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:47: in _invoke\n    result = await result\ntests/test_unmount.py:36: in on_mount\n    await self.push_screen(MyScreen(id=\"main\"))\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = UnmountApp(title='UnmountApp', classes={'-dark-mode'})\nscreen = MyScreen(id='main'), callback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'UnmountApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/test_unmount.py:36 in on_mount             \u2502\n\u2502                                                                              \u2502\n\u2502   33 \u2502                                                                       \u2502\n\u2502   34 \u2502   class UnmountApp(App):                                              \u2502\n\u2502   35 \u2502   \u2502   async def on_mount(self) -> None:                               \u2502\n\u2502 \u2771 36 \u2502   \u2502   \u2502   await self.push_screen(MyScreen(id=\"main\"))                 \u2502\n\u2502   37 \u2502                                                                       \u2502\n\u2502   38 \u2502   app = UnmountApp()                                                  \u2502\n\u2502   39 \u2502   async with app.run_test() as pilot:                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e   \u2502\n\u2502 \u2502 MyScreen = <class 'tests.test_unmount.test_unmount.<locals>.MyScreen'> \u2502   \u2502\n\u2502 \u2502     self = UnmountApp(title='UnmountApp', classes={'-dark-mode'})      \u2502   \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f   \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502         callback = None                                                  \u2502 \u2502\n\u2502 \u2502           screen = MyScreen(id='main')                                   \u2502 \u2502\n\u2502 \u2502             self = UnmountApp(                                           \u2502 \u2502\n\u2502 \u2502                    \u2502   title='UnmountApp',                               \u2502 \u2502\n\u2502 \u2502                    \u2502   classes={                                         \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   '-dark-mode'                                  \u2502 \u2502\n\u2502 \u2502                    \u2502   }                                                 \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502 wait_for_dismiss = False                                                 \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'UnmountApp' object has no attribute '_push_screen'\n_ test_app_sub_title_reactive_does_not_update_sub_title_when_screen_sub_title_is_set _\n\n    async def test_app_sub_title_reactive_does_not_update_sub_title_when_screen_sub_title_is_set():\n        class MyScreen(Screen):\n            SUB_TITLE = \"screen sub-title\"\n    \n            def compose(self):\n                yield Header()\n    \n        class MyApp(App):\n            SUB_TITLE = \"app sub-title\"\n    \n            def on_mount(self):\n                self.push_screen(MyScreen())\n    \n        app = MyApp()\n        async with app.run_test() as pilot:\n            app.sub_title = \"new app sub-title\"\n            await pilot.pause()\n>           assert app.query_one(\"HeaderTitle\").sub_text == \"screen sub-title\"\n\ntests/test_header.py:151: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/dom.py:1347: in query_one\n    return query.only_one() if expect_type is None else query.only_one(expect_type)\nsrc/textual/css/query.py:278: in only_one\n    self.first(expect_type) if expect_type is not None else self.first()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <DOMQuery query='HeaderTitle'>, expect_type = None\n\n    def first(\n        self, expect_type: type[ExpectType] | None = None\n    ) -> QueryType | ExpectType:\n        \"\"\"Get the *first* matching node.\n    \n        Args:\n            expect_type: Require matched node is of this type,\n                or None for any type.\n    \n        Raises:\n            WrongType: If the wrong type was found.\n            NoMatches: If there are no matching nodes in the query.\n    \n        Returns:\n            The matching Widget.\n        \"\"\"\n        _rich_traceback_omit = True\n        if self.nodes:\n            first = self.nodes[0]\n            if expect_type is not None:\n                if not isinstance(first, expect_type):\n                    raise WrongType(\n                        f\"Query value is wrong type; expected {expect_type}, got {type(first)}\"\n                    )\n            return first\n        else:\n>           raise NoMatches(f\"No nodes match {self!r} on {self.node!r}\")\nE           textual.css.query.NoMatches: No nodes match <DOMQuery query='HeaderTitle'> on MyApp(title='MyApp', classes={'-dark-mode'})\n\nsrc/textual/css/query.py:247: NoMatches\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_app_sub_title_reactive_does_not_update_sub_title_when_screen_sub_title_is_set():\n        class MyScreen(Screen):\n            SUB_TITLE = \"screen sub-title\"\n    \n            def compose(self):\n                yield Header()\n    \n        class MyApp(App):\n            SUB_TITLE = \"app sub-title\"\n    \n            def on_mount(self):\n                self.push_screen(MyScreen())\n    \n        app = MyApp()\n>       async with app.run_test() as pilot:\n\ntests/test_header.py:148: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/test_header.py:145: in on_mount\n    self.push_screen(MyScreen())\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'}), screen = MyScreen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/test_header.py:145 in on_mount             \u2502\n\u2502                                                                              \u2502\n\u2502   142 \u2502   \u2502   SUB_TITLE = \"app sub-title\"                                    \u2502\n\u2502   143 \u2502   \u2502                                                                  \u2502\n\u2502   144 \u2502   \u2502   def on_mount(self):                                            \u2502\n\u2502 \u2771 145 \u2502   \u2502   \u2502   self.push_screen(MyScreen())                               \u2502\n\u2502   146 \u2502                                                                      \u2502\n\u2502   147 \u2502   app = MyApp()                                                      \u2502\n\u2502   148 \u2502   async with app.run_test() as pilot:                                \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 MyScreen = <class                                                        \u2502 \u2502\n\u2502 \u2502            'tests.test_header.test_app_sub_title_reactive_does_not_upda\u2026 \u2502 \u2502\n\u2502 \u2502     self = MyApp(title='MyApp', classes={'-dark-mode'})                  \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e          \u2502\n\u2502 \u2502         callback = None                                         \u2502          \u2502\n\u2502 \u2502           screen = MyScreen()                                   \u2502          \u2502\n\u2502 \u2502             self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502          \u2502\n\u2502 \u2502 wait_for_dismiss = False                                        \u2502          \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f          \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'MyApp' object has no attribute '_push_screen'\n_____________ test_mouse_move_event_bubbles_to_screen_from_widget ______________\n\n    async def test_mouse_move_event_bubbles_to_screen_from_widget():\n        class MouseMoveRecordingScreen(Screen):\n            mouse_events = []\n    \n            DEFAULT_CSS = \"\"\"\n            Label {\n                offset: 10 10;\n            }\n            \"\"\"\n    \n            def compose(self) -> ComposeResult:\n                yield Label(\"Any label\")\n    \n            def on_mouse_move(self, event: MouseMove) -> None:\n                MouseMoveRecordingScreen.mouse_events.append(event)\n    \n        class SimpleApp(App[None]):\n            SCREENS = {\"a\": MouseMoveRecordingScreen()}\n    \n            def on_mount(self):\n                self.push_screen(\"a\")\n    \n        label_offset = Offset(10, 10)\n        mouse_offset = Offset(1, 1)\n    \n        async with SimpleApp().run_test() as pilot:\n>           await pilot.hover(Label, mouse_offset)\n\ntests/test_screens.py:428: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/pilot.py:271: in hover\n    return await self._post_mouse_events(\nsrc/textual/pilot.py:317: in _post_mouse_events\n    target_widget = app.query_one(selector)\nsrc/textual/dom.py:1347: in query_one\n    return query.only_one() if expect_type is None else query.only_one(expect_type)\nsrc/textual/css/query.py:278: in only_one\n    self.first(expect_type) if expect_type is not None else self.first()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <DOMQuery query='Label'>, expect_type = None\n\n    def first(\n        self, expect_type: type[ExpectType] | None = None\n    ) -> QueryType | ExpectType:\n        \"\"\"Get the *first* matching node.\n    \n        Args:\n            expect_type: Require matched node is of this type,\n                or None for any type.\n    \n        Raises:\n            WrongType: If the wrong type was found.\n            NoMatches: If there are no matching nodes in the query.\n    \n        Returns:\n            The matching Widget.\n        \"\"\"\n        _rich_traceback_omit = True\n        if self.nodes:\n            first = self.nodes[0]\n            if expect_type is not None:\n                if not isinstance(first, expect_type):\n                    raise WrongType(\n                        f\"Query value is wrong type; expected {expect_type}, got {type(first)}\"\n                    )\n            return first\n        else:\n>           raise NoMatches(f\"No nodes match {self!r} on {self.node!r}\")\nE           textual.css.query.NoMatches: No nodes match <DOMQuery query='Label'> on SimpleApp(title='SimpleApp', classes={'-dark-mode'})\n\nsrc/textual/css/query.py:247: NoMatches\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_mouse_move_event_bubbles_to_screen_from_widget():\n        class MouseMoveRecordingScreen(Screen):\n            mouse_events = []\n    \n            DEFAULT_CSS = \"\"\"\n            Label {\n                offset: 10 10;\n            }\n            \"\"\"\n    \n            def compose(self) -> ComposeResult:\n                yield Label(\"Any label\")\n    \n            def on_mouse_move(self, event: MouseMove) -> None:\n                MouseMoveRecordingScreen.mouse_events.append(event)\n    \n        class SimpleApp(App[None]):\n            SCREENS = {\"a\": MouseMoveRecordingScreen()}\n    \n            def on_mount(self):\n                self.push_screen(\"a\")\n    \n        label_offset = Offset(10, 10)\n        mouse_offset = Offset(1, 1)\n    \n>       async with SimpleApp().run_test() as pilot:\n\ntests/test_screens.py:427: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/test_screens.py:422: in on_mount\n    self.push_screen(\"a\")\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = SimpleApp(title='SimpleApp', classes={'-dark-mode'}), screen = 'a'\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'SimpleApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/test_screens.py:422 in on_mount            \u2502\n\u2502                                                                              \u2502\n\u2502   419 \u2502   \u2502   SCREENS = {\"a\": MouseMoveRecordingScreen()}                    \u2502\n\u2502   420 \u2502   \u2502                                                                  \u2502\n\u2502   421 \u2502   \u2502   def on_mount(self):                                            \u2502\n\u2502 \u2771 422 \u2502   \u2502   \u2502   self.push_screen(\"a\")                                      \u2502\n\u2502   423 \u2502                                                                      \u2502\n\u2502   424 \u2502   label_offset = Offset(10, 10)                                      \u2502\n\u2502   425 \u2502   mouse_offset = Offset(1, 1)                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e              \u2502\n\u2502 \u2502 self = SimpleApp(title='SimpleApp', classes={'-dark-mode'}) \u2502              \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f              \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e  \u2502\n\u2502 \u2502         callback = None                                                 \u2502  \u2502\n\u2502 \u2502           screen = 'a'                                                  \u2502  \u2502\n\u2502 \u2502             self = SimpleApp(title='SimpleApp', classes={'-dark-mode'}) \u2502  \u2502\n\u2502 \u2502 wait_for_dismiss = False                                                \u2502  \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f  \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'SimpleApp' object has no attribute '_push_screen'\n____ test_app_title_reactive_does_not_update_title_when_screen_title_is_set ____\n\n    async def test_app_title_reactive_does_not_update_title_when_screen_title_is_set():\n        class MyScreen(Screen):\n            TITLE = \"screen title\"\n    \n            def compose(self):\n                yield Header()\n    \n        class MyApp(App):\n            TITLE = \"app title\"\n    \n            def on_mount(self):\n                self.push_screen(MyScreen())\n    \n        app = MyApp()\n        async with app.run_test() as pilot:\n            app.title = \"new app title\"\n            await pilot.pause()\n>           assert app.query_one(\"HeaderTitle\").text == \"screen title\"\n\ntests/test_header.py:77: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/dom.py:1347: in query_one\n    return query.only_one() if expect_type is None else query.only_one(expect_type)\nsrc/textual/css/query.py:278: in only_one\n    self.first(expect_type) if expect_type is not None else self.first()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <DOMQuery query='HeaderTitle'>, expect_type = None\n\n    def first(\n        self, expect_type: type[ExpectType] | None = None\n    ) -> QueryType | ExpectType:\n        \"\"\"Get the *first* matching node.\n    \n        Args:\n            expect_type: Require matched node is of this type,\n                or None for any type.\n    \n        Raises:\n            WrongType: If the wrong type was found.\n            NoMatches: If there are no matching nodes in the query.\n    \n        Returns:\n            The matching Widget.\n        \"\"\"\n        _rich_traceback_omit = True\n        if self.nodes:\n            first = self.nodes[0]\n            if expect_type is not None:\n                if not isinstance(first, expect_type):\n                    raise WrongType(\n                        f\"Query value is wrong type; expected {expect_type}, got {type(first)}\"\n                    )\n            return first\n        else:\n>           raise NoMatches(f\"No nodes match {self!r} on {self.node!r}\")\nE           textual.css.query.NoMatches: No nodes match <DOMQuery query='HeaderTitle'> on MyApp(title='new app title', classes={'-dark-mode'})\n\nsrc/textual/css/query.py:247: NoMatches\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_app_title_reactive_does_not_update_title_when_screen_title_is_set():\n        class MyScreen(Screen):\n            TITLE = \"screen title\"\n    \n            def compose(self):\n                yield Header()\n    \n        class MyApp(App):\n            TITLE = \"app title\"\n    \n            def on_mount(self):\n                self.push_screen(MyScreen())\n    \n        app = MyApp()\n>       async with app.run_test() as pilot:\n\ntests/test_header.py:74: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/test_header.py:71: in on_mount\n    self.push_screen(MyScreen())\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='new app title', classes={'-dark-mode'}), screen = MyScreen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/test_header.py:71 in on_mount              \u2502\n\u2502                                                                              \u2502\n\u2502    68 \u2502   \u2502   TITLE = \"app title\"                                            \u2502\n\u2502    69 \u2502   \u2502                                                                  \u2502\n\u2502    70 \u2502   \u2502   def on_mount(self):                                            \u2502\n\u2502 \u2771  71 \u2502   \u2502   \u2502   self.push_screen(MyScreen())                               \u2502\n\u2502    72 \u2502                                                                      \u2502\n\u2502    73 \u2502   app = MyApp()                                                      \u2502\n\u2502    74 \u2502   async with app.run_test() as pilot:                                \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 MyScreen = <class                                                        \u2502 \u2502\n\u2502 \u2502            'tests.test_header.test_app_title_reactive_does_not_update_t\u2026 \u2502 \u2502\n\u2502 \u2502     self = MyApp(title='app title', classes={'-dark-mode'})              \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e      \u2502\n\u2502 \u2502         callback = None                                             \u2502      \u2502\n\u2502 \u2502           screen = MyScreen()                                       \u2502      \u2502\n\u2502 \u2502             self = MyApp(title='app title', classes={'-dark-mode'}) \u2502      \u2502\n\u2502 \u2502 wait_for_dismiss = False                                            \u2502      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f      \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'MyApp' object has no attribute '_push_screen'\n___________________________ test_switch_screen_no_op ___________________________\n\n    async def test_switch_screen_no_op():\n        \"\"\"Regression test for https://github.com/Textualize/textual/issues/2650\"\"\"\n    \n        class MyScreen(Screen):\n            pass\n    \n        class MyApp(App[None]):\n            SCREENS = {\"screen\": MyScreen()}\n    \n            def on_mount(self):\n                self.push_screen(\"screen\")\n    \n        app = MyApp()\n        async with app.run_test():\n            screen_id = id(app.screen)\n>           app.switch_screen(\"screen\")\n\ntests/test_screens.py:342: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/app.py:2157: in switch_screen\n    top_screen._pop_result_callback()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Screen(id='_default')\n\n    def _pop_result_callback(self) -> None:\n        \"\"\"Remove the latest result callback from the stack.\"\"\"\n>       self._result_callbacks.pop()\nE       IndexError: pop from empty list\n\nsrc/textual/screen.py:899: IndexError\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_switch_screen_no_op():\n        \"\"\"Regression test for https://github.com/Textualize/textual/issues/2650\"\"\"\n    \n        class MyScreen(Screen):\n            pass\n    \n        class MyApp(App[None]):\n            SCREENS = {\"screen\": MyScreen()}\n    \n            def on_mount(self):\n                self.push_screen(\"screen\")\n    \n        app = MyApp()\n>       async with app.run_test():\n\ntests/test_screens.py:340: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/test_screens.py:337: in on_mount\n    self.push_screen(\"screen\")\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'}), screen = 'screen'\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/test_screens.py:337 in on_mount            \u2502\n\u2502                                                                              \u2502\n\u2502   334 \u2502   \u2502   SCREENS = {\"screen\": MyScreen()}                               \u2502\n\u2502   335 \u2502   \u2502                                                                  \u2502\n\u2502   336 \u2502   \u2502   def on_mount(self):                                            \u2502\n\u2502 \u2771 337 \u2502   \u2502   \u2502   self.push_screen(\"screen\")                                 \u2502\n\u2502   338 \u2502                                                                      \u2502\n\u2502   339 \u2502   app = MyApp()                                                      \u2502\n\u2502   340 \u2502   async with app.run_test():                                         \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                      \u2502\n\u2502 \u2502 self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502                      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                      \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e          \u2502\n\u2502 \u2502         callback = None                                         \u2502          \u2502\n\u2502 \u2502           screen = 'screen'                                     \u2502          \u2502\n\u2502 \u2502             self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502          \u2502\n\u2502 \u2502 wait_for_dismiss = False                                        \u2502          \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f          \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'MyApp' object has no attribute '_push_screen'\n_________________ test_auto_focus_skips_non_focusable_widgets __________________\n\n    async def test_auto_focus_skips_non_focusable_widgets():\n        class MyScreen(Screen[None]):\n            def compose(self):\n                yield Label()\n                yield Button()\n    \n        class MyApp(App[None]):\n            def on_mount(self):\n                self.push_screen(MyScreen())\n    \n        app = MyApp()\n        async with app.run_test():\n>           assert app.focused is not None\nE           AssertionError: assert None is not None\nE            +  where None = MyApp(title='MyApp', classes={'-dark-mode'}).focused\n\ntests/test_screens.py:289: AssertionError\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_auto_focus_skips_non_focusable_widgets():\n        class MyScreen(Screen[None]):\n            def compose(self):\n                yield Label()\n                yield Button()\n    \n        class MyApp(App[None]):\n            def on_mount(self):\n                self.push_screen(MyScreen())\n    \n        app = MyApp()\n>       async with app.run_test():\n\ntests/test_screens.py:288: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/test_screens.py:285: in on_mount\n    self.push_screen(MyScreen())\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'}), screen = MyScreen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/test_screens.py:285 in on_mount            \u2502\n\u2502                                                                              \u2502\n\u2502   282 \u2502                                                                      \u2502\n\u2502   283 \u2502   class MyApp(App[None]):                                            \u2502\n\u2502   284 \u2502   \u2502   def on_mount(self):                                            \u2502\n\u2502 \u2771 285 \u2502   \u2502   \u2502   self.push_screen(MyScreen())                               \u2502\n\u2502   286 \u2502                                                                      \u2502\n\u2502   287 \u2502   app = MyApp()                                                      \u2502\n\u2502   288 \u2502   async with app.run_test():                                         \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 MyScreen = <class                                                        \u2502 \u2502\n\u2502 \u2502            'tests.test_screens.test_auto_focus_skips_non_focusable_widg\u2026 \u2502 \u2502\n\u2502 \u2502     self = MyApp(title='MyApp', classes={'-dark-mode'})                  \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e          \u2502\n\u2502 \u2502         callback = None                                         \u2502          \u2502\n\u2502 \u2502           screen = MyScreen()                                   \u2502          \u2502\n\u2502 \u2502             self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502          \u2502\n\u2502 \u2502 wait_for_dismiss = False                                        \u2502          \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f          \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'MyApp' object has no attribute '_push_screen'\n___________________ test_screen_css_push_screen_type_by_name ___________________\n\n    async def test_screen_css_push_screen_type_by_name():\n        \"\"\"Check that screen CSS is loaded and applied when pushing a screen name that points to a screen class.\"\"\"\n    \n        class MyApp(BaseApp):\n            SCREENS = {\"screenwithcss\": ScreenWithCSS}\n    \n            def key_p(self):\n                self.push_screen(\"screenwithcss\")\n    \n            def key_o(self):\n                self.pop_screen()\n    \n        app = MyApp()\n        async with app.run_test() as pilot:\n>           check_colors_before_screen_css(app)\n\ntests/css/test_screen_css.py:160: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \ntests/css/test_screen_css.py:61: in check_colors_before_screen_css\n    assert app.query_one(\"#app-css\").styles.background == GREEN\nsrc/textual/dom.py:1347: in query_one\n    return query.only_one() if expect_type is None else query.only_one(expect_type)\nsrc/textual/css/query.py:278: in only_one\n    self.first(expect_type) if expect_type is not None else self.first()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <DOMQuery query='#app-css'>, expect_type = None\n\n    def first(\n        self, expect_type: type[ExpectType] | None = None\n    ) -> QueryType | ExpectType:\n        \"\"\"Get the *first* matching node.\n    \n        Args:\n            expect_type: Require matched node is of this type,\n                or None for any type.\n    \n        Raises:\n            WrongType: If the wrong type was found.\n            NoMatches: If there are no matching nodes in the query.\n    \n        Returns:\n            The matching Widget.\n        \"\"\"\n        _rich_traceback_omit = True\n        if self.nodes:\n            first = self.nodes[0]\n            if expect_type is not None:\n                if not isinstance(first, expect_type):\n                    raise WrongType(\n                        f\"Query value is wrong type; expected {expect_type}, got {type(first)}\"\n                    )\n            return first\n        else:\n>           raise NoMatches(f\"No nodes match {self!r} on {self.node!r}\")\nE           textual.css.query.NoMatches: No nodes match <DOMQuery query='#app-css'> on MyApp(title='MyApp', classes={'-dark-mode'})\n\nsrc/textual/css/query.py:247: NoMatches\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_screen_css_push_screen_type_by_name():\n        \"\"\"Check that screen CSS is loaded and applied when pushing a screen name that points to a screen class.\"\"\"\n    \n        class MyApp(BaseApp):\n            SCREENS = {\"screenwithcss\": ScreenWithCSS}\n    \n            def key_p(self):\n                self.push_screen(\"screenwithcss\")\n    \n            def key_o(self):\n                self.pop_screen()\n    \n        app = MyApp()\n>       async with app.run_test() as pilot:\n\ntests/css/test_screen_css.py:159: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/css/test_screen_css.py:50: in on_mount\n    self.push_screen(BaseScreen())\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'}), screen = BaseScreen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/css/test_screen_css.py:50 in on_mount      \u2502\n\u2502                                                                              \u2502\n\u2502    47 \u2502   \"\"\"                                                                \u2502\n\u2502    48 \u2502                                                                      \u2502\n\u2502    49 \u2502   def on_mount(self):                                                \u2502\n\u2502 \u2771  50 \u2502   \u2502   self.push_screen(BaseScreen())                                 \u2502\n\u2502    51                                                                        \u2502\n\u2502    52                                                                        \u2502\n\u2502    53 class SwitchBaseApp(BaseApp):                                          \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                      \u2502\n\u2502 \u2502 self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502                      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                      \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e          \u2502\n\u2502 \u2502         callback = None                                         \u2502          \u2502\n\u2502 \u2502           screen = BaseScreen()                                 \u2502          \u2502\n\u2502 \u2502             self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502          \u2502\n\u2502 \u2502 wait_for_dismiss = False                                        \u2502          \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f          \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'MyApp' object has no attribute '_push_screen'\n_________________ test_pilot_exception_catching_widget_compose _________________\n\n    async def test_pilot_exception_catching_widget_compose():\n        class SomeScreen(Screen[None]):\n            def compose(self) -> ComposeResult:\n                1 / 0\n                yield Label(\"Beep\")\n    \n        class FailingApp(App[None]):\n            def on_mount(self) -> None:\n                self.push_screen(SomeScreen())\n    \n        with pytest.raises(ZeroDivisionError):\n>           async with FailingApp().run_test():\n\ntests/test_pilot.py:86: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:206: in __aexit__\n    await anext(self.gen)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/test_pilot.py:83: in on_mount\n    self.push_screen(SomeScreen())\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = FailingApp(title='FailingApp', classes={'-dark-mode'})\nscreen = SomeScreen(), callback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'FailingApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/test_pilot.py:83 in on_mount               \u2502\n\u2502                                                                              \u2502\n\u2502    80 \u2502                                                                      \u2502\n\u2502    81 \u2502   class FailingApp(App[None]):                                       \u2502\n\u2502    82 \u2502   \u2502   def on_mount(self) -> None:                                    \u2502\n\u2502 \u2771  83 \u2502   \u2502   \u2502   self.push_screen(SomeScreen())                             \u2502\n\u2502    84 \u2502                                                                      \u2502\n\u2502    85 \u2502   with pytest.raises(ZeroDivisionError):                             \u2502\n\u2502    86 \u2502   \u2502   async with FailingApp().run_test():                            \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502       self = FailingApp(title='FailingApp', classes={'-dark-mode'})      \u2502 \u2502\n\u2502 \u2502 SomeScreen = <class                                                      \u2502 \u2502\n\u2502 \u2502              'tests.test_pilot.test_pilot_exception_catching_widget_com\u2026 \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502         callback = None                                                  \u2502 \u2502\n\u2502 \u2502           screen = SomeScreen()                                          \u2502 \u2502\n\u2502 \u2502             self = FailingApp(                                           \u2502 \u2502\n\u2502 \u2502                    \u2502   title='FailingApp',                               \u2502 \u2502\n\u2502 \u2502                    \u2502   classes={                                         \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   '-dark-mode'                                  \u2502 \u2502\n\u2502 \u2502                    \u2502   }                                                 \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502 wait_for_dismiss = False                                                 \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'FailingApp' object has no attribute '_push_screen'\n___________ test_auto_focus_on_screen_if_app_auto_focus_is_disabled ____________\n\n    async def test_auto_focus_on_screen_if_app_auto_focus_is_disabled():\n        \"\"\"Setting app.AUTO_FOCUS = `None` means it is not taken into consideration.\"\"\"\n    \n        class MyScreen(Screen[None]):\n            def compose(self):\n                yield Button()\n                yield Input(id=\"one\")\n                yield Input(id=\"two\")\n    \n        class MyApp(App[None]):\n            AUTO_FOCUS = \"\"\n    \n        app = MyApp()\n        async with app.run_test():\n            MyScreen.AUTO_FOCUS = \"*\"\n>           await app.push_screen(MyScreen())\n\ntests/test_screens.py:218: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='MyApp', classes={'-dark-mode'}), screen = MyScreen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n____________________ test_screen_title_overrides_app_title _____________________\n\n    async def test_screen_title_overrides_app_title():\n        class MyScreen(Screen):\n            TITLE = \"screen title\"\n    \n            def compose(self):\n                yield Header()\n    \n        class MyApp(App):\n            TITLE = \"app title\"\n    \n            def on_mount(self):\n                self.push_screen(MyScreen())\n    \n        app = MyApp()\n        async with app.run_test():\n>           assert app.query_one(\"HeaderTitle\").text == \"screen title\"\n\ntests/test_header.py:37: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/dom.py:1347: in query_one\n    return query.only_one() if expect_type is None else query.only_one(expect_type)\nsrc/textual/css/query.py:278: in only_one\n    self.first(expect_type) if expect_type is not None else self.first()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <DOMQuery query='HeaderTitle'>, expect_type = None\n\n    def first(\n        self, expect_type: type[ExpectType] | None = None\n    ) -> QueryType | ExpectType:\n        \"\"\"Get the *first* matching node.\n    \n        Args:\n            expect_type: Require matched node is of this type,\n                or None for any type.\n    \n        Raises:\n            WrongType: If the wrong type was found.\n            NoMatches: If there are no matching nodes in the query.\n    \n        Returns:\n            The matching Widget.\n        \"\"\"\n        _rich_traceback_omit = True\n        if self.nodes:\n            first = self.nodes[0]\n            if expect_type is not None:\n                if not isinstance(first, expect_type):\n                    raise WrongType(\n                        f\"Query value is wrong type; expected {expect_type}, got {type(first)}\"\n                    )\n            return first\n        else:\n>           raise NoMatches(f\"No nodes match {self!r} on {self.node!r}\")\nE           textual.css.query.NoMatches: No nodes match <DOMQuery query='HeaderTitle'> on MyApp(title='app title', classes={'-dark-mode'})\n\nsrc/textual/css/query.py:247: NoMatches\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_screen_title_overrides_app_title():\n        class MyScreen(Screen):\n            TITLE = \"screen title\"\n    \n            def compose(self):\n                yield Header()\n    \n        class MyApp(App):\n            TITLE = \"app title\"\n    \n            def on_mount(self):\n                self.push_screen(MyScreen())\n    \n        app = MyApp()\n>       async with app.run_test():\n\ntests/test_header.py:36: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2563: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2510: in run_process_messages\n    await self._dispatch_message(events.Mount())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3083: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/test_header.py:33: in on_mount\n    self.push_screen(MyScreen())\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = MyApp(title='app title', classes={'-dark-mode'}), screen = MyScreen()\ncallback = None, wait_for_dismiss = False\n\n    def push_screen(\n        self,\n        screen: Screen[ScreenResultType] | str,\n        callback: ScreenResultCallbackType[ScreenResultType] | None = None,\n        wait_for_dismiss: bool = False\n    ) -> AwaitMount | asyncio.Future[ScreenResultType]:\n        \"\"\"Push a new [screen](/guide/screens) on the screen stack, making it the current screen.\n    \n        Args:\n            screen: A Screen instance or the name of an installed screen.\n            callback: An optional callback function that will be called if the screen is [dismissed][textual.screen.Screen.dismiss] with a result.\n            wait_for_dismiss: If `True`, awaiting this method will return the dismiss value from the screen. When set to `False`, awaiting\n                this method will wait for the screen to be mounted. Note that `wait_for_dismiss` should only be set to `True` when running in a worker.\n    \n        Raises:\n            NoActiveWorker: If using `wait_for_dismiss` outside of a worker.\n    \n        Returns:\n            An optional awaitable that awaits the mounting of the screen and its children, or an asyncio Future\n                to await the result of the screen.\n        \"\"\"\n        if wait_for_dismiss:\n            from .worker import get_current_worker\n    \n            if get_current_worker() is None:\n                raise NoActiveWorker(\n                    \"App.push_screen with wait_for_dismiss=True may only be called from within a worker\"\n                )\n            future: asyncio.Future[ScreenResultType] = asyncio.Future()\n            self._push_screen(screen, partial(self._set_future_result, future), True)\n            return future\n    \n>       return self._push_screen(screen, callback)\nE       AttributeError: 'MyApp' object has no attribute '_push_screen'. Did you mean: 'push_screen'?\n\nsrc/textual/app.py:2110: AttributeError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/test_header.py:33 in on_mount              \u2502\n\u2502                                                                              \u2502\n\u2502    30 \u2502   \u2502   TITLE = \"app title\"                                            \u2502\n\u2502    31 \u2502   \u2502                                                                  \u2502\n\u2502    32 \u2502   \u2502   def on_mount(self):                                            \u2502\n\u2502 \u2771  33 \u2502   \u2502   \u2502   self.push_screen(MyScreen())                               \u2502\n\u2502    34 \u2502                                                                      \u2502\n\u2502    35 \u2502   app = MyApp()                                                      \u2502\n\u2502    36 \u2502   async with app.run_test():                                         \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 MyScreen = <class                                                        \u2502 \u2502\n\u2502 \u2502            'tests.test_header.test_screen_title_overrides_app_title.<lo\u2026 \u2502 \u2502\n\u2502 \u2502     self = MyApp(title='app title', classes={'-dark-mode'})              \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2110 in push_screen           \u2502\n\u2502                                                                              \u2502\n\u2502   2107 \u2502   \u2502   \u2502   self._push_screen(screen, partial(self._set_future_result \u2502\n\u2502   2108 \u2502   \u2502   \u2502   return future                                             \u2502\n\u2502   2109 \u2502   \u2502                                                                 \u2502\n\u2502 \u2771 2110 \u2502   \u2502   return self._push_screen(screen, callback)                    \u2502\n\u2502   2111 \u2502                                                                     \u2502\n\u2502   2112 \u2502                                                                     \u2502\n\u2502   2113 \u2502   if TYPE_CHECKING:                                                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e      \u2502\n\u2502 \u2502         callback = None                                             \u2502      \u2502\n\u2502 \u2502           screen = MyScreen()                                       \u2502      \u2502\n\u2502 \u2502             self = MyApp(title='app title', classes={'-dark-mode'}) \u2502      \u2502\n\u2502 \u2502 wait_for_dismiss = False                                            \u2502      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f      \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'MyApp' object has no attribute '_push_screen'\n=============================== warnings summary ===============================\ntests/test_header.py: 8 warnings\ntests/css/test_screen_css.py: 4 warnings\ntests/test_screens.py: 13 warnings\ntests/test_widget.py: 1 warning\ntests/test_unmount.py: 1 warning\ntests/test_pilot.py: 1 warning\n  /usr/local/lib/python3.10/site-packages/tornado/ioloop.py:274: DeprecationWarning: There is no current event loop\n    loop = asyncio.get_event_loop()\n\ntests/test_header.py::test_screen_title_none_is_ignored\n  /usr/local/lib/python3.10/site-packages/tornado/platform/asyncio.py:288: DeprecationWarning: There is no current event loop\n    super().initialize(asyncio.get_event_loop(), **kwargs)\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_header.py::test_screen_title_none_is_ignored - AttributeErr...\nFAILED tests/test_focus.py::test_focus_next_and_previous_with_type_selector_without_self\nFAILED tests/css/test_screen_css.py::test_screen_css_push_screen_instance - A...\nFAILED tests/test_focus.py::test_allow_focus - AttributeError: 'App' object h...\nFAILED tests/test_header.py::test_screen_sub_title_none_is_ignored - Attribut...\nFAILED tests/test_screens.py::test_dismiss_action - AttributeError: 'MyApp' o...\nFAILED tests/test_header.py::test_screen_sub_title_reactive_updates_sub_title\nFAILED tests/css/test_screen_css.py::test_screen_pushing_and_popping_does_not_reparse_css\nFAILED tests/test_screens.py::test_auto_focus_on_screen_if_app_auto_focus_is_none\nFAILED tests/test_widget.py::test_compose_order - AttributeError: 'SelectBugA...\nFAILED tests/test_header.py::test_screen_sub_title_overrides_app_sub_title - ...\nFAILED tests/css/test_screen_css.py::test_screen_css_push_screen_instance_by_name\nFAILED tests/test_screens.py::test_switch_screen_updates_results_callback_stack\nFAILED tests/test_screens.py::test_push_screen_wait_for_dismiss - textual.wor...\nFAILED tests/test_header.py::test_screen_title_reactive_updates_title - Attri...\nFAILED tests/test_screens.py::test_auto_focus_inheritance - AttributeError: '...\nFAILED tests/test_screens.py::test_screen_receives_mouse_move_events - Attrib...\nFAILED tests/test_focus.py::test_focus_chain - AttributeError: 'App' object h...\nFAILED tests/test_screens.py::test_screens - AttributeError: 'App' object has...\nFAILED tests/test_screens.py::test_dismiss_non_top_screen - AttributeError: '...\nFAILED tests/test_unmount.py::test_unmount - AttributeError: 'UnmountApp' obj...\nFAILED tests/test_header.py::test_app_sub_title_reactive_does_not_update_sub_title_when_screen_sub_title_is_set\nFAILED tests/test_screens.py::test_mouse_move_event_bubbles_to_screen_from_widget\nFAILED tests/test_header.py::test_app_title_reactive_does_not_update_title_when_screen_title_is_set\nFAILED tests/test_screens.py::test_switch_screen_no_op - AttributeError: 'MyA...\nFAILED tests/test_screens.py::test_auto_focus_skips_non_focusable_widgets - A...\nFAILED tests/css/test_screen_css.py::test_screen_css_push_screen_type_by_name\nFAILED tests/test_pilot.py::test_pilot_exception_catching_widget_compose - At...\nFAILED tests/test_screens.py::test_auto_focus_on_screen_if_app_auto_focus_is_disabled\nFAILED tests/test_header.py::test_screen_title_overrides_app_title - Attribut...\n================== 30 failed, 1 passed, 29 warnings in 6.17s ===================\n\n"], "textual-src/textual/app.py-switch_screen": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 6 items\n\ntests/test_screens.py ..                                                 [ 33%]\ntests/css/test_screen_css.py FF                                          [ 66%]\ntests/test_screens.py F                                                  [ 83%]\ntests/css/test_screen_css.py F                                           [100%]\n\n=================================== FAILURES ===================================\n____________________ test_screen_css_switch_screen_instance ____________________\n\n    async def test_screen_css_switch_screen_instance():\n        \"\"\"Check that screen CSS is loaded and applied when switching to a screen instance.\"\"\"\n    \n        class MyApp(SwitchBaseApp):\n            def key_p(self):\n                self.switch_screen(ScreenWithCSS())\n    \n            def key_o(self):\n                self.pop_screen()\n    \n        app = MyApp()\n        async with app.run_test() as pilot:\n            check_colors_before_screen_css(app)\n            await pilot.press(\"p\")\n            check_colors_after_screen_css(app)\n            await pilot.press(\"o\")\n>           check_colors_after_screen_css(app)\n\ntests/css/test_screen_css.py:183: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\napp = MyApp(title='MyApp', classes={'-dark-mode'})\n\n    def check_colors_after_screen_css(app: BaseApp):\n        assert app.query_one(\"#app-css\").styles.background == GREEN\n>       assert app.query_one(\"#screen-css-path\").styles.background == BLUE\nE       AssertionError: assert Color(0, 255, 0) == Color(0, 0, 255)\nE         \nE         Omitting 2 identical items, use -vv to show\nE         Differing attributes:\nE         ['g', 'b']\nE         \nE         Drill down into differing attribute g:\nE           g: 255 != 0...\nE         \nE         ...Full output truncated (4 lines hidden), use '-vv' to show\n\ntests/css/test_screen_css.py:68: AssertionError\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_screen_css_switch_screen_instance():\n        \"\"\"Check that screen CSS is loaded and applied when switching to a screen instance.\"\"\"\n    \n        class MyApp(SwitchBaseApp):\n            def key_p(self):\n                self.switch_screen(ScreenWithCSS())\n    \n            def key_o(self):\n                self.pop_screen()\n    \n        app = MyApp()\n>       async with app.run_test() as pilot:\n\ntests/css/test_screen_css.py:178: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/message_pump.py:589: in _process_messages_loop\n    await self._dispatch_message(message)\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3096: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:47: in _invoke\n    result = await result\nsrc/textual/app.py:3267: in _on_key\n    await self.dispatch_key(event)\nsrc/textual/message_pump.py:850: in dispatch_key\n    handled = (await invoke(key_method, event)) is not False\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/css/test_screen_css.py:175: in key_o\n    self.pop_screen()\nsrc/textual/app.py:2259: in pop_screen\n    previous_screen._pop_result_callback()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = ScreenWithCSS()\n\n    def _pop_result_callback(self) -> None:\n        \"\"\"Remove the latest result callback from the stack.\"\"\"\n>       self._result_callbacks.pop()\nE       IndexError: pop from empty list\n\nsrc/textual/screen.py:899: IndexError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/css/test_screen_css.py:175 in key_o        \u2502\n\u2502                                                                              \u2502\n\u2502   172 \u2502   \u2502   \u2502   self.switch_screen(ScreenWithCSS())                        \u2502\n\u2502   173 \u2502   \u2502                                                                  \u2502\n\u2502   174 \u2502   \u2502   def key_o(self):                                               \u2502\n\u2502 \u2771 175 \u2502   \u2502   \u2502   self.pop_screen()                                          \u2502\n\u2502   176 \u2502                                                                      \u2502\n\u2502   177 \u2502   app = MyApp()                                                      \u2502\n\u2502   178 \u2502   async with app.run_test() as pilot:                                \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                      \u2502\n\u2502 \u2502 self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502                      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                      \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2259 in pop_screen            \u2502\n\u2502                                                                              \u2502\n\u2502   2256 \u2502   \u2502   \u2502   )                                                         \u2502\n\u2502   2257 \u2502   \u2502                                                                 \u2502\n\u2502   2258 \u2502   \u2502   previous_screen = screen_stack.pop()                          \u2502\n\u2502 \u2771 2259 \u2502   \u2502   previous_screen._pop_result_callback()                        \u2502\n\u2502   2260 \u2502   \u2502   self.screen.post_message(events.ScreenResume())               \u2502\n\u2502   2261 \u2502   \u2502   self.log.system(f\"{self.screen} is active\")                   \u2502\n\u2502   2262                                                                       \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e           \u2502\n\u2502 \u2502 previous_screen = ScreenWithCSS()                              \u2502           \u2502\n\u2502 \u2502    screen_stack = [Screen(id='_default'), BaseScreen()]        \u2502           \u2502\n\u2502 \u2502            self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502           \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f           \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/screen.py:899 in                     \u2502\n\u2502 _pop_result_callback                                                         \u2502\n\u2502                                                                              \u2502\n\u2502    896 \u2502                                                                     \u2502\n\u2502    897 \u2502   def _pop_result_callback(self) -> None:                           \u2502\n\u2502    898 \u2502   \u2502   \"\"\"Remove the latest result callback from the stack.\"\"\"       \u2502\n\u2502 \u2771  899 \u2502   \u2502   self._result_callbacks.pop()                                  \u2502\n\u2502    900 \u2502                                                                     \u2502\n\u2502    901 \u2502   def _refresh_layout(self, size: Size | None = None, scroll: bool  \u2502\n\u2502    902 \u2502   \u2502   \"\"\"Refresh the layout (can change size and positions of widge \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                                                   \u2502\n\u2502 \u2502 self = ScreenWithCSS() \u2502                                                   \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                                                   \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nIndexError: pop from empty list\n________________ test_screen_css_switch_screen_instance_by_name ________________\n\n    async def test_screen_css_switch_screen_instance_by_name():\n        \"\"\"Check that screen CSS is loaded and applied when switching a screen name that points to a screen instance.\"\"\"\n    \n        class MyApp(SwitchBaseApp):\n            SCREENS = {\"screenwithcss\": ScreenWithCSS()}\n    \n            def key_p(self):\n                self.switch_screen(\"screenwithcss\")\n    \n            def key_o(self):\n                self.pop_screen()\n    \n        app = MyApp()\n        async with app.run_test() as pilot:\n            check_colors_before_screen_css(app)\n            await pilot.press(\"p\")\n            check_colors_after_screen_css(app)\n            await pilot.press(\"o\")\n>           check_colors_after_screen_css(app)\n\ntests/css/test_screen_css.py:204: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\napp = MyApp(title='MyApp', classes={'-dark-mode'})\n\n    def check_colors_after_screen_css(app: BaseApp):\n        assert app.query_one(\"#app-css\").styles.background == GREEN\n>       assert app.query_one(\"#screen-css-path\").styles.background == BLUE\nE       AssertionError: assert Color(0, 255, 0) == Color(0, 0, 255)\nE         \nE         Omitting 2 identical items, use -vv to show\nE         Differing attributes:\nE         ['g', 'b']\nE         \nE         Drill down into differing attribute g:\nE           g: 255 != 0...\nE         \nE         ...Full output truncated (4 lines hidden), use '-vv' to show\n\ntests/css/test_screen_css.py:68: AssertionError\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_screen_css_switch_screen_instance_by_name():\n        \"\"\"Check that screen CSS is loaded and applied when switching a screen name that points to a screen instance.\"\"\"\n    \n        class MyApp(SwitchBaseApp):\n            SCREENS = {\"screenwithcss\": ScreenWithCSS()}\n    \n            def key_p(self):\n                self.switch_screen(\"screenwithcss\")\n    \n            def key_o(self):\n                self.pop_screen()\n    \n        app = MyApp()\n>       async with app.run_test() as pilot:\n\ntests/css/test_screen_css.py:199: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/message_pump.py:589: in _process_messages_loop\n    await self._dispatch_message(message)\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3096: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:47: in _invoke\n    result = await result\nsrc/textual/app.py:3267: in _on_key\n    await self.dispatch_key(event)\nsrc/textual/message_pump.py:850: in dispatch_key\n    handled = (await invoke(key_method, event)) is not False\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/css/test_screen_css.py:196: in key_o\n    self.pop_screen()\nsrc/textual/app.py:2259: in pop_screen\n    previous_screen._pop_result_callback()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = ScreenWithCSS()\n\n    def _pop_result_callback(self) -> None:\n        \"\"\"Remove the latest result callback from the stack.\"\"\"\n>       self._result_callbacks.pop()\nE       IndexError: pop from empty list\n\nsrc/textual/screen.py:899: IndexError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/css/test_screen_css.py:196 in key_o        \u2502\n\u2502                                                                              \u2502\n\u2502   193 \u2502   \u2502   \u2502   self.switch_screen(\"screenwithcss\")                        \u2502\n\u2502   194 \u2502   \u2502                                                                  \u2502\n\u2502   195 \u2502   \u2502   def key_o(self):                                               \u2502\n\u2502 \u2771 196 \u2502   \u2502   \u2502   self.pop_screen()                                          \u2502\n\u2502   197 \u2502                                                                      \u2502\n\u2502   198 \u2502   app = MyApp()                                                      \u2502\n\u2502   199 \u2502   async with app.run_test() as pilot:                                \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                      \u2502\n\u2502 \u2502 self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502                      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                      \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2259 in pop_screen            \u2502\n\u2502                                                                              \u2502\n\u2502   2256 \u2502   \u2502   \u2502   )                                                         \u2502\n\u2502   2257 \u2502   \u2502                                                                 \u2502\n\u2502   2258 \u2502   \u2502   previous_screen = screen_stack.pop()                          \u2502\n\u2502 \u2771 2259 \u2502   \u2502   previous_screen._pop_result_callback()                        \u2502\n\u2502   2260 \u2502   \u2502   self.screen.post_message(events.ScreenResume())               \u2502\n\u2502   2261 \u2502   \u2502   self.log.system(f\"{self.screen} is active\")                   \u2502\n\u2502   2262                                                                       \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e           \u2502\n\u2502 \u2502 previous_screen = ScreenWithCSS()                              \u2502           \u2502\n\u2502 \u2502    screen_stack = [Screen(id='_default'), BaseScreen()]        \u2502           \u2502\n\u2502 \u2502            self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502           \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f           \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/screen.py:899 in                     \u2502\n\u2502 _pop_result_callback                                                         \u2502\n\u2502                                                                              \u2502\n\u2502    896 \u2502                                                                     \u2502\n\u2502    897 \u2502   def _pop_result_callback(self) -> None:                           \u2502\n\u2502    898 \u2502   \u2502   \"\"\"Remove the latest result callback from the stack.\"\"\"       \u2502\n\u2502 \u2771  899 \u2502   \u2502   self._result_callbacks.pop()                                  \u2502\n\u2502    900 \u2502                                                                     \u2502\n\u2502    901 \u2502   def _refresh_layout(self, size: Size | None = None, scroll: bool  \u2502\n\u2502    902 \u2502   \u2502   \"\"\"Refresh the layout (can change size and positions of widge \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                                                   \u2502\n\u2502 \u2502 self = ScreenWithCSS() \u2502                                                   \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                                                   \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nIndexError: pop from empty list\n______________ test_switch_screen_updates_results_callback_stack _______________\n\n    async def test_switch_screen_updates_results_callback_stack():\n        \"\"\"Regression test for https://github.com/Textualize/textual/issues/2650\"\"\"\n    \n        class ScreenA(Screen):\n            pass\n    \n        class ScreenB(Screen):\n            pass\n    \n        class MyApp(App[None]):\n            SCREENS = {\n                \"a\": ScreenA(),\n                \"b\": ScreenB(),\n            }\n    \n            def callback(self, _):\n                return 42\n    \n            def on_mount(self):\n                self.push_screen(\"a\", self.callback)\n    \n        app = MyApp()\n        async with app.run_test():\n            assert len(app.screen._result_callbacks) == 1\n            assert app.screen._result_callbacks[-1].callback(None) == 42\n    \n            app.switch_screen(\"b\")\n            assert len(app.screen._result_callbacks) == 1\n>           assert app.screen._result_callbacks[-1].callback is None\nE           AssertionError: assert <bound method test_switch_screen_updates_results_callback_stack.<locals>.MyApp.callback of MyApp(title='MyApp', classes={'-dark-mode'})> is None\nE            +  where <bound method test_switch_screen_updates_results_callback_stack.<locals>.MyApp.callback of MyApp(title='MyApp', classes={'-dark-mode'})> = ResultCallback(MyApp(title='MyApp', classes={'-dark-mode'}), <bound method test_switch_screen_updates_results_callback_stack.<locals>.MyApp.callback of MyApp(title='MyApp', classes={'-dark-mode'})>, future=<Future pending>).callback\n\ntests/test_screens.py:376: AssertionError\n__________________ test_screen_css_switch_screen_type_by_name __________________\n\n    async def test_screen_css_switch_screen_type_by_name():\n        \"\"\"Check that screen CSS is loaded and applied when switching a screen name that points to a screen class.\"\"\"\n    \n        class MyApp(SwitchBaseApp):\n            SCREENS = {\"screenwithcss\": ScreenWithCSS}\n    \n            async def key_p(self):\n                self.switch_screen(\"screenwithcss\")\n    \n            def key_o(self):\n                self.pop_screen()\n    \n        app = MyApp()\n        async with app.run_test() as pilot:\n            check_colors_before_screen_css(app)\n            await pilot.press(\"p\")\n            check_colors_after_screen_css(app)\n            await pilot.press(\"o\")\n>           check_colors_after_screen_css(app)\n\ntests/css/test_screen_css.py:225: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\napp = MyApp(title='MyApp', classes={'-dark-mode'})\n\n    def check_colors_after_screen_css(app: BaseApp):\n        assert app.query_one(\"#app-css\").styles.background == GREEN\n>       assert app.query_one(\"#screen-css-path\").styles.background == BLUE\nE       AssertionError: assert Color(0, 255, 0) == Color(0, 0, 255)\nE         \nE         Omitting 2 identical items, use -vv to show\nE         Differing attributes:\nE         ['g', 'b']\nE         \nE         Drill down into differing attribute g:\nE           g: 255 != 0...\nE         \nE         ...Full output truncated (4 lines hidden), use '-vv' to show\n\ntests/css/test_screen_css.py:68: AssertionError\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_screen_css_switch_screen_type_by_name():\n        \"\"\"Check that screen CSS is loaded and applied when switching a screen name that points to a screen class.\"\"\"\n    \n        class MyApp(SwitchBaseApp):\n            SCREENS = {\"screenwithcss\": ScreenWithCSS}\n    \n            async def key_p(self):\n                self.switch_screen(\"screenwithcss\")\n    \n            def key_o(self):\n                self.pop_screen()\n    \n        app = MyApp()\n>       async with app.run_test() as pilot:\n\ntests/css/test_screen_css.py:220: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:217: in __aexit__\n    await self.gen.athrow(typ, value, traceback)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/message_pump.py:589: in _process_messages_loop\n    await self._dispatch_message(message)\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3096: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:47: in _invoke\n    result = await result\nsrc/textual/app.py:3267: in _on_key\n    await self.dispatch_key(event)\nsrc/textual/message_pump.py:850: in dispatch_key\n    handled = (await invoke(key_method, event)) is not False\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:45: in _invoke\n    result = callback(*params[:parameter_count])\ntests/css/test_screen_css.py:217: in key_o\n    self.pop_screen()\nsrc/textual/app.py:2259: in pop_screen\n    previous_screen._pop_result_callback()\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = ScreenWithCSS()\n\n    def _pop_result_callback(self) -> None:\n        \"\"\"Remove the latest result callback from the stack.\"\"\"\n>       self._result_callbacks.pop()\nE       IndexError: pop from empty list\n\nsrc/textual/screen.py:899: IndexError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/tests/css/test_screen_css.py:217 in key_o        \u2502\n\u2502                                                                              \u2502\n\u2502   214 \u2502   \u2502   \u2502   self.switch_screen(\"screenwithcss\")                        \u2502\n\u2502   215 \u2502   \u2502                                                                  \u2502\n\u2502   216 \u2502   \u2502   def key_o(self):                                               \u2502\n\u2502 \u2771 217 \u2502   \u2502   \u2502   self.pop_screen()                                          \u2502\n\u2502   218 \u2502                                                                      \u2502\n\u2502   219 \u2502   app = MyApp()                                                      \u2502\n\u2502   220 \u2502   async with app.run_test() as pilot:                                \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                      \u2502\n\u2502 \u2502 self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502                      \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                      \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2259 in pop_screen            \u2502\n\u2502                                                                              \u2502\n\u2502   2256 \u2502   \u2502   \u2502   )                                                         \u2502\n\u2502   2257 \u2502   \u2502                                                                 \u2502\n\u2502   2258 \u2502   \u2502   previous_screen = screen_stack.pop()                          \u2502\n\u2502 \u2771 2259 \u2502   \u2502   previous_screen._pop_result_callback()                        \u2502\n\u2502   2260 \u2502   \u2502   self.screen.post_message(events.ScreenResume())               \u2502\n\u2502   2261 \u2502   \u2502   self.log.system(f\"{self.screen} is active\")                   \u2502\n\u2502   2262                                                                       \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e           \u2502\n\u2502 \u2502 previous_screen = ScreenWithCSS()                              \u2502           \u2502\n\u2502 \u2502    screen_stack = [Screen(id='_default'), BaseScreen()]        \u2502           \u2502\n\u2502 \u2502            self = MyApp(title='MyApp', classes={'-dark-mode'}) \u2502           \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f           \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/screen.py:899 in                     \u2502\n\u2502 _pop_result_callback                                                         \u2502\n\u2502                                                                              \u2502\n\u2502    896 \u2502                                                                     \u2502\n\u2502    897 \u2502   def _pop_result_callback(self) -> None:                           \u2502\n\u2502    898 \u2502   \u2502   \"\"\"Remove the latest result callback from the stack.\"\"\"       \u2502\n\u2502 \u2771  899 \u2502   \u2502   self._result_callbacks.pop()                                  \u2502\n\u2502    900 \u2502                                                                     \u2502\n\u2502    901 \u2502   def _refresh_layout(self, size: Size | None = None, scroll: bool  \u2502\n\u2502    902 \u2502   \u2502   \"\"\"Refresh the layout (can change size and positions of widge \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                                                   \u2502\n\u2502 \u2502 self = ScreenWithCSS() \u2502                                                   \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                                                   \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nIndexError: pop from empty list\n=============================== warnings summary ===============================\ntests/test_screens.py::test_switch_screen_no_op\ntests/test_screens.py::test_screens\ntests/css/test_screen_css.py::test_screen_css_switch_screen_instance\ntests/css/test_screen_css.py::test_screen_css_switch_screen_instance_by_name\ntests/test_screens.py::test_switch_screen_updates_results_callback_stack\ntests/css/test_screen_css.py::test_screen_css_switch_screen_type_by_name\n  /usr/local/lib/python3.10/site-packages/tornado/ioloop.py:274: DeprecationWarning: There is no current event loop\n    loop = asyncio.get_event_loop()\n\ntests/test_screens.py::test_switch_screen_no_op\n  /usr/local/lib/python3.10/site-packages/tornado/platform/asyncio.py:288: DeprecationWarning: There is no current event loop\n    super().initialize(asyncio.get_event_loop(), **kwargs)\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/css/test_screen_css.py::test_screen_css_switch_screen_instance\nFAILED tests/css/test_screen_css.py::test_screen_css_switch_screen_instance_by_name\nFAILED tests/test_screens.py::test_switch_screen_updates_results_callback_stack\nFAILED tests/css/test_screen_css.py::test_screen_css_switch_screen_type_by_name\n=================== 4 failed, 2 passed, 7 warnings in 1.29s ====================\n\n"], "textual-src/textual/app.py-pop_screen": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 11 items\n\ntests/css/test_screen_css.py .                                           [  9%]\ntests/test_screens.py ..F                                                [ 36%]\ntests/css/test_screen_css.py .....                                       [ 81%]\ntests/test_screens.py .                                                  [ 90%]\ntests/css/test_screen_css.py .                                           [100%]\n\n=================================== FAILURES ===================================\n_________________________________ test_screens _________________________________\n\n    async def test_screens():\n        app = App()\n        app._loop = asyncio.get_running_loop()\n        app._thread_id = threading.get_ident()\n        # There should be nothing in the children since the app hasn't run yet\n        assert not app._nodes\n        assert not app.children\n        app._set_active()\n    \n        with pytest.raises(ScreenStackError):\n            app.screen\n    \n        assert not app._installed_screens\n    \n        screen1 = Screen(name=\"screen1\")\n        screen2 = Screen(name=\"screen2\")\n        screen3 = Screen(name=\"screen3\")\n    \n        # installs screens\n        app.install_screen(screen1, \"screen1\")\n        app.install_screen(screen2, \"screen2\")\n    \n        # Installing a screen does not add it to the DOM\n        assert not app._nodes\n        assert not app.children\n    \n        # Check they are installed\n        assert app.is_screen_installed(\"screen1\")\n        assert app.is_screen_installed(\"screen2\")\n    \n        assert app.get_screen(\"screen1\") is screen1\n        with pytest.raises(KeyError):\n            app.get_screen(\"foo\")\n    \n        # Check screen3 is not installed\n        assert not app.is_screen_installed(\"screen3\")\n    \n        # Installs screen3\n        app.install_screen(screen3, \"screen3\")\n        # Confirm installed\n        assert app.is_screen_installed(\"screen3\")\n    \n        # Check screen stack is empty\n        assert app.screen_stack == []\n        # Push a screen\n        await app.push_screen(\"screen1\")\n        # Check it is on the stack\n        assert app.screen_stack == [screen1]\n        # Check it is current\n        assert app.screen is screen1\n        # There should be one item in the children view\n        assert app.children == (screen1,)\n    \n        # Switch to another screen\n        await app.switch_screen(\"screen2\")\n        # Check it has changed the stack and that it is current\n        assert app.screen_stack == [screen2]\n        assert app.screen is screen2\n        assert app.children == (screen2,)\n    \n        # Push another screen\n        await app.push_screen(\"screen3\")\n        assert app.screen_stack == [screen2, screen3]\n        assert app.screen is screen3\n        # Only the current screen is in children\n        assert app.children == (screen3,)\n    \n        # Pop a screen\n        await app.pop_screen()\n        assert app.screen is screen2\n        assert app.screen_stack == [screen2]\n    \n        # Uninstall screens\n        app.uninstall_screen(screen1)\n        assert not app.is_screen_installed(screen1)\n        app.uninstall_screen(\"screen3\")\n        assert not app.is_screen_installed(screen1)\n    \n        # Check we can't uninstall a screen on the stack\n        with pytest.raises(ScreenStackError):\n            app.uninstall_screen(screen2)\n    \n        # Check we can't pop last screen\n>       with pytest.raises(ScreenStackError):\nE       Failed: DID NOT RAISE <class 'textual.app.ScreenStackError'>\n\ntests/test_screens.py:151: Failed\n=============================== warnings summary ===============================\ntests/css/test_screen_css.py: 7 warnings\ntests/test_screens.py: 4 warnings\n  /usr/local/lib/python3.10/site-packages/tornado/ioloop.py:274: DeprecationWarning: There is no current event loop\n    loop = asyncio.get_event_loop()\n\ntests/css/test_screen_css.py::test_screen_css_push_screen_instance\n  /usr/local/lib/python3.10/site-packages/tornado/platform/asyncio.py:288: DeprecationWarning: There is no current event loop\n    super().initialize(asyncio.get_event_loop(), **kwargs)\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_screens.py::test_screens - Failed: DID NOT RAISE <class 'te...\n================== 1 failed, 10 passed, 12 warnings in 1.85s ===================\n\n"], "textual-src/textual/app.py-run_action": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/test_widget.py .                                                   [100%]\n\n=============================== warnings summary ===============================\ntests/test_widget.py::test_remove\n  /usr/local/lib/python3.10/site-packages/tornado/ioloop.py:274: DeprecationWarning: There is no current event loop\n    loop = asyncio.get_event_loop()\n\ntests/test_widget.py::test_remove\n  /usr/local/lib/python3.10/site-packages/tornado/platform/asyncio.py:288: DeprecationWarning: There is no current event loop\n    super().initialize(asyncio.get_event_loop(), **kwargs)\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n======================== 1 passed, 2 warnings in 0.19s =========================\n\n"], "textual-src/textual/file_monitor.py-check": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/test_file_monitor.py .                                             [100%]\n\n============================== 1 passed in 0.08s ===============================\n\n"], "textual-src/textual/expand_tabs.py-expand_tabs_inline": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 13 items\n\ntests/test_expand_tabs.py .............                                  [100%]\n\n============================== 13 passed in 0.09s ==============================\n\n"], "textual-src/textual/_resolve.py-resolve": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 7 items\n\ntests/test_resolve.py ....FFF                                            [100%]\n\n=================================== FAILURES ===================================\n_____________________ test_resolve[scalars3-100-1-result3] _____________________\n\nscalars = ['10', '1fr'], total = 100, gutter = 1, result = [(0, 10), (11, 89)]\n\n    @pytest.mark.parametrize(\n        \"scalars,total,gutter,result\",\n        [\n            ([\"10\"], 100, 0, [(0, 10)]),\n            (\n                [\"10\", \"20\"],\n                100,\n                0,\n                [(0, 10), (10, 20)],\n            ),\n            (\n                [\"10\", \"20\"],\n                100,\n                1,\n                [(0, 10), (11, 20)],\n            ),\n            (\n                [\"10\", \"1fr\"],\n                100,\n                1,\n                [(0, 10), (11, 89)],\n            ),\n            (\n                [\"1fr\", \"1fr\"],\n                100,\n                0,\n                [(0, 50), (50, 50)],\n            ),\n            (\n                [\"3\", \"1fr\", \"1fr\", \"1\"],\n                100,\n                1,\n                [(0, 3), (4, 46), (51, 47), (99, 1)],\n            ),\n        ],\n    )\n    def test_resolve(scalars, total, gutter, result):\n>       assert (\n            resolve(\n                [Scalar.parse(scalar) for scalar in scalars],\n                total,\n                gutter,\n                Size(40, 20),\n                Size(80, 24),\n            )\n            == result\n        )\nE       assert [(0, 10), (11, 1)] == [(0, 10), (11, 89)]\nE         \nE         At index 1 diff: (11, 1) != (11, 89)\nE         Use -v to get more diff\n\ntests/test_resolve.py:52: AssertionError\n_____________________ test_resolve[scalars4-100-0-result4] _____________________\n\nscalars = ['1fr', '1fr'], total = 100, gutter = 0, result = [(0, 50), (50, 50)]\n\n    @pytest.mark.parametrize(\n        \"scalars,total,gutter,result\",\n        [\n            ([\"10\"], 100, 0, [(0, 10)]),\n            (\n                [\"10\", \"20\"],\n                100,\n                0,\n                [(0, 10), (10, 20)],\n            ),\n            (\n                [\"10\", \"20\"],\n                100,\n                1,\n                [(0, 10), (11, 20)],\n            ),\n            (\n                [\"10\", \"1fr\"],\n                100,\n                1,\n                [(0, 10), (11, 89)],\n            ),\n            (\n                [\"1fr\", \"1fr\"],\n                100,\n                0,\n                [(0, 50), (50, 50)],\n            ),\n            (\n                [\"3\", \"1fr\", \"1fr\", \"1\"],\n                100,\n                1,\n                [(0, 3), (4, 46), (51, 47), (99, 1)],\n            ),\n        ],\n    )\n    def test_resolve(scalars, total, gutter, result):\n>       assert (\n            resolve(\n                [Scalar.parse(scalar) for scalar in scalars],\n                total,\n                gutter,\n                Size(40, 20),\n                Size(80, 24),\n            )\n            == result\n        )\nE       assert [(0, 1), (1, 1)] == [(0, 50), (50, 50)]\nE         \nE         At index 0 diff: (0, 1) != (0, 50)\nE         Use -v to get more diff\n\ntests/test_resolve.py:52: AssertionError\n_____________________ test_resolve[scalars5-100-1-result5] _____________________\n\nscalars = ['3', '1fr', '1fr', '1'], total = 100, gutter = 1\nresult = [(0, 3), (4, 46), (51, 47), (99, 1)]\n\n    @pytest.mark.parametrize(\n        \"scalars,total,gutter,result\",\n        [\n            ([\"10\"], 100, 0, [(0, 10)]),\n            (\n                [\"10\", \"20\"],\n                100,\n                0,\n                [(0, 10), (10, 20)],\n            ),\n            (\n                [\"10\", \"20\"],\n                100,\n                1,\n                [(0, 10), (11, 20)],\n            ),\n            (\n                [\"10\", \"1fr\"],\n                100,\n                1,\n                [(0, 10), (11, 89)],\n            ),\n            (\n                [\"1fr\", \"1fr\"],\n                100,\n                0,\n                [(0, 50), (50, 50)],\n            ),\n            (\n                [\"3\", \"1fr\", \"1fr\", \"1\"],\n                100,\n                1,\n                [(0, 3), (4, 46), (51, 47), (99, 1)],\n            ),\n        ],\n    )\n    def test_resolve(scalars, total, gutter, result):\n>       assert (\n            resolve(\n                [Scalar.parse(scalar) for scalar in scalars],\n                total,\n                gutter,\n                Size(40, 20),\n                Size(80, 24),\n            )\n            == result\n        )\nE       assert [(0, 3), (4, ...6, 1), (8, 1)] == [(0, 3), (4, ... 47), (99, 1)]\nE         \nE         At index 1 diff: (4, 1) != (4, 46)\nE         Use -v to get more diff\n\ntests/test_resolve.py:52: AssertionError\n=========================== short test summary info ============================\nFAILED tests/test_resolve.py::test_resolve[scalars3-100-1-result3] - assert [...\nFAILED tests/test_resolve.py::test_resolve[scalars4-100-0-result4] - assert [...\nFAILED tests/test_resolve.py::test_resolve[scalars5-100-1-result5] - assert [...\n========================= 3 failed, 4 passed in 0.12s ==========================\n\n"], "textual-src/textual/widget.py-mount": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/test_mount.py F                                                    [100%]\n\n=================================== FAILURES ===================================\n_________________________ test_render_only_after_mount _________________________\n\n    async def test_render_only_after_mount():\n        \"\"\"Regression test for https://github.com/Textualize/textual/issues/2914\"\"\"\n        app = App()\n>       async with app.run_test() as pilot:\n\ntests/test_mount.py:24: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:206: in __aexit__\n    await anext(self.gen)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2588: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2533: in run_process_messages\n    await self._dispatch_message(events.Compose())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3056: in on_event\n    await super().on_event(event)\nsrc/textual/message_pump.py:722: in on_event\n    await self._on_message(event)\nsrc/textual/message_pump.py:743: in _on_message\n    await invoke(method, message)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:47: in _invoke\n    result = await result\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = App(title='App', classes={'-dark-mode'})\n\n    async def _on_compose(self) -> None:\n        _rich_traceback_omit = True\n        try:\n            widgets = [*self.screen._nodes, *compose(self)]\n        except TypeError as error:\n            raise TypeError(\n                f\"{self!r} compose() method returned an invalid result; {error}\"\n            ) from error\n    \n>       await self.mount_all(widgets)\nE       TypeError: object NoneType can't be used in 'await' expression\n\nsrc/textual/app.py:2640: TypeError\n----------------------------- Captured stderr call -----------------------------\nTypeError: object NoneType can't be used in 'await' expression\n=============================== warnings summary ===============================\ntests/test_mount.py::test_render_only_after_mount\n  /usr/local/lib/python3.10/site-packages/tornado/ioloop.py:274: DeprecationWarning: There is no current event loop\n    loop = asyncio.get_event_loop()\n\ntests/test_mount.py::test_render_only_after_mount\n  /usr/local/lib/python3.10/site-packages/tornado/platform/asyncio.py:288: DeprecationWarning: There is no current event loop\n    super().initialize(asyncio.get_event_loop(), **kwargs)\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_mount.py::test_render_only_after_mount - TypeError: object ...\n======================== 1 failed, 2 warnings in 0.30s =========================\n\n"], "textual-src/textual/widget.py-move_child": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 6 items\n\ntests/test_widget_child_moving.py FFFFFF                                 [100%]\n\n=================================== FAILURES ===================================\n________________________ test_move_before_permutations _________________________\n\n    async def test_move_before_permutations() -> None:\n        \"\"\"Test the different permutations of moving one widget before another.\"\"\"\n        widgets = [Widget(id=f\"widget-{n}\") for n in range(10)]\n        perms = ((1, 0), (widgets[1], 0), (1, widgets[0]), (widgets[1], widgets[0]))\n        for child, target in perms:\n            async with App().run_test() as pilot:\n                container = Widget(*widgets)\n                await pilot.app.mount(container)\n>               container.move_child(child, before=target)\n\ntests/test_widget_child_moving.py:145: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Widget(), child = 1, before = 0, after = None\n\n    def move_child(\n        self,\n        child: Widget,\n        before: int | str | Widget | None = None,\n        after: int | str | Widget | None = None,\n    ) -> None:\n        \"\"\"Move a child widget within its parent's list of children.\n    \n        Args:\n            child: The child widget to move.\n            before: Child widget or location index to move before.\n            after: Child widget or location index to move after.\n    \n        Raises:\n            WidgetError: If there is a problem with the child or target.\n    \n        Note:\n            Only one of `before` or `after` can be provided. If neither\n            or both are provided a `WidgetError` will be raised.\n        \"\"\"\n        if before is not None and after is not None:\n            raise WidgetError(\"Only one of 'before' or 'after' can be specified\")\n    \n        if before is None and after is None:\n            raise WidgetError(\"Either 'before' or 'after' must be specified\")\n    \n        if child not in self._nodes:\n>           raise WidgetError(f\"Child {child} is not a child of this widget\")\nE           textual.widget.WidgetError: Child 1 is not a child of this widget\n\nsrc/textual/widget.py:1066: WidgetError\n_______________________ test_move_child_after_last_child _______________________\n\n    async def test_move_child_after_last_child() -> None:\n        \"\"\"Test moving after a child after the last child.\"\"\"\n        async with App().run_test() as pilot:\n            widgets = [Widget(id=f\"widget-{n}\") for n in range(10)]\n            container = Widget(*widgets)\n            await pilot.app.mount(container)\n>           container.move_child(widgets[0], after=widgets[-1])\n\ntests/test_widget_child_moving.py:171: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Widget(), child = Widget(id='widget-0'), before = None\nafter = Widget(id='widget-9')\n\n    def move_child(\n        self,\n        child: Widget,\n        before: int | str | Widget | None = None,\n        after: int | str | Widget | None = None,\n    ) -> None:\n        \"\"\"Move a child widget within its parent's list of children.\n    \n        Args:\n            child: The child widget to move.\n            before: Child widget or location index to move before.\n            after: Child widget or location index to move after.\n    \n        Raises:\n            WidgetError: If there is a problem with the child or target.\n    \n        Note:\n            Only one of `before` or `after` can be provided. If neither\n            or both are provided a `WidgetError` will be raised.\n        \"\"\"\n        if before is not None and after is not None:\n            raise WidgetError(\"Only one of 'before' or 'after' can be specified\")\n    \n        if before is None and after is None:\n            raise WidgetError(\"Either 'before' or 'after' must be specified\")\n    \n        if child not in self._nodes:\n            raise WidgetError(f\"Child {child} is not a child of this widget\")\n    \n        current_index = self._nodes.index(child)\n>       self._nodes.remove(child)\nE       AttributeError: 'NodeList' object has no attribute 'remove'. Did you mean: '_remove'?\n\nsrc/textual/widget.py:1069: AttributeError\n_______________________ test_move_past_end_of_child_list _______________________\n\n    async def test_move_past_end_of_child_list() -> None:\n        \"\"\"Test attempting to move past the end of the child list.\"\"\"\n        async with App().run_test() as pilot:\n            widgets = [Widget(id=f\"widget-{n}\") for n in range(10)]\n            container = Widget(*widgets)\n            await pilot.app.mount(container)\n            with pytest.raises(WidgetError):\n>               container.move_child(widgets[0], before=len(widgets) + 10)\n\ntests/test_widget_child_moving.py:124: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Widget(), child = Widget(id='widget-0'), before = 20, after = None\n\n    def move_child(\n        self,\n        child: Widget,\n        before: int | str | Widget | None = None,\n        after: int | str | Widget | None = None,\n    ) -> None:\n        \"\"\"Move a child widget within its parent's list of children.\n    \n        Args:\n            child: The child widget to move.\n            before: Child widget or location index to move before.\n            after: Child widget or location index to move after.\n    \n        Raises:\n            WidgetError: If there is a problem with the child or target.\n    \n        Note:\n            Only one of `before` or `after` can be provided. If neither\n            or both are provided a `WidgetError` will be raised.\n        \"\"\"\n        if before is not None and after is not None:\n            raise WidgetError(\"Only one of 'before' or 'after' can be specified\")\n    \n        if before is None and after is None:\n            raise WidgetError(\"Either 'before' or 'after' must be specified\")\n    \n        if child not in self._nodes:\n            raise WidgetError(f\"Child {child} is not a child of this widget\")\n    \n        current_index = self._nodes.index(child)\n>       self._nodes.remove(child)\nE       AttributeError: 'NodeList' object has no attribute 'remove'. Did you mean: '_remove'?\n\nsrc/textual/widget.py:1069: AttributeError\n_________________ test_move_child_after_last_numeric_location __________________\n\n    async def test_move_child_after_last_numeric_location() -> None:\n        \"\"\"Test moving after a child after the last child's numeric position.\"\"\"\n        async with App().run_test() as pilot:\n            widgets = [Widget(id=f\"widget-{n}\") for n in range(10)]\n            container = Widget(*widgets)\n            await pilot.app.mount(container)\n>           container.move_child(widgets[0], after=widgets[9])\n\ntests/test_widget_child_moving.py:182: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Widget(), child = Widget(id='widget-0'), before = None\nafter = Widget(id='widget-9')\n\n    def move_child(\n        self,\n        child: Widget,\n        before: int | str | Widget | None = None,\n        after: int | str | Widget | None = None,\n    ) -> None:\n        \"\"\"Move a child widget within its parent's list of children.\n    \n        Args:\n            child: The child widget to move.\n            before: Child widget or location index to move before.\n            after: Child widget or location index to move after.\n    \n        Raises:\n            WidgetError: If there is a problem with the child or target.\n    \n        Note:\n            Only one of `before` or `after` can be provided. If neither\n            or both are provided a `WidgetError` will be raised.\n        \"\"\"\n        if before is not None and after is not None:\n            raise WidgetError(\"Only one of 'before' or 'after' can be specified\")\n    \n        if before is None and after is None:\n            raise WidgetError(\"Either 'before' or 'after' must be specified\")\n    \n        if child not in self._nodes:\n            raise WidgetError(f\"Child {child} is not a child of this widget\")\n    \n        current_index = self._nodes.index(child)\n>       self._nodes.remove(child)\nE       AttributeError: 'NodeList' object has no attribute 'remove'. Did you mean: '_remove'?\n\nsrc/textual/widget.py:1069: AttributeError\n_________________________ test_move_after_permutations _________________________\n\n    async def test_move_after_permutations() -> None:\n        \"\"\"Test the different permutations of moving one widget after another.\"\"\"\n        widgets = [Widget(id=f\"widget-{n}\") for n in range(10)]\n        perms = ((0, 1), (widgets[0], 1), (0, widgets[1]), (widgets[0], widgets[1]))\n        for child, target in perms:\n            async with App().run_test() as pilot:\n                container = Widget(*widgets)\n                await pilot.app.mount(container)\n>               container.move_child(child, after=target)\n\ntests/test_widget_child_moving.py:159: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Widget(), child = 0, before = None, after = 1\n\n    def move_child(\n        self,\n        child: Widget,\n        before: int | str | Widget | None = None,\n        after: int | str | Widget | None = None,\n    ) -> None:\n        \"\"\"Move a child widget within its parent's list of children.\n    \n        Args:\n            child: The child widget to move.\n            before: Child widget or location index to move before.\n            after: Child widget or location index to move after.\n    \n        Raises:\n            WidgetError: If there is a problem with the child or target.\n    \n        Note:\n            Only one of `before` or `after` can be provided. If neither\n            or both are provided a `WidgetError` will be raised.\n        \"\"\"\n        if before is not None and after is not None:\n            raise WidgetError(\"Only one of 'before' or 'after' can be specified\")\n    \n        if before is None and after is None:\n            raise WidgetError(\"Either 'before' or 'after' must be specified\")\n    \n        if child not in self._nodes:\n>           raise WidgetError(f\"Child {child} is not a child of this widget\")\nE           textual.widget.WidgetError: Child 0 is not a child of this widget\n\nsrc/textual/widget.py:1066: WidgetError\n______________________ test_move_before_end_of_child_list ______________________\n\n    async def test_move_before_end_of_child_list() -> None:\n        \"\"\"Test attempting to move before the end of the child list.\"\"\"\n        async with App().run_test() as pilot:\n            widgets = [Widget(id=f\"widget-{n}\") for n in range(10)]\n            container = Widget(*widgets)\n            await pilot.app.mount(container)\n            with pytest.raises(WidgetError):\n>               container.move_child(widgets[0], before=-(len(widgets) + 10))\n\ntests/test_widget_child_moving.py:134: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = Widget(), child = Widget(id='widget-0'), before = -20, after = None\n\n    def move_child(\n        self,\n        child: Widget,\n        before: int | str | Widget | None = None,\n        after: int | str | Widget | None = None,\n    ) -> None:\n        \"\"\"Move a child widget within its parent's list of children.\n    \n        Args:\n            child: The child widget to move.\n            before: Child widget or location index to move before.\n            after: Child widget or location index to move after.\n    \n        Raises:\n            WidgetError: If there is a problem with the child or target.\n    \n        Note:\n            Only one of `before` or `after` can be provided. If neither\n            or both are provided a `WidgetError` will be raised.\n        \"\"\"\n        if before is not None and after is not None:\n            raise WidgetError(\"Only one of 'before' or 'after' can be specified\")\n    \n        if before is None and after is None:\n            raise WidgetError(\"Either 'before' or 'after' must be specified\")\n    \n        if child not in self._nodes:\n            raise WidgetError(f\"Child {child} is not a child of this widget\")\n    \n        current_index = self._nodes.index(child)\n>       self._nodes.remove(child)\nE       AttributeError: 'NodeList' object has no attribute 'remove'. Did you mean: '_remove'?\n\nsrc/textual/widget.py:1069: AttributeError\n=============================== warnings summary ===============================\ntests/test_widget_child_moving.py::test_move_before_permutations\ntests/test_widget_child_moving.py::test_move_child_after_last_child\ntests/test_widget_child_moving.py::test_move_past_end_of_child_list\ntests/test_widget_child_moving.py::test_move_child_after_last_numeric_location\ntests/test_widget_child_moving.py::test_move_after_permutations\ntests/test_widget_child_moving.py::test_move_before_end_of_child_list\n  /usr/local/lib/python3.10/site-packages/tornado/ioloop.py:274: DeprecationWarning: There is no current event loop\n    loop = asyncio.get_event_loop()\n\ntests/test_widget_child_moving.py::test_move_before_permutations\n  /usr/local/lib/python3.10/site-packages/tornado/platform/asyncio.py:288: DeprecationWarning: There is no current event loop\n    super().initialize(asyncio.get_event_loop(), **kwargs)\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_widget_child_moving.py::test_move_before_permutations - tex...\nFAILED tests/test_widget_child_moving.py::test_move_child_after_last_child - ...\nFAILED tests/test_widget_child_moving.py::test_move_past_end_of_child_list - ...\nFAILED tests/test_widget_child_moving.py::test_move_child_after_last_numeric_location\nFAILED tests/test_widget_child_moving.py::test_move_after_permutations - text...\nFAILED tests/test_widget_child_moving.py::test_move_before_end_of_child_list\n======================== 6 failed, 7 warnings in 0.36s =========================\n\n"], "textual-src/textual/widget.py-_get_box_model": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 5 items\n\ntests/test_box_model.py FFFFF                                            [100%]\n\n=================================== FAILURES ===================================\n___________________________________ test_max ___________________________________\n\n    def test_max():\n        \"\"\"Check that max_width and max_height are respected.\"\"\"\n        one = Fraction(1)\n    \n        class TestWidget(Widget):\n            def get_content_width(self, container: Size, parent: Size) -> int:\n                assert False, \"must not be called\"\n    \n            def get_content_height(self, container: Size, parent: Size, width: int) -> int:\n                assert False, \"must not be called\"\n    \n        widget = TestWidget()\n        styles = widget.styles\n    \n        styles.width = 100\n        styles.height = 80\n        styles.max_width = 40\n        styles.max_height = 30\n    \n>       box_model = widget._get_box_model(Size(40, 30), Size(80, 24), one, one)\n\ntests/test_box_model.py:166: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = TestWidget(), container = Size(width=40, height=30)\nviewport = Size(width=80, height=24), width_fraction = Fraction(1, 1)\nheight_fraction = Fraction(1, 1)\n\n    def _get_box_model(\n        self,\n        container: Size,\n        viewport: Size,\n        width_fraction: Fraction,\n        height_fraction: Fraction,\n    ) -> BoxModel:\n        \"\"\"Process the box model for this widget.\n    \n        Args:\n            container: The size of the container widget (with a layout)\n            viewport: The viewport size.\n            width_fraction: A fraction used for 1 `fr` unit on the width dimension.\n            height_fraction: A fraction used for 1 `fr` unit on the height dimension.\n    \n        Returns:\n            The size and margin for this widget.\n        \"\"\"\n        styles = self.styles\n>       margin = styles.margin.resolve(container)\nE       AttributeError: 'Spacing' object has no attribute 'resolve'\n\nsrc/textual/widget.py:1181: AttributeError\n__________________________________ test_width __________________________________\n\n    def test_width():\n        \"\"\"Test width settings.\"\"\"\n    \n        one = Fraction(1)\n    \n        class TestWidget(Widget):\n            def get_content_width(self, container: Size, parent: Size) -> int:\n                return 10\n    \n            def get_content_height(self, container: Size, parent: Size, width: int) -> int:\n                return 10\n    \n        widget = TestWidget()\n        styles = widget.styles\n>       box_model = widget._get_box_model(Size(60, 20), Size(80, 24), one, one)\n\ntests/test_box_model.py:61: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = TestWidget(), container = Size(width=60, height=20)\nviewport = Size(width=80, height=24), width_fraction = Fraction(1, 1)\nheight_fraction = Fraction(1, 1)\n\n    def _get_box_model(\n        self,\n        container: Size,\n        viewport: Size,\n        width_fraction: Fraction,\n        height_fraction: Fraction,\n    ) -> BoxModel:\n        \"\"\"Process the box model for this widget.\n    \n        Args:\n            container: The size of the container widget (with a layout)\n            viewport: The viewport size.\n            width_fraction: A fraction used for 1 `fr` unit on the width dimension.\n            height_fraction: A fraction used for 1 `fr` unit on the height dimension.\n    \n        Returns:\n            The size and margin for this widget.\n        \"\"\"\n        styles = self.styles\n>       margin = styles.margin.resolve(container)\nE       AttributeError: 'Spacing' object has no attribute 'resolve'\n\nsrc/textual/widget.py:1181: AttributeError\n_________________________________ test_height __________________________________\n\n    def test_height():\n        \"\"\"Test height settings.\"\"\"\n    \n        one = Fraction(1)\n    \n        class TestWidget(Widget):\n            def get_content_width(self, container: Size, parent: Size) -> int:\n                return 10\n    \n            def get_content_height(self, container: Size, parent: Size, width: int) -> int:\n                return 10\n    \n        widget = TestWidget()\n        styles = widget.styles\n    \n>       box_model = widget._get_box_model(Size(60, 20), Size(80, 24), one, one)\n\ntests/test_box_model.py:111: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = TestWidget(), container = Size(width=60, height=20)\nviewport = Size(width=80, height=24), width_fraction = Fraction(1, 1)\nheight_fraction = Fraction(1, 1)\n\n    def _get_box_model(\n        self,\n        container: Size,\n        viewport: Size,\n        width_fraction: Fraction,\n        height_fraction: Fraction,\n    ) -> BoxModel:\n        \"\"\"Process the box model for this widget.\n    \n        Args:\n            container: The size of the container widget (with a layout)\n            viewport: The viewport size.\n            width_fraction: A fraction used for 1 `fr` unit on the width dimension.\n            height_fraction: A fraction used for 1 `fr` unit on the height dimension.\n    \n        Returns:\n            The size and margin for this widget.\n        \"\"\"\n        styles = self.styles\n>       margin = styles.margin.resolve(container)\nE       AttributeError: 'Spacing' object has no attribute 'resolve'\n\nsrc/textual/widget.py:1181: AttributeError\n___________________________________ test_min ___________________________________\n\n    def test_min():\n        \"\"\"Check that min_width and min_height are respected.\"\"\"\n    \n        one = Fraction(1)\n    \n        class TestWidget(Widget):\n            def get_content_width(self, container: Size, parent: Size) -> int:\n                assert False, \"must not be called\"\n    \n            def get_content_height(self, container: Size, parent: Size, width: int) -> int:\n                assert False, \"must not be called\"\n    \n        widget = TestWidget()\n        styles = widget.styles\n        styles.width = 10\n        styles.height = 5\n        styles.min_width = 40\n        styles.min_height = 30\n    \n>       box_model = widget._get_box_model(Size(40, 30), Size(80, 24), one, one)\n\ntests/test_box_model.py:189: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = TestWidget(), container = Size(width=40, height=30)\nviewport = Size(width=80, height=24), width_fraction = Fraction(1, 1)\nheight_fraction = Fraction(1, 1)\n\n    def _get_box_model(\n        self,\n        container: Size,\n        viewport: Size,\n        width_fraction: Fraction,\n        height_fraction: Fraction,\n    ) -> BoxModel:\n        \"\"\"Process the box model for this widget.\n    \n        Args:\n            container: The size of the container widget (with a layout)\n            viewport: The viewport size.\n            width_fraction: A fraction used for 1 `fr` unit on the width dimension.\n            height_fraction: A fraction used for 1 `fr` unit on the height dimension.\n    \n        Returns:\n            The size and margin for this widget.\n        \"\"\"\n        styles = self.styles\n>       margin = styles.margin.resolve(container)\nE       AttributeError: 'Spacing' object has no attribute 'resolve'\n\nsrc/textual/widget.py:1181: AttributeError\n_______________________________ test_content_box _______________________________\n\n    def test_content_box():\n        one = Fraction(1)\n    \n        class TestWidget(Widget):\n            def get_content_width(self, container: Size, parent: Size) -> int:\n                assert False, \"must not be called\"\n    \n            def get_content_height(self, container: Size, parent: Size) -> int:\n                assert False, \"must not be called\"\n    \n        widget = TestWidget()\n    \n        # border-box is default\n        assert widget.styles.box_sizing == \"border-box\"\n    \n        widget.styles.width = 10\n        widget.styles.height = 8\n        widget.styles.padding = 1\n        widget.styles.border = (\"solid\", \"red\")\n    \n>       box_model = widget._get_box_model(\n            Size(60, 20),\n            Size(80, 24),\n            one,\n            one,\n        )\n\ntests/test_box_model.py:30: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = TestWidget(), container = Size(width=60, height=20)\nviewport = Size(width=80, height=24), width_fraction = Fraction(1, 1)\nheight_fraction = Fraction(1, 1)\n\n    def _get_box_model(\n        self,\n        container: Size,\n        viewport: Size,\n        width_fraction: Fraction,\n        height_fraction: Fraction,\n    ) -> BoxModel:\n        \"\"\"Process the box model for this widget.\n    \n        Args:\n            container: The size of the container widget (with a layout)\n            viewport: The viewport size.\n            width_fraction: A fraction used for 1 `fr` unit on the width dimension.\n            height_fraction: A fraction used for 1 `fr` unit on the height dimension.\n    \n        Returns:\n            The size and margin for this widget.\n        \"\"\"\n        styles = self.styles\n>       margin = styles.margin.resolve(container)\nE       AttributeError: 'Spacing' object has no attribute 'resolve'\n\nsrc/textual/widget.py:1181: AttributeError\n=========================== short test summary info ============================\nFAILED tests/test_box_model.py::test_max - AttributeError: 'Spacing' object h...\nFAILED tests/test_box_model.py::test_width - AttributeError: 'Spacing' object...\nFAILED tests/test_box_model.py::test_height - AttributeError: 'Spacing' objec...\nFAILED tests/test_box_model.py::test_min - AttributeError: 'Spacing' object h...\nFAILED tests/test_box_model.py::test_content_box - AttributeError: 'Spacing' ...\n============================== 5 failed in 0.25s ===============================\n\n"], "textual-src/textual/widget.py-get_content_width": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 3 items\n\ntests/layouts/test_content_dimensions.py ...                             [100%]\n\n============================== 3 passed in 0.10s ===============================\n\n"], "textual-src/textual/widget.py-get_content_height": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 3 items\n\ntests/layouts/test_content_dimensions.py ...                             [100%]\n\n============================== 3 passed in 0.10s ===============================\n\n"], "textual-src/textual/suggester.py-_get_suggestion": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 11 items\n\ntests/suggester/test_suggester.py F......FFFF                            [100%]\n\n=================================== FAILURES ===================================\n_______________________ test_case_insensitive_cache_hits _______________________\n\n    async def test_case_insensitive_cache_hits():\n        count = 0\n    \n        class MySuggester(Suggester):\n            async def get_suggestion(self, value: str):\n                nonlocal count\n                count += 1\n                return value + \"abc\"\n    \n        suggester = MySuggester(use_cache=True, case_sensitive=False)\n        hellos = [\"hello\", \"HELLO\", \"HeLlO\", \"Hello\", \"hELLO\"]\n        for hello in hellos:\n            await suggester._get_suggestion(DOMNode(), hello)\n>       assert count == 1\nE       assert 0 == 1\n\ntests/suggester/test_suggester.py:111: AssertionError\n________________________________ test_cache_on _________________________________\n\n    async def test_cache_on():\n        log = []\n    \n        class MySuggester(Suggester):\n            async def get_suggestion(self, value: str):\n                log.append(value)\n                return value\n    \n        suggester = MySuggester(use_cache=True)\n        await suggester._get_suggestion(DOMNode(), \"hello\")\n>       assert log == [\"hello\"]\nE       AssertionError: assert [] == ['hello']\nE         \nE         Right contains one more item: 'hello'\nE         Use -v to get more diff\n\ntests/suggester/test_suggester.py:34: AssertionError\n__________________ test_suggestion_ready_message_on_cache_hit __________________\n\n    async def test_suggestion_ready_message_on_cache_hit():\n        log = []\n        suggester = FillSuggester(use_cache=True)\n        await suggester._get_suggestion(LogListNode(log), \"hello\")\n>       assert log == [(\"helloxxxxx\", \"hello\")]\nE       AssertionError: assert [] == [('helloxxxxx', 'hello')]\nE         \nE         Right contains one more item: ('helloxxxxx', 'hello')\nE         Use -v to get more diff\n\ntests/suggester/test_suggester.py:74: AssertionError\n________________________________ test_cache_off ________________________________\n\n    async def test_cache_off():\n        log = []\n    \n        class MySuggester(Suggester):\n            async def get_suggestion(self, value: str):\n                log.append(value)\n                return value\n    \n        suggester = MySuggester(use_cache=False)\n        await suggester._get_suggestion(DOMNode(), \"hello\")\n>       assert log == [\"hello\"]\nE       AssertionError: assert [] == ['hello']\nE         \nE         Right contains one more item: 'hello'\nE         Use -v to get more diff\n\ntests/suggester/test_suggester.py:49: AssertionError\n________________________ test_suggestion_ready_message _________________________\n\n    async def test_suggestion_ready_message():\n        log = []\n        suggester = FillSuggester()\n        await suggester._get_suggestion(LogListNode(log), \"hello\")\n>       assert log == [(\"helloxxxxx\", \"hello\")]\nE       AssertionError: assert [] == [('helloxxxxx', 'hello')]\nE         \nE         Right contains one more item: ('helloxxxxx', 'hello')\nE         Use -v to get more diff\n\ntests/suggester/test_suggester.py:58: AssertionError\n=============================== warnings summary ===============================\ntests/suggester/test_suggester.py: 11 warnings\n  /usr/local/lib/python3.10/site-packages/tornado/ioloop.py:274: DeprecationWarning: There is no current event loop\n    loop = asyncio.get_event_loop()\n\ntests/suggester/test_suggester.py::test_case_insensitive_cache_hits\n  /usr/local/lib/python3.10/site-packages/tornado/platform/asyncio.py:288: DeprecationWarning: There is no current event loop\n    super().initialize(asyncio.get_event_loop(), **kwargs)\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/suggester/test_suggester.py::test_case_insensitive_cache_hits - ...\nFAILED tests/suggester/test_suggester.py::test_cache_on - AssertionError: ass...\nFAILED tests/suggester/test_suggester.py::test_suggestion_ready_message_on_cache_hit\nFAILED tests/suggester/test_suggester.py::test_cache_off - AssertionError: as...\nFAILED tests/suggester/test_suggester.py::test_suggestion_ready_message - Ass...\n=================== 5 failed, 6 passed, 12 warnings in 0.12s ===================\n\n"], "textual-src/textual/dom.py-add_class": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/css/test_stylesheet.py .                                           [100%]\n\n============================== 1 passed in 0.11s ===============================\n\n"], "textual-src/textual/reactive.py-_initialize_object": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/test_reactive.py F                                                 [100%]\n\n=================================== FAILURES ===================================\n__________________________ test_reactive_inheritance ___________________________\n\n    async def test_reactive_inheritance():\n        \"\"\"Check that inheritance works as expected for reactives.\"\"\"\n    \n        class Primary(App):\n            foo = reactive(1)\n            bar = reactive(\"bar\")\n    \n        class Secondary(Primary):\n            foo = reactive(2)\n            egg = reactive(\"egg\")\n    \n        class Tertiary(Secondary):\n            baz = reactive(\"baz\")\n    \n        primary = Primary()\n        secondary = Secondary()\n        tertiary = Tertiary()\n    \n        primary_reactive_count = len(primary._reactives)\n    \n        # Secondary adds one new reactive\n        assert len(secondary._reactives) == primary_reactive_count + 1\n    \n>       Reactive._initialize_object(primary)\n\ntests/test_reactive.py:312: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ncls = <class 'textual.reactive.Reactive'>\nobj = Primary(title='Primary', classes={'-dark-mode'})\n\n    @classmethod\n    @classmethod\n    def _initialize_object(cls, obj: Reactable) -> None:\n        \"\"\"Set defaults and call any watchers / computes for the first time.\n    \n        Args:\n            obj: An object with Reactive descriptors\n        \"\"\"\n>       for name, reactive in obj.__class__.__reactive_attributes__.items():\nE       AttributeError: type object 'Primary' has no attribute '__reactive_attributes__'\n\nsrc/textual/reactive.py:186: AttributeError\n=============================== warnings summary ===============================\ntests/test_reactive.py::test_reactive_inheritance\n  /usr/local/lib/python3.10/site-packages/tornado/ioloop.py:274: DeprecationWarning: There is no current event loop\n    loop = asyncio.get_event_loop()\n\ntests/test_reactive.py::test_reactive_inheritance\n  /usr/local/lib/python3.10/site-packages/tornado/platform/asyncio.py:288: DeprecationWarning: There is no current event loop\n    super().initialize(asyncio.get_event_loop(), **kwargs)\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_reactive.py::test_reactive_inheritance - AttributeError: ty...\n======================== 1 failed, 2 warnings in 0.16s =========================\n\n"], "textual-src/textual/message_pump.py-call_after_refresh": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/test_call_x_schedulers.py F                                        [100%]\n\n=================================== FAILURES ===================================\n___________________________ test_call_after_refresh ____________________________\n\n    async def test_call_after_refresh() -> None:\n        \"\"\"Check that call later makes a call after a refresh.\"\"\"\n        app = CallLaterApp()\n    \n        display_count = -1\n    \n        called_event = asyncio.Event()\n    \n        callback_message_pump: MessagePump | None = None\n    \n        def callback() -> None:\n            nonlocal display_count\n            nonlocal callback_message_pump\n            called_event.set()\n            display_count = app.display_count\n            callback_message_pump = active_message_pump.get()\n    \n        async with app.run_test():\n>           app.call_after_refresh(callback)\n\ntests/test_call_x_schedulers.py:45: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/message_pump.py:430: in call_after_refresh\n    self.app.call_after_refresh(callback, *args, **kwargs)\nsrc/textual/message_pump.py:430: in call_after_refresh\n    self.app.call_after_refresh(callback, *args, **kwargs)\nE   RecursionError: maximum recursion depth exceeded while calling a Python object\n!!! Recursion detected (same locals & position)\n=============================== warnings summary ===============================\ntests/test_call_x_schedulers.py::test_call_after_refresh\n  /usr/local/lib/python3.10/site-packages/tornado/ioloop.py:274: DeprecationWarning: There is no current event loop\n    loop = asyncio.get_event_loop()\n\ntests/test_call_x_schedulers.py::test_call_after_refresh\n  /usr/local/lib/python3.10/site-packages/tornado/platform/asyncio.py:288: DeprecationWarning: There is no current event loop\n    super().initialize(asyncio.get_event_loop(), **kwargs)\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_call_x_schedulers.py::test_call_after_refresh - RecursionEr...\n======================== 1 failed, 2 warnings in 0.15s =========================\n\n"], "textual-src/textual/message_pump.py-call_later": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/test_call_x_schedulers.py F                                        [100%]\n\n=================================== FAILURES ===================================\n_______________________________ test_call_later ________________________________\n\nself = CallLaterApp(title='CallLaterApp', classes={'-dark-mode'})\ncallback = <function Pilot._wait_for_screen.<locals>.decrement_counter at 0x7f5471415900>\nargs = (), kwargs = {}\n\n    def call_later(self, callback: Callback, *args: Any, **kwargs: Any) -> bool:\n        \"\"\"Schedule a callback to run after all messages are processed in this object.\n        Positional and keywords arguments are passed to the callable.\n    \n        Args:\n            callback: Callable to call next.\n            *args: Positional arguments to pass to the callable.\n            **kwargs: Keyword arguments to pass to the callable.\n    \n        Returns:\n            `True` if the callback was scheduled, or `False` if the callback could not be\n                scheduled (may occur if the message pump was closed or closing).\n        \"\"\"\n        try:\n>           self._invoke_later(callback, self, *args, **kwargs)\nE           AttributeError: 'CallLaterApp' object has no attribute '_invoke_later'. Did you mean: '_on_invoke_later'?\n\nsrc/textual/message_pump.py:449: AttributeError\n\nDuring handling of the above exception, another exception occurred:\n\nself = CallLaterApp(title='CallLaterApp', classes={'-dark-mode'})\n\n    @asynccontextmanager\n    async def run_test(\n        self,\n        *,\n        headless: bool = True,\n        size: tuple[int, int] | None = (80, 24),\n        tooltips: bool = False,\n        notifications: bool = False,\n        message_hook: Callable[[Message], None] | None = None,\n    ) -> AsyncGenerator[Pilot[ReturnType], None]:\n        \"\"\"An asynchronous context manager for testing apps.\n    \n        !!! tip\n    \n            See the guide for [testing](/guide/testing) Textual apps.\n    \n        Use this to run your app in \"headless\" mode (no output) and drive the app via a [Pilot][textual.pilot.Pilot] object.\n    \n        Example:\n    \n            ```python\n            async with app.run_test() as pilot:\n                await pilot.click(\"#Button.ok\")\n                assert ...\n            ```\n    \n        Args:\n            headless: Run in headless mode (no output or input).\n            size: Force terminal size to `(WIDTH, HEIGHT)`,\n                or None to auto-detect.\n            tooltips: Enable tooltips when testing.\n            notifications: Enable notifications when testing.\n            message_hook: An optional callback that will be called each time any message arrives at any\n                message pump in the app.\n        \"\"\"\n        from .pilot import Pilot\n    \n        app = self\n        app._disable_tooltips = not tooltips\n        app._disable_notifications = not notifications\n        app_ready_event = asyncio.Event()\n    \n        def on_app_ready() -> None:\n            \"\"\"Called when app is ready to process events.\"\"\"\n            app_ready_event.set()\n    \n        async def run_app(app: App) -> None:\n            if message_hook is not None:\n                message_hook_context_var.set(message_hook)\n            app._loop = asyncio.get_running_loop()\n            app._thread_id = threading.get_ident()\n            await app._process_messages(\n                ready_callback=on_app_ready,\n                headless=headless,\n                terminal_size=size,\n            )\n    \n        # Launch the app in the \"background\"\n        active_message_pump.set(app)\n        app_task = create_task(run_app(app), name=f\"run_test {app}\")\n    \n        # Wait until the app has performed all startup routines.\n        await app_ready_event.wait()\n    \n        # Get the app in an active state.\n        app._set_active()\n    \n        # Context manager returns pilot object to manipulate the app\n        try:\n            pilot = Pilot(app)\n>           await pilot._wait_for_screen()\n\nsrc/textual/app.py:1484: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/pilot.py:383: in _wait_for_screen\n    if child.call_later(decrement_counter):\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = CallLaterApp(title='CallLaterApp', classes={'-dark-mode'})\ncallback = <function Pilot._wait_for_screen.<locals>.decrement_counter at 0x7f5471415900>\nargs = (), kwargs = {}\n\n    def call_later(self, callback: Callback, *args: Any, **kwargs: Any) -> bool:\n        \"\"\"Schedule a callback to run after all messages are processed in this object.\n        Positional and keywords arguments are passed to the callable.\n    \n        Args:\n            callback: Callable to call next.\n            *args: Positional arguments to pass to the callable.\n            **kwargs: Keyword arguments to pass to the callable.\n    \n        Returns:\n            `True` if the callback was scheduled, or `False` if the callback could not be\n                scheduled (may occur if the message pump was closed or closing).\n        \"\"\"\n        try:\n            self._invoke_later(callback, self, *args, **kwargs)\n            return True\n>       except errors.MessagePumpError:\nE       NameError: name 'errors' is not defined\n\nsrc/textual/message_pump.py:451: NameError\n\nDuring handling of the above exception, another exception occurred:\n\n    async def test_call_later() -> None:\n        \"\"\"Check that call later makes a call.\"\"\"\n        app = CallLaterApp()\n        called_event = asyncio.Event()\n    \n>       async with app.run_test():\n\ntests/test_call_x_schedulers.py:22: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:199: in __aenter__\n    return await anext(self.gen)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/message_pump.py:618: in _process_messages_loop\n    await invoke(method, event)\nsrc/textual/_callback.py:85: in invoke\n    return await _invoke(callback, *params)\nsrc/textual/_callback.py:47: in _invoke\n    result = await result\nsrc/textual/screen.py:778: in _on_idle\n    self.app.call_later(self.bindings_updated_signal.publish, self)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = CallLaterApp(title='CallLaterApp', classes={'-dark-mode'})\ncallback = <bound method Signal.publish of <Signal owner=Screen(id='_default') name='bindings_updated' subscriptions=[]>>\nargs = (Screen(id='_default'),), kwargs = {}\n\n    def call_later(self, callback: Callback, *args: Any, **kwargs: Any) -> bool:\n        \"\"\"Schedule a callback to run after all messages are processed in this object.\n        Positional and keywords arguments are passed to the callable.\n    \n        Args:\n            callback: Callable to call next.\n            *args: Positional arguments to pass to the callable.\n            **kwargs: Keyword arguments to pass to the callable.\n    \n        Returns:\n            `True` if the callback was scheduled, or `False` if the callback could not be\n                scheduled (may occur if the message pump was closed or closing).\n        \"\"\"\n        try:\n            self._invoke_later(callback, self, *args, **kwargs)\n            return True\n>       except errors.MessagePumpError:\nE       NameError: name 'errors' is not defined\n\nsrc/textual/message_pump.py:451: NameError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/src/textual/message_pump.py:449 in call_later    \u2502\n\u2502                                                                              \u2502\n\u2502   446 \u2502   \u2502   \u2502   \u2502   scheduled (may occur if the message pump was closed or \u2502\n\u2502   447 \u2502   \u2502   \"\"\"                                                            \u2502\n\u2502   448 \u2502   \u2502   try:                                                           \u2502\n\u2502 \u2771 449 \u2502   \u2502   \u2502   self._invoke_later(callback, self, *args, **kwargs)        \u2502\n\u2502   450 \u2502   \u2502   \u2502   return True                                                \u2502\n\u2502   451 \u2502   \u2502   except errors.MessagePumpError:                                \u2502\n\u2502   452 \u2502   \u2502   \u2502   return False                                               \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502     args = (Screen(id='_default'),)                                      \u2502 \u2502\n\u2502 \u2502 callback = <bound method Signal.publish of <Signal                       \u2502 \u2502\n\u2502 \u2502            owner=Screen(id='_default') name='bindings_updated'           \u2502 \u2502\n\u2502 \u2502            subscriptions=[]>>                                            \u2502 \u2502\n\u2502 \u2502   kwargs = {}                                                            \u2502 \u2502\n\u2502 \u2502     self = CallLaterApp(title='CallLaterApp', classes={'-dark-mode'})    \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nAttributeError: 'CallLaterApp' object has no attribute '_invoke_later'\n\nDuring handling of the above exception, another exception occurred:\n\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/src/textual/screen.py:778 in _on_idle            \u2502\n\u2502                                                                              \u2502\n\u2502    775 \u2502   \u2502   finally:                                                      \u2502\n\u2502    776 \u2502   \u2502   \u2502   if self._bindings_updated:                                \u2502\n\u2502    777 \u2502   \u2502   \u2502   \u2502   self._bindings_updated = False                        \u2502\n\u2502 \u2771  778 \u2502   \u2502   \u2502   \u2502   self.app.call_later(self.bindings_updated_signal.publ \u2502\n\u2502    779 \u2502                                                                     \u2502\n\u2502    780 \u2502   def _compositor_refresh(self) -> None:                            \u2502\n\u2502    781 \u2502   \u2502   \"\"\"Perform a compositor refresh.\"\"\"                           \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                                            \u2502\n\u2502 \u2502 event = Idle()                \u2502                                            \u2502\n\u2502 \u2502  self = Screen(id='_default') \u2502                                            \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                                            \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/message_pump.py:451 in call_later    \u2502\n\u2502                                                                              \u2502\n\u2502   448 \u2502   \u2502   try:                                                           \u2502\n\u2502   449 \u2502   \u2502   \u2502   self._invoke_later(callback, self, *args, **kwargs)        \u2502\n\u2502   450 \u2502   \u2502   \u2502   return True                                                \u2502\n\u2502 \u2771 451 \u2502   \u2502   except errors.MessagePumpError:                                \u2502\n\u2502   452 \u2502   \u2502   \u2502   return False                                               \u2502\n\u2502   453                                                                        \u2502\n\u2502   454                                                                        \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502     args = (Screen(id='_default'),)                                      \u2502 \u2502\n\u2502 \u2502 callback = <bound method Signal.publish of <Signal                       \u2502 \u2502\n\u2502 \u2502            owner=Screen(id='_default') name='bindings_updated'           \u2502 \u2502\n\u2502 \u2502            subscriptions=[]>>                                            \u2502 \u2502\n\u2502 \u2502   kwargs = {}                                                            \u2502 \u2502\n\u2502 \u2502     self = CallLaterApp(title='CallLaterApp', classes={'-dark-mode'})    \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nNameError: name 'errors' is not defined\n=============================== warnings summary ===============================\ntests/test_call_x_schedulers.py::test_call_later\n  /usr/local/lib/python3.10/site-packages/tornado/ioloop.py:274: DeprecationWarning: There is no current event loop\n    loop = asyncio.get_event_loop()\n\ntests/test_call_x_schedulers.py::test_call_later\n  /usr/local/lib/python3.10/site-packages/tornado/platform/asyncio.py:288: DeprecationWarning: There is no current event loop\n    super().initialize(asyncio.get_event_loop(), **kwargs)\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/test_call_x_schedulers.py::test_call_later - NameError: name 'er...\n======================== 1 failed, 2 warnings in 0.35s =========================\n\n"], "textual-src/textual/message_pump.py-post_message": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\n============================ no tests ran in 0.09s =============================\n\nERROR: not found: /root/repos/py_data/textual/tests/test_reactive.py::watch_test_var\n(no match in any of [<Module test_reactive.py>])\n\n"], "textual-src/textual/_spatial_map.py-get_values_in_region": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/test_spatial_map.py F                                              [100%]\n\n=================================== FAILURES ===================================\n__________________________ test_get_values_in_region ___________________________\n\n    def test_get_values_in_region() -> None:\n        spatial_map: SpatialMap[str] = SpatialMap(20, 10)\n    \n        spatial_map.insert(\n            [\n                (Region(10, 5, 5, 5), False, False, \"foo\"),\n                (Region(5, 20, 5, 5), False, False, \"bar\"),\n                (Region(0, 0, 40, 1), True, False, \"title\"),\n            ]\n        )\n    \n>       assert spatial_map.get_values_in_region(Region(0, 0, 10, 5)) == [\n            \"title\",\n            \"foo\",\n        ]\n\ntests/test_spatial_map.py:53: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual._spatial_map.SpatialMap object at 0x7fa986270400>\nregion = Region(x=0, y=0, width=10, height=5)\n\n    def get_values_in_region(self, region: Region) -> list[ValueType]:\n        \"\"\"Get a superset of all the values that intersect with a given region.\n    \n        Note that this may return false positives.\n    \n        Args:\n            region: A region.\n    \n        Returns:\n            Values under the region.\n        \"\"\"\n        values = []\n>       for value, value_region in self._values.items():\nE       AttributeError: 'SpatialMap' object has no attribute '_values'\n\nsrc/textual/_spatial_map.py:96: AttributeError\n=========================== short test summary info ============================\nFAILED tests/test_spatial_map.py::test_get_values_in_region - AttributeError:...\n============================== 1 failed in 0.10s ===============================\n\n"], "textual-src/textual/validation.py-validate": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 45 items\n\ntests/test_validation.py .......................................FF....   [100%]\n\n=================================== FAILURES ===================================\n____________________ test_URL_validate[https:///path-False] ____________________\n\nvalue = 'https:///path', expected_result = False\n\n    @pytest.mark.parametrize(\n        \"value, expected_result\",\n        [\n            (\"http://example.com\", True),  # valid URL\n            (\"https://example.com\", True),  # valid URL with https\n            (\"www.example.com\", False),  # missing scheme\n            (\"://example.com\", False),  # invalid URL (no scheme)\n            (\"https:///path\", False),  # missing netloc\n            (\n                \"redis://username:pass[word@localhost:6379/0\",\n                False,\n            ),  # invalid URL characters\n            (\"\", False),  # empty string\n        ],\n    )\n    def test_URL_validate(value, expected_result):\n        validator = URL()\n        result = validator.validate(value)\n>       assert result.is_valid == expected_result\nE       assert True == False\nE        +  where True = ValidationResult(failures=[]).is_valid\n\ntests/test_validation.py:201: AssertionError\n_____ test_URL_validate[redis://username:pass[word@localhost:6379/0-False] _____\n\nvalue = 'redis://username:pass[word@localhost:6379/0', expected_result = False\n\n    @pytest.mark.parametrize(\n        \"value, expected_result\",\n        [\n            (\"http://example.com\", True),  # valid URL\n            (\"https://example.com\", True),  # valid URL with https\n            (\"www.example.com\", False),  # missing scheme\n            (\"://example.com\", False),  # invalid URL (no scheme)\n            (\"https:///path\", False),  # missing netloc\n            (\n                \"redis://username:pass[word@localhost:6379/0\",\n                False,\n            ),  # invalid URL characters\n            (\"\", False),  # empty string\n        ],\n    )\n    def test_URL_validate(value, expected_result):\n        validator = URL()\n>       result = validator.validate(value)\n\ntests/test_validation.py:200: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/validation.py:490: in validate\n    parsed_url = urlparse(value)\n/usr/local/lib/python3.10/urllib/parse.py:393: in urlparse\n    splitresult = urlsplit(url, scheme, allow_fragments)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nurl = '/0', scheme = 'redis', allow_fragments = True\n\n    def urlsplit(url, scheme='', allow_fragments=True):\n        \"\"\"Parse a URL into 5 components:\n        <scheme>://<netloc>/<path>?<query>#<fragment>\n    \n        The result is a named 5-tuple with fields corresponding to the\n        above. It is either a SplitResult or SplitResultBytes object,\n        depending on the type of the url parameter.\n    \n        The username, password, hostname, and port sub-components of netloc\n        can also be accessed as attributes of the returned object.\n    \n        The scheme argument provides the default value of the scheme\n        component when no scheme is found in url.\n    \n        If allow_fragments is False, no attempt is made to separate the\n        fragment component from the previous component, which can be either\n        path or query.\n    \n        Note that % escapes are not expanded.\n        \"\"\"\n    \n        url, scheme, _coerce_result = _coerce_args(url, scheme)\n    \n        for b in _UNSAFE_URL_BYTES_TO_REMOVE:\n            url = url.replace(b, \"\")\n            scheme = scheme.replace(b, \"\")\n    \n        allow_fragments = bool(allow_fragments)\n        key = url, scheme, allow_fragments, type(url), type(scheme)\n        cached = _parse_cache.get(key, None)\n        if cached:\n            return _coerce_result(cached)\n        if len(_parse_cache) >= MAX_CACHE_SIZE: # avoid runaway growth\n            clear_cache()\n        netloc = query = fragment = ''\n        i = url.find(':')\n        if i > 0:\n            for c in url[:i]:\n                if c not in scheme_chars:\n                    break\n            else:\n                scheme, url = url[:i].lower(), url[i+1:]\n    \n        if url[:2] == '//':\n            netloc, url = _splitnetloc(url, 2)\n            if (('[' in netloc and ']' not in netloc) or\n                    (']' in netloc and '[' not in netloc)):\n>               raise ValueError(\"Invalid IPv6 URL\")\nE               ValueError: Invalid IPv6 URL\n\n/usr/local/lib/python3.10/urllib/parse.py:484: ValueError\n=========================== short test summary info ============================\nFAILED tests/test_validation.py::test_URL_validate[https:///path-False] - ass...\nFAILED tests/test_validation.py::test_URL_validate[redis://username:pass[word@localhost:6379/0-False]\n========================= 2 failed, 43 passed in 0.15s =========================\n\n"], "textual-src/textual/geometry.py-clamp": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 1 item\n\ntests/test_geometry.py .                                                 [100%]\n\n============================== 1 passed in 0.09s ===============================\n\n"], "textual-src/textual/constants.py-_get_textual_animations": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 0 items / 1 error\n\n==================================== ERRORS ====================================\n________ ERROR collecting tests/animations/test_environment_variable.py ________\ntests/animations/test_environment_variable.py:3: in <module>\n    from textual import constants\nsrc/textual/__init__.py:9: in <module>\n    from . import constants\nsrc/textual/constants.py:127: in <module>\n    TEXTUAL_ANIMATIONS: AnimationLevel = _get_textual_animations()\nsrc/textual/constants.py:81: in _get_textual_animations\n    return AnimationLevel.FULL\n/usr/local/lib/python3.10/typing.py:969: in __getattr__\n    return getattr(self.__origin__, attr)\n/usr/local/lib/python3.10/typing.py:374: in __getattr__\n    raise AttributeError(item)\nE   AttributeError: FULL\n=========================== short test summary info ============================\nERROR tests/animations/test_environment_variable.py - AttributeError: FULL\n=============================== 1 error in 0.09s ===============================\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_environment_variable.py::test__get_textual_animations\n\n"], "textual-src/textual/color.py-parse": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 0 items / 14 errors\n\n==================================== ERRORS ====================================\n_____________________ ERROR collecting tests/test_color.py _____________________\ntests/test_color.py:4: in <module>\n    from textual.color import Color, Gradient, Lab, lab_to_rgb, rgb_to_lab\nsrc/textual/__init__.py:12: in <module>\n    from ._on import on\nsrc/textual/_on.py:5: in <module>\n    from .css.model import SelectorSet\nsrc/textual/css/model.py:11: in <module>\n    from .styles import Styles\nsrc/textual/css/styles.py:15: in <module>\n    from ..color import Color\nsrc/textual/color.py:137: in <module>\n    class Color(NamedTuple):\nsrc/textual/color.py:396: in Color\n    def parse(cls, color_text: str | Color) -> Color:\n/usr/local/lib/python3.10/functools.py:519: in decorating_function\n    wrapper = _lru_cache_wrapper(user_function, maxsize, typed, _CacheInfo)\nE   TypeError: the first argument must be callable\n_______________ ERROR collecting tests/test_style_importance.py ________________\ntests/test_style_importance.py:1: in <module>\n    from textual.app import App, ComposeResult\nsrc/textual/__init__.py:12: in <module>\n    from ._on import on\nsrc/textual/_on.py:5: in <module>\n    from .css.model import SelectorSet\nsrc/textual/css/model.py:11: in <module>\n    from .styles import Styles\nsrc/textual/css/styles.py:15: in <module>\n    from ..color import Color\nsrc/textual/color.py:137: in <module>\n    class Color(NamedTuple):\nsrc/textual/color.py:396: in Color\n    def parse(cls, color_text: str | Color) -> Color:\n/usr/local/lib/python3.10/functools.py:519: in decorating_function\n    wrapper = _lru_cache_wrapper(user_function, maxsize, typed, _CacheInfo)\nE   TypeError: the first argument must be callable\n________ ERROR collecting tests/animations/test_disabling_animations.py ________\ntests/animations/test_disabling_animations.py:5: in <module>\n    from textual.app import App, ComposeResult\nsrc/textual/__init__.py:12: in <module>\n    from ._on import on\nsrc/textual/_on.py:5: in <module>\n    from .css.model import SelectorSet\nsrc/textual/css/model.py:11: in <module>\n    from .styles import Styles\nsrc/textual/css/styles.py:15: in <module>\n    from ..color import Color\nsrc/textual/color.py:137: in <module>\n    class Color(NamedTuple):\nsrc/textual/color.py:396: in Color\n    def parse(cls, color_text: str | Color) -> Color:\n/usr/local/lib/python3.10/functools.py:519: in decorating_function\n    wrapper = _lru_cache_wrapper(user_function, maxsize, typed, _CacheInfo)\nE   TypeError: the first argument must be callable\n________________ ERROR collecting tests/css/test_nested_css.py _________________\ntests/css/test_nested_css.py:5: in <module>\n    from textual.app import App, ComposeResult\nsrc/textual/__init__.py:12: in <module>\n    from ._on import on\nsrc/textual/_on.py:5: in <module>\n    from .css.model import SelectorSet\nsrc/textual/css/model.py:11: in <module>\n    from .styles import Styles\nsrc/textual/css/styles.py:15: in <module>\n    from ..color import Color\nsrc/textual/color.py:137: in <module>\n    class Color(NamedTuple):\nsrc/textual/color.py:396: in Color\n    def parse(cls, color_text: str | Color) -> Color:\n/usr/local/lib/python3.10/functools.py:519: in decorating_function\n    wrapper = _lru_cache_wrapper(user_function, maxsize, typed, _CacheInfo)\nE   TypeError: the first argument must be callable\n___________________ ERROR collecting tests/css/test_parse.py ___________________\ntests/css/test_parse.py:5: in <module>\n    from textual.color import Color\nsrc/textual/__init__.py:12: in <module>\n    from ._on import on\nsrc/textual/_on.py:5: in <module>\n    from .css.model import SelectorSet\nsrc/textual/css/model.py:11: in <module>\n    from .styles import Styles\nsrc/textual/css/styles.py:15: in <module>\n    from ..color import Color\nsrc/textual/color.py:137: in <module>\n    class Color(NamedTuple):\nsrc/textual/color.py:396: in Color\n    def parse(cls, color_text: str | Color) -> Color:\n/usr/local/lib/python3.10/functools.py:519: in decorating_function\n    wrapper = _lru_cache_wrapper(user_function, maxsize, typed, _CacheInfo)\nE   TypeError: the first argument must be callable\n__________________ ERROR collecting tests/css/test_styles.py ___________________\ntests/css/test_styles.py:6: in <module>\n    from textual.color import Color\nsrc/textual/__init__.py:12: in <module>\n    from ._on import on\nsrc/textual/_on.py:5: in <module>\n    from .css.model import SelectorSet\nsrc/textual/css/model.py:11: in <module>\n    from .styles import Styles\nsrc/textual/css/styles.py:15: in <module>\n    from ..color import Color\nsrc/textual/color.py:137: in <module>\n    class Color(NamedTuple):\nsrc/textual/color.py:396: in Color\n    def parse(cls, color_text: str | Color) -> Color:\n/usr/local/lib/python3.10/functools.py:519: in decorating_function\n    wrapper = _lru_cache_wrapper(user_function, maxsize, typed, _CacheInfo)\nE   TypeError: the first argument must be callable\n___________ ERROR collecting docs/examples/guide/testing/test_rgb.py ___________\ndocs/examples/guide/testing/test_rgb.py:1: in <module>\n    from rgb import RGBApp\ndocs/examples/guide/testing/rgb.py:1: in <module>\n    from textual import on\nsrc/textual/__init__.py:12: in <module>\n    from ._on import on\nsrc/textual/_on.py:5: in <module>\n    from .css.model import SelectorSet\nsrc/textual/css/model.py:11: in <module>\n    from .styles import Styles\nsrc/textual/css/styles.py:15: in <module>\n    from ..color import Color\nsrc/textual/color.py:137: in <module>\n    class Color(NamedTuple):\nsrc/textual/color.py:396: in Color\n    def parse(cls, color_text: str | Color) -> Color:\n/usr/local/lib/python3.10/functools.py:519: in decorating_function\n    wrapper = _lru_cache_wrapper(user_function, maxsize, typed, _CacheInfo)\nE   TypeError: the first argument must be callable\n__________________ ERROR collecting tests/css/test_initial.py __________________\ntests/css/test_initial.py:1: in <module>\n    from textual.app import App, ComposeResult\nsrc/textual/__init__.py:12: in <module>\n    from ._on import on\nsrc/textual/_on.py:5: in <module>\n    from .css.model import SelectorSet\nsrc/textual/css/model.py:11: in <module>\n    from .styles import Styles\nsrc/textual/css/styles.py:15: in <module>\n    from ..color import Color\nsrc/textual/color.py:137: in <module>\n    class Color(NamedTuple):\nsrc/textual/color.py:396: in Color\n    def parse(cls, color_text: str | Color) -> Color:\n/usr/local/lib/python3.10/functools.py:519: in decorating_function\n    wrapper = _lru_cache_wrapper(user_function, maxsize, typed, _CacheInfo)\nE   TypeError: the first argument must be callable\n________________ ERROR collecting tests/css/test_inheritance.py ________________\ntests/css/test_inheritance.py:3: in <module>\n    from textual.app import App, ComposeResult\nsrc/textual/__init__.py:12: in <module>\n    from ._on import on\nsrc/textual/_on.py:5: in <module>\n    from .css.model import SelectorSet\nsrc/textual/css/model.py:11: in <module>\n    from .styles import Styles\nsrc/textual/css/styles.py:15: in <module>\n    from ..color import Color\nsrc/textual/color.py:137: in <module>\n    class Color(NamedTuple):\nsrc/textual/color.py:396: in Color\n    def parse(cls, color_text: str | Color) -> Color:\n/usr/local/lib/python3.10/functools.py:519: in decorating_function\n    wrapper = _lru_cache_wrapper(user_function, maxsize, typed, _CacheInfo)\nE   TypeError: the first argument must be callable\n__________________ ERROR collecting tests/test_line_filter.py __________________\ntests/test_line_filter.py:4: in <module>\n    from textual.color import Color\nsrc/textual/__init__.py:12: in <module>\n    from ._on import on\nsrc/textual/_on.py:5: in <module>\n    from .css.model import SelectorSet\nsrc/textual/css/model.py:11: in <module>\n    from .styles import Styles\nsrc/textual/css/styles.py:15: in <module>\n    from ..color import Color\nsrc/textual/color.py:137: in <module>\n    class Color(NamedTuple):\nsrc/textual/color.py:396: in Color\n    def parse(cls, color_text: str | Color) -> Color:\n/usr/local/lib/python3.10/functools.py:519: in decorating_function\n    wrapper = _lru_cache_wrapper(user_function, maxsize, typed, _CacheInfo)\nE   TypeError: the first argument must be callable\n_________________ ERROR collecting tests/test_styles_cache.py __________________\ntests/test_styles_cache.py:7: in <module>\n    from textual._styles_cache import StylesCache\nsrc/textual/__init__.py:12: in <module>\n    from ._on import on\nsrc/textual/_on.py:5: in <module>\n    from .css.model import SelectorSet\nsrc/textual/css/model.py:11: in <module>\n    from .styles import Styles\nsrc/textual/css/styles.py:15: in <module>\n    from ..color import Color\nsrc/textual/color.py:137: in <module>\n    class Color(NamedTuple):\nsrc/textual/color.py:396: in Color\n    def parse(cls, color_text: str | Color) -> Color:\n/usr/local/lib/python3.10/functools.py:519: in decorating_function\n    wrapper = _lru_cache_wrapper(user_function, maxsize, typed, _CacheInfo)\nE   TypeError: the first argument must be callable\n________________ ERROR collecting tests/css/test_stylesheet.py _________________\ntests/css/test_stylesheet.py:5: in <module>\n    from textual.color import Color\nsrc/textual/__init__.py:12: in <module>\n    from ._on import on\nsrc/textual/_on.py:5: in <module>\n    from .css.model import SelectorSet\nsrc/textual/css/model.py:11: in <module>\n    from .styles import Styles\nsrc/textual/css/styles.py:15: in <module>\n    from ..color import Color\nsrc/textual/color.py:137: in <module>\n    class Color(NamedTuple):\nsrc/textual/color.py:396: in Color\n    def parse(cls, color_text: str | Color) -> Color:\n/usr/local/lib/python3.10/functools.py:519: in decorating_function\n    wrapper = _lru_cache_wrapper(user_function, maxsize, typed, _CacheInfo)\nE   TypeError: the first argument must be callable\n_____________________ ERROR collecting tests/test_strip.py _____________________\ntests/test_strip.py:5: in <module>\n    from textual._segment_tools import NoCellPositionForIndex\nsrc/textual/__init__.py:12: in <module>\n    from ._on import on\nsrc/textual/_on.py:5: in <module>\n    from .css.model import SelectorSet\nsrc/textual/css/model.py:11: in <module>\n    from .styles import Styles\nsrc/textual/css/styles.py:15: in <module>\n    from ..color import Color\nsrc/textual/color.py:137: in <module>\n    class Color(NamedTuple):\nsrc/textual/color.py:396: in Color\n    def parse(cls, color_text: str | Color) -> Color:\n/usr/local/lib/python3.10/functools.py:519: in decorating_function\n    wrapper = _lru_cache_wrapper(user_function, maxsize, typed, _CacheInfo)\nE   TypeError: the first argument must be callable\n_______________ ERROR collecting tests/test_style_properties.py ________________\ntests/test_style_properties.py:4: in <module>\n    from textual.color import Color\nsrc/textual/__init__.py:12: in <module>\n    from ._on import on\nsrc/textual/_on.py:5: in <module>\n    from .css.model import SelectorSet\nsrc/textual/css/model.py:11: in <module>\n    from .styles import Styles\nsrc/textual/css/styles.py:15: in <module>\n    from ..color import Color\nsrc/textual/color.py:137: in <module>\n    class Color(NamedTuple):\nsrc/textual/color.py:396: in Color\n    def parse(cls, color_text: str | Color) -> Color:\n/usr/local/lib/python3.10/functools.py:519: in decorating_function\n    wrapper = _lru_cache_wrapper(user_function, maxsize, typed, _CacheInfo)\nE   TypeError: the first argument must be callable\n=========================== short test summary info ============================\nERROR tests/test_color.py - TypeError: the first argument must be callable\nERROR tests/test_style_importance.py - TypeError: the first argument must be ...\nERROR tests/animations/test_disabling_animations.py - TypeError: the first ar...\nERROR tests/css/test_nested_css.py - TypeError: the first argument must be ca...\nERROR tests/css/test_parse.py - TypeError: the first argument must be callable\nERROR tests/css/test_styles.py - TypeError: the first argument must be callable\nERROR docs/examples/guide/testing/test_rgb.py - TypeError: the first argument...\nERROR tests/css/test_initial.py - TypeError: the first argument must be callable\nERROR tests/css/test_inheritance.py - TypeError: the first argument must be c...\nERROR tests/test_line_filter.py - TypeError: the first argument must be callable\nERROR tests/test_styles_cache.py - TypeError: the first argument must be call...\nERROR tests/css/test_stylesheet.py - TypeError: the first argument must be ca...\nERROR tests/test_strip.py - TypeError: the first argument must be callable\nERROR tests/test_style_properties.py - TypeError: the first argument must be ...\n============================== 14 errors in 0.54s ==============================\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_color.py::test_color_parse\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_color.py::test_color_parse_input_has_spaces\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_style_importance.py::test_outline_importance\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_disabling_animations.py::test_style_animations_via_animate_are_disabled_on_basic\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_nested_css.py::test_rule_declaration_after_nested\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_parse.py::test_background\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_disabling_animations.py::test_style_animations_via_animate_are_disabled_on_none\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_styles.py::test_render_styles_border\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_color.py::test_color_parse_clamp\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_color.py::test_color_parse_hsla_negative_degrees\n\nERROR: found no collectors for /root/repos/py_data/textual/docs/examples/guide/testing/test_rgb.py::test_keys\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_parse.py::test_opacity_invalid_value\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_initial.py::test_initial_default\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_styles.py::test_merge\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_parse.py::test_type_starts_with_number\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_disabling_animations.py::test_style_animations_via_animate_work_on_full\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_inheritance.py::test_inheritance\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_parse.py::test_combined_type_starts_with_number\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_line_filter.py::test_dim_apply\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_parse.py::test_text_align_invalid\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_styles_cache.py::test_crop\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_disabling_animations.py::test_style_animations_via_transition_are_disabled_on_none\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_styles_cache.py::test_outline\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_stylesheet.py::test_did_you_mean_for_css_property_names\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_color.py::test_color_parse_hsl_negative_degrees\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_parse.py::test_invalid_layout_name\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_stylesheet.py::test_did_you_mean_for_color_names\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_styles.py::test_set_rule\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_styles_cache.py::test_dirty_cache\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_disabling_animations.py::test_style_animations_via_transition_work_on_full\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_styles.py::test_merge_rules\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_color.py::test_color_parse_color\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_styles.py::test_get_rules\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_styles_cache.py::test_border\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_nested_css.py::test_pseudo_classes_work_in_nested_css\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_stylesheet.py::test_color_property_parsing\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_strip.py::test_apply_filter\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/animations/test_disabling_animations.py::test_style_animations_via_transition_are_disabled_on_basic\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_styles_cache.py::test_padding_border\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_parse.py::test_foreground\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_nested_css.py::test_lists_of_selectors_in_nested_css\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_nested_css.py::test_parse_errors\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_style_importance.py::test_border_importance\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_color.py::test_gradient_errors\n\nERROR: found no collectors for /root/repos/py_data/textual/docs/examples/guide/testing/test_rgb.py::test_buttons\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_styles_cache.py::test_no_styles\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_styles_cache.py::test_padding\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_styles.py::test_reset\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_nested_css.py::test_nest_app\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_initial.py::test_initial\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_parse.py::test_unknown_easing_function\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_parse.py::test_parse_bad_pseudo_selector\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_stylesheet.py::test_did_you_mean_for_property_names_in_nested_css\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/css/test_parse.py::test_parse_bad_pseudo_selector_with_suggestion\n\nERROR: found no collectors for /root/repos/py_data/textual/tests/test_style_properties.py::test_box_normalization\n\n"], "textual-src/textual/_slug.py-slug": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 34 items\n\ntests/test_slug.py ..................FFFFFFFFFFFFFFFF                    [100%]\n\n=================================== FAILURES ===================================\n________________________ test_tracked_slugs[test-test] _________________________\n\ntracker = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = 'test'\nexpected = 'test'\n\n    @pytest.mark.parametrize(\n        \"text, expected\",\n        [\n            (\"test\", \"test\"),\n            (\"test\", \"test-1\"),\n            (\"test\", \"test-2\"),\n            (\"-test-\", \"-test-\"),\n            (\"-test-\", \"-test--1\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst\"),\n            (\"t\u00ebst\", \"t%C3%ABst-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst-2\"),\n            (\"test\ud83d\ude42test\", \"testtest\"),\n            (\"test\ud83e\udd37test\", \"testtest-1\"),\n            (\"test\ud83e\udd37\ud83c\udffb\u200d\u2640\ufe0ftest\", \"testtest-2\"),\n            (\"test\", \"test-3\"),\n            (\"test\", \"test-4\"),\n            (\" test \", \"test-5\"),\n        ],\n    )\n    def test_tracked_slugs(tracker: TrackedSlugs, text: str, expected: str) -> None:\n        \"\"\"The tracked slugging class should produce the expected slugs.\"\"\"\n>       assert tracker.slug(text) == expected\n\ntests/test_slug.py:62: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = 'test'\n\n    def slug(self, text: str) -> str:\n        \"\"\"Create a Markdown-friendly unique slug from the given text.\n    \n        Args:\n            text: The text to generate a slug from.\n    \n        Returns:\n            A slug for the given text.\n        \"\"\"\n        # Convert to lowercase\n        slug = text.lower()\n    \n        # Replace spaces with hyphens\n        slug = slug.replace(\" \", \"-\")\n    \n        # Remove any non-alphanumeric characters (except hyphens)\n        slug = \"\".join(char for char in slug if char.isalnum() or char == \"-\")\n    \n        # Remove any leading or trailing hyphens\n        slug = slug.strip(\"-\")\n    \n        # Ensure uniqueness by appending a number if necessary\n        original_slug = slug\n        counter = 1\n>       while slug in self.existing_slugs:\nE       AttributeError: 'TrackedSlugs' object has no attribute 'existing_slugs'\n\nsrc/textual/_slug.py:126: AttributeError\n_______________________ test_tracked_slugs[test-test-1] ________________________\n\ntracker = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = 'test'\nexpected = 'test-1'\n\n    @pytest.mark.parametrize(\n        \"text, expected\",\n        [\n            (\"test\", \"test\"),\n            (\"test\", \"test-1\"),\n            (\"test\", \"test-2\"),\n            (\"-test-\", \"-test-\"),\n            (\"-test-\", \"-test--1\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst\"),\n            (\"t\u00ebst\", \"t%C3%ABst-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst-2\"),\n            (\"test\ud83d\ude42test\", \"testtest\"),\n            (\"test\ud83e\udd37test\", \"testtest-1\"),\n            (\"test\ud83e\udd37\ud83c\udffb\u200d\u2640\ufe0ftest\", \"testtest-2\"),\n            (\"test\", \"test-3\"),\n            (\"test\", \"test-4\"),\n            (\" test \", \"test-5\"),\n        ],\n    )\n    def test_tracked_slugs(tracker: TrackedSlugs, text: str, expected: str) -> None:\n        \"\"\"The tracked slugging class should produce the expected slugs.\"\"\"\n>       assert tracker.slug(text) == expected\n\ntests/test_slug.py:62: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = 'test'\n\n    def slug(self, text: str) -> str:\n        \"\"\"Create a Markdown-friendly unique slug from the given text.\n    \n        Args:\n            text: The text to generate a slug from.\n    \n        Returns:\n            A slug for the given text.\n        \"\"\"\n        # Convert to lowercase\n        slug = text.lower()\n    \n        # Replace spaces with hyphens\n        slug = slug.replace(\" \", \"-\")\n    \n        # Remove any non-alphanumeric characters (except hyphens)\n        slug = \"\".join(char for char in slug if char.isalnum() or char == \"-\")\n    \n        # Remove any leading or trailing hyphens\n        slug = slug.strip(\"-\")\n    \n        # Ensure uniqueness by appending a number if necessary\n        original_slug = slug\n        counter = 1\n>       while slug in self.existing_slugs:\nE       AttributeError: 'TrackedSlugs' object has no attribute 'existing_slugs'\n\nsrc/textual/_slug.py:126: AttributeError\n_______________________ test_tracked_slugs[test-test-2] ________________________\n\ntracker = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = 'test'\nexpected = 'test-2'\n\n    @pytest.mark.parametrize(\n        \"text, expected\",\n        [\n            (\"test\", \"test\"),\n            (\"test\", \"test-1\"),\n            (\"test\", \"test-2\"),\n            (\"-test-\", \"-test-\"),\n            (\"-test-\", \"-test--1\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst\"),\n            (\"t\u00ebst\", \"t%C3%ABst-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst-2\"),\n            (\"test\ud83d\ude42test\", \"testtest\"),\n            (\"test\ud83e\udd37test\", \"testtest-1\"),\n            (\"test\ud83e\udd37\ud83c\udffb\u200d\u2640\ufe0ftest\", \"testtest-2\"),\n            (\"test\", \"test-3\"),\n            (\"test\", \"test-4\"),\n            (\" test \", \"test-5\"),\n        ],\n    )\n    def test_tracked_slugs(tracker: TrackedSlugs, text: str, expected: str) -> None:\n        \"\"\"The tracked slugging class should produce the expected slugs.\"\"\"\n>       assert tracker.slug(text) == expected\n\ntests/test_slug.py:62: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = 'test'\n\n    def slug(self, text: str) -> str:\n        \"\"\"Create a Markdown-friendly unique slug from the given text.\n    \n        Args:\n            text: The text to generate a slug from.\n    \n        Returns:\n            A slug for the given text.\n        \"\"\"\n        # Convert to lowercase\n        slug = text.lower()\n    \n        # Replace spaces with hyphens\n        slug = slug.replace(\" \", \"-\")\n    \n        # Remove any non-alphanumeric characters (except hyphens)\n        slug = \"\".join(char for char in slug if char.isalnum() or char == \"-\")\n    \n        # Remove any leading or trailing hyphens\n        slug = slug.strip(\"-\")\n    \n        # Ensure uniqueness by appending a number if necessary\n        original_slug = slug\n        counter = 1\n>       while slug in self.existing_slugs:\nE       AttributeError: 'TrackedSlugs' object has no attribute 'existing_slugs'\n\nsrc/textual/_slug.py:126: AttributeError\n______________________ test_tracked_slugs[-test---test-] _______________________\n\ntracker = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = '-test-'\nexpected = '-test-'\n\n    @pytest.mark.parametrize(\n        \"text, expected\",\n        [\n            (\"test\", \"test\"),\n            (\"test\", \"test-1\"),\n            (\"test\", \"test-2\"),\n            (\"-test-\", \"-test-\"),\n            (\"-test-\", \"-test--1\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst\"),\n            (\"t\u00ebst\", \"t%C3%ABst-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst-2\"),\n            (\"test\ud83d\ude42test\", \"testtest\"),\n            (\"test\ud83e\udd37test\", \"testtest-1\"),\n            (\"test\ud83e\udd37\ud83c\udffb\u200d\u2640\ufe0ftest\", \"testtest-2\"),\n            (\"test\", \"test-3\"),\n            (\"test\", \"test-4\"),\n            (\" test \", \"test-5\"),\n        ],\n    )\n    def test_tracked_slugs(tracker: TrackedSlugs, text: str, expected: str) -> None:\n        \"\"\"The tracked slugging class should produce the expected slugs.\"\"\"\n>       assert tracker.slug(text) == expected\n\ntests/test_slug.py:62: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = '-test-'\n\n    def slug(self, text: str) -> str:\n        \"\"\"Create a Markdown-friendly unique slug from the given text.\n    \n        Args:\n            text: The text to generate a slug from.\n    \n        Returns:\n            A slug for the given text.\n        \"\"\"\n        # Convert to lowercase\n        slug = text.lower()\n    \n        # Replace spaces with hyphens\n        slug = slug.replace(\" \", \"-\")\n    \n        # Remove any non-alphanumeric characters (except hyphens)\n        slug = \"\".join(char for char in slug if char.isalnum() or char == \"-\")\n    \n        # Remove any leading or trailing hyphens\n        slug = slug.strip(\"-\")\n    \n        # Ensure uniqueness by appending a number if necessary\n        original_slug = slug\n        counter = 1\n>       while slug in self.existing_slugs:\nE       AttributeError: 'TrackedSlugs' object has no attribute 'existing_slugs'\n\nsrc/textual/_slug.py:126: AttributeError\n_____________________ test_tracked_slugs[-test---test--1] ______________________\n\ntracker = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = '-test-'\nexpected = '-test--1'\n\n    @pytest.mark.parametrize(\n        \"text, expected\",\n        [\n            (\"test\", \"test\"),\n            (\"test\", \"test-1\"),\n            (\"test\", \"test-2\"),\n            (\"-test-\", \"-test-\"),\n            (\"-test-\", \"-test--1\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst\"),\n            (\"t\u00ebst\", \"t%C3%ABst-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst-2\"),\n            (\"test\ud83d\ude42test\", \"testtest\"),\n            (\"test\ud83e\udd37test\", \"testtest-1\"),\n            (\"test\ud83e\udd37\ud83c\udffb\u200d\u2640\ufe0ftest\", \"testtest-2\"),\n            (\"test\", \"test-3\"),\n            (\"test\", \"test-4\"),\n            (\" test \", \"test-5\"),\n        ],\n    )\n    def test_tracked_slugs(tracker: TrackedSlugs, text: str, expected: str) -> None:\n        \"\"\"The tracked slugging class should produce the expected slugs.\"\"\"\n>       assert tracker.slug(text) == expected\n\ntests/test_slug.py:62: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = '-test-'\n\n    def slug(self, text: str) -> str:\n        \"\"\"Create a Markdown-friendly unique slug from the given text.\n    \n        Args:\n            text: The text to generate a slug from.\n    \n        Returns:\n            A slug for the given text.\n        \"\"\"\n        # Convert to lowercase\n        slug = text.lower()\n    \n        # Replace spaces with hyphens\n        slug = slug.replace(\" \", \"-\")\n    \n        # Remove any non-alphanumeric characters (except hyphens)\n        slug = \"\".join(char for char in slug if char.isalnum() or char == \"-\")\n    \n        # Remove any leading or trailing hyphens\n        slug = slug.strip(\"-\")\n    \n        # Ensure uniqueness by appending a number if necessary\n        original_slug = slug\n        counter = 1\n>       while slug in self.existing_slugs:\nE       AttributeError: 'TrackedSlugs' object has no attribute 'existing_slugs'\n\nsrc/textual/_slug.py:126: AttributeError\n____ test_tracked_slugs[test!\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test-test-_test] ____\n\ntracker = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>\ntext = 'test!\"#$%&\\'()*+,-./:;<=>?@[]^_`{|}~test', expected = 'test-_test'\n\n    @pytest.mark.parametrize(\n        \"text, expected\",\n        [\n            (\"test\", \"test\"),\n            (\"test\", \"test-1\"),\n            (\"test\", \"test-2\"),\n            (\"-test-\", \"-test-\"),\n            (\"-test-\", \"-test--1\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst\"),\n            (\"t\u00ebst\", \"t%C3%ABst-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst-2\"),\n            (\"test\ud83d\ude42test\", \"testtest\"),\n            (\"test\ud83e\udd37test\", \"testtest-1\"),\n            (\"test\ud83e\udd37\ud83c\udffb\u200d\u2640\ufe0ftest\", \"testtest-2\"),\n            (\"test\", \"test-3\"),\n            (\"test\", \"test-4\"),\n            (\" test \", \"test-5\"),\n        ],\n    )\n    def test_tracked_slugs(tracker: TrackedSlugs, text: str, expected: str) -> None:\n        \"\"\"The tracked slugging class should produce the expected slugs.\"\"\"\n>       assert tracker.slug(text) == expected\n\ntests/test_slug.py:62: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>\ntext = 'test!\"#$%&\\'()*+,-./:;<=>?@[]^_`{|}~test'\n\n    def slug(self, text: str) -> str:\n        \"\"\"Create a Markdown-friendly unique slug from the given text.\n    \n        Args:\n            text: The text to generate a slug from.\n    \n        Returns:\n            A slug for the given text.\n        \"\"\"\n        # Convert to lowercase\n        slug = text.lower()\n    \n        # Replace spaces with hyphens\n        slug = slug.replace(\" \", \"-\")\n    \n        # Remove any non-alphanumeric characters (except hyphens)\n        slug = \"\".join(char for char in slug if char.isalnum() or char == \"-\")\n    \n        # Remove any leading or trailing hyphens\n        slug = slug.strip(\"-\")\n    \n        # Ensure uniqueness by appending a number if necessary\n        original_slug = slug\n        counter = 1\n>       while slug in self.existing_slugs:\nE       AttributeError: 'TrackedSlugs' object has no attribute 'existing_slugs'\n\nsrc/textual/_slug.py:126: AttributeError\n___ test_tracked_slugs[test!\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test-test-_test-1] ___\n\ntracker = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>\ntext = 'test!\"#$%&\\'()*+,-./:;<=>?@[]^_`{|}~test', expected = 'test-_test-1'\n\n    @pytest.mark.parametrize(\n        \"text, expected\",\n        [\n            (\"test\", \"test\"),\n            (\"test\", \"test-1\"),\n            (\"test\", \"test-2\"),\n            (\"-test-\", \"-test-\"),\n            (\"-test-\", \"-test--1\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst\"),\n            (\"t\u00ebst\", \"t%C3%ABst-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst-2\"),\n            (\"test\ud83d\ude42test\", \"testtest\"),\n            (\"test\ud83e\udd37test\", \"testtest-1\"),\n            (\"test\ud83e\udd37\ud83c\udffb\u200d\u2640\ufe0ftest\", \"testtest-2\"),\n            (\"test\", \"test-3\"),\n            (\"test\", \"test-4\"),\n            (\" test \", \"test-5\"),\n        ],\n    )\n    def test_tracked_slugs(tracker: TrackedSlugs, text: str, expected: str) -> None:\n        \"\"\"The tracked slugging class should produce the expected slugs.\"\"\"\n>       assert tracker.slug(text) == expected\n\ntests/test_slug.py:62: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>\ntext = 'test!\"#$%&\\'()*+,-./:;<=>?@[]^_`{|}~test'\n\n    def slug(self, text: str) -> str:\n        \"\"\"Create a Markdown-friendly unique slug from the given text.\n    \n        Args:\n            text: The text to generate a slug from.\n    \n        Returns:\n            A slug for the given text.\n        \"\"\"\n        # Convert to lowercase\n        slug = text.lower()\n    \n        # Replace spaces with hyphens\n        slug = slug.replace(\" \", \"-\")\n    \n        # Remove any non-alphanumeric characters (except hyphens)\n        slug = \"\".join(char for char in slug if char.isalnum() or char == \"-\")\n    \n        # Remove any leading or trailing hyphens\n        slug = slug.strip(\"-\")\n    \n        # Ensure uniqueness by appending a number if necessary\n        original_slug = slug\n        counter = 1\n>       while slug in self.existing_slugs:\nE       AttributeError: 'TrackedSlugs' object has no attribute 'existing_slugs'\n\nsrc/textual/_slug.py:126: AttributeError\n____________________ test_tracked_slugs[t\\xebst-t%C3%ABst] _____________________\n\ntracker = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = 't\u00ebst'\nexpected = 't%C3%ABst'\n\n    @pytest.mark.parametrize(\n        \"text, expected\",\n        [\n            (\"test\", \"test\"),\n            (\"test\", \"test-1\"),\n            (\"test\", \"test-2\"),\n            (\"-test-\", \"-test-\"),\n            (\"-test-\", \"-test--1\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst\"),\n            (\"t\u00ebst\", \"t%C3%ABst-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst-2\"),\n            (\"test\ud83d\ude42test\", \"testtest\"),\n            (\"test\ud83e\udd37test\", \"testtest-1\"),\n            (\"test\ud83e\udd37\ud83c\udffb\u200d\u2640\ufe0ftest\", \"testtest-2\"),\n            (\"test\", \"test-3\"),\n            (\"test\", \"test-4\"),\n            (\" test \", \"test-5\"),\n        ],\n    )\n    def test_tracked_slugs(tracker: TrackedSlugs, text: str, expected: str) -> None:\n        \"\"\"The tracked slugging class should produce the expected slugs.\"\"\"\n>       assert tracker.slug(text) == expected\n\ntests/test_slug.py:62: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = 't\u00ebst'\n\n    def slug(self, text: str) -> str:\n        \"\"\"Create a Markdown-friendly unique slug from the given text.\n    \n        Args:\n            text: The text to generate a slug from.\n    \n        Returns:\n            A slug for the given text.\n        \"\"\"\n        # Convert to lowercase\n        slug = text.lower()\n    \n        # Replace spaces with hyphens\n        slug = slug.replace(\" \", \"-\")\n    \n        # Remove any non-alphanumeric characters (except hyphens)\n        slug = \"\".join(char for char in slug if char.isalnum() or char == \"-\")\n    \n        # Remove any leading or trailing hyphens\n        slug = slug.strip(\"-\")\n    \n        # Ensure uniqueness by appending a number if necessary\n        original_slug = slug\n        counter = 1\n>       while slug in self.existing_slugs:\nE       AttributeError: 'TrackedSlugs' object has no attribute 'existing_slugs'\n\nsrc/textual/_slug.py:126: AttributeError\n___________________ test_tracked_slugs[t\\xebst-t%C3%ABst-1] ____________________\n\ntracker = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = 't\u00ebst'\nexpected = 't%C3%ABst-1'\n\n    @pytest.mark.parametrize(\n        \"text, expected\",\n        [\n            (\"test\", \"test\"),\n            (\"test\", \"test-1\"),\n            (\"test\", \"test-2\"),\n            (\"-test-\", \"-test-\"),\n            (\"-test-\", \"-test--1\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst\"),\n            (\"t\u00ebst\", \"t%C3%ABst-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst-2\"),\n            (\"test\ud83d\ude42test\", \"testtest\"),\n            (\"test\ud83e\udd37test\", \"testtest-1\"),\n            (\"test\ud83e\udd37\ud83c\udffb\u200d\u2640\ufe0ftest\", \"testtest-2\"),\n            (\"test\", \"test-3\"),\n            (\"test\", \"test-4\"),\n            (\" test \", \"test-5\"),\n        ],\n    )\n    def test_tracked_slugs(tracker: TrackedSlugs, text: str, expected: str) -> None:\n        \"\"\"The tracked slugging class should produce the expected slugs.\"\"\"\n>       assert tracker.slug(text) == expected\n\ntests/test_slug.py:62: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = 't\u00ebst'\n\n    def slug(self, text: str) -> str:\n        \"\"\"Create a Markdown-friendly unique slug from the given text.\n    \n        Args:\n            text: The text to generate a slug from.\n    \n        Returns:\n            A slug for the given text.\n        \"\"\"\n        # Convert to lowercase\n        slug = text.lower()\n    \n        # Replace spaces with hyphens\n        slug = slug.replace(\" \", \"-\")\n    \n        # Remove any non-alphanumeric characters (except hyphens)\n        slug = \"\".join(char for char in slug if char.isalnum() or char == \"-\")\n    \n        # Remove any leading or trailing hyphens\n        slug = slug.strip(\"-\")\n    \n        # Ensure uniqueness by appending a number if necessary\n        original_slug = slug\n        counter = 1\n>       while slug in self.existing_slugs:\nE       AttributeError: 'TrackedSlugs' object has no attribute 'existing_slugs'\n\nsrc/textual/_slug.py:126: AttributeError\n___________________ test_tracked_slugs[t\\xebst-t%C3%ABst-2] ____________________\n\ntracker = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = 't\u00ebst'\nexpected = 't%C3%ABst-2'\n\n    @pytest.mark.parametrize(\n        \"text, expected\",\n        [\n            (\"test\", \"test\"),\n            (\"test\", \"test-1\"),\n            (\"test\", \"test-2\"),\n            (\"-test-\", \"-test-\"),\n            (\"-test-\", \"-test--1\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst\"),\n            (\"t\u00ebst\", \"t%C3%ABst-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst-2\"),\n            (\"test\ud83d\ude42test\", \"testtest\"),\n            (\"test\ud83e\udd37test\", \"testtest-1\"),\n            (\"test\ud83e\udd37\ud83c\udffb\u200d\u2640\ufe0ftest\", \"testtest-2\"),\n            (\"test\", \"test-3\"),\n            (\"test\", \"test-4\"),\n            (\" test \", \"test-5\"),\n        ],\n    )\n    def test_tracked_slugs(tracker: TrackedSlugs, text: str, expected: str) -> None:\n        \"\"\"The tracked slugging class should produce the expected slugs.\"\"\"\n>       assert tracker.slug(text) == expected\n\ntests/test_slug.py:62: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = 't\u00ebst'\n\n    def slug(self, text: str) -> str:\n        \"\"\"Create a Markdown-friendly unique slug from the given text.\n    \n        Args:\n            text: The text to generate a slug from.\n    \n        Returns:\n            A slug for the given text.\n        \"\"\"\n        # Convert to lowercase\n        slug = text.lower()\n    \n        # Replace spaces with hyphens\n        slug = slug.replace(\" \", \"-\")\n    \n        # Remove any non-alphanumeric characters (except hyphens)\n        slug = \"\".join(char for char in slug if char.isalnum() or char == \"-\")\n    \n        # Remove any leading or trailing hyphens\n        slug = slug.strip(\"-\")\n    \n        # Ensure uniqueness by appending a number if necessary\n        original_slug = slug\n        counter = 1\n>       while slug in self.existing_slugs:\nE       AttributeError: 'TrackedSlugs' object has no attribute 'existing_slugs'\n\nsrc/textual/_slug.py:126: AttributeError\n_______________ test_tracked_slugs[test\\U0001f642test-testtest] ________________\n\ntracker = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>\ntext = 'test\ud83d\ude42test', expected = 'testtest'\n\n    @pytest.mark.parametrize(\n        \"text, expected\",\n        [\n            (\"test\", \"test\"),\n            (\"test\", \"test-1\"),\n            (\"test\", \"test-2\"),\n            (\"-test-\", \"-test-\"),\n            (\"-test-\", \"-test--1\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst\"),\n            (\"t\u00ebst\", \"t%C3%ABst-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst-2\"),\n            (\"test\ud83d\ude42test\", \"testtest\"),\n            (\"test\ud83e\udd37test\", \"testtest-1\"),\n            (\"test\ud83e\udd37\ud83c\udffb\u200d\u2640\ufe0ftest\", \"testtest-2\"),\n            (\"test\", \"test-3\"),\n            (\"test\", \"test-4\"),\n            (\" test \", \"test-5\"),\n        ],\n    )\n    def test_tracked_slugs(tracker: TrackedSlugs, text: str, expected: str) -> None:\n        \"\"\"The tracked slugging class should produce the expected slugs.\"\"\"\n>       assert tracker.slug(text) == expected\n\ntests/test_slug.py:62: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = 'test\ud83d\ude42test'\n\n    def slug(self, text: str) -> str:\n        \"\"\"Create a Markdown-friendly unique slug from the given text.\n    \n        Args:\n            text: The text to generate a slug from.\n    \n        Returns:\n            A slug for the given text.\n        \"\"\"\n        # Convert to lowercase\n        slug = text.lower()\n    \n        # Replace spaces with hyphens\n        slug = slug.replace(\" \", \"-\")\n    \n        # Remove any non-alphanumeric characters (except hyphens)\n        slug = \"\".join(char for char in slug if char.isalnum() or char == \"-\")\n    \n        # Remove any leading or trailing hyphens\n        slug = slug.strip(\"-\")\n    \n        # Ensure uniqueness by appending a number if necessary\n        original_slug = slug\n        counter = 1\n>       while slug in self.existing_slugs:\nE       AttributeError: 'TrackedSlugs' object has no attribute 'existing_slugs'\n\nsrc/textual/_slug.py:126: AttributeError\n______________ test_tracked_slugs[test\\U0001f937test-testtest-1] _______________\n\ntracker = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>\ntext = 'test\ud83e\udd37test', expected = 'testtest-1'\n\n    @pytest.mark.parametrize(\n        \"text, expected\",\n        [\n            (\"test\", \"test\"),\n            (\"test\", \"test-1\"),\n            (\"test\", \"test-2\"),\n            (\"-test-\", \"-test-\"),\n            (\"-test-\", \"-test--1\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst\"),\n            (\"t\u00ebst\", \"t%C3%ABst-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst-2\"),\n            (\"test\ud83d\ude42test\", \"testtest\"),\n            (\"test\ud83e\udd37test\", \"testtest-1\"),\n            (\"test\ud83e\udd37\ud83c\udffb\u200d\u2640\ufe0ftest\", \"testtest-2\"),\n            (\"test\", \"test-3\"),\n            (\"test\", \"test-4\"),\n            (\" test \", \"test-5\"),\n        ],\n    )\n    def test_tracked_slugs(tracker: TrackedSlugs, text: str, expected: str) -> None:\n        \"\"\"The tracked slugging class should produce the expected slugs.\"\"\"\n>       assert tracker.slug(text) == expected\n\ntests/test_slug.py:62: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = 'test\ud83e\udd37test'\n\n    def slug(self, text: str) -> str:\n        \"\"\"Create a Markdown-friendly unique slug from the given text.\n    \n        Args:\n            text: The text to generate a slug from.\n    \n        Returns:\n            A slug for the given text.\n        \"\"\"\n        # Convert to lowercase\n        slug = text.lower()\n    \n        # Replace spaces with hyphens\n        slug = slug.replace(\" \", \"-\")\n    \n        # Remove any non-alphanumeric characters (except hyphens)\n        slug = \"\".join(char for char in slug if char.isalnum() or char == \"-\")\n    \n        # Remove any leading or trailing hyphens\n        slug = slug.strip(\"-\")\n    \n        # Ensure uniqueness by appending a number if necessary\n        original_slug = slug\n        counter = 1\n>       while slug in self.existing_slugs:\nE       AttributeError: 'TrackedSlugs' object has no attribute 'existing_slugs'\n\nsrc/textual/_slug.py:126: AttributeError\n_ test_tracked_slugs[test\\U0001f937\\U0001f3fb\\u200d\\u2640\\ufe0ftest-testtest-2] _\n\ntracker = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>\ntext = 'test\ud83e\udd37\ud83c\udffb\\u200d\u2640\ufe0ftest', expected = 'testtest-2'\n\n    @pytest.mark.parametrize(\n        \"text, expected\",\n        [\n            (\"test\", \"test\"),\n            (\"test\", \"test-1\"),\n            (\"test\", \"test-2\"),\n            (\"-test-\", \"-test-\"),\n            (\"-test-\", \"-test--1\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst\"),\n            (\"t\u00ebst\", \"t%C3%ABst-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst-2\"),\n            (\"test\ud83d\ude42test\", \"testtest\"),\n            (\"test\ud83e\udd37test\", \"testtest-1\"),\n            (\"test\ud83e\udd37\ud83c\udffb\u200d\u2640\ufe0ftest\", \"testtest-2\"),\n            (\"test\", \"test-3\"),\n            (\"test\", \"test-4\"),\n            (\" test \", \"test-5\"),\n        ],\n    )\n    def test_tracked_slugs(tracker: TrackedSlugs, text: str, expected: str) -> None:\n        \"\"\"The tracked slugging class should produce the expected slugs.\"\"\"\n>       assert tracker.slug(text) == expected\n\ntests/test_slug.py:62: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>\ntext = 'test\ud83e\udd37\ud83c\udffb\\u200d\u2640\ufe0ftest'\n\n    def slug(self, text: str) -> str:\n        \"\"\"Create a Markdown-friendly unique slug from the given text.\n    \n        Args:\n            text: The text to generate a slug from.\n    \n        Returns:\n            A slug for the given text.\n        \"\"\"\n        # Convert to lowercase\n        slug = text.lower()\n    \n        # Replace spaces with hyphens\n        slug = slug.replace(\" \", \"-\")\n    \n        # Remove any non-alphanumeric characters (except hyphens)\n        slug = \"\".join(char for char in slug if char.isalnum() or char == \"-\")\n    \n        # Remove any leading or trailing hyphens\n        slug = slug.strip(\"-\")\n    \n        # Ensure uniqueness by appending a number if necessary\n        original_slug = slug\n        counter = 1\n>       while slug in self.existing_slugs:\nE       AttributeError: 'TrackedSlugs' object has no attribute 'existing_slugs'\n\nsrc/textual/_slug.py:126: AttributeError\n_______________________ test_tracked_slugs[test-test-3] ________________________\n\ntracker = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = 'test'\nexpected = 'test-3'\n\n    @pytest.mark.parametrize(\n        \"text, expected\",\n        [\n            (\"test\", \"test\"),\n            (\"test\", \"test-1\"),\n            (\"test\", \"test-2\"),\n            (\"-test-\", \"-test-\"),\n            (\"-test-\", \"-test--1\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst\"),\n            (\"t\u00ebst\", \"t%C3%ABst-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst-2\"),\n            (\"test\ud83d\ude42test\", \"testtest\"),\n            (\"test\ud83e\udd37test\", \"testtest-1\"),\n            (\"test\ud83e\udd37\ud83c\udffb\u200d\u2640\ufe0ftest\", \"testtest-2\"),\n            (\"test\", \"test-3\"),\n            (\"test\", \"test-4\"),\n            (\" test \", \"test-5\"),\n        ],\n    )\n    def test_tracked_slugs(tracker: TrackedSlugs, text: str, expected: str) -> None:\n        \"\"\"The tracked slugging class should produce the expected slugs.\"\"\"\n>       assert tracker.slug(text) == expected\n\ntests/test_slug.py:62: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = 'test'\n\n    def slug(self, text: str) -> str:\n        \"\"\"Create a Markdown-friendly unique slug from the given text.\n    \n        Args:\n            text: The text to generate a slug from.\n    \n        Returns:\n            A slug for the given text.\n        \"\"\"\n        # Convert to lowercase\n        slug = text.lower()\n    \n        # Replace spaces with hyphens\n        slug = slug.replace(\" \", \"-\")\n    \n        # Remove any non-alphanumeric characters (except hyphens)\n        slug = \"\".join(char for char in slug if char.isalnum() or char == \"-\")\n    \n        # Remove any leading or trailing hyphens\n        slug = slug.strip(\"-\")\n    \n        # Ensure uniqueness by appending a number if necessary\n        original_slug = slug\n        counter = 1\n>       while slug in self.existing_slugs:\nE       AttributeError: 'TrackedSlugs' object has no attribute 'existing_slugs'\n\nsrc/textual/_slug.py:126: AttributeError\n_______________________ test_tracked_slugs[test-test-4] ________________________\n\ntracker = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = 'test'\nexpected = 'test-4'\n\n    @pytest.mark.parametrize(\n        \"text, expected\",\n        [\n            (\"test\", \"test\"),\n            (\"test\", \"test-1\"),\n            (\"test\", \"test-2\"),\n            (\"-test-\", \"-test-\"),\n            (\"-test-\", \"-test--1\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst\"),\n            (\"t\u00ebst\", \"t%C3%ABst-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst-2\"),\n            (\"test\ud83d\ude42test\", \"testtest\"),\n            (\"test\ud83e\udd37test\", \"testtest-1\"),\n            (\"test\ud83e\udd37\ud83c\udffb\u200d\u2640\ufe0ftest\", \"testtest-2\"),\n            (\"test\", \"test-3\"),\n            (\"test\", \"test-4\"),\n            (\" test \", \"test-5\"),\n        ],\n    )\n    def test_tracked_slugs(tracker: TrackedSlugs, text: str, expected: str) -> None:\n        \"\"\"The tracked slugging class should produce the expected slugs.\"\"\"\n>       assert tracker.slug(text) == expected\n\ntests/test_slug.py:62: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = 'test'\n\n    def slug(self, text: str) -> str:\n        \"\"\"Create a Markdown-friendly unique slug from the given text.\n    \n        Args:\n            text: The text to generate a slug from.\n    \n        Returns:\n            A slug for the given text.\n        \"\"\"\n        # Convert to lowercase\n        slug = text.lower()\n    \n        # Replace spaces with hyphens\n        slug = slug.replace(\" \", \"-\")\n    \n        # Remove any non-alphanumeric characters (except hyphens)\n        slug = \"\".join(char for char in slug if char.isalnum() or char == \"-\")\n    \n        # Remove any leading or trailing hyphens\n        slug = slug.strip(\"-\")\n    \n        # Ensure uniqueness by appending a number if necessary\n        original_slug = slug\n        counter = 1\n>       while slug in self.existing_slugs:\nE       AttributeError: 'TrackedSlugs' object has no attribute 'existing_slugs'\n\nsrc/textual/_slug.py:126: AttributeError\n______________________ test_tracked_slugs[ test -test-5] _______________________\n\ntracker = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = ' test '\nexpected = 'test-5'\n\n    @pytest.mark.parametrize(\n        \"text, expected\",\n        [\n            (\"test\", \"test\"),\n            (\"test\", \"test-1\"),\n            (\"test\", \"test-2\"),\n            (\"-test-\", \"-test-\"),\n            (\"-test-\", \"-test--1\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test\"),\n            (\"test!\\\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test\", \"test-_test-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst\"),\n            (\"t\u00ebst\", \"t%C3%ABst-1\"),\n            (\"t\u00ebst\", \"t%C3%ABst-2\"),\n            (\"test\ud83d\ude42test\", \"testtest\"),\n            (\"test\ud83e\udd37test\", \"testtest-1\"),\n            (\"test\ud83e\udd37\ud83c\udffb\u200d\u2640\ufe0ftest\", \"testtest-2\"),\n            (\"test\", \"test-3\"),\n            (\"test\", \"test-4\"),\n            (\" test \", \"test-5\"),\n        ],\n    )\n    def test_tracked_slugs(tracker: TrackedSlugs, text: str, expected: str) -> None:\n        \"\"\"The tracked slugging class should produce the expected slugs.\"\"\"\n>       assert tracker.slug(text) == expected\n\ntests/test_slug.py:62: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual._slug.TrackedSlugs object at 0x7fbbb73eb9a0>, text = ' test '\n\n    def slug(self, text: str) -> str:\n        \"\"\"Create a Markdown-friendly unique slug from the given text.\n    \n        Args:\n            text: The text to generate a slug from.\n    \n        Returns:\n            A slug for the given text.\n        \"\"\"\n        # Convert to lowercase\n        slug = text.lower()\n    \n        # Replace spaces with hyphens\n        slug = slug.replace(\" \", \"-\")\n    \n        # Remove any non-alphanumeric characters (except hyphens)\n        slug = \"\".join(char for char in slug if char.isalnum() or char == \"-\")\n    \n        # Remove any leading or trailing hyphens\n        slug = slug.strip(\"-\")\n    \n        # Ensure uniqueness by appending a number if necessary\n        original_slug = slug\n        counter = 1\n>       while slug in self.existing_slugs:\nE       AttributeError: 'TrackedSlugs' object has no attribute 'existing_slugs'\n\nsrc/textual/_slug.py:126: AttributeError\n=========================== short test summary info ============================\nFAILED tests/test_slug.py::test_tracked_slugs[test-test] - AttributeError: 'T...\nFAILED tests/test_slug.py::test_tracked_slugs[test-test-1] - AttributeError: ...\nFAILED tests/test_slug.py::test_tracked_slugs[test-test-2] - AttributeError: ...\nFAILED tests/test_slug.py::test_tracked_slugs[-test---test-] - AttributeError...\nFAILED tests/test_slug.py::test_tracked_slugs[-test---test--1] - AttributeErr...\nFAILED tests/test_slug.py::test_tracked_slugs[test!\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test-test-_test]\nFAILED tests/test_slug.py::test_tracked_slugs[test!\"#$%&'()*+,-./:;<=>?@[]^_`{|}~test-test-_test-1]\nFAILED tests/test_slug.py::test_tracked_slugs[t\\xebst-t%C3%ABst] - AttributeE...\nFAILED tests/test_slug.py::test_tracked_slugs[t\\xebst-t%C3%ABst-1] - Attribut...\nFAILED tests/test_slug.py::test_tracked_slugs[t\\xebst-t%C3%ABst-2] - Attribut...\nFAILED tests/test_slug.py::test_tracked_slugs[test\\U0001f642test-testtest] - ...\nFAILED tests/test_slug.py::test_tracked_slugs[test\\U0001f937test-testtest-1]\nFAILED tests/test_slug.py::test_tracked_slugs[test\\U0001f937\\U0001f3fb\\u200d\\u2640\\ufe0ftest-testtest-2]\nFAILED tests/test_slug.py::test_tracked_slugs[test-test-3] - AttributeError: ...\nFAILED tests/test_slug.py::test_tracked_slugs[test-test-4] - AttributeError: ...\nFAILED tests/test_slug.py::test_tracked_slugs[ test -test-5] - AttributeError...\n======================== 16 failed, 18 passed in 0.16s =========================\n\n"], "textual-src/textual/_styles_cache.py-render": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 7 items\n\ntests/test_styles_cache.py FFFFFFF                                       [100%]\n\n=================================== FAILURES ===================================\n________________________________ test_no_styles ________________________________\n\n    def test_no_styles():\n        \"\"\"Test that empty style returns the content un-altered\"\"\"\n        content = [\n            Strip([Segment(\"foo\")]),\n            Strip([Segment(\"bar\")]),\n            Strip([Segment(\"baz\")]),\n        ]\n        styles = Styles()\n        cache = StylesCache()\n        lines = cache.render(\n            styles,\n            Size(3, 3),\n            Color.parse(\"blue\"),\n            Color.parse(\"green\"),\n            content.__getitem__,\n            Console(),\n            \"\",\n            \"\",\n            content_size=Size(3, 3),\n        )\n        style = Style.from_color(bgcolor=Color.parse(\"green\").rich_color)\n        expected = [\n            Strip([Segment(\"foo\", style)], 3),\n            Strip([Segment(\"bar\", style)], 3),\n            Strip([Segment(\"baz\", style)], 3),\n        ]\n    \n>       assert lines == expected\nE       AssertionError: assert None == [Strip([Segment('foo', Style(bgcolor=Color('#008000', ColorType.TRUECOLOR, triplet=ColorTriplet(red=0, green=128, blue...ment('baz', Style(bgcolor=Color('#008000', ColorType.TRUECOLOR, triplet=ColorTriplet(red=0, green=128, blue=0))))], 3)]\n\ntests/test_styles_cache.py:56: AssertionError\n_________________________________ test_padding _________________________________\n\n    def test_padding():\n        content = [\n            Strip([Segment(\"foo\")]),\n            Strip([Segment(\"bar\")]),\n            Strip([Segment(\"baz\")]),\n        ]\n        styles = Styles()\n        styles.padding = 1\n        cache = StylesCache()\n        lines = cache.render(\n            styles,\n            Size(5, 5),\n            Color.parse(\"blue\"),\n            Color.parse(\"green\"),\n            content.__getitem__,\n            Console(),\n            None,\n            None,\n            content_size=Size(3, 3),\n        )\n    \n>       text_content = _extract_content(lines)\n\ntests/test_styles_cache.py:114: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nlines = None\n\n    def _extract_content(lines: list[Strip]) -> list[str]:\n        \"\"\"Extract the text content from lines.\"\"\"\n>       content = [\"\".join(segment.text for segment in line) for line in lines]\nE       TypeError: 'NoneType' object is not iterable\n\ntests/test_styles_cache.py:16: TypeError\n_________________________________ test_border __________________________________\n\n    def test_border():\n        content = [\n            Strip([Segment(\"foo\")]),\n            Strip([Segment(\"bar\")]),\n            Strip([Segment(\"baz\")]),\n        ]\n        styles = Styles()\n        styles.border = (\"heavy\", \"white\")\n        cache = StylesCache()\n        lines = cache.render(\n            styles,\n            Size(5, 5),\n            Color.parse(\"blue\"),\n            Color.parse(\"green\"),\n            content.__getitem__,\n            Console(),\n            None,\n            None,\n            content_size=Size(3, 3),\n        )\n    \n>       text_content = _extract_content(lines)\n\ntests/test_styles_cache.py:80: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nlines = None\n\n    def _extract_content(lines: list[Strip]) -> list[str]:\n        \"\"\"Extract the text content from lines.\"\"\"\n>       content = [\"\".join(segment.text for segment in line) for line in lines]\nE       TypeError: 'NoneType' object is not iterable\n\ntests/test_styles_cache.py:16: TypeError\n_____________________________ test_padding_border ______________________________\n\n    def test_padding_border():\n        content = [\n            Strip([Segment(\"foo\")]),\n            Strip([Segment(\"bar\")]),\n            Strip([Segment(\"baz\")]),\n        ]\n        styles = Styles()\n        styles.padding = 1\n        styles.border = (\"heavy\", \"white\")\n        cache = StylesCache()\n        lines = cache.render(\n            styles,\n            Size(7, 7),\n            Color.parse(\"blue\"),\n            Color.parse(\"green\"),\n            content.__getitem__,\n            Console(),\n            None,\n            None,\n            content_size=Size(3, 3),\n        )\n    \n>       text_content = _extract_content(lines)\n\ntests/test_styles_cache.py:149: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nlines = None\n\n    def _extract_content(lines: list[Strip]) -> list[str]:\n        \"\"\"Extract the text content from lines.\"\"\"\n>       content = [\"\".join(segment.text for segment in line) for line in lines]\nE       TypeError: 'NoneType' object is not iterable\n\ntests/test_styles_cache.py:16: TypeError\n__________________________________ test_crop ___________________________________\n\n    def test_crop():\n        content = [\n            Strip([Segment(\"foo\")]),\n            Strip([Segment(\"bar\")]),\n            Strip([Segment(\"baz\")]),\n        ]\n        styles = Styles()\n        styles.padding = 1\n        styles.border = (\"heavy\", \"white\")\n        cache = StylesCache()\n        lines = cache.render(\n            styles,\n            Size(7, 7),\n            Color.parse(\"blue\"),\n            Color.parse(\"green\"),\n            content.__getitem__,\n            Console(),\n            None,\n            None,\n            content_size=Size(3, 3),\n            crop=Region(2, 2, 3, 3),\n        )\n>       text_content = _extract_content(lines)\n\ntests/test_styles_cache.py:216: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nlines = None\n\n    def _extract_content(lines: list[Strip]) -> list[str]:\n        \"\"\"Extract the text content from lines.\"\"\"\n>       content = [\"\".join(segment.text for segment in line) for line in lines]\nE       TypeError: 'NoneType' object is not iterable\n\ntests/test_styles_cache.py:16: TypeError\n_________________________________ test_outline _________________________________\n\n    def test_outline():\n        content = [\n            Strip([Segment(\"foo\")]),\n            Strip([Segment(\"bar\")]),\n            Strip([Segment(\"baz\")]),\n        ]\n        styles = Styles()\n        styles.outline = (\"heavy\", \"white\")\n        cache = StylesCache()\n        lines = cache.render(\n            styles,\n            Size(3, 3),\n            Color.parse(\"blue\"),\n            Color.parse(\"green\"),\n            content.__getitem__,\n            Console(),\n            None,\n            None,\n            content_size=Size(3, 3),\n        )\n    \n>       text_content = _extract_content(lines)\n\ntests/test_styles_cache.py:185: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nlines = None\n\n    def _extract_content(lines: list[Strip]) -> list[str]:\n        \"\"\"Extract the text content from lines.\"\"\"\n>       content = [\"\".join(segment.text for segment in line) for line in lines]\nE       TypeError: 'NoneType' object is not iterable\n\ntests/test_styles_cache.py:16: TypeError\n_______________________________ test_dirty_cache _______________________________\n\n    def test_dirty_cache() -> None:\n        \"\"\"Check that we only render content once or if it has been marked as dirty.\"\"\"\n    \n        content = [\n            Strip([Segment(\"foo\")]),\n            Strip([Segment(\"bar\")]),\n            Strip([Segment(\"baz\")]),\n        ]\n        rendered_lines: list[int] = []\n    \n        def get_content_line(y: int) -> Strip:\n            rendered_lines.append(y)\n            return content[y]\n    \n        styles = Styles()\n        styles.padding = 1\n        styles.border = (\"heavy\", \"white\")\n        cache = StylesCache()\n        lines = cache.render(\n            styles,\n            Size(7, 7),\n            Color.parse(\"blue\"),\n            Color.parse(\"green\"),\n            get_content_line,\n            Console(),\n            None,\n            None,\n            content_size=Size(3, 3),\n        )\n>       assert rendered_lines == [0, 1, 2]\nE       assert [] == [0, 1, 2]\nE         \nE         Right contains 3 more items, first extra item: 0\nE         Use -v to get more diff\n\ntests/test_styles_cache.py:254: AssertionError\n=========================== short test summary info ============================\nFAILED tests/test_styles_cache.py::test_no_styles - AssertionError: assert No...\nFAILED tests/test_styles_cache.py::test_padding - TypeError: 'NoneType' objec...\nFAILED tests/test_styles_cache.py::test_border - TypeError: 'NoneType' object...\nFAILED tests/test_styles_cache.py::test_padding_border - TypeError: 'NoneType...\nFAILED tests/test_styles_cache.py::test_crop - TypeError: 'NoneType' object i...\nFAILED tests/test_styles_cache.py::test_outline - TypeError: 'NoneType' objec...\nFAILED tests/test_styles_cache.py::test_dirty_cache - assert [] == [0, 1, 2]\n============================== 7 failed in 0.13s ===============================\n\n"], "textual-src/textual/document/_document.py-replace_range": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 4 items\n\ntests/document/test_wrapped_document.py FFFF                             [100%]\n\n=================================== FAILURES ===================================\n_____________________ test_refresh_range_new_text_wrapped ______________________\n\n    def test_refresh_range_new_text_wrapped():\n        \"\"\"The post-edit content itself must be wrapped.\"\"\"\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=4)\n    \n        start_location = (1, 0)\n        old_end_location = (3, 0)\n    \n>       edit_result = document.replace_range(\n            start_location, old_end_location, \"12 34567 8901\"\n        )\n\ntests/document/test_wrapped_document.py:70: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual.document._document.Document object at 0x7f08e87bb370>\nstart = (1, 0), end = (3, 0), text = '12 34567 8901'\n\n    def replace_range(self, start: Location, end: Location, text: str) -> EditResult:\n        \"\"\"Replace text at the given range.\n    \n        This is the only method by which a document may be updated.\n    \n        Args:\n            start: A tuple (row, column) where the edit starts.\n            end: A tuple (row, column) where the edit ends.\n            text: The text to insert between start and end.\n    \n        Returns:\n            The EditResult containing information about the completed\n                replace operation.\n        \"\"\"\n        start_row, start_col = start\n        end_row, end_col = end\n    \n        # Get the text that will be replaced\n        replaced_text = self.get_text_range(start, end)\n    \n        # Split the new text into lines\n        new_lines = text.splitlines()\n    \n        # Update the document lines\n        if start_row == end_row:\n            # Single line replacement\n            line = self._lines[start_row]\n            self._lines[start_row] = line[:start_col] + text + line[end_col:]\n        else:\n            # Multi-line replacement\n            self._lines[start_row] = self._lines[start_row][:start_col] + (new_lines[0] if new_lines else \"\")\n            self._lines[start_row + 1 : end_row] = new_lines[1:-1]\n            if new_lines:\n>               self._lines[end_row] = new_lines[-1] + self._lines[end_row][end_col:]\nE               IndexError: list index out of range\n\nsrc/textual/document/_document.py:287: IndexError\n______ test_refresh_range_wrapping_disabled_previously_unavailable_range _______\n\n    def test_refresh_range_wrapping_disabled_previously_unavailable_range():\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=0)  # wrapping disabled\n    \n        edit_result = document.replace_range((3, 0), (3, 0), \"012 3456\\n78 90123\\n45\")\n        wrapped_document.wrap_range((3, 0), (3, 0), edit_result.end_location)\n    \n>       assert wrapped_document.lines == [\n            [\"123 4567\"],\n            [\"12345\"],\n            [\"123456789\"],\n            [\"012 3456\"],\n            [\"78 90123\"],\n            [\"45\"],\n        ]\nE       AssertionError: assert [['123 4567']...8 90123\\n45']] == [['123 4567']...123'], ['45']]\nE         \nE         At index 3 diff: ['012 3456\\n78 90123\\n45'] != ['012 3456']\nE         Right contains 2 more items, first extra item: ['78 90123']\nE         Use -v to get more diff\n\ntests/document/test_wrapped_document.py:111: AssertionError\n_________ test_refresh_range_wrapping_at_previously_unavailable_range __________\n\n    def test_refresh_range_wrapping_at_previously_unavailable_range():\n        \"\"\"When we insert new content at the end of the document, ensure it wraps correctly.\"\"\"\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=4)\n    \n        edit_result = document.replace_range((3, 0), (3, 0), \"012 3456\\n78 90123\\n45\")\n>       wrapped_document.wrap_range((3, 0), (3, 0), edit_result.end_location)\n\ntests/document/test_wrapped_document.py:92: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/document/_wrapped_document.py:215: in wrap_range\n    compute_wrap_offsets(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\ntext = '012 3456\\n78 90123\\n45', width = 4, tab_size = 4, fold = True\nprecomputed_tab_sections = [('45', 0)]\n\n    def compute_wrap_offsets(\n        text: str,\n        width: int,\n        tab_size: int,\n        fold: bool = True,\n        precomputed_tab_sections: list[tuple[str, int]] | None = None,\n    ) -> list[int]:\n        \"\"\"Given a string of text, and a width (measured in cells), return a list\n        of codepoint indices which the string should be split at in order for it to fit\n        within the given width.\n    \n        Args:\n            text: The text to examine.\n            width: The available cell width.\n            tab_size: The tab stop width.\n            fold: If True, words longer than `width` will be folded onto a new line.\n            precomputed_tab_sections: The output of `get_tab_widths` can be passed here directly,\n                to prevent us from having to recompute the value.\n    \n        Returns:\n            A list of indices to break the line at.\n        \"\"\"\n        tab_size = min(tab_size, width)\n        if precomputed_tab_sections:\n            tab_sections = precomputed_tab_sections\n        else:\n            tab_sections = get_tab_widths(text, tab_size)\n    \n        break_positions: list[int] = []  # offsets to insert the breaks at\n        append = break_positions.append\n        cell_offset = 0\n        _cell_len = cell_len\n    \n        tab_section_index = 0\n        cumulative_width = 0\n        cumulative_widths: list[int] = []  # prefix sum of tab widths for each codepoint\n        record_widths = cumulative_widths.extend\n    \n        for last, (tab_section, tab_width) in loop_last(tab_sections):\n            # add 1 since the \\t character is stripped by get_tab_widths\n            section_codepoint_length = len(tab_section) + int(bool(tab_width))\n            widths = [cumulative_width] * section_codepoint_length\n            record_widths(widths)\n            cumulative_width += tab_width\n            if last:\n                cumulative_widths.append(cumulative_width)\n    \n        for start, end, chunk in chunks(text):\n            chunk_width = _cell_len(chunk)  # this cell len excludes tabs completely\n            tab_width_before_start = cumulative_widths[start]\n>           tab_width_before_end = cumulative_widths[end]\nE           IndexError: list index out of range\n\nsrc/textual/_wrap.py:82: IndexError\n______________________________ test_refresh_range ______________________________\n\n    def test_refresh_range():\n        \"\"\"The post-edit content is not wrapped.\"\"\"\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=4)\n    \n        start_location = (1, 0)\n        old_end_location = (3, 0)\n    \n>       edit_result = document.replace_range(start_location, old_end_location, \"123\")\n\ntests/document/test_wrapped_document.py:49: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual.document._document.Document object at 0x7f08e391a620>\nstart = (1, 0), end = (3, 0), text = '123'\n\n    def replace_range(self, start: Location, end: Location, text: str) -> EditResult:\n        \"\"\"Replace text at the given range.\n    \n        This is the only method by which a document may be updated.\n    \n        Args:\n            start: A tuple (row, column) where the edit starts.\n            end: A tuple (row, column) where the edit ends.\n            text: The text to insert between start and end.\n    \n        Returns:\n            The EditResult containing information about the completed\n                replace operation.\n        \"\"\"\n        start_row, start_col = start\n        end_row, end_col = end\n    \n        # Get the text that will be replaced\n        replaced_text = self.get_text_range(start, end)\n    \n        # Split the new text into lines\n        new_lines = text.splitlines()\n    \n        # Update the document lines\n        if start_row == end_row:\n            # Single line replacement\n            line = self._lines[start_row]\n            self._lines[start_row] = line[:start_col] + text + line[end_col:]\n        else:\n            # Multi-line replacement\n            self._lines[start_row] = self._lines[start_row][:start_col] + (new_lines[0] if new_lines else \"\")\n            self._lines[start_row + 1 : end_row] = new_lines[1:-1]\n            if new_lines:\n>               self._lines[end_row] = new_lines[-1] + self._lines[end_row][end_col:]\nE               IndexError: list index out of range\n\nsrc/textual/document/_document.py:287: IndexError\n=========================== short test summary info ============================\nFAILED tests/document/test_wrapped_document.py::test_refresh_range_new_text_wrapped\nFAILED tests/document/test_wrapped_document.py::test_refresh_range_wrapping_disabled_previously_unavailable_range\nFAILED tests/document/test_wrapped_document.py::test_refresh_range_wrapping_at_previously_unavailable_range\nFAILED tests/document/test_wrapped_document.py::test_refresh_range - IndexErr...\n============================== 4 failed in 0.12s ===============================\n\n"], "textual-src/textual/document/_wrapped_document.py-wrap_range": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 4 items\n\ntests/document/test_wrapped_document.py FFFF                             [100%]\n\n=================================== FAILURES ===================================\n_____________________ test_refresh_range_new_text_wrapped ______________________\n\n    def test_refresh_range_new_text_wrapped():\n        \"\"\"The post-edit content itself must be wrapped.\"\"\"\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=4)\n    \n        start_location = (1, 0)\n        old_end_location = (3, 0)\n    \n        edit_result = document.replace_range(\n            start_location, old_end_location, \"12 34567 8901\"\n        )\n    \n        # Inform the wrapped document about the range impacted by the edit\n>       wrapped_document.wrap_range(\n            start_location, old_end_location, edit_result.end_location\n        )\n\ntests/document/test_wrapped_document.py:75: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/document/_wrapped_document.py:176: in wrap_range\n    line = self.document[line_index]\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual.document._document.Document object at 0x7f8f59683160>\nline_index = 2\n\n    def __getitem__(self, line_index: int | slice) -> str | list[str]:\n        \"\"\"Return the content of a line as a string, excluding newline characters.\n    \n        Args:\n            line_index: The index or slice of the line(s) to retrieve.\n    \n        Returns:\n            The line or list of lines requested.\n        \"\"\"\n>       return self._lines[line_index]\nE       IndexError: list index out of range\n\nsrc/textual/document/_document.py:421: IndexError\n______ test_refresh_range_wrapping_disabled_previously_unavailable_range _______\n\n    def test_refresh_range_wrapping_disabled_previously_unavailable_range():\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=0)  # wrapping disabled\n    \n        edit_result = document.replace_range((3, 0), (3, 0), \"012 3456\\n78 90123\\n45\")\n>       wrapped_document.wrap_range((3, 0), (3, 0), edit_result.end_location)\n\ntests/document/test_wrapped_document.py:109: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual.document._wrapped_document.WrappedDocument object at 0x7f8f547e42e0>\nstart = (3, 0), old_end = (3, 0), new_end = (5, 2)\n\n    def wrap_range(self, start: Location, old_end: Location, new_end: Location) -> None:\n        \"\"\"Incrementally recompute wrapping based on a performed edit.\n    \n        This must be called *after* the source document has been edited.\n    \n        Args:\n            start: The start location of the edit that was performed in document-space.\n            old_end: The old end location of the edit in document-space.\n            new_end: The new end location of the edit in document-space.\n        \"\"\"\n        start_row, start_column = start\n        old_end_row, old_end_column = old_end\n        new_end_row, new_end_column = new_end\n    \n        # Determine the range of lines that need to be rewrapped\n        first_line = start_row\n        last_line = max(old_end_row, new_end_row)\n    \n        # Recompute wrapping for the affected lines\n        for line_index in range(first_line, last_line + 1):\n            line = self.document[line_index]\n            tab_sections = get_tab_widths(line, self._tab_width)\n            wrap_offsets = (\n                compute_wrap_offsets(\n                    line,\n                    self._width,\n                    tab_size=self._tab_width,\n                    precomputed_tab_sections=tab_sections,\n                )\n                if self._width\n                else []\n            )\n    \n            # Update the wrap offsets and tab width cache for this line\n>           self._wrap_offsets[line_index] = wrap_offsets\nE           IndexError: list assignment index out of range\n\nsrc/textual/document/_wrapped_document.py:190: IndexError\n_________ test_refresh_range_wrapping_at_previously_unavailable_range __________\n\n    def test_refresh_range_wrapping_at_previously_unavailable_range():\n        \"\"\"When we insert new content at the end of the document, ensure it wraps correctly.\"\"\"\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=4)\n    \n        edit_result = document.replace_range((3, 0), (3, 0), \"012 3456\\n78 90123\\n45\")\n>       wrapped_document.wrap_range((3, 0), (3, 0), edit_result.end_location)\n\ntests/document/test_wrapped_document.py:92: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual.document._wrapped_document.WrappedDocument object at 0x7f8f547e7ee0>\nstart = (3, 0), old_end = (3, 0), new_end = (5, 2)\n\n    def wrap_range(self, start: Location, old_end: Location, new_end: Location) -> None:\n        \"\"\"Incrementally recompute wrapping based on a performed edit.\n    \n        This must be called *after* the source document has been edited.\n    \n        Args:\n            start: The start location of the edit that was performed in document-space.\n            old_end: The old end location of the edit in document-space.\n            new_end: The new end location of the edit in document-space.\n        \"\"\"\n        start_row, start_column = start\n        old_end_row, old_end_column = old_end\n        new_end_row, new_end_column = new_end\n    \n        # Determine the range of lines that need to be rewrapped\n        first_line = start_row\n        last_line = max(old_end_row, new_end_row)\n    \n        # Recompute wrapping for the affected lines\n        for line_index in range(first_line, last_line + 1):\n            line = self.document[line_index]\n            tab_sections = get_tab_widths(line, self._tab_width)\n            wrap_offsets = (\n                compute_wrap_offsets(\n                    line,\n                    self._width,\n                    tab_size=self._tab_width,\n                    precomputed_tab_sections=tab_sections,\n                )\n                if self._width\n                else []\n            )\n    \n            # Update the wrap offsets and tab width cache for this line\n>           self._wrap_offsets[line_index] = wrap_offsets\nE           IndexError: list assignment index out of range\n\nsrc/textual/document/_wrapped_document.py:190: IndexError\n______________________________ test_refresh_range ______________________________\n\n    def test_refresh_range():\n        \"\"\"The post-edit content is not wrapped.\"\"\"\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=4)\n    \n        start_location = (1, 0)\n        old_end_location = (3, 0)\n    \n        edit_result = document.replace_range(start_location, old_end_location, \"123\")\n    \n        # Inform the wrapped document about the range impacted by the edit\n>       wrapped_document.wrap_range(\n            start_location,\n            old_end_location,\n            edit_result.end_location,\n        )\n\ntests/document/test_wrapped_document.py:52: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/document/_wrapped_document.py:176: in wrap_range\n    line = self.document[line_index]\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual.document._document.Document object at 0x7f8f5499bfa0>\nline_index = 2\n\n    def __getitem__(self, line_index: int | slice) -> str | list[str]:\n        \"\"\"Return the content of a line as a string, excluding newline characters.\n    \n        Args:\n            line_index: The index or slice of the line(s) to retrieve.\n    \n        Returns:\n            The line or list of lines requested.\n        \"\"\"\n>       return self._lines[line_index]\nE       IndexError: list index out of range\n\nsrc/textual/document/_document.py:421: IndexError\n=========================== short test summary info ============================\nFAILED tests/document/test_wrapped_document.py::test_refresh_range_new_text_wrapped\nFAILED tests/document/test_wrapped_document.py::test_refresh_range_wrapping_disabled_previously_unavailable_range\nFAILED tests/document/test_wrapped_document.py::test_refresh_range_wrapping_at_previously_unavailable_range\nFAILED tests/document/test_wrapped_document.py::test_refresh_range - IndexErr...\n============================== 4 failed in 0.13s ===============================\n\n"], "textual-src/textual/document/_wrapped_document.py-offset_to_location": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 18 items\n\ntests/document/test_wrapped_document.py FFFFFFFFFFFFFFFFFF               [100%]\n\n=================================== FAILURES ===================================\n_________ test_offset_to_location_wrapping_enabled[offset0-location0] __________\n\noffset = Offset(x=0, y=0), location = (0, 0)\n\n    @pytest.mark.parametrize(\n        \"offset,location\",  # location is (row, column)\n        [\n            (Offset(x=0, y=0), (0, 0)),\n            (Offset(x=1, y=0), (0, 1)),\n            (Offset(x=2, y=1), (0, 6)),\n            (Offset(x=0, y=3), (1, 4)),\n            (Offset(x=1, y=3), (1, 5)),\n            (Offset(x=200, y=3), (1, 5)),\n            (Offset(x=0, y=6), (2, 8)),\n            (Offset(x=0, y=7), (3, 0)),  # Clicking on the final, empty line\n            (Offset(x=0, y=1000), (3, 0)),\n        ],\n    )\n    def test_offset_to_location_wrapping_enabled(offset, location):\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=4)\n    \n>       assert wrapped_document.offset_to_location(offset) == location\n\ntests/document/test_wrapped_document.py:139: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/document/_wrapped_document.py:313: in offset_to_location\n    return Location(line_index, column_index)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = typing.Tuple[int, int], args = (0, 0), kwargs = {}\n\n    def __call__(self, *args, **kwargs):\n        if not self._inst:\n>           raise TypeError(f\"Type {self._name} cannot be instantiated; \"\n                            f\"use {self.__origin__.__name__}() instead\")\nE           TypeError: Type Tuple cannot be instantiated; use tuple() instead\n\n/usr/local/lib/python3.10/typing.py:941: TypeError\n_________ test_offset_to_location_wrapping_enabled[offset1-location1] __________\n\noffset = Offset(x=1, y=0), location = (0, 1)\n\n    @pytest.mark.parametrize(\n        \"offset,location\",  # location is (row, column)\n        [\n            (Offset(x=0, y=0), (0, 0)),\n            (Offset(x=1, y=0), (0, 1)),\n            (Offset(x=2, y=1), (0, 6)),\n            (Offset(x=0, y=3), (1, 4)),\n            (Offset(x=1, y=3), (1, 5)),\n            (Offset(x=200, y=3), (1, 5)),\n            (Offset(x=0, y=6), (2, 8)),\n            (Offset(x=0, y=7), (3, 0)),  # Clicking on the final, empty line\n            (Offset(x=0, y=1000), (3, 0)),\n        ],\n    )\n    def test_offset_to_location_wrapping_enabled(offset, location):\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=4)\n    \n>       assert wrapped_document.offset_to_location(offset) == location\n\ntests/document/test_wrapped_document.py:139: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/document/_wrapped_document.py:313: in offset_to_location\n    return Location(line_index, column_index)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = typing.Tuple[int, int], args = (0, 1), kwargs = {}\n\n    def __call__(self, *args, **kwargs):\n        if not self._inst:\n>           raise TypeError(f\"Type {self._name} cannot be instantiated; \"\n                            f\"use {self.__origin__.__name__}() instead\")\nE           TypeError: Type Tuple cannot be instantiated; use tuple() instead\n\n/usr/local/lib/python3.10/typing.py:941: TypeError\n_________ test_offset_to_location_wrapping_enabled[offset2-location2] __________\n\noffset = Offset(x=2, y=1), location = (0, 6)\n\n    @pytest.mark.parametrize(\n        \"offset,location\",  # location is (row, column)\n        [\n            (Offset(x=0, y=0), (0, 0)),\n            (Offset(x=1, y=0), (0, 1)),\n            (Offset(x=2, y=1), (0, 6)),\n            (Offset(x=0, y=3), (1, 4)),\n            (Offset(x=1, y=3), (1, 5)),\n            (Offset(x=200, y=3), (1, 5)),\n            (Offset(x=0, y=6), (2, 8)),\n            (Offset(x=0, y=7), (3, 0)),  # Clicking on the final, empty line\n            (Offset(x=0, y=1000), (3, 0)),\n        ],\n    )\n    def test_offset_to_location_wrapping_enabled(offset, location):\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=4)\n    \n>       assert wrapped_document.offset_to_location(offset) == location\n\ntests/document/test_wrapped_document.py:139: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/document/_wrapped_document.py:313: in offset_to_location\n    return Location(line_index, column_index)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = typing.Tuple[int, int], args = (0, 6), kwargs = {}\n\n    def __call__(self, *args, **kwargs):\n        if not self._inst:\n>           raise TypeError(f\"Type {self._name} cannot be instantiated; \"\n                            f\"use {self.__origin__.__name__}() instead\")\nE           TypeError: Type Tuple cannot be instantiated; use tuple() instead\n\n/usr/local/lib/python3.10/typing.py:941: TypeError\n_________ test_offset_to_location_wrapping_enabled[offset3-location3] __________\n\noffset = Offset(x=0, y=3), location = (1, 4)\n\n    @pytest.mark.parametrize(\n        \"offset,location\",  # location is (row, column)\n        [\n            (Offset(x=0, y=0), (0, 0)),\n            (Offset(x=1, y=0), (0, 1)),\n            (Offset(x=2, y=1), (0, 6)),\n            (Offset(x=0, y=3), (1, 4)),\n            (Offset(x=1, y=3), (1, 5)),\n            (Offset(x=200, y=3), (1, 5)),\n            (Offset(x=0, y=6), (2, 8)),\n            (Offset(x=0, y=7), (3, 0)),  # Clicking on the final, empty line\n            (Offset(x=0, y=1000), (3, 0)),\n        ],\n    )\n    def test_offset_to_location_wrapping_enabled(offset, location):\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=4)\n    \n>       assert wrapped_document.offset_to_location(offset) == location\n\ntests/document/test_wrapped_document.py:139: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/document/_wrapped_document.py:313: in offset_to_location\n    return Location(line_index, column_index)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = typing.Tuple[int, int], args = (1, 4), kwargs = {}\n\n    def __call__(self, *args, **kwargs):\n        if not self._inst:\n>           raise TypeError(f\"Type {self._name} cannot be instantiated; \"\n                            f\"use {self.__origin__.__name__}() instead\")\nE           TypeError: Type Tuple cannot be instantiated; use tuple() instead\n\n/usr/local/lib/python3.10/typing.py:941: TypeError\n_________ test_offset_to_location_wrapping_enabled[offset4-location4] __________\n\noffset = Offset(x=1, y=3), location = (1, 5)\n\n    @pytest.mark.parametrize(\n        \"offset,location\",  # location is (row, column)\n        [\n            (Offset(x=0, y=0), (0, 0)),\n            (Offset(x=1, y=0), (0, 1)),\n            (Offset(x=2, y=1), (0, 6)),\n            (Offset(x=0, y=3), (1, 4)),\n            (Offset(x=1, y=3), (1, 5)),\n            (Offset(x=200, y=3), (1, 5)),\n            (Offset(x=0, y=6), (2, 8)),\n            (Offset(x=0, y=7), (3, 0)),  # Clicking on the final, empty line\n            (Offset(x=0, y=1000), (3, 0)),\n        ],\n    )\n    def test_offset_to_location_wrapping_enabled(offset, location):\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=4)\n    \n>       assert wrapped_document.offset_to_location(offset) == location\n\ntests/document/test_wrapped_document.py:139: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/document/_wrapped_document.py:313: in offset_to_location\n    return Location(line_index, column_index)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = typing.Tuple[int, int], args = (1, 5), kwargs = {}\n\n    def __call__(self, *args, **kwargs):\n        if not self._inst:\n>           raise TypeError(f\"Type {self._name} cannot be instantiated; \"\n                            f\"use {self.__origin__.__name__}() instead\")\nE           TypeError: Type Tuple cannot be instantiated; use tuple() instead\n\n/usr/local/lib/python3.10/typing.py:941: TypeError\n_________ test_offset_to_location_wrapping_enabled[offset5-location5] __________\n\noffset = Offset(x=200, y=3), location = (1, 5)\n\n    @pytest.mark.parametrize(\n        \"offset,location\",  # location is (row, column)\n        [\n            (Offset(x=0, y=0), (0, 0)),\n            (Offset(x=1, y=0), (0, 1)),\n            (Offset(x=2, y=1), (0, 6)),\n            (Offset(x=0, y=3), (1, 4)),\n            (Offset(x=1, y=3), (1, 5)),\n            (Offset(x=200, y=3), (1, 5)),\n            (Offset(x=0, y=6), (2, 8)),\n            (Offset(x=0, y=7), (3, 0)),  # Clicking on the final, empty line\n            (Offset(x=0, y=1000), (3, 0)),\n        ],\n    )\n    def test_offset_to_location_wrapping_enabled(offset, location):\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=4)\n    \n>       assert wrapped_document.offset_to_location(offset) == location\n\ntests/document/test_wrapped_document.py:139: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/document/_wrapped_document.py:313: in offset_to_location\n    return Location(line_index, column_index)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = typing.Tuple[int, int], args = (1, 5), kwargs = {}\n\n    def __call__(self, *args, **kwargs):\n        if not self._inst:\n>           raise TypeError(f\"Type {self._name} cannot be instantiated; \"\n                            f\"use {self.__origin__.__name__}() instead\")\nE           TypeError: Type Tuple cannot be instantiated; use tuple() instead\n\n/usr/local/lib/python3.10/typing.py:941: TypeError\n_________ test_offset_to_location_wrapping_enabled[offset6-location6] __________\n\noffset = Offset(x=0, y=6), location = (2, 8)\n\n    @pytest.mark.parametrize(\n        \"offset,location\",  # location is (row, column)\n        [\n            (Offset(x=0, y=0), (0, 0)),\n            (Offset(x=1, y=0), (0, 1)),\n            (Offset(x=2, y=1), (0, 6)),\n            (Offset(x=0, y=3), (1, 4)),\n            (Offset(x=1, y=3), (1, 5)),\n            (Offset(x=200, y=3), (1, 5)),\n            (Offset(x=0, y=6), (2, 8)),\n            (Offset(x=0, y=7), (3, 0)),  # Clicking on the final, empty line\n            (Offset(x=0, y=1000), (3, 0)),\n        ],\n    )\n    def test_offset_to_location_wrapping_enabled(offset, location):\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=4)\n    \n>       assert wrapped_document.offset_to_location(offset) == location\n\ntests/document/test_wrapped_document.py:139: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/document/_wrapped_document.py:313: in offset_to_location\n    return Location(line_index, column_index)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = typing.Tuple[int, int], args = (2, 8), kwargs = {}\n\n    def __call__(self, *args, **kwargs):\n        if not self._inst:\n>           raise TypeError(f\"Type {self._name} cannot be instantiated; \"\n                            f\"use {self.__origin__.__name__}() instead\")\nE           TypeError: Type Tuple cannot be instantiated; use tuple() instead\n\n/usr/local/lib/python3.10/typing.py:941: TypeError\n_________ test_offset_to_location_wrapping_enabled[offset7-location7] __________\n\noffset = Offset(x=0, y=7), location = (3, 0)\n\n    @pytest.mark.parametrize(\n        \"offset,location\",  # location is (row, column)\n        [\n            (Offset(x=0, y=0), (0, 0)),\n            (Offset(x=1, y=0), (0, 1)),\n            (Offset(x=2, y=1), (0, 6)),\n            (Offset(x=0, y=3), (1, 4)),\n            (Offset(x=1, y=3), (1, 5)),\n            (Offset(x=200, y=3), (1, 5)),\n            (Offset(x=0, y=6), (2, 8)),\n            (Offset(x=0, y=7), (3, 0)),  # Clicking on the final, empty line\n            (Offset(x=0, y=1000), (3, 0)),\n        ],\n    )\n    def test_offset_to_location_wrapping_enabled(offset, location):\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=4)\n    \n>       assert wrapped_document.offset_to_location(offset) == location\n\ntests/document/test_wrapped_document.py:139: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/document/_wrapped_document.py:313: in offset_to_location\n    return Location(line_index, column_index)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = typing.Tuple[int, int], args = (3, 0), kwargs = {}\n\n    def __call__(self, *args, **kwargs):\n        if not self._inst:\n>           raise TypeError(f\"Type {self._name} cannot be instantiated; \"\n                            f\"use {self.__origin__.__name__}() instead\")\nE           TypeError: Type Tuple cannot be instantiated; use tuple() instead\n\n/usr/local/lib/python3.10/typing.py:941: TypeError\n_________ test_offset_to_location_wrapping_enabled[offset8-location8] __________\n\noffset = Offset(x=0, y=1000), location = (3, 0)\n\n    @pytest.mark.parametrize(\n        \"offset,location\",  # location is (row, column)\n        [\n            (Offset(x=0, y=0), (0, 0)),\n            (Offset(x=1, y=0), (0, 1)),\n            (Offset(x=2, y=1), (0, 6)),\n            (Offset(x=0, y=3), (1, 4)),\n            (Offset(x=1, y=3), (1, 5)),\n            (Offset(x=200, y=3), (1, 5)),\n            (Offset(x=0, y=6), (2, 8)),\n            (Offset(x=0, y=7), (3, 0)),  # Clicking on the final, empty line\n            (Offset(x=0, y=1000), (3, 0)),\n        ],\n    )\n    def test_offset_to_location_wrapping_enabled(offset, location):\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=4)\n    \n>       assert wrapped_document.offset_to_location(offset) == location\n\ntests/document/test_wrapped_document.py:139: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual.document._wrapped_document.WrappedDocument object at 0x7f9469daf460>\noffset = Offset(x=0, y=1000)\n\n    def offset_to_location(self, offset: Offset) -> Location:\n        \"\"\"Given an offset within the wrapped/visual display of the document,\n        return the corresponding location in the document.\n    \n        Args:\n            offset: The y-offset within the document.\n    \n        Raises:\n            ValueError: When the given offset does not correspond to a line\n                in the document.\n    \n        Returns:\n            The Location in the document corresponding to the given offset.\n        \"\"\"\n        x_offset, y_offset = offset\n    \n        if y_offset < 0 or y_offset >= len(self._offset_to_line_info):\n>           raise ValueError(f\"Invalid y-offset: {y_offset}\")\nE           ValueError: Invalid y-offset: 1000\n\nsrc/textual/document/_wrapped_document.py:294: ValueError\n_ test_offset_to_location_invalid_offset_clamps_to_valid_offset[offset0-location0] _\n\noffset = Offset(x=-3, y=0), location = (0, 0)\n\n    @pytest.mark.parametrize(\n        \"offset,location\",\n        [\n            [Offset(-3, 0), (0, 0)],\n            [Offset(0, -10), (0, 0)],\n        ],\n    )\n    def test_offset_to_location_invalid_offset_clamps_to_valid_offset(offset, location):\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=4)\n    \n>       result = wrapped_document.offset_to_location(offset)\n\ntests/document/test_wrapped_document.py:172: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/document/_wrapped_document.py:313: in offset_to_location\n    return Location(line_index, column_index)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = typing.Tuple[int, int], args = (0, 0), kwargs = {}\n\n    def __call__(self, *args, **kwargs):\n        if not self._inst:\n>           raise TypeError(f\"Type {self._name} cannot be instantiated; \"\n                            f\"use {self.__origin__.__name__}() instead\")\nE           TypeError: Type Tuple cannot be instantiated; use tuple() instead\n\n/usr/local/lib/python3.10/typing.py:941: TypeError\n_ test_offset_to_location_invalid_offset_clamps_to_valid_offset[offset1-location1] _\n\noffset = Offset(x=0, y=-10), location = (0, 0)\n\n    @pytest.mark.parametrize(\n        \"offset,location\",\n        [\n            [Offset(-3, 0), (0, 0)],\n            [Offset(0, -10), (0, 0)],\n        ],\n    )\n    def test_offset_to_location_invalid_offset_clamps_to_valid_offset(offset, location):\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=4)\n    \n>       result = wrapped_document.offset_to_location(offset)\n\ntests/document/test_wrapped_document.py:172: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual.document._wrapped_document.WrappedDocument object at 0x7f9469986d10>\noffset = Offset(x=0, y=-10)\n\n    def offset_to_location(self, offset: Offset) -> Location:\n        \"\"\"Given an offset within the wrapped/visual display of the document,\n        return the corresponding location in the document.\n    \n        Args:\n            offset: The y-offset within the document.\n    \n        Raises:\n            ValueError: When the given offset does not correspond to a line\n                in the document.\n    \n        Returns:\n            The Location in the document corresponding to the given offset.\n        \"\"\"\n        x_offset, y_offset = offset\n    \n        if y_offset < 0 or y_offset >= len(self._offset_to_line_info):\n>           raise ValueError(f\"Invalid y-offset: {y_offset}\")\nE           ValueError: Invalid y-offset: -10\n\nsrc/textual/document/_wrapped_document.py:294: ValueError\n_________ test_offset_to_location_wrapping_disabled[offset0-location0] _________\n\noffset = Offset(x=0, y=0), location = (0, 0)\n\n    @pytest.mark.parametrize(\n        \"offset,location\",  # location is (row, column)\n        [\n            (Offset(x=0, y=0), (0, 0)),\n            (Offset(x=1, y=0), (0, 1)),\n            (Offset(x=2, y=1), (1, 2)),\n            (Offset(x=0, y=3), (3, 0)),\n            (Offset(x=1, y=3), (3, 0)),\n            (Offset(x=200, y=3), (3, 0)),\n            (Offset(x=200, y=200), (3, 0)),  # Clicking below the document\n        ],\n    )\n    def test_offset_to_location_wrapping_disabled(offset, location):\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=0)\n    \n>       assert wrapped_document.offset_to_location(offset) == location\n\ntests/document/test_wrapped_document.py:158: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/document/_wrapped_document.py:313: in offset_to_location\n    return Location(line_index, column_index)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = typing.Tuple[int, int], args = (0, 0), kwargs = {}\n\n    def __call__(self, *args, **kwargs):\n        if not self._inst:\n>           raise TypeError(f\"Type {self._name} cannot be instantiated; \"\n                            f\"use {self.__origin__.__name__}() instead\")\nE           TypeError: Type Tuple cannot be instantiated; use tuple() instead\n\n/usr/local/lib/python3.10/typing.py:941: TypeError\n_________ test_offset_to_location_wrapping_disabled[offset1-location1] _________\n\noffset = Offset(x=1, y=0), location = (0, 1)\n\n    @pytest.mark.parametrize(\n        \"offset,location\",  # location is (row, column)\n        [\n            (Offset(x=0, y=0), (0, 0)),\n            (Offset(x=1, y=0), (0, 1)),\n            (Offset(x=2, y=1), (1, 2)),\n            (Offset(x=0, y=3), (3, 0)),\n            (Offset(x=1, y=3), (3, 0)),\n            (Offset(x=200, y=3), (3, 0)),\n            (Offset(x=200, y=200), (3, 0)),  # Clicking below the document\n        ],\n    )\n    def test_offset_to_location_wrapping_disabled(offset, location):\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=0)\n    \n>       assert wrapped_document.offset_to_location(offset) == location\n\ntests/document/test_wrapped_document.py:158: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/document/_wrapped_document.py:313: in offset_to_location\n    return Location(line_index, column_index)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = typing.Tuple[int, int], args = (0, 1), kwargs = {}\n\n    def __call__(self, *args, **kwargs):\n        if not self._inst:\n>           raise TypeError(f\"Type {self._name} cannot be instantiated; \"\n                            f\"use {self.__origin__.__name__}() instead\")\nE           TypeError: Type Tuple cannot be instantiated; use tuple() instead\n\n/usr/local/lib/python3.10/typing.py:941: TypeError\n_________ test_offset_to_location_wrapping_disabled[offset2-location2] _________\n\noffset = Offset(x=2, y=1), location = (1, 2)\n\n    @pytest.mark.parametrize(\n        \"offset,location\",  # location is (row, column)\n        [\n            (Offset(x=0, y=0), (0, 0)),\n            (Offset(x=1, y=0), (0, 1)),\n            (Offset(x=2, y=1), (1, 2)),\n            (Offset(x=0, y=3), (3, 0)),\n            (Offset(x=1, y=3), (3, 0)),\n            (Offset(x=200, y=3), (3, 0)),\n            (Offset(x=200, y=200), (3, 0)),  # Clicking below the document\n        ],\n    )\n    def test_offset_to_location_wrapping_disabled(offset, location):\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=0)\n    \n>       assert wrapped_document.offset_to_location(offset) == location\n\ntests/document/test_wrapped_document.py:158: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/document/_wrapped_document.py:313: in offset_to_location\n    return Location(line_index, column_index)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = typing.Tuple[int, int], args = (1, 2), kwargs = {}\n\n    def __call__(self, *args, **kwargs):\n        if not self._inst:\n>           raise TypeError(f\"Type {self._name} cannot be instantiated; \"\n                            f\"use {self.__origin__.__name__}() instead\")\nE           TypeError: Type Tuple cannot be instantiated; use tuple() instead\n\n/usr/local/lib/python3.10/typing.py:941: TypeError\n_________ test_offset_to_location_wrapping_disabled[offset3-location3] _________\n\noffset = Offset(x=0, y=3), location = (3, 0)\n\n    @pytest.mark.parametrize(\n        \"offset,location\",  # location is (row, column)\n        [\n            (Offset(x=0, y=0), (0, 0)),\n            (Offset(x=1, y=0), (0, 1)),\n            (Offset(x=2, y=1), (1, 2)),\n            (Offset(x=0, y=3), (3, 0)),\n            (Offset(x=1, y=3), (3, 0)),\n            (Offset(x=200, y=3), (3, 0)),\n            (Offset(x=200, y=200), (3, 0)),  # Clicking below the document\n        ],\n    )\n    def test_offset_to_location_wrapping_disabled(offset, location):\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=0)\n    \n>       assert wrapped_document.offset_to_location(offset) == location\n\ntests/document/test_wrapped_document.py:158: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/document/_wrapped_document.py:313: in offset_to_location\n    return Location(line_index, column_index)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = typing.Tuple[int, int], args = (3, 0), kwargs = {}\n\n    def __call__(self, *args, **kwargs):\n        if not self._inst:\n>           raise TypeError(f\"Type {self._name} cannot be instantiated; \"\n                            f\"use {self.__origin__.__name__}() instead\")\nE           TypeError: Type Tuple cannot be instantiated; use tuple() instead\n\n/usr/local/lib/python3.10/typing.py:941: TypeError\n_________ test_offset_to_location_wrapping_disabled[offset4-location4] _________\n\noffset = Offset(x=1, y=3), location = (3, 0)\n\n    @pytest.mark.parametrize(\n        \"offset,location\",  # location is (row, column)\n        [\n            (Offset(x=0, y=0), (0, 0)),\n            (Offset(x=1, y=0), (0, 1)),\n            (Offset(x=2, y=1), (1, 2)),\n            (Offset(x=0, y=3), (3, 0)),\n            (Offset(x=1, y=3), (3, 0)),\n            (Offset(x=200, y=3), (3, 0)),\n            (Offset(x=200, y=200), (3, 0)),  # Clicking below the document\n        ],\n    )\n    def test_offset_to_location_wrapping_disabled(offset, location):\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=0)\n    \n>       assert wrapped_document.offset_to_location(offset) == location\n\ntests/document/test_wrapped_document.py:158: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/document/_wrapped_document.py:313: in offset_to_location\n    return Location(line_index, column_index)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = typing.Tuple[int, int], args = (3, 0), kwargs = {}\n\n    def __call__(self, *args, **kwargs):\n        if not self._inst:\n>           raise TypeError(f\"Type {self._name} cannot be instantiated; \"\n                            f\"use {self.__origin__.__name__}() instead\")\nE           TypeError: Type Tuple cannot be instantiated; use tuple() instead\n\n/usr/local/lib/python3.10/typing.py:941: TypeError\n_________ test_offset_to_location_wrapping_disabled[offset5-location5] _________\n\noffset = Offset(x=200, y=3), location = (3, 0)\n\n    @pytest.mark.parametrize(\n        \"offset,location\",  # location is (row, column)\n        [\n            (Offset(x=0, y=0), (0, 0)),\n            (Offset(x=1, y=0), (0, 1)),\n            (Offset(x=2, y=1), (1, 2)),\n            (Offset(x=0, y=3), (3, 0)),\n            (Offset(x=1, y=3), (3, 0)),\n            (Offset(x=200, y=3), (3, 0)),\n            (Offset(x=200, y=200), (3, 0)),  # Clicking below the document\n        ],\n    )\n    def test_offset_to_location_wrapping_disabled(offset, location):\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=0)\n    \n>       assert wrapped_document.offset_to_location(offset) == location\n\ntests/document/test_wrapped_document.py:158: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/document/_wrapped_document.py:313: in offset_to_location\n    return Location(line_index, column_index)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = typing.Tuple[int, int], args = (3, 0), kwargs = {}\n\n    def __call__(self, *args, **kwargs):\n        if not self._inst:\n>           raise TypeError(f\"Type {self._name} cannot be instantiated; \"\n                            f\"use {self.__origin__.__name__}() instead\")\nE           TypeError: Type Tuple cannot be instantiated; use tuple() instead\n\n/usr/local/lib/python3.10/typing.py:941: TypeError\n_________ test_offset_to_location_wrapping_disabled[offset6-location6] _________\n\noffset = Offset(x=200, y=200), location = (3, 0)\n\n    @pytest.mark.parametrize(\n        \"offset,location\",  # location is (row, column)\n        [\n            (Offset(x=0, y=0), (0, 0)),\n            (Offset(x=1, y=0), (0, 1)),\n            (Offset(x=2, y=1), (1, 2)),\n            (Offset(x=0, y=3), (3, 0)),\n            (Offset(x=1, y=3), (3, 0)),\n            (Offset(x=200, y=3), (3, 0)),\n            (Offset(x=200, y=200), (3, 0)),  # Clicking below the document\n        ],\n    )\n    def test_offset_to_location_wrapping_disabled(offset, location):\n        document = Document(SIMPLE_TEXT)\n        wrapped_document = WrappedDocument(document, width=0)\n    \n>       assert wrapped_document.offset_to_location(offset) == location\n\ntests/document/test_wrapped_document.py:158: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual.document._wrapped_document.WrappedDocument object at 0x7f9469e97a60>\noffset = Offset(x=200, y=200)\n\n    def offset_to_location(self, offset: Offset) -> Location:\n        \"\"\"Given an offset within the wrapped/visual display of the document,\n        return the corresponding location in the document.\n    \n        Args:\n            offset: The y-offset within the document.\n    \n        Raises:\n            ValueError: When the given offset does not correspond to a line\n                in the document.\n    \n        Returns:\n            The Location in the document corresponding to the given offset.\n        \"\"\"\n        x_offset, y_offset = offset\n    \n        if y_offset < 0 or y_offset >= len(self._offset_to_line_info):\n>           raise ValueError(f\"Invalid y-offset: {y_offset}\")\nE           ValueError: Invalid y-offset: 200\n\nsrc/textual/document/_wrapped_document.py:294: ValueError\n=========================== short test summary info ============================\nFAILED tests/document/test_wrapped_document.py::test_offset_to_location_wrapping_enabled[offset0-location0]\nFAILED tests/document/test_wrapped_document.py::test_offset_to_location_wrapping_enabled[offset1-location1]\nFAILED tests/document/test_wrapped_document.py::test_offset_to_location_wrapping_enabled[offset2-location2]\nFAILED tests/document/test_wrapped_document.py::test_offset_to_location_wrapping_enabled[offset3-location3]\nFAILED tests/document/test_wrapped_document.py::test_offset_to_location_wrapping_enabled[offset4-location4]\nFAILED tests/document/test_wrapped_document.py::test_offset_to_location_wrapping_enabled[offset5-location5]\nFAILED tests/document/test_wrapped_document.py::test_offset_to_location_wrapping_enabled[offset6-location6]\nFAILED tests/document/test_wrapped_document.py::test_offset_to_location_wrapping_enabled[offset7-location7]\nFAILED tests/document/test_wrapped_document.py::test_offset_to_location_wrapping_enabled[offset8-location8]\nFAILED tests/document/test_wrapped_document.py::test_offset_to_location_invalid_offset_clamps_to_valid_offset[offset0-location0]\nFAILED tests/document/test_wrapped_document.py::test_offset_to_location_invalid_offset_clamps_to_valid_offset[offset1-location1]\nFAILED tests/document/test_wrapped_document.py::test_offset_to_location_wrapping_disabled[offset0-location0]\nFAILED tests/document/test_wrapped_document.py::test_offset_to_location_wrapping_disabled[offset1-location1]\nFAILED tests/document/test_wrapped_document.py::test_offset_to_location_wrapping_disabled[offset2-location2]\nFAILED tests/document/test_wrapped_document.py::test_offset_to_location_wrapping_disabled[offset3-location3]\nFAILED tests/document/test_wrapped_document.py::test_offset_to_location_wrapping_disabled[offset4-location4]\nFAILED tests/document/test_wrapped_document.py::test_offset_to_location_wrapping_disabled[offset5-location5]\nFAILED tests/document/test_wrapped_document.py::test_offset_to_location_wrapping_disabled[offset6-location6]\n============================== 18 failed in 0.45s ==============================\n\n"], "textual-src/textual/css/parse.py-substitute_references": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 0 items\n\n============================ no tests ran in 0.08s =============================\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_multi_value_variable\n(no match in any of [<Module test_parse.py>])\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_simple_reference\n(no match in any of [<Module test_parse.py>])\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_variable_reference_whitespace_trimming\n(no match in any of [<Module test_parse.py>])\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_transitive_reference\n(no match in any of [<Module test_parse.py>])\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_simple_reference_no_whitespace\n(no match in any of [<Module test_parse.py>])\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_variable_definition_eof\n(no match in any of [<Module test_parse.py>])\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_empty_variable\n(no match in any of [<Module test_parse.py>])\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_variable_used_inside_property_value\n(no match in any of [<Module test_parse.py>])\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_undefined_variable\n(no match in any of [<Module test_parse.py>])\n\n"], "textual-src/textual/css/parse.py-parse": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 14 items\n\ntests/css/test_nested_css.py FFFFFFFFFFFFFF                              [100%]\n\n=================================== FAILURES ===================================\n________________________________ test_nest_app _________________________________\n\n    async def test_nest_app():\n        \"\"\"Test nested CSS works as expected.\"\"\"\n        app = NestedApp()\n>       async with app.run_test():\n\ntests/css/test_nested_css.py:40: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:199: in __aenter__\n    return await anext(self.gen)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2588: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2533: in run_process_messages\n    await self._dispatch_message(events.Compose())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3053: in on_event\n    self._register(self, screen)\nsrc/textual/app.py:2752: in _register\n    apply_stylesheet(widget, cache=cache)\nsrc/textual/css/stylesheet.py:461: in apply\n    rules_map = self.rules_map\nsrc/textual/css/stylesheet.py:184: in rules_map\n    for rule in self.rules:\nsrc/textual/css/stylesheet.py:170: in rules\n    self.parse()\nsrc/textual/css/stylesheet.py:368: in parse\n    css_rules = self._parse_rules(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <Stylesheet [('/root/repos/py_data/textual/src/textual/app.py', 'App.DEFAULT_CSS'), ('/root/repos/py_data/textual/test...extual/screen.py', 'Screen.DEFAULT_CSS'), ('/root/repos/py_data/textual/src/textual/widget.py', 'Widget.DEFAULT_CSS')]>\ncss = '\\n    App {\\n        background: $background;\\n        color: $text;\\n    }\\n    *:disabled:can-focus {\\n        opacity: 0.7;\\n    }\\n    '\nread_from = ('/root/repos/py_data/textual/src/textual/app.py', 'App.DEFAULT_CSS')\nis_default_rules = True, tie_breaker = -1, scope = 'App'\n\n    def _parse_rules(\n        self,\n        css: str,\n        read_from: CSSLocation,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n        scope: str = \"\",\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS and return rules.\n    \n        Args:\n            css: String containing Textual CSS.\n            read_from: Original CSS location.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            scope: Scope of rules, or empty string for global scope.\n    \n        Raises:\n            StylesheetError: If the CSS is invalid.\n    \n        Returns:\n            List of RuleSets.\n        \"\"\"\n        cache_key = (css, read_from, is_default_rules, tie_breaker, scope)\n        try:\n            return self._parse_cache[cache_key]\n        except KeyError:\n            pass\n        try:\n            rules = list(\n                parse(\n                    scope,\n                    css,\n                    read_from,\n                    variable_tokens=self._variable_tokens,\n                    is_default_rules=is_default_rules,\n                    tie_breaker=tie_breaker,\n                )\n            )\n        except TokenError:\n            raise\n        except Exception as error:\n>           raise StylesheetError(f\"failed to parse css; {error}\") from None\nE           textual.css.errors.StylesheetError: failed to parse css; parse() got an unexpected keyword argument 'variable_tokens'\n\nsrc/textual/css/stylesheet.py:261: StylesheetError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/src/textual/app.py:3053 in on_event              \u2502\n\u2502                                                                              \u2502\n\u2502   3050 \u2502   \u2502   # If the event has been forwarded it may have bubbled up back \u2502\n\u2502   3051 \u2502   \u2502   if isinstance(event, events.Compose):                         \u2502\n\u2502   3052 \u2502   \u2502   \u2502   screen: Screen[Any] = self.get_default_screen()           \u2502\n\u2502 \u2771 3053 \u2502   \u2502   \u2502   self._register(self, screen)                              \u2502\n\u2502   3054 \u2502   \u2502   \u2502   self._screen_stack.append(screen)                         \u2502\n\u2502   3055 \u2502   \u2502   \u2502   screen.post_message(events.ScreenResume())                \u2502\n\u2502   3056 \u2502   \u2502   \u2502   await super().on_event(event)                             \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e            \u2502\n\u2502 \u2502  event = Compose()                                            \u2502            \u2502\n\u2502 \u2502 screen = Screen(id='_default')                                \u2502            \u2502\n\u2502 \u2502   self = NestedApp(title='NestedApp', classes={'-dark-mode'}) \u2502            \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f            \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2752 in _register             \u2502\n\u2502                                                                              \u2502\n\u2502   2749 \u2502   \u2502   \u2502   \u2502   self._register_child(parent, widget, before, after)   \u2502\n\u2502   2750 \u2502   \u2502   \u2502   \u2502   if widget._nodes:                                     \u2502\n\u2502   2751 \u2502   \u2502   \u2502   \u2502   \u2502   self._register(widget, *widget._nodes, cache=cach \u2502\n\u2502 \u2771 2752 \u2502   \u2502   \u2502   \u2502   apply_stylesheet(widget, cache=cache)                 \u2502\n\u2502   2753 \u2502   \u2502                                                                 \u2502\n\u2502   2754 \u2502   \u2502   if not self._running:                                         \u2502\n\u2502   2755 \u2502   \u2502   \u2502   # If the app is not running, prevent awaiting of the widg \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502            after = None                                                  \u2502 \u2502\n\u2502 \u2502 apply_stylesheet = <bound method Stylesheet.apply of <Stylesheet         \u2502 \u2502\n\u2502 \u2502                    [('/root/repos/py_data/textual/src/textual/app.py',   \u2502 \u2502\n\u2502 \u2502                    'App.DEFAULT_CSS'),                                   \u2502 \u2502\n\u2502 \u2502                    ('/root/repos/py_data/textual/tests/css/test_nested_\u2026 \u2502 \u2502\n\u2502 \u2502                    'NestedApp.CSS'),                                     \u2502 \u2502\n\u2502 \u2502                    ('/root/repos/py_data/textual/src/textual/screen.py', \u2502 \u2502\n\u2502 \u2502                    'Screen.DEFAULT_CSS'),                                \u2502 \u2502\n\u2502 \u2502                    ('/root/repos/py_data/textual/src/textual/widget.py', \u2502 \u2502\n\u2502 \u2502                    'Widget.DEFAULT_CSS')]>>                              \u2502 \u2502\n\u2502 \u2502           before = None                                                  \u2502 \u2502\n\u2502 \u2502            cache = {}                                                    \u2502 \u2502\n\u2502 \u2502           parent = NestedApp(title='NestedApp', classes={'-dark-mode'})  \u2502 \u2502\n\u2502 \u2502             self = NestedApp(title='NestedApp', classes={'-dark-mode'})  \u2502 \u2502\n\u2502 \u2502           widget = Screen(id='_default')                                 \u2502 \u2502\n\u2502 \u2502      widget_list = (Screen(id='_default'),)                              \u2502 \u2502\n\u2502 \u2502          widgets = (Screen(id='_default'),)                              \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:461 in apply       \u2502\n\u2502                                                                              \u2502\n\u2502   458 \u2502   \u2502   rule_attributes: defaultdict[str, list[tuple[Specificity6, obj \u2502\n\u2502   459 \u2502   \u2502   rule_attributes = defaultdict(list)                            \u2502\n\u2502   460 \u2502   \u2502                                                                  \u2502\n\u2502 \u2771 461 \u2502   \u2502   rules_map = self.rules_map                                     \u2502\n\u2502   462 \u2502   \u2502                                                                  \u2502\n\u2502   463 \u2502   \u2502   # Discard rules which are not applicable early                 \u2502\n\u2502   464 \u2502   \u2502   limit_rules = {                                                \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502         animate = False                                                  \u2502 \u2502\n\u2502 \u2502           cache = {}                                                     \u2502 \u2502\n\u2502 \u2502            node = Screen(id='_default')                                  \u2502 \u2502\n\u2502 \u2502 rule_attributes = defaultdict(<class 'list'>, {})                        \u2502 \u2502\n\u2502 \u2502            self = <Stylesheet                                            \u2502 \u2502\n\u2502 \u2502                   \u2502   [                                                  \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   (                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502                                              \u2502 \u2502\n\u2502 \u2502                   '/root/repos/py_data/textual/src/textual/app.py',      \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                          \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   ),                                             \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   (                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502                                              \u2502 \u2502\n\u2502 \u2502                   '/root/repos/py_data/textual/tests/css/test_nested_cs\u2026 \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502   'NestedApp.CSS'                            \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   ),                                             \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   (                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502                                              \u2502 \u2502\n\u2502 \u2502                   '/root/repos/py_data/textual/src/textual/screen.py',   \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                       \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   ),                                             \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   (                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502                                              \u2502 \u2502\n\u2502 \u2502                   '/root/repos/py_data/textual/src/textual/widget.py',   \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                       \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   )                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   ]                                                  \u2502 \u2502\n\u2502 \u2502                   >                                                      \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:184 in rules_map   \u2502\n\u2502                                                                              \u2502\n\u2502   181 \u2502   \u2502   \"\"\"                                                            \u2502\n\u2502   182 \u2502   \u2502   if self._rules_map is None:                                    \u2502\n\u2502   183 \u2502   \u2502   \u2502   rules_map: dict[str, list[RuleSet]] = defaultdict(list)    \u2502\n\u2502 \u2771 184 \u2502   \u2502   \u2502   for rule in self.rules:                                    \u2502\n\u2502   185 \u2502   \u2502   \u2502   \u2502   for name in rule.selector_names:                       \u2502\n\u2502   186 \u2502   \u2502   \u2502   \u2502   \u2502   rules_map[name].append(rule)                       \u2502\n\u2502   187 \u2502   \u2502   \u2502   self._rules_map = dict(rules_map)                          \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 rules_map = defaultdict(<class 'list'>, {})                              \u2502 \u2502\n\u2502 \u2502      self = <Stylesheet                                                  \u2502 \u2502\n\u2502 \u2502             \u2502   [                                                        \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   (                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502                                                    \u2502 \u2502\n\u2502 \u2502             '/root/repos/py_data/textual/src/textual/app.py',            \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                                \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   ),                                                   \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   (                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502                                                    \u2502 \u2502\n\u2502 \u2502             '/root/repos/py_data/textual/tests/css/test_nested_css.py',  \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502   'NestedApp.CSS'                                  \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   ),                                                   \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   (                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502                                                    \u2502 \u2502\n\u2502 \u2502             '/root/repos/py_data/textual/src/textual/screen.py',         \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                             \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   ),                                                   \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   (                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502                                                    \u2502 \u2502\n\u2502 \u2502             '/root/repos/py_data/textual/src/textual/widget.py',         \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                             \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   )                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   ]                                                        \u2502 \u2502\n\u2502 \u2502             >                                                            \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:170 in rules       \u2502\n\u2502                                                                              \u2502\n\u2502   167 \u2502   \u2502   \u2502   List of rules sets for this stylesheet.                    \u2502\n\u2502   168 \u2502   \u2502   \"\"\"                                                            \u2502\n\u2502   169 \u2502   \u2502   if self._require_parse:                                        \u2502\n\u2502 \u2771 170 \u2502   \u2502   \u2502   self.parse()                                               \u2502\n\u2502   171 \u2502   \u2502   \u2502   self._require_parse = False                                \u2502\n\u2502   172 \u2502   \u2502   assert self._rules is not None                                 \u2502\n\u2502   173 \u2502   \u2502   return self._rules                                             \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 self = <Stylesheet                                                       \u2502 \u2502\n\u2502 \u2502        \u2502   [                                                             \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   (                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   '/root/repos/py_data/textual/src/textual/app.py',     \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                                     \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   ),                                                        \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   (                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502                                                         \u2502 \u2502\n\u2502 \u2502        '/root/repos/py_data/textual/tests/css/test_nested_css.py',       \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   'NestedApp.CSS'                                       \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   ),                                                        \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   (                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   '/root/repos/py_data/textual/src/textual/screen.py',  \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                                  \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   ),                                                        \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   (                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   '/root/repos/py_data/textual/src/textual/widget.py',  \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                                  \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   )                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   ]                                                             \u2502 \u2502\n\u2502 \u2502        >                                                                 \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:368 in parse       \u2502\n\u2502                                                                              \u2502\n\u2502   365 \u2502   \u2502   \u2502   if css in self._invalid_css:                               \u2502\n\u2502   366 \u2502   \u2502   \u2502   \u2502   continue                                               \u2502\n\u2502   367 \u2502   \u2502   \u2502   try:                                                       \u2502\n\u2502 \u2771 368 \u2502   \u2502   \u2502   \u2502   css_rules = self._parse_rules(                         \u2502\n\u2502   369 \u2502   \u2502   \u2502   \u2502   \u2502   css,                                               \u2502\n\u2502   370 \u2502   \u2502   \u2502   \u2502   \u2502   read_from=read_from,                               \u2502\n\u2502   371 \u2502   \u2502   \u2502   \u2502   \u2502   is_default_rules=is_default_rules,                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502        add_rules = <built-in method extend of list object at             \u2502 \u2502\n\u2502 \u2502                    0x7fb36e1d5cc0>                                       \u2502 \u2502\n\u2502 \u2502              css = '\\n    App {\\n        background: $background;\\n      \u2502 \u2502\n\u2502 \u2502                    color: $text;\\n    }\\n    *:di'+51                    \u2502 \u2502\n\u2502 \u2502 is_default_rules = True                                                  \u2502 \u2502\n\u2502 \u2502        read_from = (                                                     \u2502 \u2502\n\u2502 \u2502                    \u2502   '/root/repos/py_data/textual/src/textual/app.py', \u2502 \u2502\n\u2502 \u2502                    \u2502   'App.DEFAULT_CSS'                                 \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502            rules = []                                                    \u2502 \u2502\n\u2502 \u2502            scope = 'App'                                                 \u2502 \u2502\n\u2502 \u2502             self = <Stylesheet                                           \u2502 \u2502\n\u2502 \u2502                    \u2502   [                                                 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/app.py',     \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                         \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/tests/css/test_nested_c\u2026 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'NestedApp.CSS'                           \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/screen.py',  \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                      \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/widget.py',  \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                      \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   )                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   ]                                                 \u2502 \u2502\n\u2502 \u2502                    >                                                     \u2502 \u2502\n\u2502 \u2502      tie_breaker = -1                                                    \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:261 in             \u2502\n\u2502 _parse_rules                                                                 \u2502\n\u2502                                                                              \u2502\n\u2502   258 \u2502   \u2502   except TokenError:                                             \u2502\n\u2502   259 \u2502   \u2502   \u2502   raise                                                      \u2502\n\u2502   260 \u2502   \u2502   except Exception as error:                                     \u2502\n\u2502 \u2771 261 \u2502   \u2502   \u2502   raise StylesheetError(f\"failed to parse css; {error}\") fro \u2502\n\u2502   262 \u2502   \u2502                                                                  \u2502\n\u2502   263 \u2502   \u2502   self._parse_cache[cache_key] = rules                           \u2502\n\u2502   264 \u2502   \u2502   return rules                                                   \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502        cache_key = (                                                     \u2502 \u2502\n\u2502 \u2502                    \u2502   '\\n    App {\\n        background: $background;\\n  \u2502 \u2502\n\u2502 \u2502                    color: $text;\\n    }\\n    *:di'+51,                   \u2502 \u2502\n\u2502 \u2502                    \u2502   (                                                 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502                                                 \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/app.py',     \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   'App.DEFAULT_CSS'                             \u2502 \u2502\n\u2502 \u2502                    \u2502   ),                                                \u2502 \u2502\n\u2502 \u2502                    \u2502   True,                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   -1,                                               \u2502 \u2502\n\u2502 \u2502                    \u2502   'App'                                             \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502              css = '\\n    App {\\n        background: $background;\\n      \u2502 \u2502\n\u2502 \u2502                    color: $text;\\n    }\\n    *:di'+51                    \u2502 \u2502\n\u2502 \u2502 is_default_rules = True                                                  \u2502 \u2502\n\u2502 \u2502        read_from = (                                                     \u2502 \u2502\n\u2502 \u2502                    \u2502   '/root/repos/py_data/textual/src/textual/app.py', \u2502 \u2502\n\u2502 \u2502                    \u2502   'App.DEFAULT_CSS'                                 \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502            scope = 'App'                                                 \u2502 \u2502\n\u2502 \u2502             self = <Stylesheet                                           \u2502 \u2502\n\u2502 \u2502                    \u2502   [                                                 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/app.py',     \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                         \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/tests/css/test_nested_c\u2026 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'NestedApp.CSS'                           \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/screen.py',  \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                      \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/widget.py',  \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                      \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   )                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   ]                                                 \u2502 \u2502\n\u2502 \u2502                    >                                                     \u2502 \u2502\n\u2502 \u2502      tie_breaker = -1                                                    \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nStylesheetError: failed to parse css; parse() got an unexpected keyword argument\n'variable_tokens'\n____________________ test_pseudo_classes_work_in_nested_css ____________________\n\n    async def test_pseudo_classes_work_in_nested_css() -> None:\n        \"\"\"Makes sure pseudo-classes are correctly understood in nested TCSS.\n    \n        Regression test for https://github.com/Textualize/textual/issues/4039.\n        \"\"\"\n    \n        app = PseudoClassesInNestedApp()\n        green = Color.parse(\"green\")\n        red = Color.parse(\"red\")\n>       async with app.run_test() as pilot:\n\ntests/css/test_nested_css.py:169: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:199: in __aenter__\n    return await anext(self.gen)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2588: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2533: in run_process_messages\n    await self._dispatch_message(events.Compose())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3053: in on_event\n    self._register(self, screen)\nsrc/textual/app.py:2752: in _register\n    apply_stylesheet(widget, cache=cache)\nsrc/textual/css/stylesheet.py:461: in apply\n    rules_map = self.rules_map\nsrc/textual/css/stylesheet.py:184: in rules_map\n    for rule in self.rules:\nsrc/textual/css/stylesheet.py:170: in rules\n    self.parse()\nsrc/textual/css/stylesheet.py:368: in parse\n    css_rules = self._parse_rules(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <Stylesheet [('/root/repos/py_data/textual/src/textual/app.py', 'App.DEFAULT_CSS'), ('/root/repos/py_data/textual/test...extual/screen.py', 'Screen.DEFAULT_CSS'), ('/root/repos/py_data/textual/src/textual/widget.py', 'Widget.DEFAULT_CSS')]>\ncss = '\\n    App {\\n        background: $background;\\n        color: $text;\\n    }\\n    *:disabled:can-focus {\\n        opacity: 0.7;\\n    }\\n    '\nread_from = ('/root/repos/py_data/textual/src/textual/app.py', 'App.DEFAULT_CSS')\nis_default_rules = True, tie_breaker = -1, scope = 'App'\n\n    def _parse_rules(\n        self,\n        css: str,\n        read_from: CSSLocation,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n        scope: str = \"\",\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS and return rules.\n    \n        Args:\n            css: String containing Textual CSS.\n            read_from: Original CSS location.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            scope: Scope of rules, or empty string for global scope.\n    \n        Raises:\n            StylesheetError: If the CSS is invalid.\n    \n        Returns:\n            List of RuleSets.\n        \"\"\"\n        cache_key = (css, read_from, is_default_rules, tie_breaker, scope)\n        try:\n            return self._parse_cache[cache_key]\n        except KeyError:\n            pass\n        try:\n            rules = list(\n                parse(\n                    scope,\n                    css,\n                    read_from,\n                    variable_tokens=self._variable_tokens,\n                    is_default_rules=is_default_rules,\n                    tie_breaker=tie_breaker,\n                )\n            )\n        except TokenError:\n            raise\n        except Exception as error:\n>           raise StylesheetError(f\"failed to parse css; {error}\") from None\nE           textual.css.errors.StylesheetError: failed to parse css; parse() got an unexpected keyword argument 'variable_tokens'\n\nsrc/textual/css/stylesheet.py:261: StylesheetError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/src/textual/app.py:3053 in on_event              \u2502\n\u2502                                                                              \u2502\n\u2502   3050 \u2502   \u2502   # If the event has been forwarded it may have bubbled up back \u2502\n\u2502   3051 \u2502   \u2502   if isinstance(event, events.Compose):                         \u2502\n\u2502   3052 \u2502   \u2502   \u2502   screen: Screen[Any] = self.get_default_screen()           \u2502\n\u2502 \u2771 3053 \u2502   \u2502   \u2502   self._register(self, screen)                              \u2502\n\u2502   3054 \u2502   \u2502   \u2502   self._screen_stack.append(screen)                         \u2502\n\u2502   3055 \u2502   \u2502   \u2502   screen.post_message(events.ScreenResume())                \u2502\n\u2502   3056 \u2502   \u2502   \u2502   await super().on_event(event)                             \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                           \u2502\n\u2502 \u2502  event = Compose()                             \u2502                           \u2502\n\u2502 \u2502 screen = Screen(id='_default')                 \u2502                           \u2502\n\u2502 \u2502   self = PseudoClassesInNestedApp(             \u2502                           \u2502\n\u2502 \u2502          \u2502   title='PseudoClassesInNestedApp', \u2502                           \u2502\n\u2502 \u2502          \u2502   classes={'-dark-mode'}            \u2502                           \u2502\n\u2502 \u2502          )                                     \u2502                           \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                           \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2752 in _register             \u2502\n\u2502                                                                              \u2502\n\u2502   2749 \u2502   \u2502   \u2502   \u2502   self._register_child(parent, widget, before, after)   \u2502\n\u2502   2750 \u2502   \u2502   \u2502   \u2502   if widget._nodes:                                     \u2502\n\u2502   2751 \u2502   \u2502   \u2502   \u2502   \u2502   self._register(widget, *widget._nodes, cache=cach \u2502\n\u2502 \u2771 2752 \u2502   \u2502   \u2502   \u2502   apply_stylesheet(widget, cache=cache)                 \u2502\n\u2502   2753 \u2502   \u2502                                                                 \u2502\n\u2502   2754 \u2502   \u2502   if not self._running:                                         \u2502\n\u2502   2755 \u2502   \u2502   \u2502   # If the app is not running, prevent awaiting of the widg \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502            after = None                                                  \u2502 \u2502\n\u2502 \u2502 apply_stylesheet = <bound method Stylesheet.apply of <Stylesheet         \u2502 \u2502\n\u2502 \u2502                    [('/root/repos/py_data/textual/src/textual/app.py',   \u2502 \u2502\n\u2502 \u2502                    'App.DEFAULT_CSS'),                                   \u2502 \u2502\n\u2502 \u2502                    ('/root/repos/py_data/textual/tests/css/test_nested_\u2026 \u2502 \u2502\n\u2502 \u2502                    'PseudoClassesInNestedApp.CSS'),                      \u2502 \u2502\n\u2502 \u2502                    ('/root/repos/py_data/textual/src/textual/screen.py', \u2502 \u2502\n\u2502 \u2502                    'Screen.DEFAULT_CSS'),                                \u2502 \u2502\n\u2502 \u2502                    ('/root/repos/py_data/textual/src/textual/widget.py', \u2502 \u2502\n\u2502 \u2502                    'Widget.DEFAULT_CSS')]>>                              \u2502 \u2502\n\u2502 \u2502           before = None                                                  \u2502 \u2502\n\u2502 \u2502            cache = {}                                                    \u2502 \u2502\n\u2502 \u2502           parent = PseudoClassesInNestedApp(                             \u2502 \u2502\n\u2502 \u2502                    \u2502   title='PseudoClassesInNestedApp',                 \u2502 \u2502\n\u2502 \u2502                    \u2502   classes={'-dark-mode'}                            \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502             self = PseudoClassesInNestedApp(                             \u2502 \u2502\n\u2502 \u2502                    \u2502   title='PseudoClassesInNestedApp',                 \u2502 \u2502\n\u2502 \u2502                    \u2502   classes={'-dark-mode'}                            \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502           widget = Screen(id='_default')                                 \u2502 \u2502\n\u2502 \u2502      widget_list = (Screen(id='_default'),)                              \u2502 \u2502\n\u2502 \u2502          widgets = (Screen(id='_default'),)                              \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:461 in apply       \u2502\n\u2502                                                                              \u2502\n\u2502   458 \u2502   \u2502   rule_attributes: defaultdict[str, list[tuple[Specificity6, obj \u2502\n\u2502   459 \u2502   \u2502   rule_attributes = defaultdict(list)                            \u2502\n\u2502   460 \u2502   \u2502                                                                  \u2502\n\u2502 \u2771 461 \u2502   \u2502   rules_map = self.rules_map                                     \u2502\n\u2502   462 \u2502   \u2502                                                                  \u2502\n\u2502   463 \u2502   \u2502   # Discard rules which are not applicable early                 \u2502\n\u2502   464 \u2502   \u2502   limit_rules = {                                                \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502         animate = False                                                  \u2502 \u2502\n\u2502 \u2502           cache = {}                                                     \u2502 \u2502\n\u2502 \u2502            node = Screen(id='_default')                                  \u2502 \u2502\n\u2502 \u2502 rule_attributes = defaultdict(<class 'list'>, {})                        \u2502 \u2502\n\u2502 \u2502            self = <Stylesheet                                            \u2502 \u2502\n\u2502 \u2502                   \u2502   [                                                  \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   (                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502                                              \u2502 \u2502\n\u2502 \u2502                   '/root/repos/py_data/textual/src/textual/app.py',      \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                          \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   ),                                             \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   (                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502                                              \u2502 \u2502\n\u2502 \u2502                   '/root/repos/py_data/textual/tests/css/test_nested_cs\u2026 \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502   'PseudoClassesInNestedApp.CSS'             \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   ),                                             \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   (                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502                                              \u2502 \u2502\n\u2502 \u2502                   '/root/repos/py_data/textual/src/textual/screen.py',   \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                       \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   ),                                             \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   (                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502                                              \u2502 \u2502\n\u2502 \u2502                   '/root/repos/py_data/textual/src/textual/widget.py',   \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                       \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   )                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   ]                                                  \u2502 \u2502\n\u2502 \u2502                   >                                                      \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:184 in rules_map   \u2502\n\u2502                                                                              \u2502\n\u2502   181 \u2502   \u2502   \"\"\"                                                            \u2502\n\u2502   182 \u2502   \u2502   if self._rules_map is None:                                    \u2502\n\u2502   183 \u2502   \u2502   \u2502   rules_map: dict[str, list[RuleSet]] = defaultdict(list)    \u2502\n\u2502 \u2771 184 \u2502   \u2502   \u2502   for rule in self.rules:                                    \u2502\n\u2502   185 \u2502   \u2502   \u2502   \u2502   for name in rule.selector_names:                       \u2502\n\u2502   186 \u2502   \u2502   \u2502   \u2502   \u2502   rules_map[name].append(rule)                       \u2502\n\u2502   187 \u2502   \u2502   \u2502   self._rules_map = dict(rules_map)                          \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 rules_map = defaultdict(<class 'list'>, {})                              \u2502 \u2502\n\u2502 \u2502      self = <Stylesheet                                                  \u2502 \u2502\n\u2502 \u2502             \u2502   [                                                        \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   (                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502                                                    \u2502 \u2502\n\u2502 \u2502             '/root/repos/py_data/textual/src/textual/app.py',            \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                                \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   ),                                                   \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   (                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502                                                    \u2502 \u2502\n\u2502 \u2502             '/root/repos/py_data/textual/tests/css/test_nested_css.py',  \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502   'PseudoClassesInNestedApp.CSS'                   \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   ),                                                   \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   (                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502                                                    \u2502 \u2502\n\u2502 \u2502             '/root/repos/py_data/textual/src/textual/screen.py',         \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                             \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   ),                                                   \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   (                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502                                                    \u2502 \u2502\n\u2502 \u2502             '/root/repos/py_data/textual/src/textual/widget.py',         \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                             \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   )                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   ]                                                        \u2502 \u2502\n\u2502 \u2502             >                                                            \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:170 in rules       \u2502\n\u2502                                                                              \u2502\n\u2502   167 \u2502   \u2502   \u2502   List of rules sets for this stylesheet.                    \u2502\n\u2502   168 \u2502   \u2502   \"\"\"                                                            \u2502\n\u2502   169 \u2502   \u2502   if self._require_parse:                                        \u2502\n\u2502 \u2771 170 \u2502   \u2502   \u2502   self.parse()                                               \u2502\n\u2502   171 \u2502   \u2502   \u2502   self._require_parse = False                                \u2502\n\u2502   172 \u2502   \u2502   assert self._rules is not None                                 \u2502\n\u2502   173 \u2502   \u2502   return self._rules                                             \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 self = <Stylesheet                                                       \u2502 \u2502\n\u2502 \u2502        \u2502   [                                                             \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   (                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   '/root/repos/py_data/textual/src/textual/app.py',     \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                                     \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   ),                                                        \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   (                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502                                                         \u2502 \u2502\n\u2502 \u2502        '/root/repos/py_data/textual/tests/css/test_nested_css.py',       \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   'PseudoClassesInNestedApp.CSS'                        \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   ),                                                        \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   (                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   '/root/repos/py_data/textual/src/textual/screen.py',  \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                                  \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   ),                                                        \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   (                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   '/root/repos/py_data/textual/src/textual/widget.py',  \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                                  \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   )                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   ]                                                             \u2502 \u2502\n\u2502 \u2502        >                                                                 \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:368 in parse       \u2502\n\u2502                                                                              \u2502\n\u2502   365 \u2502   \u2502   \u2502   if css in self._invalid_css:                               \u2502\n\u2502   366 \u2502   \u2502   \u2502   \u2502   continue                                               \u2502\n\u2502   367 \u2502   \u2502   \u2502   try:                                                       \u2502\n\u2502 \u2771 368 \u2502   \u2502   \u2502   \u2502   css_rules = self._parse_rules(                         \u2502\n\u2502   369 \u2502   \u2502   \u2502   \u2502   \u2502   css,                                               \u2502\n\u2502   370 \u2502   \u2502   \u2502   \u2502   \u2502   read_from=read_from,                               \u2502\n\u2502   371 \u2502   \u2502   \u2502   \u2502   \u2502   is_default_rules=is_default_rules,                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502        add_rules = <built-in method extend of list object at             \u2502 \u2502\n\u2502 \u2502                    0x7fb36dbb2bc0>                                       \u2502 \u2502\n\u2502 \u2502              css = '\\n    App {\\n        background: $background;\\n      \u2502 \u2502\n\u2502 \u2502                    color: $text;\\n    }\\n    *:di'+51                    \u2502 \u2502\n\u2502 \u2502 is_default_rules = True                                                  \u2502 \u2502\n\u2502 \u2502        read_from = (                                                     \u2502 \u2502\n\u2502 \u2502                    \u2502   '/root/repos/py_data/textual/src/textual/app.py', \u2502 \u2502\n\u2502 \u2502                    \u2502   'App.DEFAULT_CSS'                                 \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502            rules = []                                                    \u2502 \u2502\n\u2502 \u2502            scope = 'App'                                                 \u2502 \u2502\n\u2502 \u2502             self = <Stylesheet                                           \u2502 \u2502\n\u2502 \u2502                    \u2502   [                                                 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/app.py',     \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                         \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/tests/css/test_nested_c\u2026 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'PseudoClassesInNestedApp.CSS'            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/screen.py',  \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                      \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/widget.py',  \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                      \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   )                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   ]                                                 \u2502 \u2502\n\u2502 \u2502                    >                                                     \u2502 \u2502\n\u2502 \u2502      tie_breaker = -1                                                    \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:261 in             \u2502\n\u2502 _parse_rules                                                                 \u2502\n\u2502                                                                              \u2502\n\u2502   258 \u2502   \u2502   except TokenError:                                             \u2502\n\u2502   259 \u2502   \u2502   \u2502   raise                                                      \u2502\n\u2502   260 \u2502   \u2502   except Exception as error:                                     \u2502\n\u2502 \u2771 261 \u2502   \u2502   \u2502   raise StylesheetError(f\"failed to parse css; {error}\") fro \u2502\n\u2502   262 \u2502   \u2502                                                                  \u2502\n\u2502   263 \u2502   \u2502   self._parse_cache[cache_key] = rules                           \u2502\n\u2502   264 \u2502   \u2502   return rules                                                   \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502        cache_key = (                                                     \u2502 \u2502\n\u2502 \u2502                    \u2502   '\\n    App {\\n        background: $background;\\n  \u2502 \u2502\n\u2502 \u2502                    color: $text;\\n    }\\n    *:di'+51,                   \u2502 \u2502\n\u2502 \u2502                    \u2502   (                                                 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502                                                 \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/app.py',     \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   'App.DEFAULT_CSS'                             \u2502 \u2502\n\u2502 \u2502                    \u2502   ),                                                \u2502 \u2502\n\u2502 \u2502                    \u2502   True,                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   -1,                                               \u2502 \u2502\n\u2502 \u2502                    \u2502   'App'                                             \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502              css = '\\n    App {\\n        background: $background;\\n      \u2502 \u2502\n\u2502 \u2502                    color: $text;\\n    }\\n    *:di'+51                    \u2502 \u2502\n\u2502 \u2502 is_default_rules = True                                                  \u2502 \u2502\n\u2502 \u2502        read_from = (                                                     \u2502 \u2502\n\u2502 \u2502                    \u2502   '/root/repos/py_data/textual/src/textual/app.py', \u2502 \u2502\n\u2502 \u2502                    \u2502   'App.DEFAULT_CSS'                                 \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502            scope = 'App'                                                 \u2502 \u2502\n\u2502 \u2502             self = <Stylesheet                                           \u2502 \u2502\n\u2502 \u2502                    \u2502   [                                                 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/app.py',     \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                         \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/tests/css/test_nested_c\u2026 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'PseudoClassesInNestedApp.CSS'            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/screen.py',  \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                      \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/widget.py',  \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                      \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   )                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   ]                                                 \u2502 \u2502\n\u2502 \u2502                    >                                                     \u2502 \u2502\n\u2502 \u2502      tie_breaker = -1                                                    \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nStylesheetError: failed to parse css; parse() got an unexpected keyword argument\n'variable_tokens'\n______________________ test_rule_declaration_after_nested ______________________\n\n    async def test_rule_declaration_after_nested() -> None:\n        \"\"\"Regression test for https://github.com/Textualize/textual/issues/3999.\"\"\"\n        app = DeclarationAfterNestedApp()\n>       async with app.run_test():\n\ntests/css/test_nested_css.py:89: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:199: in __aenter__\n    return await anext(self.gen)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2588: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2533: in run_process_messages\n    await self._dispatch_message(events.Compose())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3053: in on_event\n    self._register(self, screen)\nsrc/textual/app.py:2752: in _register\n    apply_stylesheet(widget, cache=cache)\nsrc/textual/css/stylesheet.py:461: in apply\n    rules_map = self.rules_map\nsrc/textual/css/stylesheet.py:184: in rules_map\n    for rule in self.rules:\nsrc/textual/css/stylesheet.py:170: in rules\n    self.parse()\nsrc/textual/css/stylesheet.py:368: in parse\n    css_rules = self._parse_rules(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <Stylesheet [('/root/repos/py_data/textual/src/textual/app.py', 'App.DEFAULT_CSS'), ('/root/repos/py_data/textual/test...extual/screen.py', 'Screen.DEFAULT_CSS'), ('/root/repos/py_data/textual/src/textual/widget.py', 'Widget.DEFAULT_CSS')]>\ncss = '\\n    App {\\n        background: $background;\\n        color: $text;\\n    }\\n    *:disabled:can-focus {\\n        opacity: 0.7;\\n    }\\n    '\nread_from = ('/root/repos/py_data/textual/src/textual/app.py', 'App.DEFAULT_CSS')\nis_default_rules = True, tie_breaker = -1, scope = 'App'\n\n    def _parse_rules(\n        self,\n        css: str,\n        read_from: CSSLocation,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n        scope: str = \"\",\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS and return rules.\n    \n        Args:\n            css: String containing Textual CSS.\n            read_from: Original CSS location.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            scope: Scope of rules, or empty string for global scope.\n    \n        Raises:\n            StylesheetError: If the CSS is invalid.\n    \n        Returns:\n            List of RuleSets.\n        \"\"\"\n        cache_key = (css, read_from, is_default_rules, tie_breaker, scope)\n        try:\n            return self._parse_cache[cache_key]\n        except KeyError:\n            pass\n        try:\n            rules = list(\n                parse(\n                    scope,\n                    css,\n                    read_from,\n                    variable_tokens=self._variable_tokens,\n                    is_default_rules=is_default_rules,\n                    tie_breaker=tie_breaker,\n                )\n            )\n        except TokenError:\n            raise\n        except Exception as error:\n>           raise StylesheetError(f\"failed to parse css; {error}\") from None\nE           textual.css.errors.StylesheetError: failed to parse css; parse() got an unexpected keyword argument 'variable_tokens'\n\nsrc/textual/css/stylesheet.py:261: StylesheetError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/src/textual/app.py:3053 in on_event              \u2502\n\u2502                                                                              \u2502\n\u2502   3050 \u2502   \u2502   # If the event has been forwarded it may have bubbled up back \u2502\n\u2502   3051 \u2502   \u2502   if isinstance(event, events.Compose):                         \u2502\n\u2502   3052 \u2502   \u2502   \u2502   screen: Screen[Any] = self.get_default_screen()           \u2502\n\u2502 \u2771 3053 \u2502   \u2502   \u2502   self._register(self, screen)                              \u2502\n\u2502   3054 \u2502   \u2502   \u2502   self._screen_stack.append(screen)                         \u2502\n\u2502   3055 \u2502   \u2502   \u2502   screen.post_message(events.ScreenResume())                \u2502\n\u2502   3056 \u2502   \u2502   \u2502   await super().on_event(event)                             \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                          \u2502\n\u2502 \u2502  event = Compose()                              \u2502                          \u2502\n\u2502 \u2502 screen = Screen(id='_default')                  \u2502                          \u2502\n\u2502 \u2502   self = DeclarationAfterNestedApp(             \u2502                          \u2502\n\u2502 \u2502          \u2502   title='DeclarationAfterNestedApp', \u2502                          \u2502\n\u2502 \u2502          \u2502   classes={'-dark-mode'}             \u2502                          \u2502\n\u2502 \u2502          )                                      \u2502                          \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                          \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2752 in _register             \u2502\n\u2502                                                                              \u2502\n\u2502   2749 \u2502   \u2502   \u2502   \u2502   self._register_child(parent, widget, before, after)   \u2502\n\u2502   2750 \u2502   \u2502   \u2502   \u2502   if widget._nodes:                                     \u2502\n\u2502   2751 \u2502   \u2502   \u2502   \u2502   \u2502   self._register(widget, *widget._nodes, cache=cach \u2502\n\u2502 \u2771 2752 \u2502   \u2502   \u2502   \u2502   apply_stylesheet(widget, cache=cache)                 \u2502\n\u2502   2753 \u2502   \u2502                                                                 \u2502\n\u2502   2754 \u2502   \u2502   if not self._running:                                         \u2502\n\u2502   2755 \u2502   \u2502   \u2502   # If the app is not running, prevent awaiting of the widg \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502            after = None                                                  \u2502 \u2502\n\u2502 \u2502 apply_stylesheet = <bound method Stylesheet.apply of <Stylesheet         \u2502 \u2502\n\u2502 \u2502                    [('/root/repos/py_data/textual/src/textual/app.py',   \u2502 \u2502\n\u2502 \u2502                    'App.DEFAULT_CSS'),                                   \u2502 \u2502\n\u2502 \u2502                    ('/root/repos/py_data/textual/tests/css/test_nested_\u2026 \u2502 \u2502\n\u2502 \u2502                    'DeclarationAfterNestedApp.CSS'),                     \u2502 \u2502\n\u2502 \u2502                    ('/root/repos/py_data/textual/src/textual/screen.py', \u2502 \u2502\n\u2502 \u2502                    'Screen.DEFAULT_CSS'),                                \u2502 \u2502\n\u2502 \u2502                    ('/root/repos/py_data/textual/src/textual/widget.py', \u2502 \u2502\n\u2502 \u2502                    'Widget.DEFAULT_CSS')]>>                              \u2502 \u2502\n\u2502 \u2502           before = None                                                  \u2502 \u2502\n\u2502 \u2502            cache = {}                                                    \u2502 \u2502\n\u2502 \u2502           parent = DeclarationAfterNestedApp(                            \u2502 \u2502\n\u2502 \u2502                    \u2502   title='DeclarationAfterNestedApp',                \u2502 \u2502\n\u2502 \u2502                    \u2502   classes={'-dark-mode'}                            \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502             self = DeclarationAfterNestedApp(                            \u2502 \u2502\n\u2502 \u2502                    \u2502   title='DeclarationAfterNestedApp',                \u2502 \u2502\n\u2502 \u2502                    \u2502   classes={'-dark-mode'}                            \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502           widget = Screen(id='_default')                                 \u2502 \u2502\n\u2502 \u2502      widget_list = (Screen(id='_default'),)                              \u2502 \u2502\n\u2502 \u2502          widgets = (Screen(id='_default'),)                              \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:461 in apply       \u2502\n\u2502                                                                              \u2502\n\u2502   458 \u2502   \u2502   rule_attributes: defaultdict[str, list[tuple[Specificity6, obj \u2502\n\u2502   459 \u2502   \u2502   rule_attributes = defaultdict(list)                            \u2502\n\u2502   460 \u2502   \u2502                                                                  \u2502\n\u2502 \u2771 461 \u2502   \u2502   rules_map = self.rules_map                                     \u2502\n\u2502   462 \u2502   \u2502                                                                  \u2502\n\u2502   463 \u2502   \u2502   # Discard rules which are not applicable early                 \u2502\n\u2502   464 \u2502   \u2502   limit_rules = {                                                \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502         animate = False                                                  \u2502 \u2502\n\u2502 \u2502           cache = {}                                                     \u2502 \u2502\n\u2502 \u2502            node = Screen(id='_default')                                  \u2502 \u2502\n\u2502 \u2502 rule_attributes = defaultdict(<class 'list'>, {})                        \u2502 \u2502\n\u2502 \u2502            self = <Stylesheet                                            \u2502 \u2502\n\u2502 \u2502                   \u2502   [                                                  \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   (                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502                                              \u2502 \u2502\n\u2502 \u2502                   '/root/repos/py_data/textual/src/textual/app.py',      \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                          \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   ),                                             \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   (                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502                                              \u2502 \u2502\n\u2502 \u2502                   '/root/repos/py_data/textual/tests/css/test_nested_cs\u2026 \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502   'DeclarationAfterNestedApp.CSS'            \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   ),                                             \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   (                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502                                              \u2502 \u2502\n\u2502 \u2502                   '/root/repos/py_data/textual/src/textual/screen.py',   \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                       \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   ),                                             \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   (                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502                                              \u2502 \u2502\n\u2502 \u2502                   '/root/repos/py_data/textual/src/textual/widget.py',   \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                       \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   )                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   ]                                                  \u2502 \u2502\n\u2502 \u2502                   >                                                      \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:184 in rules_map   \u2502\n\u2502                                                                              \u2502\n\u2502   181 \u2502   \u2502   \"\"\"                                                            \u2502\n\u2502   182 \u2502   \u2502   if self._rules_map is None:                                    \u2502\n\u2502   183 \u2502   \u2502   \u2502   rules_map: dict[str, list[RuleSet]] = defaultdict(list)    \u2502\n\u2502 \u2771 184 \u2502   \u2502   \u2502   for rule in self.rules:                                    \u2502\n\u2502   185 \u2502   \u2502   \u2502   \u2502   for name in rule.selector_names:                       \u2502\n\u2502   186 \u2502   \u2502   \u2502   \u2502   \u2502   rules_map[name].append(rule)                       \u2502\n\u2502   187 \u2502   \u2502   \u2502   self._rules_map = dict(rules_map)                          \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 rules_map = defaultdict(<class 'list'>, {})                              \u2502 \u2502\n\u2502 \u2502      self = <Stylesheet                                                  \u2502 \u2502\n\u2502 \u2502             \u2502   [                                                        \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   (                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502                                                    \u2502 \u2502\n\u2502 \u2502             '/root/repos/py_data/textual/src/textual/app.py',            \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                                \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   ),                                                   \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   (                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502                                                    \u2502 \u2502\n\u2502 \u2502             '/root/repos/py_data/textual/tests/css/test_nested_css.py',  \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502   'DeclarationAfterNestedApp.CSS'                  \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   ),                                                   \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   (                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502                                                    \u2502 \u2502\n\u2502 \u2502             '/root/repos/py_data/textual/src/textual/screen.py',         \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                             \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   ),                                                   \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   (                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502                                                    \u2502 \u2502\n\u2502 \u2502             '/root/repos/py_data/textual/src/textual/widget.py',         \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                             \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   )                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   ]                                                        \u2502 \u2502\n\u2502 \u2502             >                                                            \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:170 in rules       \u2502\n\u2502                                                                              \u2502\n\u2502   167 \u2502   \u2502   \u2502   List of rules sets for this stylesheet.                    \u2502\n\u2502   168 \u2502   \u2502   \"\"\"                                                            \u2502\n\u2502   169 \u2502   \u2502   if self._require_parse:                                        \u2502\n\u2502 \u2771 170 \u2502   \u2502   \u2502   self.parse()                                               \u2502\n\u2502   171 \u2502   \u2502   \u2502   self._require_parse = False                                \u2502\n\u2502   172 \u2502   \u2502   assert self._rules is not None                                 \u2502\n\u2502   173 \u2502   \u2502   return self._rules                                             \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 self = <Stylesheet                                                       \u2502 \u2502\n\u2502 \u2502        \u2502   [                                                             \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   (                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   '/root/repos/py_data/textual/src/textual/app.py',     \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                                     \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   ),                                                        \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   (                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502                                                         \u2502 \u2502\n\u2502 \u2502        '/root/repos/py_data/textual/tests/css/test_nested_css.py',       \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   'DeclarationAfterNestedApp.CSS'                       \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   ),                                                        \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   (                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   '/root/repos/py_data/textual/src/textual/screen.py',  \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                                  \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   ),                                                        \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   (                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   '/root/repos/py_data/textual/src/textual/widget.py',  \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                                  \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   )                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   ]                                                             \u2502 \u2502\n\u2502 \u2502        >                                                                 \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:368 in parse       \u2502\n\u2502                                                                              \u2502\n\u2502   365 \u2502   \u2502   \u2502   if css in self._invalid_css:                               \u2502\n\u2502   366 \u2502   \u2502   \u2502   \u2502   continue                                               \u2502\n\u2502   367 \u2502   \u2502   \u2502   try:                                                       \u2502\n\u2502 \u2771 368 \u2502   \u2502   \u2502   \u2502   css_rules = self._parse_rules(                         \u2502\n\u2502   369 \u2502   \u2502   \u2502   \u2502   \u2502   css,                                               \u2502\n\u2502   370 \u2502   \u2502   \u2502   \u2502   \u2502   read_from=read_from,                               \u2502\n\u2502   371 \u2502   \u2502   \u2502   \u2502   \u2502   is_default_rules=is_default_rules,                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502        add_rules = <built-in method extend of list object at             \u2502 \u2502\n\u2502 \u2502                    0x7fb36df84780>                                       \u2502 \u2502\n\u2502 \u2502              css = '\\n    App {\\n        background: $background;\\n      \u2502 \u2502\n\u2502 \u2502                    color: $text;\\n    }\\n    *:di'+51                    \u2502 \u2502\n\u2502 \u2502 is_default_rules = True                                                  \u2502 \u2502\n\u2502 \u2502        read_from = (                                                     \u2502 \u2502\n\u2502 \u2502                    \u2502   '/root/repos/py_data/textual/src/textual/app.py', \u2502 \u2502\n\u2502 \u2502                    \u2502   'App.DEFAULT_CSS'                                 \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502            rules = []                                                    \u2502 \u2502\n\u2502 \u2502            scope = 'App'                                                 \u2502 \u2502\n\u2502 \u2502             self = <Stylesheet                                           \u2502 \u2502\n\u2502 \u2502                    \u2502   [                                                 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/app.py',     \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                         \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/tests/css/test_nested_c\u2026 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'DeclarationAfterNestedApp.CSS'           \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/screen.py',  \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                      \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/widget.py',  \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                      \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   )                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   ]                                                 \u2502 \u2502\n\u2502 \u2502                    >                                                     \u2502 \u2502\n\u2502 \u2502      tie_breaker = -1                                                    \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:261 in             \u2502\n\u2502 _parse_rules                                                                 \u2502\n\u2502                                                                              \u2502\n\u2502   258 \u2502   \u2502   except TokenError:                                             \u2502\n\u2502   259 \u2502   \u2502   \u2502   raise                                                      \u2502\n\u2502   260 \u2502   \u2502   except Exception as error:                                     \u2502\n\u2502 \u2771 261 \u2502   \u2502   \u2502   raise StylesheetError(f\"failed to parse css; {error}\") fro \u2502\n\u2502   262 \u2502   \u2502                                                                  \u2502\n\u2502   263 \u2502   \u2502   self._parse_cache[cache_key] = rules                           \u2502\n\u2502   264 \u2502   \u2502   return rules                                                   \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502        cache_key = (                                                     \u2502 \u2502\n\u2502 \u2502                    \u2502   '\\n    App {\\n        background: $background;\\n  \u2502 \u2502\n\u2502 \u2502                    color: $text;\\n    }\\n    *:di'+51,                   \u2502 \u2502\n\u2502 \u2502                    \u2502   (                                                 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502                                                 \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/app.py',     \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   'App.DEFAULT_CSS'                             \u2502 \u2502\n\u2502 \u2502                    \u2502   ),                                                \u2502 \u2502\n\u2502 \u2502                    \u2502   True,                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   -1,                                               \u2502 \u2502\n\u2502 \u2502                    \u2502   'App'                                             \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502              css = '\\n    App {\\n        background: $background;\\n      \u2502 \u2502\n\u2502 \u2502                    color: $text;\\n    }\\n    *:di'+51                    \u2502 \u2502\n\u2502 \u2502 is_default_rules = True                                                  \u2502 \u2502\n\u2502 \u2502        read_from = (                                                     \u2502 \u2502\n\u2502 \u2502                    \u2502   '/root/repos/py_data/textual/src/textual/app.py', \u2502 \u2502\n\u2502 \u2502                    \u2502   'App.DEFAULT_CSS'                                 \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502            scope = 'App'                                                 \u2502 \u2502\n\u2502 \u2502             self = <Stylesheet                                           \u2502 \u2502\n\u2502 \u2502                    \u2502   [                                                 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/app.py',     \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                         \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/tests/css/test_nested_c\u2026 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'DeclarationAfterNestedApp.CSS'           \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/screen.py',  \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                      \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/widget.py',  \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                      \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   )                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   ]                                                 \u2502 \u2502\n\u2502 \u2502                    >                                                     \u2502 \u2502\n\u2502 \u2502      tie_breaker = -1                                                    \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nStylesheetError: failed to parse css; parse() got an unexpected keyword argument\n'variable_tokens'\n____________________ test_lists_of_selectors_in_nested_css _____________________\n\n    async def test_lists_of_selectors_in_nested_css() -> None:\n        \"\"\"Regression test for https://github.com/Textualize/textual/issues/3969.\"\"\"\n        app = ListOfNestedSelectorsApp()\n        red = Color.parse(\"red\")\n>       async with app.run_test():\n\ntests/css/test_nested_css.py:66: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n/usr/local/lib/python3.10/contextlib.py:199: in __aenter__\n    return await anext(self.gen)\nsrc/textual/app.py:1492: in run_test\n    raise self._exception\nsrc/textual/app.py:2588: in _process_messages\n    await run_process_messages()\nsrc/textual/app.py:2533: in run_process_messages\n    await self._dispatch_message(events.Compose())\nsrc/textual/message_pump.py:653: in _dispatch_message\n    await self.on_event(message)\nsrc/textual/app.py:3053: in on_event\n    self._register(self, screen)\nsrc/textual/app.py:2752: in _register\n    apply_stylesheet(widget, cache=cache)\nsrc/textual/css/stylesheet.py:461: in apply\n    rules_map = self.rules_map\nsrc/textual/css/stylesheet.py:184: in rules_map\n    for rule in self.rules:\nsrc/textual/css/stylesheet.py:170: in rules\n    self.parse()\nsrc/textual/css/stylesheet.py:368: in parse\n    css_rules = self._parse_rules(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <Stylesheet [('/root/repos/py_data/textual/src/textual/app.py', 'App.DEFAULT_CSS'), ('/root/repos/py_data/textual/test...extual/screen.py', 'Screen.DEFAULT_CSS'), ('/root/repos/py_data/textual/src/textual/widget.py', 'Widget.DEFAULT_CSS')]>\ncss = '\\n    App {\\n        background: $background;\\n        color: $text;\\n    }\\n    *:disabled:can-focus {\\n        opacity: 0.7;\\n    }\\n    '\nread_from = ('/root/repos/py_data/textual/src/textual/app.py', 'App.DEFAULT_CSS')\nis_default_rules = True, tie_breaker = -1, scope = 'App'\n\n    def _parse_rules(\n        self,\n        css: str,\n        read_from: CSSLocation,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n        scope: str = \"\",\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS and return rules.\n    \n        Args:\n            css: String containing Textual CSS.\n            read_from: Original CSS location.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            scope: Scope of rules, or empty string for global scope.\n    \n        Raises:\n            StylesheetError: If the CSS is invalid.\n    \n        Returns:\n            List of RuleSets.\n        \"\"\"\n        cache_key = (css, read_from, is_default_rules, tie_breaker, scope)\n        try:\n            return self._parse_cache[cache_key]\n        except KeyError:\n            pass\n        try:\n            rules = list(\n                parse(\n                    scope,\n                    css,\n                    read_from,\n                    variable_tokens=self._variable_tokens,\n                    is_default_rules=is_default_rules,\n                    tie_breaker=tie_breaker,\n                )\n            )\n        except TokenError:\n            raise\n        except Exception as error:\n>           raise StylesheetError(f\"failed to parse css; {error}\") from None\nE           textual.css.errors.StylesheetError: failed to parse css; parse() got an unexpected keyword argument 'variable_tokens'\n\nsrc/textual/css/stylesheet.py:261: StylesheetError\n----------------------------- Captured stderr call -----------------------------\n\u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 Traceback (most recent call last) \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 /root/repos/py_data/textual/src/textual/app.py:3053 in on_event              \u2502\n\u2502                                                                              \u2502\n\u2502   3050 \u2502   \u2502   # If the event has been forwarded it may have bubbled up back \u2502\n\u2502   3051 \u2502   \u2502   if isinstance(event, events.Compose):                         \u2502\n\u2502   3052 \u2502   \u2502   \u2502   screen: Screen[Any] = self.get_default_screen()           \u2502\n\u2502 \u2771 3053 \u2502   \u2502   \u2502   self._register(self, screen)                              \u2502\n\u2502   3054 \u2502   \u2502   \u2502   self._screen_stack.append(screen)                         \u2502\n\u2502   3055 \u2502   \u2502   \u2502   screen.post_message(events.ScreenResume())                \u2502\n\u2502   3056 \u2502   \u2502   \u2502   await super().on_event(event)                             \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e                           \u2502\n\u2502 \u2502  event = Compose()                             \u2502                           \u2502\n\u2502 \u2502 screen = Screen(id='_default')                 \u2502                           \u2502\n\u2502 \u2502   self = ListOfNestedSelectorsApp(             \u2502                           \u2502\n\u2502 \u2502          \u2502   title='ListOfNestedSelectorsApp', \u2502                           \u2502\n\u2502 \u2502          \u2502   classes={'-dark-mode'}            \u2502                           \u2502\n\u2502 \u2502          )                                     \u2502                           \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f                           \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/app.py:2752 in _register             \u2502\n\u2502                                                                              \u2502\n\u2502   2749 \u2502   \u2502   \u2502   \u2502   self._register_child(parent, widget, before, after)   \u2502\n\u2502   2750 \u2502   \u2502   \u2502   \u2502   if widget._nodes:                                     \u2502\n\u2502   2751 \u2502   \u2502   \u2502   \u2502   \u2502   self._register(widget, *widget._nodes, cache=cach \u2502\n\u2502 \u2771 2752 \u2502   \u2502   \u2502   \u2502   apply_stylesheet(widget, cache=cache)                 \u2502\n\u2502   2753 \u2502   \u2502                                                                 \u2502\n\u2502   2754 \u2502   \u2502   if not self._running:                                         \u2502\n\u2502   2755 \u2502   \u2502   \u2502   # If the app is not running, prevent awaiting of the widg \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502            after = None                                                  \u2502 \u2502\n\u2502 \u2502 apply_stylesheet = <bound method Stylesheet.apply of <Stylesheet         \u2502 \u2502\n\u2502 \u2502                    [('/root/repos/py_data/textual/src/textual/app.py',   \u2502 \u2502\n\u2502 \u2502                    'App.DEFAULT_CSS'),                                   \u2502 \u2502\n\u2502 \u2502                    ('/root/repos/py_data/textual/tests/css/test_nested_\u2026 \u2502 \u2502\n\u2502 \u2502                    'ListOfNestedSelectorsApp.CSS'),                      \u2502 \u2502\n\u2502 \u2502                    ('/root/repos/py_data/textual/src/textual/screen.py', \u2502 \u2502\n\u2502 \u2502                    'Screen.DEFAULT_CSS'),                                \u2502 \u2502\n\u2502 \u2502                    ('/root/repos/py_data/textual/src/textual/widget.py', \u2502 \u2502\n\u2502 \u2502                    'Widget.DEFAULT_CSS')]>>                              \u2502 \u2502\n\u2502 \u2502           before = None                                                  \u2502 \u2502\n\u2502 \u2502            cache = {}                                                    \u2502 \u2502\n\u2502 \u2502           parent = ListOfNestedSelectorsApp(                             \u2502 \u2502\n\u2502 \u2502                    \u2502   title='ListOfNestedSelectorsApp',                 \u2502 \u2502\n\u2502 \u2502                    \u2502   classes={'-dark-mode'}                            \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502             self = ListOfNestedSelectorsApp(                             \u2502 \u2502\n\u2502 \u2502                    \u2502   title='ListOfNestedSelectorsApp',                 \u2502 \u2502\n\u2502 \u2502                    \u2502   classes={'-dark-mode'}                            \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502           widget = Screen(id='_default')                                 \u2502 \u2502\n\u2502 \u2502      widget_list = (Screen(id='_default'),)                              \u2502 \u2502\n\u2502 \u2502          widgets = (Screen(id='_default'),)                              \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:461 in apply       \u2502\n\u2502                                                                              \u2502\n\u2502   458 \u2502   \u2502   rule_attributes: defaultdict[str, list[tuple[Specificity6, obj \u2502\n\u2502   459 \u2502   \u2502   rule_attributes = defaultdict(list)                            \u2502\n\u2502   460 \u2502   \u2502                                                                  \u2502\n\u2502 \u2771 461 \u2502   \u2502   rules_map = self.rules_map                                     \u2502\n\u2502   462 \u2502   \u2502                                                                  \u2502\n\u2502   463 \u2502   \u2502   # Discard rules which are not applicable early                 \u2502\n\u2502   464 \u2502   \u2502   limit_rules = {                                                \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502         animate = False                                                  \u2502 \u2502\n\u2502 \u2502           cache = {}                                                     \u2502 \u2502\n\u2502 \u2502            node = Screen(id='_default')                                  \u2502 \u2502\n\u2502 \u2502 rule_attributes = defaultdict(<class 'list'>, {})                        \u2502 \u2502\n\u2502 \u2502            self = <Stylesheet                                            \u2502 \u2502\n\u2502 \u2502                   \u2502   [                                                  \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   (                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502                                              \u2502 \u2502\n\u2502 \u2502                   '/root/repos/py_data/textual/src/textual/app.py',      \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                          \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   ),                                             \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   (                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502                                              \u2502 \u2502\n\u2502 \u2502                   '/root/repos/py_data/textual/tests/css/test_nested_cs\u2026 \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502   'ListOfNestedSelectorsApp.CSS'             \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   ),                                             \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   (                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502                                              \u2502 \u2502\n\u2502 \u2502                   '/root/repos/py_data/textual/src/textual/screen.py',   \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                       \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   ),                                             \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   (                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502                                              \u2502 \u2502\n\u2502 \u2502                   '/root/repos/py_data/textual/src/textual/widget.py',   \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                       \u2502 \u2502\n\u2502 \u2502                   \u2502   \u2502   )                                              \u2502 \u2502\n\u2502 \u2502                   \u2502   ]                                                  \u2502 \u2502\n\u2502 \u2502                   >                                                      \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:184 in rules_map   \u2502\n\u2502                                                                              \u2502\n\u2502   181 \u2502   \u2502   \"\"\"                                                            \u2502\n\u2502   182 \u2502   \u2502   if self._rules_map is None:                                    \u2502\n\u2502   183 \u2502   \u2502   \u2502   rules_map: dict[str, list[RuleSet]] = defaultdict(list)    \u2502\n\u2502 \u2771 184 \u2502   \u2502   \u2502   for rule in self.rules:                                    \u2502\n\u2502   185 \u2502   \u2502   \u2502   \u2502   for name in rule.selector_names:                       \u2502\n\u2502   186 \u2502   \u2502   \u2502   \u2502   \u2502   rules_map[name].append(rule)                       \u2502\n\u2502   187 \u2502   \u2502   \u2502   self._rules_map = dict(rules_map)                          \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 rules_map = defaultdict(<class 'list'>, {})                              \u2502 \u2502\n\u2502 \u2502      self = <Stylesheet                                                  \u2502 \u2502\n\u2502 \u2502             \u2502   [                                                        \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   (                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502                                                    \u2502 \u2502\n\u2502 \u2502             '/root/repos/py_data/textual/src/textual/app.py',            \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                                \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   ),                                                   \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   (                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502                                                    \u2502 \u2502\n\u2502 \u2502             '/root/repos/py_data/textual/tests/css/test_nested_css.py',  \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502   'ListOfNestedSelectorsApp.CSS'                   \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   ),                                                   \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   (                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502                                                    \u2502 \u2502\n\u2502 \u2502             '/root/repos/py_data/textual/src/textual/screen.py',         \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                             \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   ),                                                   \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   (                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502                                                    \u2502 \u2502\n\u2502 \u2502             '/root/repos/py_data/textual/src/textual/widget.py',         \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                             \u2502 \u2502\n\u2502 \u2502             \u2502   \u2502   )                                                    \u2502 \u2502\n\u2502 \u2502             \u2502   ]                                                        \u2502 \u2502\n\u2502 \u2502             >                                                            \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:170 in rules       \u2502\n\u2502                                                                              \u2502\n\u2502   167 \u2502   \u2502   \u2502   List of rules sets for this stylesheet.                    \u2502\n\u2502   168 \u2502   \u2502   \"\"\"                                                            \u2502\n\u2502   169 \u2502   \u2502   if self._require_parse:                                        \u2502\n\u2502 \u2771 170 \u2502   \u2502   \u2502   self.parse()                                               \u2502\n\u2502   171 \u2502   \u2502   \u2502   self._require_parse = False                                \u2502\n\u2502   172 \u2502   \u2502   assert self._rules is not None                                 \u2502\n\u2502   173 \u2502   \u2502   return self._rules                                             \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502 self = <Stylesheet                                                       \u2502 \u2502\n\u2502 \u2502        \u2502   [                                                             \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   (                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   '/root/repos/py_data/textual/src/textual/app.py',     \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                                     \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   ),                                                        \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   (                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502                                                         \u2502 \u2502\n\u2502 \u2502        '/root/repos/py_data/textual/tests/css/test_nested_css.py',       \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   'ListOfNestedSelectorsApp.CSS'                        \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   ),                                                        \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   (                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   '/root/repos/py_data/textual/src/textual/screen.py',  \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                                  \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   ),                                                        \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   (                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   '/root/repos/py_data/textual/src/textual/widget.py',  \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                                  \u2502 \u2502\n\u2502 \u2502        \u2502   \u2502   )                                                         \u2502 \u2502\n\u2502 \u2502        \u2502   ]                                                             \u2502 \u2502\n\u2502 \u2502        >                                                                 \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:368 in parse       \u2502\n\u2502                                                                              \u2502\n\u2502   365 \u2502   \u2502   \u2502   if css in self._invalid_css:                               \u2502\n\u2502   366 \u2502   \u2502   \u2502   \u2502   continue                                               \u2502\n\u2502   367 \u2502   \u2502   \u2502   try:                                                       \u2502\n\u2502 \u2771 368 \u2502   \u2502   \u2502   \u2502   css_rules = self._parse_rules(                         \u2502\n\u2502   369 \u2502   \u2502   \u2502   \u2502   \u2502   css,                                               \u2502\n\u2502   370 \u2502   \u2502   \u2502   \u2502   \u2502   read_from=read_from,                               \u2502\n\u2502   371 \u2502   \u2502   \u2502   \u2502   \u2502   is_default_rules=is_default_rules,                 \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502        add_rules = <built-in method extend of list object at             \u2502 \u2502\n\u2502 \u2502                    0x7fb36ddbec00>                                       \u2502 \u2502\n\u2502 \u2502              css = '\\n    App {\\n        background: $background;\\n      \u2502 \u2502\n\u2502 \u2502                    color: $text;\\n    }\\n    *:di'+51                    \u2502 \u2502\n\u2502 \u2502 is_default_rules = True                                                  \u2502 \u2502\n\u2502 \u2502        read_from = (                                                     \u2502 \u2502\n\u2502 \u2502                    \u2502   '/root/repos/py_data/textual/src/textual/app.py', \u2502 \u2502\n\u2502 \u2502                    \u2502   'App.DEFAULT_CSS'                                 \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502            rules = []                                                    \u2502 \u2502\n\u2502 \u2502            scope = 'App'                                                 \u2502 \u2502\n\u2502 \u2502             self = <Stylesheet                                           \u2502 \u2502\n\u2502 \u2502                    \u2502   [                                                 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/app.py',     \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                         \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/tests/css/test_nested_c\u2026 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'ListOfNestedSelectorsApp.CSS'            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/screen.py',  \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                      \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/widget.py',  \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                      \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   )                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   ]                                                 \u2502 \u2502\n\u2502 \u2502                    >                                                     \u2502 \u2502\n\u2502 \u2502      tie_breaker = -1                                                    \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2502                                                                              \u2502\n\u2502 /root/repos/py_data/textual/src/textual/css/stylesheet.py:261 in             \u2502\n\u2502 _parse_rules                                                                 \u2502\n\u2502                                                                              \u2502\n\u2502   258 \u2502   \u2502   except TokenError:                                             \u2502\n\u2502   259 \u2502   \u2502   \u2502   raise                                                      \u2502\n\u2502   260 \u2502   \u2502   except Exception as error:                                     \u2502\n\u2502 \u2771 261 \u2502   \u2502   \u2502   raise StylesheetError(f\"failed to parse css; {error}\") fro \u2502\n\u2502   262 \u2502   \u2502                                                                  \u2502\n\u2502   263 \u2502   \u2502   self._parse_cache[cache_key] = rules                           \u2502\n\u2502   264 \u2502   \u2502   return rules                                                   \u2502\n\u2502                                                                              \u2502\n\u2502 \u256d\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500 locals \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e \u2502\n\u2502 \u2502        cache_key = (                                                     \u2502 \u2502\n\u2502 \u2502                    \u2502   '\\n    App {\\n        background: $background;\\n  \u2502 \u2502\n\u2502 \u2502                    color: $text;\\n    }\\n    *:di'+51,                   \u2502 \u2502\n\u2502 \u2502                    \u2502   (                                                 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502                                                 \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/app.py',     \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   'App.DEFAULT_CSS'                             \u2502 \u2502\n\u2502 \u2502                    \u2502   ),                                                \u2502 \u2502\n\u2502 \u2502                    \u2502   True,                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   -1,                                               \u2502 \u2502\n\u2502 \u2502                    \u2502   'App'                                             \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502              css = '\\n    App {\\n        background: $background;\\n      \u2502 \u2502\n\u2502 \u2502                    color: $text;\\n    }\\n    *:di'+51                    \u2502 \u2502\n\u2502 \u2502 is_default_rules = True                                                  \u2502 \u2502\n\u2502 \u2502        read_from = (                                                     \u2502 \u2502\n\u2502 \u2502                    \u2502   '/root/repos/py_data/textual/src/textual/app.py', \u2502 \u2502\n\u2502 \u2502                    \u2502   'App.DEFAULT_CSS'                                 \u2502 \u2502\n\u2502 \u2502                    )                                                     \u2502 \u2502\n\u2502 \u2502            scope = 'App'                                                 \u2502 \u2502\n\u2502 \u2502             self = <Stylesheet                                           \u2502 \u2502\n\u2502 \u2502                    \u2502   [                                                 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/app.py',     \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'App.DEFAULT_CSS'                         \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/tests/css/test_nested_c\u2026 \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'ListOfNestedSelectorsApp.CSS'            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/screen.py',  \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'Screen.DEFAULT_CSS'                      \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   ),                                            \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   (                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502                                             \u2502 \u2502\n\u2502 \u2502                    '/root/repos/py_data/textual/src/textual/widget.py',  \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   \u2502   'Widget.DEFAULT_CSS'                      \u2502 \u2502\n\u2502 \u2502                    \u2502   \u2502   )                                             \u2502 \u2502\n\u2502 \u2502                    \u2502   ]                                                 \u2502 \u2502\n\u2502 \u2502                    >                                                     \u2502 \u2502\n\u2502 \u2502      tie_breaker = -1                                                    \u2502 \u2502\n\u2502 \u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\nStylesheetError: failed to parse css; parse() got an unexpected keyword argument\n'variable_tokens'\n____________________ test_parse_errors[Selector {-EOFError] ____________________\n\nscope = '', css = 'Selector {', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n                token = next(tokens)\n                if token.name in {\n                    \"selector_start\",\n                    \"selector_start_id\",\n                    \"selector_start_class\",\n                    \"selector_start_universal\",\n                }:\n>                   rule_sets.extend(\n                        parse_rule_set(\n                            scope,\n                            tokens,\n                            token,\n                            is_default_rules=is_default_rules,\n                            tie_breaker=tie_breaker,\n                        )\n\nsrc/textual/css/parse.py:466: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/css/parse.py:172: in parse_rule_set\n    token = next(tokens)\nsrc/textual/css/tokenize.py:215: in __call__\n    token = get_token(expect)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual.css.tokenizer.Tokenizer object at 0x7fb36e1e4d30>\nexpect = Expect(nested='\\\\&', whitespace='\\\\s+', comment_start='\\\\/\\\\*', comment_line='\\\\# .*$', declaration_name='[a-z][a-zA-Z...or_start_class='\\\\.[a-zA-Z_\\\\-][a-zA-Z0-9_\\\\-]*', selector_start_universal='\\\\*', selector_start='[A-Z_][a-zA-Z0-9_]*')\n\n    def get_token(self, expect: Expect) -> Token:\n        \"\"\"Get the next token.\n    \n        Args:\n            expect: Expect object which describes which tokens may be read.\n    \n        Raises:\n            EOFError: If there is an unexpected end of file.\n            TokenError: If there is an error with the token.\n    \n        Returns:\n            A new Token.\n        \"\"\"\n    \n        line_no = self.line_no\n        col_no = self.col_no\n        if line_no >= len(self.lines):\n            if expect._expect_eof:\n                return Token(\n                    \"eof\",\n                    \"\",\n                    self.read_from,\n                    self.code,\n                    (line_no, col_no),\n                    None,\n                )\n            else:\n>               raise EOFError(\n                    self.read_from,\n                    self.code,\n                    (line_no + 1, col_no + 1),\n                    \"Unexpected end of file; did you forget a '}' ?\",\n                )\nE               textual.css.tokenizer.EOFError: Unexpected end of file; did you forget a '}' ?\n\nsrc/textual/css/tokenizer.py:242: EOFError\n\nDuring handling of the above exception, another exception occurred:\n\ncss = 'Selector {', exception = <class 'textual.css.tokenizer.EOFError'>\n\n    @pytest.mark.parametrize(\n        (\"css\", \"exception\"),\n        [\n            (\"Selector {\", EOFError),\n            (\"Selector{ Foo {\", EOFError),\n            (\"Selector{ Foo {}\", EOFError),\n            (\"> {}\", TokenError),\n            (\"&\", TokenError),\n            (\"&&\", TokenError),\n            (\"&.foo\", TokenError),\n            (\"& .foo\", TokenError),\n            (\"{\", TokenError),\n            (\"*{\", EOFError),\n        ],\n    )\n    def test_parse_errors(css: str, exception: type[Exception]) -> None:\n        \"\"\"Check some CSS which should fail.\"\"\"\n        with pytest.raises(exception):\n>           list(parse(\"\", css, (\"foo\", \"\")))\n\ntests/css/test_nested_css.py:112: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nscope = '', css = 'Selector {', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n                token = next(tokens)\n                if token.name in {\n                    \"selector_start\",\n                    \"selector_start_id\",\n                    \"selector_start_class\",\n                    \"selector_start_universal\",\n                }:\n                    rule_sets.extend(\n                        parse_rule_set(\n                            scope,\n                            tokens,\n                            token,\n                            is_default_rules=is_default_rules,\n                            tie_breaker=tie_breaker,\n                        )\n                    )\n                elif token.name == \"variable_name\":\n                    variable_name = token.value.rstrip(\":\")\n                    variable_tokens = list(\n                        tokenize_variable_value(tokens, expect_variable_name_continue)\n                    )\n                    if variables is not None:\n                        variables[variable_name] = variable_tokens\n                elif token.name == \"eof\":\n                    break\n    \n>       except TokenError as error:\nE       NameError: name 'TokenError' is not defined\n\nsrc/textual/css/parse.py:485: NameError\n_________________ test_parse_errors[Selector{ Foo {-EOFError] __________________\n\nscope = '', css = 'Selector{ Foo {', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n                token = next(tokens)\n                if token.name in {\n                    \"selector_start\",\n                    \"selector_start_id\",\n                    \"selector_start_class\",\n                    \"selector_start_universal\",\n                }:\n>                   rule_sets.extend(\n                        parse_rule_set(\n                            scope,\n                            tokens,\n                            token,\n                            is_default_rules=is_default_rules,\n                            tie_breaker=tie_breaker,\n                        )\n\nsrc/textual/css/parse.py:466: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/css/parse.py:184: in parse_rule_set\n    recursive_parse: list[RuleSet] = list(\nsrc/textual/css/parse.py:172: in parse_rule_set\n    token = next(tokens)\nsrc/textual/css/tokenize.py:215: in __call__\n    token = get_token(expect)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual.css.tokenizer.Tokenizer object at 0x7fb36e320e80>\nexpect = Expect(nested='\\\\&', whitespace='\\\\s+', comment_start='\\\\/\\\\*', comment_line='\\\\# .*$', declaration_name='[a-z][a-zA-Z...or_start_class='\\\\.[a-zA-Z_\\\\-][a-zA-Z0-9_\\\\-]*', selector_start_universal='\\\\*', selector_start='[A-Z_][a-zA-Z0-9_]*')\n\n    def get_token(self, expect: Expect) -> Token:\n        \"\"\"Get the next token.\n    \n        Args:\n            expect: Expect object which describes which tokens may be read.\n    \n        Raises:\n            EOFError: If there is an unexpected end of file.\n            TokenError: If there is an error with the token.\n    \n        Returns:\n            A new Token.\n        \"\"\"\n    \n        line_no = self.line_no\n        col_no = self.col_no\n        if line_no >= len(self.lines):\n            if expect._expect_eof:\n                return Token(\n                    \"eof\",\n                    \"\",\n                    self.read_from,\n                    self.code,\n                    (line_no, col_no),\n                    None,\n                )\n            else:\n>               raise EOFError(\n                    self.read_from,\n                    self.code,\n                    (line_no + 1, col_no + 1),\n                    \"Unexpected end of file; did you forget a '}' ?\",\n                )\nE               textual.css.tokenizer.EOFError: Unexpected end of file; did you forget a '}' ?\n\nsrc/textual/css/tokenizer.py:242: EOFError\n\nDuring handling of the above exception, another exception occurred:\n\ncss = 'Selector{ Foo {', exception = <class 'textual.css.tokenizer.EOFError'>\n\n    @pytest.mark.parametrize(\n        (\"css\", \"exception\"),\n        [\n            (\"Selector {\", EOFError),\n            (\"Selector{ Foo {\", EOFError),\n            (\"Selector{ Foo {}\", EOFError),\n            (\"> {}\", TokenError),\n            (\"&\", TokenError),\n            (\"&&\", TokenError),\n            (\"&.foo\", TokenError),\n            (\"& .foo\", TokenError),\n            (\"{\", TokenError),\n            (\"*{\", EOFError),\n        ],\n    )\n    def test_parse_errors(css: str, exception: type[Exception]) -> None:\n        \"\"\"Check some CSS which should fail.\"\"\"\n        with pytest.raises(exception):\n>           list(parse(\"\", css, (\"foo\", \"\")))\n\ntests/css/test_nested_css.py:112: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nscope = '', css = 'Selector{ Foo {', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n                token = next(tokens)\n                if token.name in {\n                    \"selector_start\",\n                    \"selector_start_id\",\n                    \"selector_start_class\",\n                    \"selector_start_universal\",\n                }:\n                    rule_sets.extend(\n                        parse_rule_set(\n                            scope,\n                            tokens,\n                            token,\n                            is_default_rules=is_default_rules,\n                            tie_breaker=tie_breaker,\n                        )\n                    )\n                elif token.name == \"variable_name\":\n                    variable_name = token.value.rstrip(\":\")\n                    variable_tokens = list(\n                        tokenize_variable_value(tokens, expect_variable_name_continue)\n                    )\n                    if variables is not None:\n                        variables[variable_name] = variable_tokens\n                elif token.name == \"eof\":\n                    break\n    \n>       except TokenError as error:\nE       NameError: name 'TokenError' is not defined\n\nsrc/textual/css/parse.py:485: NameError\n_________________ test_parse_errors[Selector{ Foo {}-EOFError] _________________\n\nscope = '', css = 'Selector{ Foo {}', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n                token = next(tokens)\n                if token.name in {\n                    \"selector_start\",\n                    \"selector_start_id\",\n                    \"selector_start_class\",\n                    \"selector_start_universal\",\n                }:\n>                   rule_sets.extend(\n                        parse_rule_set(\n                            scope,\n                            tokens,\n                            token,\n                            is_default_rules=is_default_rules,\n                            tie_breaker=tie_breaker,\n                        )\n\nsrc/textual/css/parse.py:466: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/css/parse.py:172: in parse_rule_set\n    token = next(tokens)\nsrc/textual/css/tokenize.py:215: in __call__\n    token = get_token(expect)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual.css.tokenizer.Tokenizer object at 0x7fb36e4592d0>\nexpect = Expect(nested='\\\\&', whitespace='\\\\s+', comment_start='\\\\/\\\\*', comment_line='\\\\# .*$', declaration_name='[a-z][a-zA-Z...or_start_class='\\\\.[a-zA-Z_\\\\-][a-zA-Z0-9_\\\\-]*', selector_start_universal='\\\\*', selector_start='[A-Z_][a-zA-Z0-9_]*')\n\n    def get_token(self, expect: Expect) -> Token:\n        \"\"\"Get the next token.\n    \n        Args:\n            expect: Expect object which describes which tokens may be read.\n    \n        Raises:\n            EOFError: If there is an unexpected end of file.\n            TokenError: If there is an error with the token.\n    \n        Returns:\n            A new Token.\n        \"\"\"\n    \n        line_no = self.line_no\n        col_no = self.col_no\n        if line_no >= len(self.lines):\n            if expect._expect_eof:\n                return Token(\n                    \"eof\",\n                    \"\",\n                    self.read_from,\n                    self.code,\n                    (line_no, col_no),\n                    None,\n                )\n            else:\n>               raise EOFError(\n                    self.read_from,\n                    self.code,\n                    (line_no + 1, col_no + 1),\n                    \"Unexpected end of file; did you forget a '}' ?\",\n                )\nE               textual.css.tokenizer.EOFError: Unexpected end of file; did you forget a '}' ?\n\nsrc/textual/css/tokenizer.py:242: EOFError\n\nDuring handling of the above exception, another exception occurred:\n\ncss = 'Selector{ Foo {}', exception = <class 'textual.css.tokenizer.EOFError'>\n\n    @pytest.mark.parametrize(\n        (\"css\", \"exception\"),\n        [\n            (\"Selector {\", EOFError),\n            (\"Selector{ Foo {\", EOFError),\n            (\"Selector{ Foo {}\", EOFError),\n            (\"> {}\", TokenError),\n            (\"&\", TokenError),\n            (\"&&\", TokenError),\n            (\"&.foo\", TokenError),\n            (\"& .foo\", TokenError),\n            (\"{\", TokenError),\n            (\"*{\", EOFError),\n        ],\n    )\n    def test_parse_errors(css: str, exception: type[Exception]) -> None:\n        \"\"\"Check some CSS which should fail.\"\"\"\n        with pytest.raises(exception):\n>           list(parse(\"\", css, (\"foo\", \"\")))\n\ntests/css/test_nested_css.py:112: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nscope = '', css = 'Selector{ Foo {}', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n                token = next(tokens)\n                if token.name in {\n                    \"selector_start\",\n                    \"selector_start_id\",\n                    \"selector_start_class\",\n                    \"selector_start_universal\",\n                }:\n                    rule_sets.extend(\n                        parse_rule_set(\n                            scope,\n                            tokens,\n                            token,\n                            is_default_rules=is_default_rules,\n                            tie_breaker=tie_breaker,\n                        )\n                    )\n                elif token.name == \"variable_name\":\n                    variable_name = token.value.rstrip(\":\")\n                    variable_tokens = list(\n                        tokenize_variable_value(tokens, expect_variable_name_continue)\n                    )\n                    if variables is not None:\n                        variables[variable_name] = variable_tokens\n                elif token.name == \"eof\":\n                    break\n    \n>       except TokenError as error:\nE       NameError: name 'TokenError' is not defined\n\nsrc/textual/css/parse.py:485: NameError\n______________________ test_parse_errors[> {}-TokenError] ______________________\n\nscope = '', css = '> {}', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n>               token = next(tokens)\n\nsrc/textual/css/parse.py:459: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/css/tokenize.py:215: in __call__\n    token = get_token(expect)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual.css.tokenizer.Tokenizer object at 0x7fb36df9c0d0>\nexpect = Expect(whitespace='\\\\s+', comment_start='\\\\/\\\\*', comment_line='\\\\# .*$', selector_start_id='\\\\#[a-zA-Z_\\\\-][a-zA-Z0-9...universal='\\\\*', selector_start='[A-Z_][a-zA-Z0-9_]*', variable_name='\\\\$[a-zA-Z0-9_\\\\-]+:', declaration_set_end='\\\\}')\n\n    def get_token(self, expect: Expect) -> Token:\n        \"\"\"Get the next token.\n    \n        Args:\n            expect: Expect object which describes which tokens may be read.\n    \n        Raises:\n            EOFError: If there is an unexpected end of file.\n            TokenError: If there is an error with the token.\n    \n        Returns:\n            A new Token.\n        \"\"\"\n    \n        line_no = self.line_no\n        col_no = self.col_no\n        if line_no >= len(self.lines):\n            if expect._expect_eof:\n                return Token(\n                    \"eof\",\n                    \"\",\n                    self.read_from,\n                    self.code,\n                    (line_no, col_no),\n                    None,\n                )\n            else:\n                raise EOFError(\n                    self.read_from,\n                    self.code,\n                    (line_no + 1, col_no + 1),\n                    \"Unexpected end of file; did you forget a '}' ?\",\n                )\n        line = self.lines[line_no]\n        match = expect.match(line, col_no)\n        if match is None:\n            error_line = line[col_no:].rstrip()\n            error_message = (\n                f\"{expect.description} (found {error_line.split(';')[0]!r}).\"\n            )\n            if not error_line.endswith(\";\"):\n                error_message += \"; Did you forget a semicolon at the end of a line?\"\n>           raise TokenError(\n                self.read_from, self.code, (line_no + 1, col_no + 1), error_message\n            )\nE           textual.css.tokenizer.TokenError: Expected selector or end of file (found '> {}').; Did you forget a semicolon at the end of a line?\n\nsrc/textual/css/tokenizer.py:257: TokenError\n\nDuring handling of the above exception, another exception occurred:\n\ncss = '> {}', exception = <class 'textual.css.tokenizer.TokenError'>\n\n    @pytest.mark.parametrize(\n        (\"css\", \"exception\"),\n        [\n            (\"Selector {\", EOFError),\n            (\"Selector{ Foo {\", EOFError),\n            (\"Selector{ Foo {}\", EOFError),\n            (\"> {}\", TokenError),\n            (\"&\", TokenError),\n            (\"&&\", TokenError),\n            (\"&.foo\", TokenError),\n            (\"& .foo\", TokenError),\n            (\"{\", TokenError),\n            (\"*{\", EOFError),\n        ],\n    )\n    def test_parse_errors(css: str, exception: type[Exception]) -> None:\n        \"\"\"Check some CSS which should fail.\"\"\"\n        with pytest.raises(exception):\n>           list(parse(\"\", css, (\"foo\", \"\")))\n\ntests/css/test_nested_css.py:112: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nscope = '', css = '> {}', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n                token = next(tokens)\n                if token.name in {\n                    \"selector_start\",\n                    \"selector_start_id\",\n                    \"selector_start_class\",\n                    \"selector_start_universal\",\n                }:\n                    rule_sets.extend(\n                        parse_rule_set(\n                            scope,\n                            tokens,\n                            token,\n                            is_default_rules=is_default_rules,\n                            tie_breaker=tie_breaker,\n                        )\n                    )\n                elif token.name == \"variable_name\":\n                    variable_name = token.value.rstrip(\":\")\n                    variable_tokens = list(\n                        tokenize_variable_value(tokens, expect_variable_name_continue)\n                    )\n                    if variables is not None:\n                        variables[variable_name] = variable_tokens\n                elif token.name == \"eof\":\n                    break\n    \n>       except TokenError as error:\nE       NameError: name 'TokenError' is not defined\n\nsrc/textual/css/parse.py:485: NameError\n_______________________ test_parse_errors[&-TokenError] ________________________\n\nscope = '', css = '&', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n>               token = next(tokens)\n\nsrc/textual/css/parse.py:459: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/css/tokenize.py:215: in __call__\n    token = get_token(expect)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual.css.tokenizer.Tokenizer object at 0x7fb36ea53d90>\nexpect = Expect(whitespace='\\\\s+', comment_start='\\\\/\\\\*', comment_line='\\\\# .*$', selector_start_id='\\\\#[a-zA-Z_\\\\-][a-zA-Z0-9...universal='\\\\*', selector_start='[A-Z_][a-zA-Z0-9_]*', variable_name='\\\\$[a-zA-Z0-9_\\\\-]+:', declaration_set_end='\\\\}')\n\n    def get_token(self, expect: Expect) -> Token:\n        \"\"\"Get the next token.\n    \n        Args:\n            expect: Expect object which describes which tokens may be read.\n    \n        Raises:\n            EOFError: If there is an unexpected end of file.\n            TokenError: If there is an error with the token.\n    \n        Returns:\n            A new Token.\n        \"\"\"\n    \n        line_no = self.line_no\n        col_no = self.col_no\n        if line_no >= len(self.lines):\n            if expect._expect_eof:\n                return Token(\n                    \"eof\",\n                    \"\",\n                    self.read_from,\n                    self.code,\n                    (line_no, col_no),\n                    None,\n                )\n            else:\n                raise EOFError(\n                    self.read_from,\n                    self.code,\n                    (line_no + 1, col_no + 1),\n                    \"Unexpected end of file; did you forget a '}' ?\",\n                )\n        line = self.lines[line_no]\n        match = expect.match(line, col_no)\n        if match is None:\n            error_line = line[col_no:].rstrip()\n            error_message = (\n                f\"{expect.description} (found {error_line.split(';')[0]!r}).\"\n            )\n            if not error_line.endswith(\";\"):\n                error_message += \"; Did you forget a semicolon at the end of a line?\"\n>           raise TokenError(\n                self.read_from, self.code, (line_no + 1, col_no + 1), error_message\n            )\nE           textual.css.tokenizer.TokenError: Expected selector or end of file (found '&').; Did you forget a semicolon at the end of a line?\n\nsrc/textual/css/tokenizer.py:257: TokenError\n\nDuring handling of the above exception, another exception occurred:\n\ncss = '&', exception = <class 'textual.css.tokenizer.TokenError'>\n\n    @pytest.mark.parametrize(\n        (\"css\", \"exception\"),\n        [\n            (\"Selector {\", EOFError),\n            (\"Selector{ Foo {\", EOFError),\n            (\"Selector{ Foo {}\", EOFError),\n            (\"> {}\", TokenError),\n            (\"&\", TokenError),\n            (\"&&\", TokenError),\n            (\"&.foo\", TokenError),\n            (\"& .foo\", TokenError),\n            (\"{\", TokenError),\n            (\"*{\", EOFError),\n        ],\n    )\n    def test_parse_errors(css: str, exception: type[Exception]) -> None:\n        \"\"\"Check some CSS which should fail.\"\"\"\n        with pytest.raises(exception):\n>           list(parse(\"\", css, (\"foo\", \"\")))\n\ntests/css/test_nested_css.py:112: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nscope = '', css = '&', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n                token = next(tokens)\n                if token.name in {\n                    \"selector_start\",\n                    \"selector_start_id\",\n                    \"selector_start_class\",\n                    \"selector_start_universal\",\n                }:\n                    rule_sets.extend(\n                        parse_rule_set(\n                            scope,\n                            tokens,\n                            token,\n                            is_default_rules=is_default_rules,\n                            tie_breaker=tie_breaker,\n                        )\n                    )\n                elif token.name == \"variable_name\":\n                    variable_name = token.value.rstrip(\":\")\n                    variable_tokens = list(\n                        tokenize_variable_value(tokens, expect_variable_name_continue)\n                    )\n                    if variables is not None:\n                        variables[variable_name] = variable_tokens\n                elif token.name == \"eof\":\n                    break\n    \n>       except TokenError as error:\nE       NameError: name 'TokenError' is not defined\n\nsrc/textual/css/parse.py:485: NameError\n_______________________ test_parse_errors[&&-TokenError] _______________________\n\nscope = '', css = '&&', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n>               token = next(tokens)\n\nsrc/textual/css/parse.py:459: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/css/tokenize.py:215: in __call__\n    token = get_token(expect)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual.css.tokenizer.Tokenizer object at 0x7fb36dd9de10>\nexpect = Expect(whitespace='\\\\s+', comment_start='\\\\/\\\\*', comment_line='\\\\# .*$', selector_start_id='\\\\#[a-zA-Z_\\\\-][a-zA-Z0-9...universal='\\\\*', selector_start='[A-Z_][a-zA-Z0-9_]*', variable_name='\\\\$[a-zA-Z0-9_\\\\-]+:', declaration_set_end='\\\\}')\n\n    def get_token(self, expect: Expect) -> Token:\n        \"\"\"Get the next token.\n    \n        Args:\n            expect: Expect object which describes which tokens may be read.\n    \n        Raises:\n            EOFError: If there is an unexpected end of file.\n            TokenError: If there is an error with the token.\n    \n        Returns:\n            A new Token.\n        \"\"\"\n    \n        line_no = self.line_no\n        col_no = self.col_no\n        if line_no >= len(self.lines):\n            if expect._expect_eof:\n                return Token(\n                    \"eof\",\n                    \"\",\n                    self.read_from,\n                    self.code,\n                    (line_no, col_no),\n                    None,\n                )\n            else:\n                raise EOFError(\n                    self.read_from,\n                    self.code,\n                    (line_no + 1, col_no + 1),\n                    \"Unexpected end of file; did you forget a '}' ?\",\n                )\n        line = self.lines[line_no]\n        match = expect.match(line, col_no)\n        if match is None:\n            error_line = line[col_no:].rstrip()\n            error_message = (\n                f\"{expect.description} (found {error_line.split(';')[0]!r}).\"\n            )\n            if not error_line.endswith(\";\"):\n                error_message += \"; Did you forget a semicolon at the end of a line?\"\n>           raise TokenError(\n                self.read_from, self.code, (line_no + 1, col_no + 1), error_message\n            )\nE           textual.css.tokenizer.TokenError: Expected selector or end of file (found '&&').; Did you forget a semicolon at the end of a line?\n\nsrc/textual/css/tokenizer.py:257: TokenError\n\nDuring handling of the above exception, another exception occurred:\n\ncss = '&&', exception = <class 'textual.css.tokenizer.TokenError'>\n\n    @pytest.mark.parametrize(\n        (\"css\", \"exception\"),\n        [\n            (\"Selector {\", EOFError),\n            (\"Selector{ Foo {\", EOFError),\n            (\"Selector{ Foo {}\", EOFError),\n            (\"> {}\", TokenError),\n            (\"&\", TokenError),\n            (\"&&\", TokenError),\n            (\"&.foo\", TokenError),\n            (\"& .foo\", TokenError),\n            (\"{\", TokenError),\n            (\"*{\", EOFError),\n        ],\n    )\n    def test_parse_errors(css: str, exception: type[Exception]) -> None:\n        \"\"\"Check some CSS which should fail.\"\"\"\n        with pytest.raises(exception):\n>           list(parse(\"\", css, (\"foo\", \"\")))\n\ntests/css/test_nested_css.py:112: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nscope = '', css = '&&', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n                token = next(tokens)\n                if token.name in {\n                    \"selector_start\",\n                    \"selector_start_id\",\n                    \"selector_start_class\",\n                    \"selector_start_universal\",\n                }:\n                    rule_sets.extend(\n                        parse_rule_set(\n                            scope,\n                            tokens,\n                            token,\n                            is_default_rules=is_default_rules,\n                            tie_breaker=tie_breaker,\n                        )\n                    )\n                elif token.name == \"variable_name\":\n                    variable_name = token.value.rstrip(\":\")\n                    variable_tokens = list(\n                        tokenize_variable_value(tokens, expect_variable_name_continue)\n                    )\n                    if variables is not None:\n                        variables[variable_name] = variable_tokens\n                elif token.name == \"eof\":\n                    break\n    \n>       except TokenError as error:\nE       NameError: name 'TokenError' is not defined\n\nsrc/textual/css/parse.py:485: NameError\n_____________________ test_parse_errors[&.foo-TokenError] ______________________\n\nscope = '', css = '&.foo', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n>               token = next(tokens)\n\nsrc/textual/css/parse.py:459: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/css/tokenize.py:215: in __call__\n    token = get_token(expect)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual.css.tokenizer.Tokenizer object at 0x7fb36df7b5e0>\nexpect = Expect(whitespace='\\\\s+', comment_start='\\\\/\\\\*', comment_line='\\\\# .*$', selector_start_id='\\\\#[a-zA-Z_\\\\-][a-zA-Z0-9...universal='\\\\*', selector_start='[A-Z_][a-zA-Z0-9_]*', variable_name='\\\\$[a-zA-Z0-9_\\\\-]+:', declaration_set_end='\\\\}')\n\n    def get_token(self, expect: Expect) -> Token:\n        \"\"\"Get the next token.\n    \n        Args:\n            expect: Expect object which describes which tokens may be read.\n    \n        Raises:\n            EOFError: If there is an unexpected end of file.\n            TokenError: If there is an error with the token.\n    \n        Returns:\n            A new Token.\n        \"\"\"\n    \n        line_no = self.line_no\n        col_no = self.col_no\n        if line_no >= len(self.lines):\n            if expect._expect_eof:\n                return Token(\n                    \"eof\",\n                    \"\",\n                    self.read_from,\n                    self.code,\n                    (line_no, col_no),\n                    None,\n                )\n            else:\n                raise EOFError(\n                    self.read_from,\n                    self.code,\n                    (line_no + 1, col_no + 1),\n                    \"Unexpected end of file; did you forget a '}' ?\",\n                )\n        line = self.lines[line_no]\n        match = expect.match(line, col_no)\n        if match is None:\n            error_line = line[col_no:].rstrip()\n            error_message = (\n                f\"{expect.description} (found {error_line.split(';')[0]!r}).\"\n            )\n            if not error_line.endswith(\";\"):\n                error_message += \"; Did you forget a semicolon at the end of a line?\"\n>           raise TokenError(\n                self.read_from, self.code, (line_no + 1, col_no + 1), error_message\n            )\nE           textual.css.tokenizer.TokenError: Expected selector or end of file (found '&.foo').; Did you forget a semicolon at the end of a line?\n\nsrc/textual/css/tokenizer.py:257: TokenError\n\nDuring handling of the above exception, another exception occurred:\n\ncss = '&.foo', exception = <class 'textual.css.tokenizer.TokenError'>\n\n    @pytest.mark.parametrize(\n        (\"css\", \"exception\"),\n        [\n            (\"Selector {\", EOFError),\n            (\"Selector{ Foo {\", EOFError),\n            (\"Selector{ Foo {}\", EOFError),\n            (\"> {}\", TokenError),\n            (\"&\", TokenError),\n            (\"&&\", TokenError),\n            (\"&.foo\", TokenError),\n            (\"& .foo\", TokenError),\n            (\"{\", TokenError),\n            (\"*{\", EOFError),\n        ],\n    )\n    def test_parse_errors(css: str, exception: type[Exception]) -> None:\n        \"\"\"Check some CSS which should fail.\"\"\"\n        with pytest.raises(exception):\n>           list(parse(\"\", css, (\"foo\", \"\")))\n\ntests/css/test_nested_css.py:112: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nscope = '', css = '&.foo', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n                token = next(tokens)\n                if token.name in {\n                    \"selector_start\",\n                    \"selector_start_id\",\n                    \"selector_start_class\",\n                    \"selector_start_universal\",\n                }:\n                    rule_sets.extend(\n                        parse_rule_set(\n                            scope,\n                            tokens,\n                            token,\n                            is_default_rules=is_default_rules,\n                            tie_breaker=tie_breaker,\n                        )\n                    )\n                elif token.name == \"variable_name\":\n                    variable_name = token.value.rstrip(\":\")\n                    variable_tokens = list(\n                        tokenize_variable_value(tokens, expect_variable_name_continue)\n                    )\n                    if variables is not None:\n                        variables[variable_name] = variable_tokens\n                elif token.name == \"eof\":\n                    break\n    \n>       except TokenError as error:\nE       NameError: name 'TokenError' is not defined\n\nsrc/textual/css/parse.py:485: NameError\n_____________________ test_parse_errors[& .foo-TokenError] _____________________\n\nscope = '', css = '& .foo', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n>               token = next(tokens)\n\nsrc/textual/css/parse.py:459: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/css/tokenize.py:215: in __call__\n    token = get_token(expect)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual.css.tokenizer.Tokenizer object at 0x7fb36ea53b50>\nexpect = Expect(whitespace='\\\\s+', comment_start='\\\\/\\\\*', comment_line='\\\\# .*$', selector_start_id='\\\\#[a-zA-Z_\\\\-][a-zA-Z0-9...universal='\\\\*', selector_start='[A-Z_][a-zA-Z0-9_]*', variable_name='\\\\$[a-zA-Z0-9_\\\\-]+:', declaration_set_end='\\\\}')\n\n    def get_token(self, expect: Expect) -> Token:\n        \"\"\"Get the next token.\n    \n        Args:\n            expect: Expect object which describes which tokens may be read.\n    \n        Raises:\n            EOFError: If there is an unexpected end of file.\n            TokenError: If there is an error with the token.\n    \n        Returns:\n            A new Token.\n        \"\"\"\n    \n        line_no = self.line_no\n        col_no = self.col_no\n        if line_no >= len(self.lines):\n            if expect._expect_eof:\n                return Token(\n                    \"eof\",\n                    \"\",\n                    self.read_from,\n                    self.code,\n                    (line_no, col_no),\n                    None,\n                )\n            else:\n                raise EOFError(\n                    self.read_from,\n                    self.code,\n                    (line_no + 1, col_no + 1),\n                    \"Unexpected end of file; did you forget a '}' ?\",\n                )\n        line = self.lines[line_no]\n        match = expect.match(line, col_no)\n        if match is None:\n            error_line = line[col_no:].rstrip()\n            error_message = (\n                f\"{expect.description} (found {error_line.split(';')[0]!r}).\"\n            )\n            if not error_line.endswith(\";\"):\n                error_message += \"; Did you forget a semicolon at the end of a line?\"\n>           raise TokenError(\n                self.read_from, self.code, (line_no + 1, col_no + 1), error_message\n            )\nE           textual.css.tokenizer.TokenError: Expected selector or end of file (found '& .foo').; Did you forget a semicolon at the end of a line?\n\nsrc/textual/css/tokenizer.py:257: TokenError\n\nDuring handling of the above exception, another exception occurred:\n\ncss = '& .foo', exception = <class 'textual.css.tokenizer.TokenError'>\n\n    @pytest.mark.parametrize(\n        (\"css\", \"exception\"),\n        [\n            (\"Selector {\", EOFError),\n            (\"Selector{ Foo {\", EOFError),\n            (\"Selector{ Foo {}\", EOFError),\n            (\"> {}\", TokenError),\n            (\"&\", TokenError),\n            (\"&&\", TokenError),\n            (\"&.foo\", TokenError),\n            (\"& .foo\", TokenError),\n            (\"{\", TokenError),\n            (\"*{\", EOFError),\n        ],\n    )\n    def test_parse_errors(css: str, exception: type[Exception]) -> None:\n        \"\"\"Check some CSS which should fail.\"\"\"\n        with pytest.raises(exception):\n>           list(parse(\"\", css, (\"foo\", \"\")))\n\ntests/css/test_nested_css.py:112: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nscope = '', css = '& .foo', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n                token = next(tokens)\n                if token.name in {\n                    \"selector_start\",\n                    \"selector_start_id\",\n                    \"selector_start_class\",\n                    \"selector_start_universal\",\n                }:\n                    rule_sets.extend(\n                        parse_rule_set(\n                            scope,\n                            tokens,\n                            token,\n                            is_default_rules=is_default_rules,\n                            tie_breaker=tie_breaker,\n                        )\n                    )\n                elif token.name == \"variable_name\":\n                    variable_name = token.value.rstrip(\":\")\n                    variable_tokens = list(\n                        tokenize_variable_value(tokens, expect_variable_name_continue)\n                    )\n                    if variables is not None:\n                        variables[variable_name] = variable_tokens\n                elif token.name == \"eof\":\n                    break\n    \n>       except TokenError as error:\nE       NameError: name 'TokenError' is not defined\n\nsrc/textual/css/parse.py:485: NameError\n_______________________ test_parse_errors[{-TokenError] ________________________\n\nscope = '', css = '{', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n>               token = next(tokens)\n\nsrc/textual/css/parse.py:459: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/css/tokenize.py:215: in __call__\n    token = get_token(expect)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual.css.tokenizer.Tokenizer object at 0x7fb36e323f40>\nexpect = Expect(whitespace='\\\\s+', comment_start='\\\\/\\\\*', comment_line='\\\\# .*$', selector_start_id='\\\\#[a-zA-Z_\\\\-][a-zA-Z0-9...universal='\\\\*', selector_start='[A-Z_][a-zA-Z0-9_]*', variable_name='\\\\$[a-zA-Z0-9_\\\\-]+:', declaration_set_end='\\\\}')\n\n    def get_token(self, expect: Expect) -> Token:\n        \"\"\"Get the next token.\n    \n        Args:\n            expect: Expect object which describes which tokens may be read.\n    \n        Raises:\n            EOFError: If there is an unexpected end of file.\n            TokenError: If there is an error with the token.\n    \n        Returns:\n            A new Token.\n        \"\"\"\n    \n        line_no = self.line_no\n        col_no = self.col_no\n        if line_no >= len(self.lines):\n            if expect._expect_eof:\n                return Token(\n                    \"eof\",\n                    \"\",\n                    self.read_from,\n                    self.code,\n                    (line_no, col_no),\n                    None,\n                )\n            else:\n                raise EOFError(\n                    self.read_from,\n                    self.code,\n                    (line_no + 1, col_no + 1),\n                    \"Unexpected end of file; did you forget a '}' ?\",\n                )\n        line = self.lines[line_no]\n        match = expect.match(line, col_no)\n        if match is None:\n            error_line = line[col_no:].rstrip()\n            error_message = (\n                f\"{expect.description} (found {error_line.split(';')[0]!r}).\"\n            )\n            if not error_line.endswith(\";\"):\n                error_message += \"; Did you forget a semicolon at the end of a line?\"\n>           raise TokenError(\n                self.read_from, self.code, (line_no + 1, col_no + 1), error_message\n            )\nE           textual.css.tokenizer.TokenError: Expected selector or end of file (found '{').; Did you forget a semicolon at the end of a line?\n\nsrc/textual/css/tokenizer.py:257: TokenError\n\nDuring handling of the above exception, another exception occurred:\n\ncss = '{', exception = <class 'textual.css.tokenizer.TokenError'>\n\n    @pytest.mark.parametrize(\n        (\"css\", \"exception\"),\n        [\n            (\"Selector {\", EOFError),\n            (\"Selector{ Foo {\", EOFError),\n            (\"Selector{ Foo {}\", EOFError),\n            (\"> {}\", TokenError),\n            (\"&\", TokenError),\n            (\"&&\", TokenError),\n            (\"&.foo\", TokenError),\n            (\"& .foo\", TokenError),\n            (\"{\", TokenError),\n            (\"*{\", EOFError),\n        ],\n    )\n    def test_parse_errors(css: str, exception: type[Exception]) -> None:\n        \"\"\"Check some CSS which should fail.\"\"\"\n        with pytest.raises(exception):\n>           list(parse(\"\", css, (\"foo\", \"\")))\n\ntests/css/test_nested_css.py:112: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nscope = '', css = '{', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n                token = next(tokens)\n                if token.name in {\n                    \"selector_start\",\n                    \"selector_start_id\",\n                    \"selector_start_class\",\n                    \"selector_start_universal\",\n                }:\n                    rule_sets.extend(\n                        parse_rule_set(\n                            scope,\n                            tokens,\n                            token,\n                            is_default_rules=is_default_rules,\n                            tie_breaker=tie_breaker,\n                        )\n                    )\n                elif token.name == \"variable_name\":\n                    variable_name = token.value.rstrip(\":\")\n                    variable_tokens = list(\n                        tokenize_variable_value(tokens, expect_variable_name_continue)\n                    )\n                    if variables is not None:\n                        variables[variable_name] = variable_tokens\n                elif token.name == \"eof\":\n                    break\n    \n>       except TokenError as error:\nE       NameError: name 'TokenError' is not defined\n\nsrc/textual/css/parse.py:485: NameError\n________________________ test_parse_errors[*{-EOFError] ________________________\n\nscope = '', css = '*{', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n                token = next(tokens)\n                if token.name in {\n                    \"selector_start\",\n                    \"selector_start_id\",\n                    \"selector_start_class\",\n                    \"selector_start_universal\",\n                }:\n>                   rule_sets.extend(\n                        parse_rule_set(\n                            scope,\n                            tokens,\n                            token,\n                            is_default_rules=is_default_rules,\n                            tie_breaker=tie_breaker,\n                        )\n\nsrc/textual/css/parse.py:466: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nsrc/textual/css/parse.py:172: in parse_rule_set\n    token = next(tokens)\nsrc/textual/css/tokenize.py:215: in __call__\n    token = get_token(expect)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <textual.css.tokenizer.Tokenizer object at 0x7fb36ea68dc0>\nexpect = Expect(nested='\\\\&', whitespace='\\\\s+', comment_start='\\\\/\\\\*', comment_line='\\\\# .*$', declaration_name='[a-z][a-zA-Z...or_start_class='\\\\.[a-zA-Z_\\\\-][a-zA-Z0-9_\\\\-]*', selector_start_universal='\\\\*', selector_start='[A-Z_][a-zA-Z0-9_]*')\n\n    def get_token(self, expect: Expect) -> Token:\n        \"\"\"Get the next token.\n    \n        Args:\n            expect: Expect object which describes which tokens may be read.\n    \n        Raises:\n            EOFError: If there is an unexpected end of file.\n            TokenError: If there is an error with the token.\n    \n        Returns:\n            A new Token.\n        \"\"\"\n    \n        line_no = self.line_no\n        col_no = self.col_no\n        if line_no >= len(self.lines):\n            if expect._expect_eof:\n                return Token(\n                    \"eof\",\n                    \"\",\n                    self.read_from,\n                    self.code,\n                    (line_no, col_no),\n                    None,\n                )\n            else:\n>               raise EOFError(\n                    self.read_from,\n                    self.code,\n                    (line_no + 1, col_no + 1),\n                    \"Unexpected end of file; did you forget a '}' ?\",\n                )\nE               textual.css.tokenizer.EOFError: Unexpected end of file; did you forget a '}' ?\n\nsrc/textual/css/tokenizer.py:242: EOFError\n\nDuring handling of the above exception, another exception occurred:\n\ncss = '*{', exception = <class 'textual.css.tokenizer.EOFError'>\n\n    @pytest.mark.parametrize(\n        (\"css\", \"exception\"),\n        [\n            (\"Selector {\", EOFError),\n            (\"Selector{ Foo {\", EOFError),\n            (\"Selector{ Foo {}\", EOFError),\n            (\"> {}\", TokenError),\n            (\"&\", TokenError),\n            (\"&&\", TokenError),\n            (\"&.foo\", TokenError),\n            (\"& .foo\", TokenError),\n            (\"{\", TokenError),\n            (\"*{\", EOFError),\n        ],\n    )\n    def test_parse_errors(css: str, exception: type[Exception]) -> None:\n        \"\"\"Check some CSS which should fail.\"\"\"\n        with pytest.raises(exception):\n>           list(parse(\"\", css, (\"foo\", \"\")))\n\ntests/css/test_nested_css.py:112: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nscope = '', css = '*{', read_from = ('foo', ''), variables = None\nis_default_rules = False, tie_breaker = 0\n\n    def parse(\n        scope: str,\n        css: str,\n        read_from: CSSLocation,\n        variables: dict[str, list[Token]] | None = None,\n        is_default_rules: bool = False,\n        tie_breaker: int = 0,\n    ) -> list[RuleSet]:\n        \"\"\"Parse CSS by tokenizing it, performing variable substitution,\n        and generating rule sets from it.\n    \n        Args:\n            scope: CSS type name.\n            css: The input CSS.\n            read_from: The source location of the CSS.\n            variables: Substitution variables to substitute tokens for.\n            is_default_rules: True if the rules we're extracting are\n                default (i.e. in Widget.DEFAULT_CSS) rules. False if they're from user defined CSS.\n            tie_breaker: Integer representing the priority of this source.\n    \n        Returns:\n            A list of RuleSet objects representing the parsed CSS.\n        \"\"\"\n        tokens = iter(tokenize(css, read_from))\n        rule_sets: list[RuleSet] = []\n    \n        try:\n            while True:\n                token = next(tokens)\n                if token.name in {\n                    \"selector_start\",\n                    \"selector_start_id\",\n                    \"selector_start_class\",\n                    \"selector_start_universal\",\n                }:\n                    rule_sets.extend(\n                        parse_rule_set(\n                            scope,\n                            tokens,\n                            token,\n                            is_default_rules=is_default_rules,\n                            tie_breaker=tie_breaker,\n                        )\n                    )\n                elif token.name == \"variable_name\":\n                    variable_name = token.value.rstrip(\":\")\n                    variable_tokens = list(\n                        tokenize_variable_value(tokens, expect_variable_name_continue)\n                    )\n                    if variables is not None:\n                        variables[variable_name] = variable_tokens\n                elif token.name == \"eof\":\n                    break\n    \n>       except TokenError as error:\nE       NameError: name 'TokenError' is not defined\n\nsrc/textual/css/parse.py:485: NameError\n=============================== warnings summary ===============================\ntests/css/test_nested_css.py::test_nest_app\ntests/css/test_nested_css.py::test_pseudo_classes_work_in_nested_css\ntests/css/test_nested_css.py::test_rule_declaration_after_nested\ntests/css/test_nested_css.py::test_lists_of_selectors_in_nested_css\n  /usr/local/lib/python3.10/site-packages/tornado/ioloop.py:274: DeprecationWarning: There is no current event loop\n    loop = asyncio.get_event_loop()\n\ntests/css/test_nested_css.py::test_nest_app\n  /usr/local/lib/python3.10/site-packages/tornado/platform/asyncio.py:288: DeprecationWarning: There is no current event loop\n    super().initialize(asyncio.get_event_loop(), **kwargs)\n\n-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html\n=========================== short test summary info ============================\nFAILED tests/css/test_nested_css.py::test_nest_app - textual.css.errors.Style...\nFAILED tests/css/test_nested_css.py::test_pseudo_classes_work_in_nested_css\nFAILED tests/css/test_nested_css.py::test_rule_declaration_after_nested - tex...\nFAILED tests/css/test_nested_css.py::test_lists_of_selectors_in_nested_css - ...\nFAILED tests/css/test_nested_css.py::test_parse_errors[Selector {-EOFError]\nFAILED tests/css/test_nested_css.py::test_parse_errors[Selector{ Foo {-EOFError]\nFAILED tests/css/test_nested_css.py::test_parse_errors[Selector{ Foo {}-EOFError]\nFAILED tests/css/test_nested_css.py::test_parse_errors[> {}-TokenError] - Nam...\nFAILED tests/css/test_nested_css.py::test_parse_errors[&-TokenError] - NameEr...\nFAILED tests/css/test_nested_css.py::test_parse_errors[&&-TokenError] - NameE...\nFAILED tests/css/test_nested_css.py::test_parse_errors[&.foo-TokenError] - Na...\nFAILED tests/css/test_nested_css.py::test_parse_errors[& .foo-TokenError] - N...\nFAILED tests/css/test_nested_css.py::test_parse_errors[{-TokenError] - NameEr...\nFAILED tests/css/test_nested_css.py::test_parse_errors[*{-EOFError] - NameErr...\n======================== 14 failed, 5 warnings in 1.96s ========================\n\n"], "textual-src/textual/css/stylesheet.py-_parse_rules": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 0 items\n\n============================ no tests ran in 0.08s =============================\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_opacity_invalid_value\n(no match in any of [<Module test_parse.py>])\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_text_align_invalid\n(no match in any of [<Module test_parse.py>])\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_unknown_easing_function\n(no match in any of [<Module test_parse.py>])\n\n"], "textual-src/textual/css/stylesheet.py-parse": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/textual\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 3 items\n\n============================ no tests ran in 0.08s =============================\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_opacity_invalid_value\n(no match in any of [<Module test_parse.py>])\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_type_starts_with_number\n(no match in any of [<Module test_parse.py>])\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_unknown_easing_function\n(no match in any of [<Module test_parse.py>])\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_combined_type_starts_with_number\n(no match in any of [<Module test_parse.py>])\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_text_align_invalid\n(no match in any of [<Module test_parse.py>])\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_background\n(no match in any of [<Module test_parse.py>])\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_foreground\n(no match in any of [<Module test_parse.py>])\n\nERROR: not found: /root/repos/py_data/textual/tests/css/test_parse.py::test_invalid_layout_name\n(no match in any of [<Module test_parse.py>])\n\n"], "gpt-engineer-gpt_engineer/core/chat_to_files.py-parse_diffs": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/gpt-engineer\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 8 items\n\ntests/core/test_chat_to_files.py F.FF.F..                                [100%]\n\n=================================== FAILURES ===================================\n_______________ test_correct_skipped_lines_and_number_correction _______________\n\n    def test_correct_skipped_lines_and_number_correction():\n        distorted_example = insert_string_in_lined_string(\n            file_example, \"#\\n#comment\\n#\\n#\", 14\n        )\n        diffs = parse_diffs(example_line_dist_diff)\n        # list(diffs.values())[0].validate_and_correct(file_to_lines_dict(distorted_example))\n        for diff in diffs.values():\n            problems = diff.validate_and_correct(file_to_lines_dict(distorted_example))\n            print(problems)\n        with open(\n            os.path.join(\n                THIS_FILE_DIR,\n                \"improve_function_test_cases\",\n                \"corrected_diff_from_missing_lines\",\n            ),\n            \"r\",\n        ) as f:\n            corrected_diff_from_missing_lines = f.read()\n>       assert (\n            diffs[\"example.txt\"].diff_to_string().strip()\n            == corrected_diff_from_missing_lines.strip()\n        )\nE       AssertionError: assert '--- example....ion of step Y' == '--- example....ion of step Y'\nE         \nE           --- example.txt\nE           +++ example.txt\nE         - @@ -12,7 +12,8 @@\nE         ?      ^ ^   ^ ^\nE         + @@ -10,9 +10,10 @@\nE         ?      ^ ^   ^ ^^...\nE         \nE         ...Full output truncated (26 lines hidden), use '-vv' to show\n\ntests/core/test_chat_to_files.py:257: AssertionError\n----------------------------- Captured stdout call -----------------------------\n[]\n_________________________ test_diff_changing_two_files _________________________\n\n    def test_diff_changing_two_files():\n        merged_diff = parse_diffs(example_diff + add_example)\n        correct_diff = \"\\n\".join(example_diff.strip().split(\"\\n\")[4:-1])\n        correct_add_diff = \"\\n\".join(add_example.strip().split(\"\\n\")[2:-1])\n>       assert merged_diff[\"example.txt\"].diff_to_string() == correct_diff\nE       AssertionError: assert '--- example.... with changes' == '--- example....ion of step Y'\nE         \nE         Skipping 166 identical leading characters in diff, use -v to show\nE         - ith changes\nE         ?            -\nE         + ith changes\nE         - @@ -35,4 +36,5 @@\nE         -          checking status:...\nE         \nE         ...Full output truncated (6 lines hidden), use '-vv' to show\n\ntests/core/test_chat_to_files.py:198: AssertionError\n________________________ test_correct_distorted_numbers ________________________\n\n    def test_correct_distorted_numbers():\n        lines_dict = file_to_lines_dict(file_example)\n        diffs = parse_diffs(example_line_dist_diff)\n        # This is a test in its own right since it full of exceptions, would something go wrong\n        list(diffs.values())[0].validate_and_correct(lines_dict)\n        correct_diff = \"\\n\".join(example_diff.strip().split(\"\\n\")[4:-1])\n>       assert diffs[\"example.txt\"].diff_to_string() == correct_diff\nE       AssertionError: assert '--- example....ion of step Y' == '--- example....ion of step Y'\nE         \nE           --- example.txt\nE           +++ example.txt\nE         - @@ -12,3 +12,4 @@\nE         ?      ^ ^   ^ ^\nE         + @@ -10,5 +10,6 @@\nE         ?      ^ ^   ^ ^...\nE         \nE         ...Full output truncated (20 lines hidden), use '-vv' to show\n\ntests/core/test_chat_to_files.py:215: AssertionError\n__________________________ test_correct_skipped_lines __________________________\n\n    def test_correct_skipped_lines():\n        distorted_example = insert_string_in_lined_string(\n            file_example, \"#\\n#comment\\n#\\n#\", 14\n        )\n        diffs = parse_diffs(example_diff)\n        list(diffs.values())[0].validate_and_correct(file_to_lines_dict(distorted_example))\n        with open(\n            os.path.join(\n                THIS_FILE_DIR,\n                \"improve_function_test_cases\",\n                \"corrected_diff_from_missing_lines\",\n            ),\n            \"r\",\n        ) as f:\n            corrected_diff_from_missing_lines = f.read()\n>       assert (\n            diffs[\"example.txt\"].diff_to_string().strip()\n            == corrected_diff_from_missing_lines.strip()\n        )\nE       AssertionError: assert '--- example....ion of step Y' == '--- example....ion of step Y'\nE         \nE         Skipping 192 identical leading characters in diff, use -v to show\nE           nges\nE         - @@ -39,4 +40,5 @@\nE         + @@ -35,8 +36,9 @@\nE         +  \nE         +  ...\nE         \nE         ...Full output truncated (9 lines hidden), use '-vv' to show\n\ntests/core/test_chat_to_files.py:233: AssertionError\n=========================== short test summary info ============================\nFAILED tests/core/test_chat_to_files.py::test_correct_skipped_lines_and_number_correction\nFAILED tests/core/test_chat_to_files.py::test_diff_changing_two_files - Asser...\nFAILED tests/core/test_chat_to_files.py::test_correct_distorted_numbers - Ass...\nFAILED tests/core/test_chat_to_files.py::test_correct_skipped_lines - Asserti...\n========================= 4 failed, 4 passed in 0.07s ==========================\n\n"], "gpt-engineer-gpt_engineer/core/ai.py-start": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/gpt-engineer\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 3 items\n\ntests/core/test_ai.py ...                                                [100%]\n\n============================== 3 passed in 0.81s ===============================\n\n"], "gpt-engineer-gpt_engineer/core/ai.py-next": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/gpt-engineer\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 2 items\n\ntests/core/test_ai.py ..                                                 [100%]\n\n============================== 2 passed in 0.81s ===============================\n\n"], "gpt-engineer-gpt_engineer/core/project_config.py-to_toml": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/gpt-engineer\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 4 items\n\ntests/test_project_config.py ....                                        [100%]\n\n============================== 4 passed in 0.05s ===============================\n\n"], "gpt-engineer-gpt_engineer/core/diff.py-is_similar": ["============================= test session starts ==============================\nplatform linux -- Python 3.10.1, pytest-8.2.2, pluggy-1.5.0\nbenchmark: 4.0.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)\nrootdir: /root/repos/py_data/gpt-engineer\nconfigfile: pytest.ini\nplugins: examples-0.0.13, mock-3.11.1, timeout-2.3.1, asyncio-0.23.7, tornasync-0.6.0.post2, anyio-4.4.0, lazy-fixtures-1.0.7, benchmark-4.0.0, xdist-3.6.1, Faker-26.0.0, time-machine-2.14.2\nasyncio: mode=strict\ncollected 4 items\n\ntests/core/test_chat_to_files.py ....                                    [100%]\n\n============================== 4 passed in 0.04s ===============================\n\n"]}